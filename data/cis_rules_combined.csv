"rule_id","benchmark","device_type","control_name","cis_level","description","expected_values","validation_logic","remediation_steps","severity","is_active","references","audit","rationale","impact"
"1.1","CIS FortiGate 7.4.x Benchmark","FortiGate","Ensure DNS server is configured","Level 1","Fortinet uses the Domain Name Service (DNS) to translate host names into IP
addresses. To enable DNS lookups, you must specify the primary DNS server for your
system. You can also specify secondary and tertiary DNS servers. When resolving host
names, the system consults the primary name server. If a failure or time-out occurs, the
system consults the secondary name server.
For security purpose, trusted DNS servers should be configured to prevent man-in-the-
middle attacks.

Default Value:
Default primary DNS server is 96.45.45.45. Default secondary DNS server is
96.45.46.46.","","","In this example, we will assign 8.8.8.8 as primary DNS and 8.8.4.4 as secondary DNS.
In CLI:
FGT1 # config system dns
FGT1 (dns) # set primary 8.8.8.8
FGT1 (dns) # set secondary 8.8.4.4
FGT1 (dns) # end
FGT1 #
In the GUI, go to Networks > DNS. Click on ""Specify"" and put in 8.8.8.8 as ""Primary
DNS Server"" and 8.8.4.4 as ""Secondary DNS Server""","","true","1. https://docs.fortinet.com/document/fortigate/7.4.0/administration-guide/903162","In CLI:
FGT1 # config system dns
FGT1 (dns) # show
config system dns
set primary <ip_address>
set secondary <ip_address>
...
end
In the GUI, go to Networks > DNS. The FortiGate uses either the default FortiGuard
DNS or customized DNS","The purpose is to perform the resolution of system hostnames to Internet Protocol (IP)
addresses using trusted DNS servers.",""
"1.2","CIS FortiGate 7.4.x Benchmark","FortiGate","Ensure intra-zone traffic is not always allowed","Level 1","This is to make sure that only specific, authorized traffic is allowed between networks in
the same zone.

Default Value:
By default, intra-zone traffic is blocked","","","In this example, we'll turn off intra-zone traffic in the zone DMZ. In CLI:
FGT1 # config system zone
FGT1 (zone) # edit DMZ
FGT1 (DMZ) # set intrazone deny
FGT1 (DMZ) # end
FGT1 #
In the GUI, click on Network -> Interfaces, select the zone and click on ""Edit"" and turn
on ""Block intra-zone traffic""","","true","1. https://docs.fortinet.com/document/fortigate/7.4.5/cli-
reference/314783845/config-system-zone
2. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/116821","In this example, we'll verify the zone DMZ. In CLI:
FGT1 # config system zone
FGT1 (zone) # edit DMZ
FGT1 (DMZ) # show full
config system zone
edit ""DMZ""
...
set intrazone deny
...
next
end
In the GUI, click on Network -> Interfaces, select the zone and click on ""Edit"". Make
sure that the option ""Block intra-zone traffic"" is enabled.","This adds an extra layer of protection between different networks.",""
"1.3","CIS FortiGate 7.4.x Benchmark","FortiGate","Disable all management related services on WAN port","Level 1","Enabling any management related services on WAN interface is high risk. Management
related services such as HTTPS, HTTP, ping, SSH, SNMP, and Radius should be
disabled on WAN.","","","On GUI:
Go to ""Network"" > ""Interfaces"".
Review WAN interface and disable HTTPS, HTTP, ping, SSH, SNMP, and Radius
services.
On CLI:
FGT1 # config system interface
FGT1 (interface) # edit ""port1""
FGT1 (port1) # unselect allowaccess ping https ssh snmp http radius-acct
Note:
1. Interface name may differ based on deployment. For this example, port1 is
deployed as WAN interface.
2. ""unselect allowaccess"" will only show services that you have enabled. If you
have not enabled snmp on that interface, then snmp option will not be available.","","true","","On GUI:
Go to ""Network"" > ""Interfaces"".
Identify WAN interface and validate that HTTPS, HTTP, PING, SSH, SNMP, and
Radius Accounting is not enabled in ""Administrative Access"" section.
On CLI:
`FGT1 # show system interface`
Identify WAN interface and validate that ""set allowaccess"" does not include ping, https,
http, ssh, snmp or radius-acct configured.","Management related services should only be enabled on management interface. This is
part of defending the firewall from attacks and reducing the attack surface. For WAN
related services such as IPsec and SSLVPN, make use of local-in-policy (refer to CIS
Section 2.4) to tighten firewall defenses.","Enabling management related services on WAN port is convenient, but it exposes the
firewall to unnecessary risks. Vulnerabilities found on vendor devices are commonly
related to management services, and opening access to these allows attackers to
exploit its vulnerabilities."
"2.1.1","CIS FortiGate 7.4.x Benchmark","FortiGate","Ensure 'Pre-Login Banner' is set","Level 1","Configure a pre-login banner, ideally approved by the organization’s legal team. This
banner should, at minimum, prohibit unauthorized access, provide notice of logging or
monitoring, and avoid using the word “welcome” or similar words of invitation.

Default Value:
the 'Pre-Login Banner' is disabled by default
FG1 # config system global
FG1 (global) # show
config system global
...
set pre-login-banner disable
...
end
the warning message default value is as follows:
PRE WARNING:
This is a private computer system. Unauthorized access or use
is prohibited and subject to prosecution and/or disciplinary
action. All use of this system constitutes consent to
monitoring at all times and users are not entitled to any
expectation of privacy. If monitoring reveals possible evidence
of violation of criminal statutes, this evidence and any other
related information, including identification information about
the user, may be provided to law enforcement officials.
If monitoring reveals violations of security regulations or
unauthorized use, employees who violate security regulations or
make unauthorized use of this system are subject to appropriate
disciplinary action.","","","Run the following command in the CLI to enable the pre-login-banner:
FG1 # config system global
FG1 (global) # set pre-login-banner enable
FG1 (global) # end
FG1 #
In the GUI, to edit the content of the pre-login disclaimer message:
1. Go to 'System' -> 'Replacement Messages' -> 'Extended View' -> 'Pre-login
Disclaimer Message'. The edit screen is on the bottom right corner of the page.
Click on ""Save"" after the editing is done.","","true","1. https://community.fortinet.com/t5/FortiGate/Technical-Tip-Configuring-admin-
disclaimer-page/ta-p/198609?externalID=FD33887","Run the following command in the CLI to verify the pre-login-banner is enabled:
FG1 # get system global
...
pre-login-banner : enable
...
end
In the GUI, to verify the content of the pre-login disclaimer message:
1) Go to 'System' -> 'Replacement Messages'
2) From the top right side, select 'Extended View'
3) Find 'Pre-login Disclaimer Message'","Through a properly stated login banner, the risk of unintentional access to the device by
unauthorized users is reduced. Should legal action take place against a person
accessing the device without authorization, the login banner greatly diminishes a
defendant’s claim of ignorance.","Login banners provide a definitive warning to any possible intruders who may want to
access the FortiGate that certain types of activity are illegal. At the same time, it also
advises the authorized and legitimate users of their obligations relating to acceptable
use."
"2.1.2","CIS FortiGate 7.4.x Benchmark","FortiGate","Ensure 'Post-Login-Banner' is set","Level 1","Sets the banner after users successfully log in. This is equivalent to Message of the Day
(MOTD) in some other systems.

Default Value:
POST WARNING: This is a private computer system. Unauthorized access or use is
prohibited and subject to prosecution and/or disciplinary action. All use of this system
constitutes consent to monitoring at all times and users are not entitled to any
expectation of privacy. If monitoring reveals possible evidence of violation of criminal
statutes, this evidence and any other related information, including identification
information about the user, may be provided to law enforcement officials. If monitoring
reveals violations of security regulations or unauthorized use, employees who violate
security regulations or make unauthorized use of this system are subject to appropriate
disciplinary action.
%%LAST_SUCCESSFUL_LOGIN%% %%LAST_FAILED_LOGIN%%","","","Run the following command in the CLI to enable the post-login-banner:
FG1 # config system global
FG1 (global) # set post-login-banner enable
FG1 (global) # end
FG1 #
In the GUI, to edit the content of the post-login disclaimer message, go to
System -> Replace Messages -> Extended View -> ""Post-login Disclaimer
Message"". The edit screen is on the bottom right corner of the page. Click on
""Save"" after the editing is done.","","true","1. https://community.fortinet.com/t5/FortiGate/Technical-Tip-Configuring-admin-
disclaimer-page/ta-p/198609?externalID=FD33887","Run the following command in the CLI to verify the post-login-banner is enabled:
FG1 # get system global
...
post-login-banner : enable
...
In the GUI, to verify the content of the post-login disclaimer message:
1) Go to 'System' -> 'Replacement Messages'
2) From the top right side, select 'Extended View'
3) Find 'Post-login Disclaimer Message'","Network banners are electronic messages that provide notice of legal rights to users of
computer networks. From a legal standpoint, banners have four primary functions:
First, banners may be used to generate consent to real-time monitoring under Title III.
Second, banners may be used to generate consent to the retrieval of stored files and
records pursuant to ECPA. Third, in the case of government networks, banners may
eliminate any Fourth Amendment ""reasonable expectation of privacy"" that government
employees or other users might otherwise retain in their use of the government's
network under O'Connor v.","When post-login banner is enabled, some automated-script might be affected because
both CLI and GUI need an acceptance action (press ""A"" or ""Accept"") to continue."
"2.1.3","CIS FortiGate 7.4.x Benchmark","FortiGate","Ensure timezone is properly configured","Level 1","Sets the local time zone information so that the time displayed by the device is more
relevant to those who are viewing it.

Default Value:
Default value is (GMT-8:00) Pacific Time (US & Canada)

Additional Information:
Daylight savings time is enabled by default, and can only be configured in the CLI.","","","In this example, we will set Eastern Timezone (GMT-5:00) for the Fortigate. Each
timezone will have its corresponding ID. To find the correct ID, when you type in the
command ""set timezone "", also type the question mark '?' to list all of the available
timezones and their IDs. The ID of the Eastern Timezone is 12 In the CLI:
FGT1 # config system global
FGT1 (global) # set timezone 12
FGT1 (global) # end
FGT1 #
In the GUI, do the following:
1) After login to fortigate, go to 'System' -> 'Settings'
2) Select '(GMT-5:00) Eastern Time (US & Canada)' under 'System Time'","","true","1. https://community.fortinet.com/t5/FortiGate/Technical-Tip-Setting-the-system-
time/ta-p/192907?externalID=FD49018
2. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/512210","In the CLI, do the following command and check the result of timezone filed in the
output
FGT1 # get system global
...
timezone : (GMT-8:00) Pacific Time (US & Canada)
...
Or from GUI, do the following:
1) Login to FortiGate
2) Go to 'System' -> 'Settings'.
3) Time Zone and NTP settings are under 'System Time'","Having a correct time set on the device is important for two main reasons. The first
reason is that digital certificates compare this time to the range defined by their Valid
From and Valid To fields to define a specific validity period. The second reason is to
have relevant time stamps when logging information. Whether you are sending
messages to a Syslog server, sending messages to an SNMP monitoring station, or
performing packet captures, timestamps have little usefulness if you cannot be certain
of their accuracy.","For many features to work, including scheduling, logging, and SSL-dependent features,
the FortiOS system time must be accurate."
"2.1.4","CIS FortiGate 7.4.x Benchmark","FortiGate","Ensure correct system time is configured through NTP","Level 1","You can either manually set the FortiOS system time, or configure the device to
automatically keep its system time correct by synchronizing with a Network Time
Protocol (NTP) server.
These settings enable the use of primary and secondary NTP servers to provide
redundancy in case of a failure involving the primary NTP server.

Default Value:
By default, Fortinet uses the NTPs server of the FortiGuard

Additional Information:
Daylight savings time is enabled by default, and can only be configured in the CLI.","","","You can only customize NTP setting using CLI. In this example, we'll assign
pool.ntp.org as primary NTP server and 1.1.1.1 as secondary NTP server.
FGT1 # config system ntp
FGT1 (ntp) # set type custom
FGT1 (ntp) # config ntpserver
FGT1 (ntpserver) # edit 1
FGT1 (1) # set server pool.ntp.org
FGT1 (1) # next
FGT1 (ntpserver) # edit 2
FGT1 (2) # set server 1.1.1.1
FGT1 (2) # end
FGT1 (ntp) # end
FGT1 #","","true","1. https://community.fortinet.com/t5/FortiGate/Technical-Tip-Setting-the-system-
time/ta-p/192907?externalID=FD49018
2. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/512210","In the CLI:
FGT1 # diag sys ntp status
synchronized: yes, ntpsync: enabled, server-mode: enabled
ipv4 server(ntp2.fortiguard.com) 208.91.114.23 -- reachable(0xff) S:3 T:54
server-version=4, stratum=1
reference time is e12361d5.f27e0322 -- UTC Wed Sep 11 12:06:45 2019
clock offset is -0.001569 sec, root delay is 0.000000 sec
root dispersion is 0.010269 sec, peer dispersion is 19 msec
ipv4 server(ntp1.fortiguard.com) 208.91.115.123 -- reachable(0xff) S:3 T:54
selected
server-version=4, stratum=1
reference time is e12361d4.4f8b22a5 -- UTC Wed Sep 11 12:06:44 2019
clock offset is -0.000652 sec, root delay is 0.000000 sec
root dispersion is 0.010284 sec, peer dispersion is 8 msec
ipv4 server(ntp2.fortiguard.com) 208.91.113.71 -- reachable(0xff) S:3 T:54
server-version=4, stratum=2
reference time is e12361d6.4caf57ab -- UTC Wed Sep 11 12:06:46 2019
clock offset is -0.004814 sec, root delay is 0.000137 sec
root dispersion is 0.011154 sec, peer dispersion is 3 msec
ipv4 server(ntp1.fortiguard.com) 208.91.113.70 -- reachable(0xff) S:3 T:54
server-version=4, stratum=2
reference time is e123617b.c98e2059 -- UTC Wed Sep 11 12:05:15 2019
clock offset is -0.005106 sec, root delay is 0.000122 sec
root dispersion is 0.013382 sec, peer dispersion is 6 msec","NTP enables the device to maintain accurate time and date when receiving updates
from a reliable NTP server. Accurate timestamps are critical when correlating events
with other systems, troubleshooting, or performing investigative work. Logs and certain
cryptographic functions, such as those utilizing certificates, rely on accurate time and
date parameters. In addition, rules referencing a Schedule object will not function as
intended if the device’s time and date are incorrect. For additional security,
authenticated NTP can be utilized. If Symmetric Key authentication is selected, only
SHA1 should be used, as MD5 is considered severely compromised.","For many features to work, including scheduling, logging, and SSL-dependent features,
the FortiOS system time must be accurate."
"2.1.5","CIS FortiGate 7.4.x Benchmark","FortiGate","Ensure hostname is set","Level 1","Changes the device default hostname.

Default Value:
The default value of the hostname is the model number of the unit. Example: 'FortiGate
2000E'","","","In CLI, set the hostname to 'New_FGT1' as follows:
FGT1 # config system global
FGT1 (global) # set hostname ""New_FGT1""
FGT1 (global) # end
New_FGT1 #
In GUI
1) Go to 'System' > 'Settings'
2) Update the field 'Hostname' with the new hostname
3) click 'Apply'","","true","1. https://community.fortinet.com/t5/FortiGate/Technical-Tip-Renaming-the-
hostname/ta-p/198521?externalID=FD48765","In CLI
get system global
...
hostname : FG1
...
In GUI
1) Go to 'System' > 'Settings'
2) Check the field 'Hostname'","The device hostname plays an important role in asset inventory and identification as a
security requirement. It is also crucial in the public keys and certificate deployments, as
well as when correlating logs from different systems during an incident handling.",""
"2.1.6","CIS FortiGate 7.4.x Benchmark","FortiGate","Ensure the latest firmware is installed","Level 2","Check against the Fortinet website to make sure that the latest stable firmware is
installed.

Default Value:
There is no default firmware. The hardware comes with the latest firmware at the time it
was manufactured.","","","First, determine the upgrade path recommended by Fortinet. If you have not upgraded
the system for a long time, it is not recommended to upgrade straight to the latest
version, as the configuration could be lost. Fortinet provides a tool to recommend an
upgrade path for all of its products.
Go to https://docs.fortinet.com/upgrade-tool. Choose your product from the ""Current
Product"" drop-down menu, the ""current FortiOS version"", and the latest firmware
version available for that model from ""Upgrade to FortiOS Version"". Click ""Go"". Write
down the path and then click on ""Download"" to download all the necessary versions.
The second step is to download the required FortiOS firmware/s. Go to
https://support.fortinet.com and login. Go to Support -> Firmware Download. Once
there, select the product and click on ""Upgrade Path"". Choose the specific model of the
hardware, the current firmware version and the latest firmware version available for that
model. Click ""Go"". Write down the path and then click on ""Download"" to download all
the necessary versions.
The last step is to install the new firmwares in the order provided by the ""Upgrade tool"".
It is recommended to use GUI to perform this task as it would be much easier.
In the GUI
1. Go to System > Fabric Management
2. Right click on device that needs to be upgraded.
3. Then click on ""Upgrade"". You might have to perform this step multiple
times if you follow the upgrade path.","","true","1. https://community.fortinet.com/t5/FortiGate/Technical-Tip-How-to-upgrade-
FortiGate-firmware/ta-p/194980?externalID=10948","First, check for the latest firmware version available by going to
https://docs.fortinet.com/upgrade-tool, select your product from the Current Product
drop-down menu, then select the upgrade to FortiOS Version for the latest available
version.
Second, verify the current firmware on your system. In the CLI:
FGT1 # get system status
...
Version: Fortigate-100D v6.2.7,build1190,201216 (GA)
...
FGT1 #
In the GUI:
1. Go to Dashboard > Status > System information
2. Check for firmware.
At the same time, go to https://www.fortiguard.com/psirt?product=FortiOS and check for
vulnerabilities that your existing version might have.","Fortinet periodically updates the FortiGate firmware to include new features and resolve
important issues. After you have registered your FortiGate unit, firmware updates can
be downloaded from the Fortinet Customer Service & Support website.
It is important to constantly keep the firmware up to date to prevent any new well-known
exploitation.",""
"2.1.7","CIS FortiGate 7.4.x Benchmark","FortiGate","Disable USB Firmware and configuration installation","Level 2","Disable USB port auto install feature for config and firmware.

Default Value:
auto-install is enabled by default.","","","CLI:
config system auto-install
set auto-install-config disable
set auto-install-image disable
end","","true","1. https://docs.fortinet.com/document/fortigate/7.4.5/cli-
reference/304730529/config-system-auto-install","CLI:
config system auto-install
get
Verify that set auto-install-config and set auto-install-image are disabled","Disabling USB port for auto install prevents a USB with a manipulated configuration or
incorrect firmware from being connected and loaded automatically.",""
"2.1.8","CIS FortiGate 7.4.x Benchmark","FortiGate","Disable static keys for TLS","Level 2","Disable support for static keys on TLS sessions terminating on the FortiGate

Default Value:
ssl-static-key-ciphers is enabled","","","CLI:
config system global
set ssl-static-key-ciphers disable
end","","true","1. https://docs.fortinet.com/document/fortigate/7.4.5/cli-
reference/339914554/config-system-global","CLI:
config system global
get
Validate that ssl-static-key-ciphers disabled.","Prevent TLS sessions terminating on the FortiGate from using static SSL keys",""
"2.1.9","CIS FortiGate 7.4.x Benchmark","FortiGate","Enable Global Strong Encryption","Level 2","Enable FortiOS to only use strong encryption and allow only strong ciphers for
communication

Default Value:
strong-crypto is enabled by default.","","","CLI:
config system global
set strong-crypto enable
end","","true","1. https://docs.fortinet.com/document/fortigate/7.4.5/cli-
reference/339914554/config-system-global","CLI:
config system global
get
Validate strong-crypto is enabled.","",""
"2.1.10","CIS FortiGate 7.4.x Benchmark","FortiGate","Ensure management GUI listens on secure TLS version","Level 1","As we move towards better encryption capabilities, we need to also ensure GUI access
is properly secured. TLS 1.3 is currently the most secure SSL/TLS supported version for
SSL-encrypted administrator access (at this time of writing).

Default Value:
FortiOS 7.x - TLS 1.2 and 1.3 enabled
FortiOS 6.x - TLS 1.1, 1.2, and 1.3 enabled","","","CLI:
config system global
set admin-https-ssl-versions tlsv1-3","","true","1. https://docs.fortinet.com/document/fortigate/7.4.5/cli-
reference/339914554/config-system-global","CLI:
config system global
get
Verify if set admin-https-ssl-versions tlsv1-3 is configured.","Use higher version of SSL/TLS to prevent MiTM attacks.",""
"2.1.11","CIS FortiGate 7.4.x Benchmark","FortiGate","Ensure CDN is enabled for improved GUI performance","Level 2","To improve GUI performance, an option is added to enable loading static GUI artifacts
cached in CDN (content delivery network) servers closer to the user rather than from
the FortiGate. On failure, the files can fall back to loading from the FortiGate.

Default Value:
Enabled","","","On CLI:
config system global
set gui-cdn-usage enable
end","","true","1. https://docs.fortinet.com/document/fortigate/7.4.5/administration-
guide/205105/loading-artifacts-from-a-cdn","On CLI:
config system global
get
Ensure that gui-cdn-usage is enabled.","When accessing a remote FortiGate, GUI might experience some slowness due to
geographical distance. For this case, loading static GUI artifacts cached in CDN servers
will provide a better GUI / web management experience.","This is not a security control recommendation. Hence, there is no impact if this is not
enabled."
"2.1.12","CIS FortiGate 7.4.x Benchmark","FortiGate","Ensure single CPU core overloaded event is logged","Level 1","Add log-single-cpu-high option under config system global. When enabled, CPU single
core usage will be polled every three seconds, and any single CPU core usage above
the CPU usage threshold will report an event log. If a core is reported, that core will not
be checked again for the next 30 seconds.

Default Value:
Disabled","","","On CLI:
config system global
set log-single-cpu-high enable
end","","true","1. https://community.fortinet.com/t5/FortiGate/Technical-Tip-Enable-logging-for-
single-core-CPU-spike-against/ta-p/293010
2. https://docs.fortinet.com/document/fortigate/7.2.4/fortios-release-
notes/743723/new-features-or-enhancements","On CLI:
config system global
get
Ensure that log-single-cpu-high is enabled.","There are instances where overall CPU usage is low, but there is a single CPU core
that is overloaded. But because reporting and dashboard in FortiGate shows the overall
CPU usage, a single CPU core spike may get overlooked on a FortiGate with multiple
CPU cores. This causes performance issues where there are instances which traffic has
been stopped processing.",""
"2.1.13","CIS FortiGate 7.4.x Benchmark","FortiGate","Ensure Hostname is Not Displayed On Login GUI","Level 2","Ensure that the device hostname is not displayed on the GUI login page

Default Value:
Default Value for ""gui-display-hostname"" is disable
2.2 Password Policy
This Section contains criteria for local passwords such as complexity and restrictions.
The best practice is to use named accounts, and if possible a back-end authentication
solution such as Active Directory or (best case) a two-factor authentication solution.
However, local credentials will always exist, if only to account for the failure of a back-
end authentication solution.","","","To disable ""gui-display-hostname""
In the CLI:
FGT1 # config system global
FGT1 (global) # set gui-display-hostname disable
FGT1 (global) # end
FGT1 #","","true","","From the CLI run the command:
FGT1 # get system global | grep -f gui-display
gui-display-hostname: disable <---
If ""gui-display-hostname"" is set to disable the hostname will not be displayed on the
login screen","The hostname of the device may be displayed on the GUI login page which may provide
information for reconnaissance",""
"2.2.1","CIS FortiGate 7.4.x Benchmark","FortiGate","Ensure 'Password Policy' is enabled","Level 1","It is important to use secure and complex passwords for preventing unauthorized
access to the FortiGate device.

Default Value:
By default, 'Password Policy' is disabled. It can be checked from CLI as follows:
config system password-policy
set status disable
end
Or from GUI as follows:
1) Log in to FortiGate as Super Admin
2) Go to 'System' > 'Settings'
3) Find the 'Password Policy' section
4) Default 'Password scope' is 'Off'

Additional Information:
Consider the following to ensure better security:
• Do not use passwords that are obvious, such as the company name,
administrator names, or other obvious words or phrases.
• Administrator passwords can be up to 64 characters.
• Use multiple words together, or possibly even a sentence, for example:
correcthorsebatterystaple.
• Make note of the password and store it in a safe place away from the
management computer, in case you forget it; or ensure at least two people know
the password in the event one person becomes unavailable. Alternatively, have
two different admin logins.","","","Can be modified from CLI or GUI.
From CLI, do the following:
config system password-policy
set status enable
set apply-to admin-password ipsec-preshared-key
set minimum-length 14
end
Or from GUI, do the following:
1) Log in to FortiGate as Super Admin
2) Go to 'System' > 'Settings'
3) Find the 'Password Policy' section
4) Default 'Password scope' is 'Off', change it to 'Both'
5) set 'Minimum length' to '14'","","true","1. https://pages.nist.gov/800-63-4/sp800-63b.html
2. https://docs.fortinet.com/document/fortigate/7.4.5/cli-
reference/127236326/config-system-password-policy
3. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/364729","Currently implemented password policy can be shown from GUI or CLI
From CLI, type:
get system password-policy
Or from GUI as follows:
1) Log in to FortiGate with a user with at least read-only privileges
2) Go to 'System' > 'Settings'
3) Find and check the status of the 'Password Policy' Section
4) Ensure 'Password scope' is 'Both'
5) Ensure 'Minimum length' to '14'
The recent update by NIST on password policy has shifted focus to password length,
since longer passwords are harder to crack with brute-force attacks. Not enforcing
password complexity such as symbols and numbers can be easier for users to
remember without being predictable.
NIST also is now recommending password resets in the case of a credential breach
only.","Attackers can use brute force password software to launch more than just dictionary
attacks. Such attacks can discover common passwords where a letter is replaced by a
number or symbol. Center for Internet Security (CIS) recommends that passwords
should be at least 14 characters long with no limit on the enforced maximum number of
characters","Weak passwords can be easily discovered by hackers, which leads to unauthorized
access to FortiGate. Depending on the access privilege of the compromised account,
the attacker may modify important settings."
"2.2.2","CIS FortiGate 7.4.x Benchmark","FortiGate","Ensure administrator password retries and lockout time are configured","Level 1","Failed login attempts can indicate malicious attempts to gain access to your network. To
prevent this security risk, FortiGate is preconfigured to limit the number of failed
administrator login attempts. After the maximum number of failed login attempts is
reached, access to the account is blocked for the configured lockout period.

Default Value:
By default, the number of password retry attempts is set to three, allowing the
administrator a maximum of three attempts at logging in to their account before they are
locked out for a set amount of time (by default, 60 seconds).

Additional Information:
The number of attempts and the default wait time before the administrator can try to
enter a password again can be configured using the CLI.
A maximum of ten retry attempts can be configured, and the lockout period can be 1 to
2147483647 seconds (over 68 years).
The higher the retry attempts, the higher the risk that someone might be able to guess
the password.","","","To configure the lockout options, from CLI:
config system global
set admin-lockout-threshold 3
set admin-lockout-duration 900
end
Lockout affects the offending IP address, not the entire account.","","true","1. https://docs.fortinet.com/document/fortigate/7.4.5/cli-
reference/339914554/config-system-global","To check the lockout options, from CLI:
get system global
from the output, check the value of the below fields:
1. admin-lockout-threshold
2. admin-lockout-duration
Ensure that admin-lockout-threshold is set at 3 or less and admin-lockout-
duration is set at 900 or less","When you log in and fail to enter the correct password, you could potentially be a valid
user or a hacker attempting to gain access. For this reason, best practice dictates
limiting the number of failed login attempts before a lockout period in which you cannot
log in for a certain period of time. Lockout period will minimize hacker attempts to gain
access to the firewall.","Attackers will keep attempting to access the device through brute force attacks without
any interruption, which may lead to a successful login."
"2.3.1","CIS FortiGate 7.4.x Benchmark","FortiGate","Ensure only SNMPv3 is enabled","Level 1","Ensuring that only SNMPv3 service is enabled and SNMPv1, SNMPv2c are disabled.

Default Value:
By default, SNMP agent is disabled.","","","To enable SNMP agent in CLI:
FGT1 # config system snmp sysinfo
FGT1 (sysinfo) # set status enable
FGT1 (sysinfo) # end
In GUI, go to System > SNMP and enable SNMP Agent.
To delete SNMPv1/2c communities. In this example, we'll delete community ""public"" in
CLI:
First, to identify the community, run
FGT1 # config system snmp community
FGT1 (community) # show
config system snmp community
edit 1
set name ""public""
config hosts
edit 1
next
end
next
end
This shows that the community public has ID 1
FGT1 # config system snmp community
FGT1 (community) # delete 1
FGT1 (community) # end
FGT #
In the GUI, go to:
System > SNMP, select the community and click on the Delete button.
To add SNMPv3 user in CLI:
FGT1 # config system snmp user
FGT1 (user) # edit ""snmp_test""
FGT1 (snmp_test) # set security-level auth-priv
FGT1 (snmp_test) # set auth-proto sha256
FGT1 (snmp_test) # set auth-pwd xxxx
FGT1 (snmp_test) # set priv-proto aes256
FGT1 (snmp_test) # set priv_pwd xxxx
FGT1 (snmp_test) # end
FGT1 #
In the GUI, go to:
1. System > SNMP, under SNMPv3, click on ""Create New"" button.
2. Select ""Authentication"" and choose SHA256 as Authentication algorithm.
3. Click ""Change"" to type in the password.
4. Also select option ""Private"", choose AES256 as Encryption Algorithm.
5. Click on ""Change"" to change the password. Click ""OK"" to add the new user.
6. Click apply to apply the new setting into the current config.","","true","1. https://community.fortinet.com/t5/FortiGate/Technical-Tip-How-to-Configure-
FortiGate-SNMP-Agent-for/ta-p/196866?externalID=FD45755
2. https://docs.fortinet.com/document/fortigate/7.4.5/administration-
guide/325005/basic-configuration","From CLI, check to make sure that there is not any community for SNMPv1 or
SNMPv2c and only SNMPv3 users are there. Also make sure that SNMP Agent is
enabled:
FGT1 # config system snmp sysinfo
FGT1 (sysinfo) # show
config system snmp sysinfo
set status enable
...
end
FGT1 (sysinfo) # end
FGT1 # config system snmp community
FGT1 (community) # show
config system snmp community
end
FGT1 (community) # end
FGT1 # config system snmp user
FGT1 (user) # show
config system snmp user
edit ""snmp_test""
set security-level auth-priv
set auth-proto sha256
set auth-pwd ENC xxxxxx
set priv-proto aes256
set priv-pwd ENC xxxxxx
next
end
In the GUI, go to:
1. System > SNMP. Make sure that SNMP agent is enabled.
2. Make sure that there is not any SNMPv1/2c community.
3. Make sure that there is at least 1 SNMPv3 user in the list.","SNMP Version 3 provides security enhancements that are not available in SNMP
Version 1 or SNMP Version 2c. SNMP Versions 1 and 2c transmit data between the
SNMP server and SNMP agent in clear text. SNMP Version 3 adds authentication and
privacy options to secure protocol operations. Some firewalls need to be constantly
monitored of its performance and status, especially if the firewalls are critical to the
operation. Enabling SNMPv3 will ensure that the firewall is monitored properly.","Some older SNMP servers that only run SNMPv1 or SNMPv2c will not be able to query
to this firewall."
"2.3.2","CIS FortiGate 7.4.x Benchmark","FortiGate","Allow only trusted hosts in SNMPv3","Level 2","Ensuring that only certain hosts are able to conduct SNMP GET or receive SNMP Trap.

Default Value:
By default, no SNMP is configured.","","","To remove 0.0.0.0 from trusted hosts in CLI:
FGT1 # config system snmp user
FGT1 (user) # edit ""snmp_test""
FGT1 (snmp_test) # unselect notify-hosts 0.0.0.0
FGT1 (snmp_test) # end
FGT1 #
From GUI:
1. System > SNMP.
2. On SNMPv3 section, double click on the configured SNMPv3 settings.
3. Remove 0.0.0.0 from ""Hosts"" option.","","true","1. https://docs.fortinet.com/document/fortigate/7.4.5/administration-
guide/325005/basic-configuration","From CLI:
FGT1 # show system snmp user
config system snmp user
edit ""snmp_test""
set notify-hosts 192.168.1.101
set security-level auth-priv
set auth-proto sha512
set auth-pwd ENC xxxxx
set priv-proto aes256
set priv-pwd ENC xxxxx
next
end
Validate that ""notify-hosts"" is configured with specific IP address, and there is no
""0.0.0.0"" configured.
From GUI:
1. System > SNMP.
2. On SNMPv3 section, double click on the configured SNMPv3 settings.
3. Ensure that ""Hosts"" is configured with specific IP address, and there is
no ""0.0.0.0"" configured.","SNMP offers rich information that can be useful for reconnaissance activity. Hence,
limiting this information to only relevant devices such as NMS (Network Monitoring
System) or other SNMP servers is necessary.",""
"2.3.3","CIS FortiGate 7.4.x Benchmark","FortiGate","Disable SNMPv3 Query Per User","Level 2","Disabling SNMP query for SNMPv3 Users that only need to receive SNMP traps

Default Value:
By Default SNMPv3 Users allow Queries","","","To disable Queries for a specific SNMPv3 User in CLI:
{snmp_test is the example SNMPv3 username}
FGT1 # config system snmp user
FGT1 (user) # edit snmp_test
FGT1 (snmp_test) # set queries disable
FGT1 (snmp_test) # next
FGT1 (user) # end
To disable Queries for a specific SNMPv3 User in GUI:
1. System > SNMP
2. Under the SNMPv3 section select the specific user and double click or
single click and select edit
3. Under the Queries section click the slider for ""Enabled"" so it is turned
off","","true","","From CLI:
config system snmp user
edit ""snmp_test""
set queries disable
set notify-hosts 192.168.1.101
set security-level auth-priv
set auth-proto sha512
set auth-pwd ENC xxxxxx
set priv-proto aes256
set priv-pwd ENC xxxxxx
next
end
Validate that ""set queries"" is disabled
From GUI:
1. System > SNMP
2. On SNMPv3 settings double click on the SNMPv3 user to modify
3. Ensure that the slider for ""Queries"" is disabled","SNMP can contain information that is useful for reconnaissance, SNMP queries allow
devices to send requests for information, disabling this on SNMPv3 users that do not
need to query and only need to receive SNMP traps is necessary.",""
"2.3.4","CIS FortiGate 7.4.x Benchmark","FortiGate","Enabling SNMP trap for memory usage","Level 1","Enabling SNMP traps for memory usage monitoring helps detect anomalies and ensure
critical security features remain operational. This proactive approach enhances system
reliability by alerting administrators to potential resource issues.

Default Value:
trap-free-memory-threshold is set to 5 trap-freeable-memory-threshold is set to 60","","","To configure SNMP trap trap-free-memory-threshold and trap-freeable-memory-
threshold. From CLI:
FGT1 # config system snmp sysinfo
FGT1 (sysinfo) # show
config system snmp sysinfo
set status enable
set trap-free-memory-threshold 20
set trap-freeable-memory-threshold 50
end","","true","1. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/943586","In the example below, SNMP trap will trigger once memory usage is above 80% (less
than 20% free memory), and the freeable memory is more than 35% (memory that can
be reclaimed by the system when needed).
From CLI, enable SNMP trap trap-free-memory-threshold and trap-freeable-memory-
threshold.
FGT1 # config system snmp sysinfo
FGT1 (sysinfo) # show
config system snmp sysinfo
set status enable
set trap-free-memory-threshold 20
set trap-freeable-memory-threshold 50
end","Monitoring memory usage via SNMP traps ensures that critical security processes have
sufficient resources to operate effectively. This helps prevent performance degradation
or failures that could expose the system to security risks.","Memory usage reaching critical status will automatically turn FortiGates into conserve
mode which will impact security inspection."
"2.4.1","CIS FortiGate 7.4.x Benchmark","FortiGate","Remove default admin user and create one with other name","Level 1","Before deploying any new FortiGate, it is important to change the password of the
default admin account.
It is also recommended that you change even the user name of the default admin
account, However, since you cannot change the user name of an account that is
currently in use, a second administrator account must be created in order to do this.

Default Value:
By default, your FortiGate has an administrator account set up with the username admin
and no password. In order to prevent unauthorized access to FortiGate, it is highly
recommended that you add a password to this account.
Username: admin The default admin account does not have any password. Just
leave it blank

Additional Information:
In FortiOS 6.2.1 and later, adding a password to the admin administrator is mandatory.
You will be prompted to configure it the first time you log in to the FortiGate using that
account, after a factory reset, and after a new image installation.","","","First create an other local admin account, for example mycompanyadmin.
#if VDOM enabled
config global
#configure new admin
config system admin
edit ""mycompanyadmin""
set password
set accprofile ""super_admin""
next
end
Verify if the newly created login works by opening another CLI session, do not logout of
your current session.
Once validated, logout with the default local admin account and use the CLI session
with mycompanyadmin to delete the default local admin account.
Please make sure there are no references in the configuration to the account (groups,
etc.)
#if VDOM enabled
config global
config system admin
delete ""admin""
end
To change the default password in the GUI:
Global (if VDOM enabled) > System > Administrators
Create New admin account (mycompanyadmin) Verify if you can login with that account
via another browser session (eg. incognito mode).
Remove default admin
System > Administrators menu","","true","1. https://kb.fortinet.com/kb/documentLink.do?externalID=FD48763
2. https://docs.fortinet.com/document/fortigate/6.2.0/cookbook/99980/default-
administrator-password","Using both CLI and GUI, in the username field put in ""admin"", leave the password field
blank and proceed. If it's checked out, it means that the default password is still in place
and needs to be changed.","Default credentials are well documented by most vendors, including Fortinet. Therefore,
it will be one of the first things that will be tried to illegally gain access to the system.","If not changed, then any scripts that use default credentials will be able to access the
system."
"2.4.2","CIS FortiGate 7.4.x Benchmark","FortiGate","Ensure all the login accounts having specific trusted hosts enabled","Level 1","Configure an administrative account to be accessible only to someone who is using a
trusted host. You can set a specific IP address for the trusted host or use a subnet.

Default Value:
By default, each account is accessible from everywhere. The host value is 0.0.0.0/0","","","To remove a trusted host item from the list in CLI:
FG1 # config system admin
FG1 (admin) # edit ""test_admin""
FG1 (test_admin) # unset trusthost1
FG1 (test_admin) # end
FG1 #
To add a trusted host into the list in CLI:
FG1 # config system admin
FG1 (admin) # edit ""test_admin""
FG1 (test_admin) # set trusthost6 1.1.1.1 255.255.255.255
FG1 (test_admin) # end
FG1 #
Before adding an item, please make sure that it does not already exist. For example, if
trusthost3 is already in the list, using it again will override the existing host/network.
In the Web GUI:
1. System > Administrators.
2. select the account and click on edit.
3. In the account setting page, make sure that ""Restrict login to trusted
hosts"" is enabled and all the allowed hosts / subnets are in the list of
trusted host.
Please take note that certain versions of FortiOS will only show the first 3 trusted hosts
in the list. If you want to see more, you have to click on the ""+"" sign as if you're adding a
new item into the list. Keep clicking until you see an empty field of trusted host. That's
when you know that you have reached the bottom of the list. To add another trusted
host, fill in the empty field of the new ""Trusted Host"". To remove a trusted host, simply
erase everything in the field of that corresponding host.","","true","1. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/14906","This example is to check if trusted hosts option is enabled for account ""test_admin"" and
which trusted hosts are in the list:
FG1 # config system admin
FG1 (admin) # edit ""test_admin""
FG1 (test_admin) # show
config system admin
edit ""test_admin""
...
set trusthost1 10.0.0.0 255.255.255.0
set trusthost2 192.168.10.0 255.255.255.0
...
next
end
In the Web GUI:
1. System > Administrators.
2. Select the account and click on edit.
3. In the account setting page, make sure that ""Restrict login to trusted
hosts"" is enabled and all the allowed hosts / subnets are in the list of
trusted host.
Please take note that certain versions of FortiOS will only show the first 3 trusted hosts
in the list. If you want to see more, you have to click on the ""+"" sign as if you're adding a
new item into the list. Keep clicking until you see an empty field of trusted host. That's
when you know that you have reached the bottom of the list.","Access to a firewall to perform administrative tasks should only come from specific
network segments reserved for administrators only. This additional layer of security
ensures that no one from anywhere else on the network is able to log in, even with
correct credentials.","All access outside of the allowed segment will be stopped, including from both
legitimate and illegitimate users. Thus, administrators working remotely will have to
make sure that they have access to jump hosts that sit in the allowed segment."
"2.4.3","CIS FortiGate 7.4.x Benchmark","FortiGate","Ensure admin accounts with different privileges have their correct profiles assigned","Level 1","Verify that users with access to the Fortinet should only have the minimum privileges
required for that particular user.

Default Value:
By default, there are only 2 profiles: prof_admin and super_admin. You must select a
profile to create an admin account. The system will not automatically choose for you.

Additional Information:
You cannot change the profile of the account you are already logged in as.
The profile ""super_admin"" cannot be deleted or modified.","","","In this example, the goal is to provide the profile ""tier_1"" the ability to view and modify
address objects. This sub-privilege is under fwgrp privilege.
In CLI:
FGT1 # config system accprofile
FGT1 (accprofile) # edit ""tier_1""
FGT1 (tier_1) # set fwgrp custom
FGT1 (tier_1) # config fwgrp-permission
FGT1 (fwgrp-permission) # set address read-write
FGT1 (fwgrp-permission) # end
FGT1 (tier_1) # end
FGT1 #
For the GUI, go to:
1. System > Admin Profiles, select ""tier_1"" and click ""Edit"".
2. On ""Firewall"", click on ""Custom"".
3. Click on ""Read/Write"" option for ""Address"".
In the next example, assign the profile ""tier_1"" to the account ""support1"".
In the CLI:
FGT1 # config system admin
FGT1 (admin) # edit ""support1""
FGT1 (support1) # set accprofile ""tier_1""
FGT1 (support1) # end
FGT1 #
For the GUI, go to:
1. System > Administrators.
2. Select ""support1"" and click ""Edit"".
3. Under ""Administrator Profile"", select ""tier_1"".","","true","1. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/294491","There are 2 stages to audit. Here is how to verify in the CLI:
Stage 1: Verify the profile.
FGT1 # config system accprofile
FGT1 (accprofile) # edit ""tier_1""
FGT1 (tier_1) # show full
config system accprofile
edit ""tier_1""
set comments ''
set secfabgrp read
set ftviewgrp read
set authgrp none
set sysgrp none
set netgrp read
set loggrp none
set fwgrp custom
set vpngrp none
set utmgrp none
set wifi none
set admintimeout-override disable
config fwgrp-permission
set policy none
set address none
set service none
set schedule none
end
next
end
FGT1 (tier_1) #
If the following privileges are set to ""custom"", please also check the sub-privileges of the
customized ones to make sure that only the right privileges are allowed: fwgrp, sysgrp,
netgrp, loggrp, utmgrpset.
In the GUI, go to:
System > Admin Profiles, select the profile and click on ""Edit"".
Stage 2: Verify the admin accounts.
In the CLI:
FGT1 #config system admin
FGT1 (admin) # edit ""support1""
FGT1 (support1) # show full
config system admin
edit ""support1""
...
set accprofile ""tier_1""
...
next
end
In the GUI, go to:
System > Administrators, select the account and click ""Edit""","In some organizations, it is necessary to create different levels of administrative
accounts. For example, technicians from tier 1 support should not have total access to
the system compared to a tier 3 support.",""
"2.4.4","CIS FortiGate 7.4.x Benchmark","FortiGate","Ensure Admin idle timeout time is configured","Level 1","The idle timeout period is the amount of time that an administrator will stay logged in to
the GUI without any activity.

Default Value:
By default, it is set to five minutes.

Additional Information:
A setting of higher than 15 minutes will have a negative effect on a security rating score.","","","To change the idle timeout in the GUI:
1) Login to FortiGate with Super Admin privileges
2) Go to 'System' > 'Settings'.
3) In the 'Administration Settings' section, set the 'Idle timeout' value to
five minutes by typing 5.
4) Click Apply.
To change the idle timeout in the CLI:
config system global
set admintimeout 5
end","","true","1. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/215451","To check the idle timeout in the GUI:
1) Login to FortiGate
2) Go to 'System' > 'Settings'.
3) In the 'Administration Settings' section, check the 'Idle timeout' value
in minutes.
To check the idle timeout in the CLI:
get system global
check the value of admintimeout in minutes","Best practice dictates setting admin idle timeout to prevent the risk of unauthorized
access to the device, such as someone using a logged-in GUI on a PC that has been
left unattended.
For security reasons, the Center for Internet Security (CIS) recommends that
administrator sessions should automatically timeout after a period of inactivity, with a
maximum recommended time of 15 minutes or less","This is to prevent someone from accessing the FortiGate if the management PC is left
unattended."
"2.4.5","CIS FortiGate 7.4.x Benchmark","FortiGate","Ensure only encrypted access channels are enabled","Level 1","Allow only HTTPS access to the GUI and SSH access to the CLI.

Default Value:
By default, HTTP and Telnet are not enabled on any interface.","","","If HTTP or Telnet is in the allowaccess list, you will have to set that list again with the
same elements except for http or telnet.
On CLI:
FG1 # config system interface
FG1 (interface) # edit port1
FG1 (port1) # set allowaccess ssh https ping snmp
FG1 (port1) # end
FG1 #
In the web GUI, click on:
1. Network > Interfaces, select the interface and click ""Edit"".
2. In the interface setting page, uncheck HTTP and Telnet in the section
""Administrative Access"".","","true","1. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/574723","In the CLI, when verifying the network interface, make sure that http and telnet are not
in the allowaccess list:
FG1 # config system interface
FG1 (interface) # edit port1
FG1 (port1) # show
config system interface
edit ""port1""
...
set allowaccess ssh https ping snmp
...
next
end
In the web GUI, click on:
1. Network > Interfaces, select the interface and click ""Edit"".
2. In the interface setting page, make sure that HTTP and Telnet are not
selected in the section ""Administrative Access""","By only allowing encrypted access, we are making it harder to use ""Man in the Middle""
attacks to sniff login credentials.",""
"2.4.6","CIS FortiGate 7.4.x Benchmark","FortiGate","Apply Local-in Policies","Level 1","Configure Local-in Policies to control inbound traffic that is destined to a FortiGate
interface.

Default Value:
There are no Local-in Policies in place by default.","","","Local-in Policies can only be configured through the CLI:
config firewall {local-in-policy | local-in-policy6}
edit <policy_number>
set intf <interface>
set srcaddr <source_address> [source_address] ...
set dstaddr <destination_address> [destination_address] ...
set action {accept | deny}
set service <service_name> [service_name] ...
set schedule <schedule_name>
set comments <string>
next
end
For example, to prevent the source subnet 10.10.10.0/24 from pinging port1, but allow
administrative access for PING on port1:
config firewall address
edit ""10.10.10.0""
set subnet 10.10.10.0 255.255.255.0
next
end
config firewall local-in-policy
edit 1
set intf ""port1""
set srcaddr ""10.10.10.0""
set dstaddr ""all""
set service ""PING""
set schedule ""always""
next
end","","true","1. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/363127","To review Local-in Policies in the GUI, go to:
1. System > Feature Visibility.
2. Turning on ""Local-in policies"" under the Additional Features Section.
This will then add the section under ""Policies and Objects"" there will now be a section
for ""Local-in Policies""
It can also be viewed through the CLI:
config firewall local-in-policy
show","Local-in Policies allow for more granular and specific control of all types of traffic that
are destined for a FortiGate interface. They are not limited to management-only
protocols, therefore they can extend past ""trusted host"" configurations and be
configured with source and destination addresses as well as specific services.","Local-in Policies are processed before ""trusted host"" configurations, so it is important to
validate that management access will be maintained once the Local-in policies are put
in place."
"2.4.7","CIS FortiGate 7.4.x Benchmark","FortiGate","Ensure default Admin ports are changed","Level 1","FortiGate admin ports listen on the common ports of 80 and 443. This is default
behavior. While interface access is controlled by configuring network interfaces, the
FortiGate still listens on the admin ports that have been configured, which can also
cause a conflict should 80 or 443 be needed as part of additional configuration later on.

Default Value:
config system global
set admin-https-redirect enable
set admin-port 80
set admin-server-cert ""self-sign""
set admin-sport 443

Additional Information:
TIP: Don't choose these ports:
8080/8081 - These are very common browser proxy ports.
4433 - This is the FortiGate default FTM push port.
10443 - This is the FortiGate default SSL VPN port.
Other Admin Ports such as 22 and 23 can also be changed as required.","","","config system global
set admin-https-redirect disable
set admin-port 8082 **(or any other uncommon port)**
set admin-server-cert ""self-sign""
set admin-sport 4343 **(or any other uncommon port)**
end
OR
From Web GUI:
1. System > Settings
2. Change the ports/settings under 'Administration Settings' section.
NOTE: https redirection must be turned off as well as changing port 80. This is due to
the nature of how browser port redirection works. The browser will be redirected from
port 80 to port 443 or whichever 'admin-sport' is configured, meaning that it will still
listen on port 80 even when the port has been reconfigured.","","true","1. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/616955
2. https://community.fortinet.com/t5/FortiGate/Technical-Tip-How-to-change-the-
port-for-the-admin-access-to/ta-p/192295?externalID=FD46981","Log in to the GUI and click on System > Settings > Review the ports under
'Administration Settings' section.","To increase security of the FortiGate Admin Ports, changing it from the default ports will
reduce the attack surface should FortiGate Admin Access be targeted. As mentioned, a
possible port conflict can also be avoided.","Unauthorized access to a FortiGate or any firewall could prove very costly. While this is
a single hardening step of many, it is an important one when hardening any firewall."
"2.4.8","CIS FortiGate 7.4.x Benchmark","FortiGate","Virtual patching on the local-in management interface","Level 1","Allow virtual patching to be applied to traffic destined to the FortiGate by applying IPS
signatures to the local in interface using local in policies. Attacks geared towards GUI
and SSH management access, for example, can be mitigated using IPS signatures
pushed from FortiGuard, thereby virtually patching these vulnerabilities.
The FortiGate must have a valid FMWR (Firmware) license to install the FMWP
database. The FMWP database can be viewed by running the diagnose autoupdate
versions command.

Default Value:
Disabled","","","On CLI:
config firewall local-in-policy
edit <id>
set virtual-patch enable
next
end","","true","1. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/393161","On CLI:
config firewall local-in-policy
show
Ensure that virtual-patch is enabled for those policy that is allowing traffic.","Patches require scheduling of downtime, which means there is some attack window
from the time Fortinet announced the vulnerability to when patch is applied. To minimise
the risk, virtual patching on GUI and SSH management access is needed.",""
"2.5.1","CIS FortiGate 7.4.x Benchmark","FortiGate","Ensure High Availability configuration is enabled","Level 2","Ensure that FortiGate devices are configured for High Availability (HA).

Default Value:
N/A","","","In GUI:
1. Navigate to ""System"" and then ""HA""
2. Ensure ""Mode"" is set to proper setting ""Active-Active"" or ""Active-Passive""
3. Review Configuration settings:
- ""Cluster Name"" must match on devices
- ""Password"" Must match on devices
- ""Heartbeat Interfaces"" need to be defined on devices
4. Click ""OK"" to save changes and exit
In CLI:
FGT1 # config system ha
FGT1 (ha) # set mode a-p ###(Active-Passive)
FGT1 (ha) # set group-name ""FGT-HA"" ###(Set cluster name)
FGT1 (ha) # set password ******* ###(Set password)
FGT1 (ha) # set hbdev port10 50 ###(Set Heartbeat
Interface and priority)
FGT1 (ha) # end
To review configuration in CLI:
FGT1 # config system ha
FGT1 (ha) # show
config system ha
set group-name ""FGT-HA""
set mode a-p
set password ENC
enrwD467hJmO6j6YW/l6FEOa1YNVYdo8Z5mCcTDEKUFpOVXcNYnPBmQDGX//ViXk6TkwNH0il5aJr
/fZY25lq+husndQHZVWp2LIlXmCv/n81U43nkZUWaIKvqkellGFbhv0/IHoOLzQPCsVcBbyrsgopr
YMvh6w7F06+nRriBtMNQxpOV5V+e388EcwsOOMsXBZOw==
set hbdev ""port10"" 50
set override disable
end","","true","1. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/357558
2. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/900885","In GUI:
1. Navigate to ""System"" and then ""HA""
2. Ensure ""Mode"" is set to proper setting ""Active-Active"" or ""Active-Passive""
3. Review Configuration settings:
- ""Cluster Name"" must match on devices
- ""Password"" Must match on devices
- ""Heartbeat Interfaces"" need to be defined on devices
4. Click ""OK"" to save changes and exit
In CLI:
FGT1 # config system ha
FGT1 (ha) # set mode a-p ###(Active-Passive)
FGT1 (ha) # set group-name ""FGT-HA"" ###(Set cluster name)
FGT1 (ha) # set password ******* ###(Set password)
FGT1 (ha) # set hbdev port10 50 ###(Set Heartbeat
Interface and priority)
FGT1 (ha) # end
To review configuration in CLI:
FGT1 # config system ha
FGT1 (ha) # show
config system ha
set group-name ""FGT-HA""
set mode a-p
set password ENC
enrwD467hJmO6j6YW/l6FEOa1YNVYdo8Z5mCcTDEKUFpOVXcNYnPBmQDGX//ViXk6TkwNH0il5aJr
/fZY25lq+husndQHZVWp2LIlXmCv/n81U43nkZUWaIKvqkellGFbhv0/IHoOLzQPCsVcBbyrsgopr
YMvh6w7F06+nRriBtMNQxpOV5V+e388EcwsOOMsXBZOw==
set hbdev ""port10"" 50
set override disable
end","Configuring High Availability (HA) increases system availability as well as decreases
impact of routine maintenance (Firmware updates, cable moves, etc.) and the the
impact of device failure.","Not having High Availability (HA) configured correctly and synced properly impacts the
availability of the FortiGate devices as well as any systems that require traversing the
FortiGates. With properly configured HA in place outages can be minimized during
firmware updates as well as if there are power outages or device failures."
"2.5.2","CIS FortiGate 7.4.x Benchmark","FortiGate","Ensure ""Monitor Interfaces"" for High Availability devices is enabled","Level 1","Configure Interface Monitoring within High Availability settings. Interface Monitoring
should be enabled on all critical interfaces.

Default Value:
N/A","","","To remediate from GUI:
1. Go to System > HA.
2. Under ""Monitor Interfaces"" select all applicable interfaces.
3. Select ""OK"".
To validate from CLI:
FGT1 # config system ha
FGT1 (ha) # set monitor ""port6"" ""port7""
FGT1 (ha) # show ###To Review changes to monitored interfaces before
applying
config system ha
set group-name ""FGT-HA""
set mode a-p
set password ENC
enrwD467hJmO6j6YW/l6FEOa1YNVYdo8Z5mCcTDEKUFpOVXcNYnPBmQDGX//ViXk6TkwNH0il5aJr
/fZY25lq+husndQHZVWp2LIlXmCv/n81U43nkZUWaIKvqkellGFbhv0/IHoOLzQPCsVcBbyrsgopr
YMvh6w7F06+nRriBtMNQxpiTE+12xAHz7lA3EoYZzf8A==
set override disable
set monitor ""port6"" ""port7""
end","","true","1. https://docs.fortinet.com/document/fortigate/6.0.0/best-
practices/498515/interface-monitoring-port-monitoring","To validate from GUI:
1. Go to System > HA.
2. Under ""Monitor Interfaces"" validate all applicable interfaces are
selected.
3. Select ""OK"".
To validate from CLI:
FGT1 # config system ha
FGT1 (ha) # show
config system ha
set group-name ""FGT-HA""
set mode a-p
set password ENC
enrwD467hJmO6j6YW/l6FEOa1YNVYdo8Z5mCcTDEKUFpOVXcNYnPBmQDGX//ViXk6TkwNH0il5aJr
/fZY25lq+husndQHZVWp2LIlXmCv/n81U43nkZUWaIKvqkellGFbhv0/IHoOLzQPCsVcBbyrsgopr
YMvh6w7F06+nRriBtMNQxpiTE+12xAHz7lA3EoYZzf8A==
set override disable
set monitor ""port6"" ""port7"" ###Validate proper interfaces are present
end","With Interface Monitoring enabled on devices, failover can occur if there are
physical media issues or issues with the specific port to which the FortiGate is
connected.","Not configuring Interface Monitoring can directly impact services due to a failure to
trigger a High Availability failover if an interface is impacted only on the primary device
and is not being monitored. Without the Interface Monitoring enabled, failover
would be limited to hardware, system, or power faults."
"2.5.3","CIS FortiGate 7.4.x Benchmark","FortiGate","Ensure HA Reserved Management Interface is configured","Level 1","Ensure Reserved Management Interfaces are configured on HA devices.

Default Value:
N/A","","","Remediate through the GUI:
1. Go to System > HA edit the ""Master"" device.
2. Enable ""Management Interface Reservation"" once this is enabled select an
an interface, and configure the appropriate gateway.
Remediate through the CLI:
FGT1 #config system ha
FGT1 (ha) # set ha-mgmt-status enable
FGT1 (ha) # config ha-mgmt-interfaces
FGT1 (ha-mgmt-interfaces) # edit 1
new entry '1' added
FGT1 (1) # set interface port6
FGT1 (1) # set gateway 10.10.10.1
FGT1 (1) # end
FGT1 (ha) # show
config system ha
set group-name ""FGT-HA""
set mode a-p
set password ENC
enrwD467hJmO6j6YW/l6FEOa1YNVYdo8Z5mCcTDEKUFpOVXcNYnPBmQDGX//ViXk6TkwNH0il5aJr
/fZY25lq+husndQHZVWp2LIlXmCv/n81U43nkZUWaIKvqkellGFbhv0/IHoOLzQPCsVcBbyrsgopr
YMvh6w7F06+nRriBtMNQxpiTE+12xAHz7lA3EoYZzf8A==
set ha-mgmt-status enable
config ha-mgmt-interfaces
edit 1
set interface ""port6""
set gateway 10.10.10.1
next
end
set override disable
end
FGT1 (ha) # end","","true","1. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/313152","Review through the GUI:
1. Go to System > HA edit the ""Master"" device.
2. Verify that ""Management Interface Reservation"" is selected and there is an
interface, and gateway defined.
Review through the CLI:
FGT1 #config system ha
FGT1 (ha) # show
config system ha
set group-name ""FGT-HA""
set mode a-p
set password ENC
enrwD467hJmO6j6YW/l6FEOa1YNVYdo8Z5mCcTDEKUFpOVXcNYnPBmQDGX//ViXk6TkwNH0il5aJr
/fZY25lq+husndQHZVWp2LIlXmCv/n81U43nkZUWaIKvqkellGFbhv0/IHoOLzQPCsVcBbyrsgopr
YMvh6w7F06+nRriBtMNQxpiTE+12xAHz7lA3EoYZzf8A==
set ha-mgmt-status enable
config ha-mgmt-interfaces
edit 1
set interface ""port6""
set gateway 10.10.10.1
next
end
set override disable
end
Validate that set ha-mgmt-status is enabled and that config ha-mgmt-interfaces
has at least one entry with an interface and gateway defined.","To be able to access both the primary and secondary firewalls in an HA cluster,
Reserved Management Interfaces need to be configured to prevent them from
syncing with HA and sharing a virtual MAC address.","Not configuring Reserved Management Interfaces impacts the ability to access
secondary devices directly due to the primary and secondary devices syncing
configuration exactly and floating a virtualized mac address between them for failover."
"2.5.4","CIS FortiGate 7.4.x Benchmark","FortiGate","Ensure High Availability Group-ID is configured","Level 2","Ensure that FortiGate High Availability (HA) configuration has non-default ""Group-ID""

Default Value:
The default ""Group-ID"" value is set to 0
3 Policy and Objects
This section contains best practices related to configuring firewall policies, Objects and
traffic shaping","","","To modify High Availability (HA) Group-ID
From the CLI:
FGT1 # config system ha
FGT1 (ha) # set group-id 10
FGT1 (ha) # end
FGT1 #
The Group ID can be any integer value from 0-1023
From the GUI:
1. System > HA
2. Select Primary device and either double click or single click and select
""Edit""
3. Under Cluster Settings enter a value in the ""Group ID""
4. Click OK to apply
The Group ID can be any integer value from 0-1023","","true","","In the CLI:
FGT1 # show sys ha
config system ha
set group-id 10
set group-name ""HAGROUP""
set mode a-p
set password ENC xxxxxxxx
set hbdev ""port7"" 50
set session-pickup enable
set override disable
set priority 200
end
Validate that ""group-id"" is present and not configured for the default of 0
In the GUI:
1. System > HA
2. Select the primary device and either double click to open or single click
and select edit
3. Under ""Cluster Settings"" Validate that ""Group ID"" is not 0 and has been
configured","High Availability (HA) allows a FortiGate cluster to float a virtual MAC address between
devices to minimize downtime if there is a failover event. This Virtual MAC address is
generated using the GROUP-ID so to prevent possible duplicate MAC addresses on
Layer 2 of the network configuring a non-default Group-ID is needed.","Not modifying the Group-ID attribute in HA could allow a duplicate MAC address from
another default FortiGate having HA configured which can cause problems if they are
both within the same network"
"3.1","CIS FortiGate 7.4.x Benchmark","FortiGate","Ensure that unused policies are reviewed regularly","Level 2","All firewall policies should be reviewed regularly to verify the business purpose. Unused
policies should be disabled and logged.
Recommendation to review twice per year or inline with BCP practice (Business
Continuity Plan). Some of the firewall policies will only be used during BCP, hence, the
hit count might show 0 if the review is done too often.

Default Value:
By default, the hit count value is 0 at the beginning.

Additional Information:
The CLI commands are only available after FortiOS 6.0. Before that, please use GUI.","","","The remediation is to review and decide if you should delete unused policies.","","true","1. https://kb.fortinet.com/kb/documentLink.do?externalID=FD44631","In CLI, type ""diag firewall iprope show 100004 <policy_id>"". In this example, we'll verify
policy with ID of 32. We'll also need to clear the counter after each review so that we
can tell if the policy is still being used for the next review :
FGT1 # diag firewall iprope show 100004 32
idx=2 pkts/bytes=144967/135758174 asic_pkts/asic_bytes=0/0 flag=0x0 hit
count:663
FGT1 # diag firewall iprope clear 100004 32
In the GUI,
1. Go to Policy & Objects.
2. Click on Firewall Policy.
3. Make sure that either the columns ""Bytes"" or ""Hit Count"" are visible. To
display either one of them, move the cursor to the top row where all the
columns names are. Right click and select ""Bytes"" or ""Hit Count"" and click
OK. To clear the counter, right click on the ""Bytes"" or ""Hit Count"" columns
of that policy and click on ""Clear Counters"".","By reviewing policies regularly, we can determine if the policies are still needed by the
business purpose. Thus, we can keep the firewall policies lean and efficient. It also
prevents traffic being allowed or blocked accidently.",""
"3.2","CIS FortiGate 7.4.x Benchmark","FortiGate","Ensure that policies do not use ""ALL"" as Service","Level 1","Ensure that all security policies in effect clearly state which protocols / services they are
allowing.

Default Value:
By default, all new policy will have ""ALL"" in its service field.","","","This is an example showing how to modify policy with ID of 2 to change the service from
""ALL"" to FTP and SNMP.
In CLI:
FGT1 # config firewall policy
FGT1 (policy) # edit 2
FGT1 (2) # set service ""FTP"" ""SNMP""
FGT1 (2) # end
FGT1 #
In the GUI,
1. Go to Policy & Objects.
2. Click on Firewall Policy.
3. Select the policy, click ""Edit"".
4. In the Service section, click on it and select FTP and SNMP. Click OK.","","true","","In CLI:
FGT1 # config firewall policy
FGT1 (policy) # show
TEST-FG-Third (policy) # show
config firewall policy
edit 1
set uuid d0eed832-bb73-51e6-c3da-3cd2ec201608
set srcintf ""internal""
set dstintf ""wan""
set srcaddr ""all""
set dstaddr ""all""
set action accept
set schedule ""always""
set service ""HTTPS"" ""HTTP""
set ssl-ssh-profile ""__tmp_no-inspection""
set nat enable
next
end
In the GUI,
1. Go to Policy & Objects.
2. Click on Firewall Policy.
Make sure that none of the policies use ""ALL"" as its service.","This is to make sure that the firewall do not allow traffic with unauthorized
protocols/services by mistake.",""
"3.3","CIS FortiGate 7.4.x Benchmark","FortiGate","Ensure firewall policy denying all traffic to/from Tor, malicious server, or scanner IP addresses using ISDB","Level 1","Firewall policies should include a deny rule for traffic going to/from Tor, malicious
server, or scanner IP addresses using ISDB (Internet Service Database).","","","Review firewall policies and ensure there are:
1. A firewall policy created to block inbound connections with these settings:
From: Any
To: Any
Source: ""Tor-Exit.Node"", ""Tor-Relay.Node"", ""Censys-Scanner"", ""Shodan-
Scanner"", ""Botnet-C&C.Server"", ""Phishing-Phishing.Server"", ""Proxy-
Proxy.Server"", ""Spam-Spamming.Server"", ""VPN-Anonymous.VPN"", and ""Malicious-
Malicious.Server""
Destination: all
Schedule: Always
Services: All
Action: Deny
Log Violation Traffic: Enabled
Enable this policy: Enabled
2. A firewall policy created to block outbound connections with these settings:
From: Any
To: Any
Source: All
Destination: ""Tor-Relay.Node"", ""Botnet-C&C.Server"", ""Phishing-
Phishing.Server"", ""Proxy-Proxy.Server"", ""Spam-Spamming.Server"", ""VPN-
Anonymous.VPN"", and ""Malicious-Malicious.Server""
Schedule: Always
Action: Deny
Log Violation Traffic: Enabled
Enable this policy: Enabled","","true","","Go to ""Policy & Objects"".
Validate that there is a firewall policy created to block inbound connections from
sources named ""Tor-Exit.Node"", ""Tor-Relay.Node"", ""Censys-Scanner"", ""Shodan-
Scanner"", ""Botnet-C&C.Server"", ""Phishing-Phishing.Server"", ""Proxy-Proxy.Server"",
""Spam-Spamming.Server"", ""VPN-Anonymous.VPN"", and ""Malicious-Malicious.Server""
on ""All"" services.
Validate that there is a firewall policy created to block outbound connections to
destination named ""Tor-Relay.Node"", ""Botnet-C&C.Server"", ""Phishing-Phishing.Server"",
""Proxy-Proxy.Server"", ""Spam-Spamming.Server"", ""VPN-Anonymous.VPN"", and
""Malicious-Malicious.Server"".
Note that these ISDBs is recommended as of December 2024 (FortiOS 7.4.5). Fortinet
might rollout additional ISDBs to be blocked in newer versions that is not covered in this
benchmark.","FortiGate includes Tor or malicious server related IP address using ISDB. The idea is to
filter out malicious traffic using firewall policies as first level filtering. This is done without
involving more resource intensive processes such as IPS inspection, hence optimizing
FortiGate's performance.",""
"3.4","CIS FortiGate 7.4.x Benchmark","FortiGate","Ensure logging is enabled on all firewall policies","Level 1","Logging should be enabled for all firewall policies including the default implicit deny
policy.

Default Value:
Logging is disabled.","","","Review firewall policies and ensure that:
1. For allowed policies, ""Log Allowed Traffic"" is set on ""All Sessions"" option.
2. For denied policies, ""Log Violation Traffic"" is enabled.","","true","","Go to ""Policy & Objects"" > ""Firewall Policy"".
Validate that logging is enabled on all firewall policies.","Firewall policies should log for all traffic (both allow and deny policies). This enables
SOC or security analyst to do further investigations on security incidents especially on
threat hunting or incident response activities. Although there are many data sources that
can provide DNS query logs (AD or EDR), this option should be enabled out of best
practice and with assumption that no other data sources are available.","By default, when creating firewall policies, a logging option is not enabled. Also, the
default implicit deny policy is not logged. This creates a data gap in threat hunting or
incident response activities."
"4.1.1","CIS FortiGate 7.4.x Benchmark","FortiGate","Detect Botnet connections","Level 2","Interfaces which are classified as ""WAN"" and are used by a policy should use an IPS
sensor which blocks or monitors outgoing connections to botnet sites.

Default Value:
""Scan Outgoing Connections to Botnet Sites"" is disabled on default profile.","","","On GUI:
1. Configure relevant IPS profiles with ""Scan Outgoing Connections to Botnet
Sites"" set to ""Block"".
2. Apply relevant IPS profile on all firewall policies with traffic exiting
the network to a ""WAN"" interface.","","true","1. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/668865","On GUI:
1. Ensure that relevant IPS profile is configured with ""Scan Outgoing
Connections to Botnet Sites"" set to ""Block"".
2. Review all firewall policies that have a ""WAN"" interface as the
destination.","Blocking outgoing connections to known Botnets should be utilized in a Defense In
Depth network design.",""
"4.1.2","CIS FortiGate 7.4.x Benchmark","FortiGate","Apply IPS Security Profile to Policies","Level 1","Ensuring that traffic traversing between networks on the FortiGate have an IPS security
profile inspecting it.

Default Value:
Not Configured","","","Configure on all ""Allowed"" firewall policies to have an appropriate IPS security profile
applied to policies.","","true","1. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/243446","Review all firewall policies and ensure that traffic has an IPS security profile assigned
for inspection.","Traffic moving between ""interfaces"" on the FortiGate should have firewall policies
applied with an IPS security profile applied.",""
"4.2.1","CIS FortiGate 7.4.x Benchmark","FortiGate","Ensure Antivirus Definition Push Updates are Configured","Level 2","Ensure FortiGate is configured to accept antivirus definition push updates.

Default Value:
Enabled and set to automatic.","","","On GUI:
1. Access the FortiGate administrative web access page and go to System >
FortiGuard.
2. Under ""FortiGuard Updates"" ensure that the ""Scheduled updates"" is set to
""Automatic"".
On CLI:
config system autoupdate schedule
set status enable
set frequency automatic
end","","true","1. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/547335","On GUI:
1. Access the FortiGate administrative web access page and go to System >
FortiGuard.
2. Under ""FortiGuard Updates"" ensure that the ""Scheduled updates"" is set to
""Automatic"".
On CLI:
config system autoupdate schedule
show (Validate that there are no output, meaning it is already set as
""automatic""","Ensure that the FortiGate will accept push updates from FortiGuard to ensure the most
up to date signature databases are present on the device.",""
"4.2.2","CIS FortiGate 7.4.x Benchmark","FortiGate","Apply Antivirus Security Profile to Policies","Level 2","Ensuring that traffic traversing between networks on the FortiGate has an Antivirus
Security profile inspecting it.

Default Value:
No security inspection on firewall policies.","","","Review firewall policies and apply an appropriate antivirus security profile to policies.","","true","1. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/243446","Review all firewall policies and ensure that traffic has an antivirus security profile
assigned for inspection.","Traffic moving between ""interfaces"" on the FortiGate should have firewall policies
applied with an antivirus security profile applied.",""
"4.2.3","CIS FortiGate 7.4.x Benchmark","FortiGate","Enable Outbreak Prevention Database","Level 2","Ensure FortiGate AV inspection uses outbreak prevention database as an added layer
of protection on top of antivirus' signature-based detection.

Default Value:
Disabled","","","Review Antivirus Security Profiles and validate that ""Use FortiGuard outbreak
prevention database"" is enabled.","","true","1. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/889364","On GUI:
1. Go to ""Security Profiles"" > ""AntiVirus"".
2. Select AV profile.
Validate that ""Use FortiGuard outbreak prevention database"" is enabled.
On CLI:
FGT1 # config antivirus profile
FGT1 (profile) # show
Validate that for each traffic protocol, ""set outbreak-prevention block"" is configured.","Antivirus mainly uses signature for malware blocking. By enabling ""FortiGuard outbreak
prevention database"", FortiGate can leverage on 3rd party malware hash signatures
curated by the FortiGuard as an additional protection layer.
The hash signatures are obtained from FortiGuard's Global Threat Intelligence
database. The antivirus database queries FortiGuard with the hash of a scanned file. If
FortiGuard returns a match, the scanned file is deemed to be malicious.",""
"4.2.4","CIS FortiGate 7.4.x Benchmark","FortiGate","Enable AI /heuristic based malware detection","Level 2","AI /heuristic based detection should be enabled.

Default Value:
Enabled.","","","On CLI:
FGT1 # config antivirus settings
FGT1 (settings) # set machine-learning-detection enable","","true","1. https://docs.fortinet.com/document/fortigate/7.4.5/cli-
reference/252375733/config-antivirus-settings","Configuration and verification can be only done on CLI.
On CLI:
FGT1 # show antivirus settings | grep machine-learning-detection
Validate that it is enabled.","The AV Engine AI malware detection model integrates into regular AV scanning to help
detect potentially malicious Windows Portable Executables (PEs) in order to mitigate
zero-day attacks. It is an additional layer of protection on top of traditional antivirus
protection.
In version 6.x, it is named ""Heuristic detection"". On version 7.x, Fortinet has renamed
this to AI based detection.",""
"4.2.5","CIS FortiGate 7.4.x Benchmark","FortiGate","Enable grayware detection on antivirus","Level 2","Grayware detection should be enabled.

Default Value:
Enabled in 7.4 or newer. Older versions the default is disabled","","","On CLI:
FGT1 # config antivirus settings
FGT1 (settings) # set grayware enable","","true","1. https://docs.fortinet.com/document/fortigate/7.4.5/cli-
reference/252375733/config-antivirus-settings","CLI:
FGT1 # show antivirus settings | grep grayware
Validate that grayware detection is enabled.","Usage of grayware is generally not allowed in strict company policies and some
graywares can be used for malicious intent. If the file passes the virus scan, it can be
checked for grayware. Grayware signatures are kept up to date in the same manner as
the antivirus definitions.",""
"4.2.6","CIS FortiGate 7.4.x Benchmark","FortiGate","Ensure inline scanning with FortiGuard AI-Based Sandbox Service is enabled","Level 1","Inline scanning is supported when the FortiGate is licensed with the FortiGuard AI-
Based Sandbox Service (FAIS). It works similar to inline scanning for the FortiSandbox
appliance, by holding a file up to 50 seconds for the verdict to be returned. Timed out
scans can either be set to block, log, or ignore. Inline scanning can be enabled from the
GUI on the Cloud Sandbox configuration page.

Default Value:
Disabled","","","On GUI:
Enable the FortiGate Cloud feature visibility:
1. Go to System > Feature Visibility.
2. In the Additional Features section, enable FortiGate Cloud Sandbox.
3. Click Apply.
Configure the Cloud Sandbox Fabric connector:
1. Go to Security Fabric > Fabric Connectors and double-click the Cloud
Sandbox card.
2. Set the Type to FortiGate Cloud.
3. Select a Region.
4. Enable Inline scan.
5. Click OK.
Configure the antivirus profile:
1. Go to Security Profiles > AntiVirus and click Create New.
2. Set the Feature set to Proxy-based.
3. Enable the protocols to inspect.
4. Enable Send files to FortiSandbox for inspection.
5. Set the Scan strategy to Inline, and set the Action to Block.
6. Click OK.
On CLI: Disable FortiSandbox appliance and FortiSandbox Cloud:
config system fortisandbox
set status disable
end
Configure FortiGate Cloud Sandbox (example given is setting it as ""Global"" region):
# execute forticloud-sandbox region
0 Global
1 Europe
2 Japan
3 US
Please select cloud sandbox region[0-3]:0
Cloud sandbox region is selected: Global
Enable inline scanning for FortiGate Cloud:
config system fortiguard
set sandbox-region ""Global""
set sandbox-inline-scan enable
end
Enforced on AV security profile:
config antivirus profile
edit <profile name>
set feature-set proxy
set fortisandbox-mode inline
config http
set fortisandbox block
end
config ftp
set fortisandbox block
end
config imap
set fortisandbox block
end
config pop3
set fortisandbox block
end
config mapi
set fortisandbox block
end
config nntp
set fortisandbox block
end
config cifs
set fortisandbox block
end
config ssh
set fortisandbox block
end
next
end","","true","1. https://docs.fortinet.com/document/fortigate/7.4.5/administration-
guide/571153/using-fortisandbox-inline-scanning-with-antivirus","On CLI:
config system fortiguard
get
Verify if sandbox-inline-scan is enabled. Note that, sandbox-inline-scan will only
show up after sandbox region is set (this is done during initial setup). If there is no
sandbox-inline-scan in the output, it means that this feature is not enabled.
If sandbox-inline-scan is enabled, check on CLI if it is enforced on AV security
profile:
config antivirus profile
show
Verify if fortisandbox-mode inline is set and on each traffic protocol, fortisandbox
block is set.
On GUI:
1. Go to Security Fabric > Fabric Connectors and double-click the Cloud
Sandbox card.
Verify if ""Inline scan"" is enabled.
If ""Inline scan"" is enabled, then:
1. Go to Security Profiles > AntiVirus and double-click the relevant AV
profile.
Verify if Scan strategy is set as ""Inline"" and Action is set as ""Block""","With FAIS, unknown malware can be detected and blocked using cloud sandboxing
technology. Using inline scanning with FAIS, patient zero can also be prevented. This
complements the existing antivirus signature-based detection and also acts as an
additional layer of defense on top of FortiGate's AV heuristics feature.",""
"4.2.7","CIS FortiGate 7.4.x Benchmark","FortiGate","Enable CDR for proxy mode on XLSB, OpenOffice, and RTF files","Level 2","Enabling Content Disarm & Reconstruction (CDR) for proxy mode on XLSB,
OpenOffice, and RTF files enhances security by sanitizing potentially malicious content
in these file types. This helps prevent threats embedded in documents while maintaining
usability.
Note that, this is only applicable for AV profiles and firewall policies in ""Proxy mode"".

Default Value:
Disabled","","","To configure antivirus CDR in the GUI:
1. Go to Security Profiles > AntiVirus and click Create New.
2. Enable AntiVirus scan, and select Block.
3. Set Feature set to Proxy-based.
4. Under Inspected Protocols, enable one or more protocols that support
proxy-based antivirus scanning.
5. Under APT Protection Options, enable Content Disarm and Reconstruction,
and select Apply CDR to office files to disarm Microsoft Office and
OpenOffice files, including RTF (Rich Text Format) and XLSB (Excel Binary
Workbook) files.","","true","1. https://docs.fortinet.com/document/fortigate/7.4.0/new-features/920942/support-
xlsb-openoffice-and-rtf-files-for-cdr-in-antivirus-profiles-7-4-4","Ensure CDR is configured from GUI:
1. Go to Security Profiles > AntiVirus and click Create New.
2. Enable AntiVirus scan, and select Block.
3. Set Feature set to Proxy-based.
4. Under Inspected Protocols, enable one or more protocols that support
proxy-based antivirus scanning.
5. Under APT Protection Options, enable Content Disarm and Reconstruction,
and select Apply CDR to office files to disarm Microsoft Office and
OpenOffice files, including RTF (Rich Text Format) and XLSB (Excel Binary
Workbook) files.","Enabling Content Disarm & Reconstruction (CDR) for XLSB, OpenOffice, and RTF files
mitigates the risk of embedded malware by sanitizing potentially harmful content before
it reaches the user. This proactive approach reduces the attack surface while ensuring
business continuity.","Without CDR, malicious payloads hidden in these document formats could bypass
traditional security measures, leading to data breaches or system compromise."
"4.3.1","CIS FortiGate 7.4.x Benchmark","FortiGate","Enable Botnet C&C Domain Blocking DNS Filter","Level 2","Enable Botnet C&C domain blocking to block botnet access at the DNS name resolving
stage.

Default Value:
""Redirect botnet C&C requests to Block Portal"" is enabled on default profile.","","","On GUI:
1. Go to Security Profiles > DNS Filter.
2. On the relevant security profile name, double click. Enable ""Redirect
botnet C&C requests to Block Portal"".
2. Ensure that firewall policies that have DNS traffic have a DNS Filter
security profile applied with that option enabled.","","true","1. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/105208","On GUI:
1. Review DNS filters under Security Profiles > DNS Filter and ensure that
""Redirect botnet C&C requests to Block Portal"" is enabled.
2. Ensure that firewall policies allowing DNS traffic have a DNS Filter
Security profile applied.","Blocking botnet website access at the DNS resolution stage provides an additional layer
of defense.",""
"4.3.2","CIS FortiGate 7.4.x Benchmark","FortiGate","Ensure DNS Filter logs all DNS queries and responses","Level 1","DNS filter should log all DNS queries and responses.

Default Value:
Disabled","","","Review DNS Filter Security Profiles and validate that ""Log all DNS queries and
responses"" is enabled.","","true","1. https://community.fortinet.com/t5/FortiGate/Technical-Tip-FortiGate-Static-DNS-
filter-behavior-in-logging/ta-p/223110","GUI:
1. Go to ""Security Profiles"" > ""DNS Filter"".
2. Select relevant DNS Filter profile.
Validate that ""Log all DNS queries and responses"" is enabled.
CLI:
FGT1 # config dnsfilter profile
FGT1 (profile) # show
Validate that ""set log-all-domain enable"" is configured on DNS Filter profile.","DNS filter should log all DNS queries and responses (whether the DNS category is
blocked, monitored, or allowed). This enables SOC or security analysts to do further
investigations on security incidents, especially on threat hunting or incident response
activities. Although there are many data sources that can provide DNS query logs (AD
or EDR), this option should be enabled out of best practice and with the assumption that
no other data source is available.","By default, allowed DNS is not logged. This creates a data gap in threat hunting or
incident response activities."
"4.3.3","CIS FortiGate 7.4.x Benchmark","FortiGate","Apply DNS Filter Security Profile to Policies","Level 1","Ensuring that traffic traversing to the Internet on the FortiGate has a DNS Filter security
profile inspecting it.

Default Value:
Not Configured","","","Configure on ""Allowed"" firewall policies that handle traffic outbound to Internet to have
an appropriate DNS Filter security profile applied to policies.","","true","1. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/243446","Review firewall policies that handle traffic outbound to Internet has an DNS Filter
security profile assigned for inspection.","Traffic outbound to the Internet on the FortiGate should have firewall policies applied
with an DNS Filter security profile applied.",""
"4.4.1","CIS FortiGate 7.4.x Benchmark","FortiGate","Create a Web Filtering Profile","Level 1","Ensure FortiGuard Category-based Web filtering is blocking Security Risk categories

Default Value:
By default, all categories under ""Security Risk"" and ""Unrated"" are set to Block.","","","Apply Web Filter profile to the firewall policy or SD-WAN and ensure that the Security
Risk categories, including Malicious Websites, Phishing, and Spam URLs, are
configured to Block.","","true","1. https://docs.fortinet.com/document/fortigate/7.6.2/administration-
guide/267887/configuring-a-web-filter-profile
4.5 Application Control
Application Control Security profiles","GUI:
Go to Security Profiles > Web Filter. Select the relevant web filter profile,
if applicable. Validate that, within the ""Security Risk"" section, categories
such as ""Malicious Websites"", ""Phishing"", and ""Spam URLs"" are set to the
action ""Block"".","Websites categorized under ""Security Risk"" pose significant threats to an organization's
network and users. Categories such as ""Dynamic DNS"", ""Malicious Websites"",
""Phishing"", and ""Spam URLs"" are often associated with cyber threats and serve as
initial access vectors for attacks such as malware distribution, phishing schemes,
command-and-control activities, and data theft.
If any websites or web pages that fall under the FortiGuard URL Database Categories
""Dynamic DNS"", ""Newly Observed Domains"", or ""Newly Registered Domains"" are
required to be allowed, this based on an organization's policy, those specific entries
should be configured under ""Monitor"" action in the web filter configuration.","Setting the FortiGuard URL Database Categories ""Newly Observed Domains"" or ""Newly
Registered Domains"" to ""Block"" action, can significantly impact user access to websites,
particularly newly created website and/or uncategorized websites while it's relation to
unrated category."
"4.5.1","CIS FortiGate 7.4.x Benchmark","FortiGate","Block high risk categories on Application Control","Level 1","Ensure FortiGate Application Control blocks high risk applications to reduce attack
surface.

Default Value:
All application category ""Action"" is set as ""Monitor"" by default.","","","Review Application Control Security Profiles and validate that ""P2P"" and ""Proxy""
category is blocked.","","true","1. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/19814","GUI:
1. Go to ""Security Profiles"" > ""Application Control"".
2. Select App Control profile.
Validate that ""P2P"" and ""Proxy"" category is blocked.","High risk applications such as those in ""P2P"" and ""Proxy"" are known for spreading
malware. Some of this traffic is encrypted and therefore is able to bypass network
security inspection (for those without decryption implemented). Blocking these
applications from running eliminates this risk.
If any application that falls under ""P2P"" and ""Proxy"" is required to be allowed based on
an organization's policy, that specific application needs to be under ""Monitor"" mode in
the ""Application and Filter Override"" configuration.",""
"4.5.2","CIS FortiGate 7.4.x Benchmark","FortiGate","Block applications running on non-default ports","Level 2","Ensure FortiGate Application Control blocks applications running on non-default ports.

Default Value:
Disabled","","","GUI:
1. Go to ""Security Profiles"" > ""Application Control"".
2. Select relevant App Control profile.
Enable ""Block applications detected on non-default ports"" option.
On CLI:
FGT1 # config application list
FGT1 (list) # edit <profile name>
FGT1 (<profile name>) # set enforce-default-app-port enable","","true","1. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/66882","On GUI:
1. Go to ""Security Profiles"" > ""Application Control"".
2. Select relevant App Control profile.
Validate that ""Block applications detected on non-default ports"" option is enabled.","Running applications on non-default ports is not directly a threat, but can be an
indication of something unexpected. For example, HTTPS runs on port 443. Potentially,
if an attacker starts a rogue HTTPS server on port 10443, it could be used for data
exfiltration.",""
"4.5.3","CIS FortiGate 7.4.x Benchmark","FortiGate","Ensure all Application Control related traffic is logged","Level 1","Ensure no category is set to ""Allow"" on FortiGate Application Control.

Default Value:
""Unknown Applications"" category is set as ""Allow"".","","","On GUI:
1. Go to ""Security Profiles"" > ""Application Control"".
2. Select the relevant App Control profile.
3. Change any categories with ""Allow"" action to ""Monitor"".","","true","1. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/19814","On GUI:
1. Review ""Security Profiles"" > ""Application Control"".
2. Select the relevant App Control profile.
Validate that no ""Allow"" action is set on any categories.","Any category that is set as ""Allow"" on Application Control will not be logged. This
creates a visibility gap on security investigation. This includes ""Unknown Applications""
category.","Visibility gap, which affects incident forensics and response."
"4.5.4","CIS FortiGate 7.4.x Benchmark","FortiGate","Apply Application Control Security Profile to Policies","Level 1","Ensuring that traffic traversing between networks on the FortiGate have an Application
Control security profile inspecting it.

Default Value:
Not Configured","","","Configure on all ""Allowed"" firewall policies to have an appropriate Application
Control security profile applied to policies.","","true","1. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/243446","Review all firewall policies and ensure that traffic has an Application Control
security profile assigned for inspection.","Traffic moving between ""interfaces"" on the FortiGate should have firewall policies
applied with an Application Control security profile applied.",""
"5.1.1","CIS FortiGate 7.4.x Benchmark","FortiGate","Enable Compromised Host Quarantine","Level 1","Default automation trigger configuration for when a high severity compromised host is
detected.

Default Value:
Not enabled","","","GUI
Security Fabric > Automation
Edit and change Disabled to Enabled
CLI
config system automation-action
edit ""Quarantine on FortiSwitch + FortiAP""
set description ""Default automation action configuration for
quarantining a MAC address on FortiSwitches and FortiAPs.""
set action-type quarantine
next
edit ""Quarantine FortiClient EMS Endpoint""
set description ""Default automation action configuration for
quarantining a FortiClient EMS endpoint device.""
set action-type quarantine-forticlient
next
end
config system automation-trigger
edit ""Compromised Host - High""
set description ""Default automation trigger configuration for when a
high severity compromised host is detected.""
next
end
config system automation-stitch
edit ""Compromised Host Quarantine""
set description ""Default automation stitch to quarantine a high
severity compromised host on FortiAPs, FortiSwitches, and FortiClient EMS.""
set status enable
set trigger ""Compromised Host - High""
config actions
edit 1
set action ""Quarantine on FortiSwitch + FortiAP""
next
edit 2
set action ""Quarantine FortiClient EMS Endpoint""
next
end
next
end","","true","","GUI
Security Fabric > Automation
Verify Compromised Host Quarantine is enabled.","By enabling this feature you protect your environment against compromised hosts.
Default automation stitch to quarantine a high severity compromised host on FortiAPs,
FortiSwitches, and FortiClient EMS.
Please note that this is only applicable if you have Fortinet's solution ecosystem
(FortiGate with FortiAP, FortiSwitches, or FortiClient EMS).",""
"5.2.1.1","CIS FortiGate 7.4.x Benchmark","FortiGate","Ensure Security Fabric is Configured","Level 2","Ensure Root FortiGate is configured as security fabric root.

Default Value:
Disabled","","","Remediation through the GUI:
1. Go to ""Security Fabric"" -> Fabric Connectors and then select ""Security
Fabric Setup"".
2. On the root FortiGate, set the status to enabled and the Security Fabric
Role to ""Serve as Fabric Root"".
3. Configure FortiAnalyzer settings when prompted and define a Fabric name as
well as interfaces that will ""Allow other Security Fabric Devices to Join"".","","true","","Review through the GUI:
1. Go to ""Security Fabric"" -> Fabric Connectors and then select ""Security
Fabric Setup"".
2. Validate that the root FortiGate has status set to enabled and the
Security Fabric Role set to ""Serve as Fabric Root"".
3. Ensure that FortiAnalyzer settings are correct and that there is a defined
Fabric name as well as interfaces selected that will ""Allow other Security
Fabric Devices to Join"".","Without a root FortiGate configured, the security fabric is not functional and can not be
leveraged.
Please note that this is only applicable if security fabric function within FortiGate is used.","Without Security Fabric enabled, visibility and management of traffic throughout an
organization is decreased and individual FortiGate management becomes more
intensive."
"6.1.1","CIS FortiGate 7.4.x Benchmark","FortiGate","Apply a Trusted Signed Certificate for VPN Portal","Level 2","Apply a signed certificate from a trusted Certificate Authority (CA) to the SSL VPN portal
to allow users to connect securely with confidence.

Default Value:
Self Signed Factory installed certificate","","","Import a signed certificate from a trusted CA through the GUI:
1. Go to System > Certificates > Import.
2. Then assign the certificate to the SSL VPN portal by going to VPN > SSL-
VPN Settings and selecting the proper certificate in the dropdown for ""Server
Certificate"".","","true","","GUI:
1. Access the FortiGate administrative web access page.
2. Go to VPN > SSL-VPN Settings and assign a signed certificate in the
dropdown for ""Server Certificate"".","Having an unsigned or self signed certificate leaves connections open to man-in-the-
middle attacks and could allow users to connect to untrusted servers.",""
"6.1.2","CIS FortiGate 7.4.x Benchmark","FortiGate","Enable Limited TLS Versions for SSL VPN","Level 2","Enable and disable TLS versions and Cipher suites for more granular control of SSL
VPN connections and enforcing more secure connections.

Default Value:
ssl-max-proto-ver : tls1-3
ssl-min-proto-ver : tls1-2
algorithm : high","","","CLI:
config vpn ssl settings
set ssl-max-proto-ver tls1-3
set ssl-min-proto-ver tls1-2
set algorithm high","","true","1. https://docs.fortinet.com/document/fortigate/7.4.5/cli-
reference/114404382/config-vpn-ssl-settings","CLI:
config vpn ssl settings
get
Validate that:
ssl-max-prot-ver is set to tls1-3.
ssl-min-proto-ver is set to tls1-2.
algorithm is set to high.","Limiting TLS versions to more secure versions as well as enforcing stronger ciphers
increases the security of the SSL VPN connections.",""
"7.1.1","CIS FortiGate 7.4.x Benchmark","FortiGate","Enable Event Logging","Level 2","Enabling event logging to allow for log generation and review.

Default Value:
Enabled","","","On GUI:
1. Go to Log & Report > Log Settings.
2. Enable ""All"" Event Logging.
On CLI:
config log eventfilter
set event enable
end","","true","1. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/250999","CLI:
config log eventfilter
get
Validate that all event types are enabled.","Enabling event logging generates logs that can be stored for later review or auditing or
can be ingested by another system (SIEM, Analyzer) for monitoring and response.",""
"7.2.1","CIS FortiGate 7.4.x Benchmark","FortiGate","Centralized Logging and Reporting","Level 2","Device logs should be sent to a centralized device for log collection, retention, and
reporting. This could be a SIEM. syslog device, FortiAnalyzer, FortiManager, etc.

Default Value:
Not configured.","","","Configure a remote server for logs to be sent to:
1. Go to Log & Report > Log Settings.
2. Under ""Syslog logging"" configure a remote server to send logs to.","","true","1. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/250999","On GUI:
1. Go to Log & Report > Log Settings.
2. Validate under ""Syslog logging"" that logs are being offloaded to another
device.","Centralized logging allows for more reliable log retention and more enriched log data for
review and reporting.",""
"7.3.1","CIS FortiGate 7.4.x Benchmark","FortiGate","Encrypt Log Transmission to FortiAnalyzer / FortiManager","Level 1","Enable encryption for logs that are sent to FortiAnalyzer or FortiManager.

Default Value:
Disabled","","","Secure log transfer settings can only be configured on CLI:
config log fortianalyzer setting
set reliable enable
set enc-algorithm high
end","","true","1. https://docs.fortinet.com/document/fortianalyzer/7.4.5/administration-
guide/410387","CLI:
config log fortianalyzer setting
get
Validate enc-algorithm is set to high.
Validate reliable is set enabled.","Provides encryption for logs that are sent to FortiAnalyzer or FortiManager to prevent
logs being collected and viewed as they traverse the network.",""
"7.3.2","CIS FortiGate 7.4.x Benchmark","FortiGate","Encrypt Log Transmission to Syslog","Level 1","Enable encryption for logs that are sent to FortiAnalyzer or FortiManager.

Default Value:
Disabled","","","Secure log transfer settings can only be configured on CLI:
config log syslog setting
set reliable enable
set enc-algorithm high
end","","true","1. https://docs.fortinet.com/document/fortianalyzer/7.4.5/administration-
guide/410387","CLI:
config log syslog setting
get
Validate enc-algorithm is set to high.
Validate reliable is set enabled.","Provides encryption for logs that are sent to syslog to prevent logs being collected and
viewed as they traverse the network.",""
"7.3.3","CIS FortiGate 7.4.x Benchmark","FortiGate","Encrypt Log Transmission to Syslog","Level 1","Enable encryption for logs that are sent to FortiAnalyzer or FortiManager.

Default Value:
Disabled","","","Secure log transfer settings can only be configured on CLI:
config log syslog setting
set reliable enable
set enc-algorithm high
end","","true","1. https://docs.fortinet.com/document/fortianalyzer/7.4.5/administration-
guide/410387","CLI:
config log syslog setting
get
Validate enc-algorithm is set to high.
Validate reliable is set enabled.","Provides encryption for logs that are sent to syslog to prevent logs being collected and
viewed as they traverse the network.",""
"1.1","CIS Docker Community Edition Benchmark","Docker","Ensure a separate partition for containers has been created","Level 1","Scoring: Scored

All Docker containers and their data and metadata is stored under /var/lib/docker
directory. By default, /var/lib/docker would be mounted under / or /var partitions based
on availability.

Default Value:
By default, /var/lib/docker would be mounted under / or /var partitions based on
availability.","","","For new installations, create a separate partition for /var/lib/docker mount point. For
systems that were previously installed, use the Logical Volume Manager (LVM) to create
partitions.","","true","1. https://www.projectatomic.io/docs/docker-storage-recommendation/","At the Docker host execute the below command:
grep /var/lib/docker /etc/fstab
This should return the partition details for /var/lib/docker mount point.","Docker depends on /var/lib/docker as the default directory where all Docker related files,
including the images, are stored. This directory might fill up fast and soon Docker and the
host could become unusable. So, it is advisable to create a separate partition (logical
volume) for storing Docker files.","None."
"1.2","CIS Docker Community Edition Benchmark","Docker","Ensure the container host has been Hardened","Level 1","Scoring: Not Scored

Containers run on a Linux host. A container host can run one or more containers. It is of
utmost importance to harden the host to mitigate host security misconfiguration.

Default Value:
By default, host has factory settings. It is not hardened.","","","You may consider various CIS Security Benchmarks for your container host. If you have
other security guidelines or regulatory requirements to adhere to, please follow them as
suitable in your environment.
Additionally, you can run a kernel with grsecurity and PaX. This would add many safety
checks, both at compile-time and run-time. It is also designed to defeat many exploits and
has powerful security features. These features do not require Docker-specific
configuration, since those security features apply system-wide, independent of containers.","","true","1. https://docs.docker.com/engine/security/security/
2. https://learn.cisecurity.org/benchmarks
3. https://docs.docker.com/engine/security/security/#other-kernel-security-features
4. https://grsecurity.net/
5. https://en.wikibooks.org/wiki/Grsecurity
6. https://pax.grsecurity.net/
7. http://en.wikipedia.org/wiki/PaX","Ensure that the host specific security guidelines are followed. Ask the system
administrators which security benchmark does current host system comply with. Ensure
that the host systems actually comply with that host specific security benchmark.","You should follow infrastructure security best practices and harden your host OS. Keeping
the host system hardened would ensure that the host vulnerabilities are mitigated. Not
hardening the host system could lead to security exposures and breaches.","None."
"1.3","CIS Docker Community Edition Benchmark","Docker","Ensure Docker is up to date","Level 1","Scoring: Not Scored

There are frequent releases for Docker software that address security vulnerabilities,
product bugs and bring in new functionality. Keep a tab on these product updates and
upgrade as frequently as when new security vulnerabilities are fixed or deemed correct for
your organization.

Default Value:
Not Applicable","","","Keep a track of Docker releases and update as necessary.","","true","1. https://docs.docker.com/engine/installation/
2. https://github.com/moby/moby/releases/latest
3. https://github.com/docker/docker-ce/releases/latest","Execute the below command and verify that the Docker version is up to date as deemed
necessary. It is not a mandate to be on the latest one, though.
docker version","By staying up to date on Docker updates, vulnerabilities in the Docker software can be
mitigated. An educated attacker may exploit known vulnerabilities when attempting to
attain access or elevate privileges. Not installing regular Docker updates may leave you
with running vulnerable Docker software. It might lead to elevation privileges,
unauthorized access or other security breaches. Keep a track of new releases and update as
necessary.","Perform a risk assessment for docker version updates in how they may impact your Docker
operations. Be aware that several third-party products that use Docker may require older
major version of Docker to be supported."
"1.4","CIS Docker Community Edition Benchmark","Docker","Ensure only trusted users are allowed to control Docker daemon","Level 1","Scoring: Scored

The Docker daemon currently requires root privileges. A user added to the docker group
gives him full root access rights.

Default Value:
Not Applicable","","","Remove any users from the docker group that are not trusted. Additionally, do not create a
mapping of sensitive directories on host to container volumes.","","true","1. https://docs.docker.com/engine/security/security/#docker-daemon-attack-
surface
2. https://www.andreas-jung.com/contents/on-docker-security-docker-group-
considered-harmful
3. http://www.projectatomic.io/blog/2015/08/why-we-dont-let-non-root-users-run-
docker-in-centos-fedora-or-rhel/","Execute the below command on the docker host and ensure that only trusted users are
members of the docker group.
getent group docker","Docker allows you to share a directory between the Docker host and a guest container
without limiting the access rights of the container. This means that you can start a
container and map the / directory on your host to the container. The container will then be
able to alter your host file system without any restrictions. In simple terms, it means that
you can attain elevated privileges with just being a member of the docker group and then
starting a container with mapped / directory on the host.","Rights to build and execute containers as normal user would be restricted."
"1.5","CIS Docker Community Edition Benchmark","Docker","Ensure auditing is configured for the docker daemon","Level 1","Scoring: Scored

Audit all Docker daemon activities.

Default Value:
By default, Docker daemon is not audited.","","","Add a rule for Docker daemon.
For example,
Add the line as below line in /etc/audit/audit.rules file:
-w /usr/bin/docker -k docker
Then, restart the audit daemon. For example,
service auditd restart","","true","1. https://access.redhat.com/documentation/en-
US/Red_Hat_Enterprise_Linux/6/html/Security_Guide/chap-system_auditing.html","Verify that there is an audit rule for Docker daemon. For example, execute below
command:
auditctl -l | grep /usr/bin/docker
This should list a rule for Docker daemon.","Apart from auditing your regular Linux file system and system calls, audit Docker daemon
as well. Docker daemon runs with root privileges. It is thus necessary to audit its activities
and usage.","Auditing generates quite big log files. Ensure to rotate and archive them periodically. Also,
create a separate partition of audit to avoid filling root file system."
"1.6","CIS Docker Community Edition Benchmark","Docker","Ensure auditing is configured for Docker files and directories - /var/lib/docker","Level 1","Scoring: Scored

Audit /var/lib/docker.

Default Value:
By default, Docker related files and directories are not audited.","","","Add a rule for /var/lib/docker directory.
For example,
Add the line as below in /etc/audit/audit.rules file:
-w /var/lib/docker -k docker
Then, restart the audit daemon. For example,
service auditd restart","","true","1. https://access.redhat.com/documentation/en-
US/Red_Hat_Enterprise_Linux/6/html/Security_Guide/chap-system_auditing.html","Verify that there is an audit rule corresponding to /var/lib/docker directory.
For example, execute below command:
auditctl -l | grep /var/lib/docker
This should list a rule for /var/lib/docker directory.","Apart from auditing your regular Linux file system and system calls, audit all Docker
related files and directories. Docker daemon runs with root privileges. Its behavior
depends on some key files and directories. /var/lib/docker is one such directory. It holds
all the information about containers. It must be audited.","Auditing generates quite big log files. Ensure to rotate and archive them periodically. Also,
create a separate partition of audit to avoid filling root file system."
"1.7","CIS Docker Community Edition Benchmark","Docker","Ensure auditing is configured for Docker files and directories - /etc/docker","Level 1","Scoring: Scored

Audit /etc/docker.

Default Value:
By default, Docker related files and directories are not audited.","","","Add a rule for /etc/docker directory.
For example,
Add the line as below in /etc/audit/audit.rules file:
-w /etc/docker -k docker
Then, restart the audit daemon. For example,
service auditd restart","","true","1. https://access.redhat.com/documentation/en-
US/Red_Hat_Enterprise_Linux/6/html/Security_Guide/chap-system_auditing.html","Verify that there is an audit rule corresponding to /etc/docker directory.
For example, execute below command:
auditctl -l | grep /etc/docker
This should list a rule for /etc/docker directory.","Apart from auditing your regular Linux file system and system calls, audit all Docker
related files and directories. Docker daemon runs with root privileges. Its behavior
depends on some key files and directories. /etc/docker is one such directory. It holds
various certificates and keys used for TLS communication between Docker daemon and
Docker client. It must be audited.","Auditing generates quite big log files. Ensure to rotate and archive them periodically. Also,
create a separate partition of audit to avoid filling root file system."
"1.8","CIS Docker Community Edition Benchmark","Docker","Ensure auditing is configured for Docker files and directories - docker.service","Level 1","Scoring: Scored

Audit docker.service, if applicable.

Default Value:
By default, Docker related files and directories are not audited. The file docker.service
may not be available on the system.","","","If the file exists, add a rule for it.
For example,
Add the line as below in /etc/audit/audit.rules file:
-w /usr/lib/systemd/system/docker.service -k docker
Then, restart the audit daemon. For example,
service auditd restart","","true","1. https://access.redhat.com/documentation/en-
US/Red_Hat_Enterprise_Linux/6/html/Security_Guide/chap-system_auditing.html","Step 1: Find out the file location:
systemctl show -p FragmentPath docker.service
Step 2: If the file does not exist, this recommendation is not applicable. If the file exists,
verify that there is an audit rule corresponding to the file:
For example, execute the below command:
auditctl -l | grep docker.service
This should list a rule for docker.service as per its location.","Apart from auditing your regular Linux file system and system calls, audit all Docker
related files and directories. Docker daemon runs with root privileges. Its behavior
depends on some key files and directories. docker.service is one such file. The
docker.service file might be present if the daemon parameters have been changed by an
administrator. It holds various parameters for Docker daemon. It must be audited, if
applicable.","Auditing generates quite big log files. Ensure to rotate and archive them periodically. Also,
create a separate partition of audit to avoid filling root file system."
"1.9","CIS Docker Community Edition Benchmark","Docker","Ensure auditing is configured for Docker files and directories - docker.socket","Level 1","Scoring: Scored

Audit docker.socket, if applicable.

Default Value:
By default, Docker related files and directories are not audited. The file docker.socket may
not be available on the system.","","","If the file exists, add a rule for it.
For example,
Add the line as below in /etc/audit/audit.rules file:
-w /usr/lib/systemd/system/docker.socket -k docker
Then, restart the audit daemon. For example,
service auditd restart","","true","1. https://access.redhat.com/documentation/en-
US/Red_Hat_Enterprise_Linux/6/html/Security_Guide/chap-system_auditing.html","Step 1: Find out the file location:
systemctl show -p FragmentPath docker.socket
Step 2: If the file does not exist, this recommendation is not applicable. If the file exists,
verify that there is an audit rule corresponding to the file:
For example, execute the below command:
auditctl -l | grep docker.socket
This should list a rule for docker.socket as per its location.","Apart from auditing your regular Linux file system and system calls, audit all Docker
related files and directories. Docker daemon runs with root privileges. Its behavior
depends on some key files and directories. docker.socket is one such file. It holds various
parameters for Docker daemon socket. It must be audited, if applicable.","Auditing generates quite big log files. Ensure to rotate and archive them periodically. Also,
create a separate partition of audit to avoid filling root file system."
"1.10","CIS Docker Community Edition Benchmark","Docker","Ensure auditing is configured for Docker files and directories - /etc/default/docker","Level 1","Scoring: Scored

Audit /etc/default/docker, if applicable.

Default Value:
By default, Docker related files and directories are not audited. The file
/etc/default/docker may not be available on the system. In that case, this
recommendation is not applicable.","","","Add a rule for /etc/default/docker file.
For example,
Add the line as below in /etc/audit/audit.rules file:
-w /etc/default/docker -k docker
Then, restart the audit daemon. For example,
service auditd restart","","true","1. https://access.redhat.com/documentation/en-
US/Red_Hat_Enterprise_Linux/6/html/Security_Guide/chap-system_auditing.html","Verify that there is an audit rule corresponding to /etc/default/docker file.
For example, execute below command:
auditctl -l | grep /etc/default/docker
This should list a rule for /etc/default/docker file.","Apart from auditing your regular Linux file system and system calls, audit all Docker
related files and directories. Docker daemon runs with root privileges. Its behavior
depends on some key files and directories. /etc/default/docker is one such file. It holds
various parameters for Docker daemon. It must be audited, if applicable.","Auditing generates quite big log files. Ensure to rotate and archive them periodically. Also,
create a separate partition of audit to avoid filling root file system."
"1.11","CIS Docker Community Edition Benchmark","Docker","Ensure auditing is configured for Docker files and directories - /etc/docker/daemon.json","Level 1","Scoring: Scored

Audit /etc/docker/daemon.json, if applicable.

Default Value:
By default, Docker related files and directories are not audited. The file
/etc/docker/daemon.json may not be available on the system. In that case, this
recommendation is not applicable.","","","Add a rule for /etc/docker/daemon.json file.
For example,
Add the line as below in /etc/audit/audit.rules file:
-w /etc/docker/daemon.json -k docker
Then, restart the audit daemon. For example,
service auditd restart","","true","1. https://access.redhat.com/documentation/en-
US/Red_Hat_Enterprise_Linux/6/html/Security_Guide/chap-system_auditing.html
2. https://docs.docker.com/engine/reference/commandline/dockerd/#daemon-
configuration-file","Verify that there is an audit rule corresponding to /etc/docker/daemon.json file.
For example, execute below command:
auditctl -l | grep /etc/docker/daemon.json
This should list a rule for /etc/docker/daemon.json file.","Apart from auditing your regular Linux file system and system calls, audit all Docker
related files and directories. Docker daemon runs with root privileges. Its behavior
depends on some key files and directories. /etc/docker/daemon.json is one such file. It
holds various parameters for Docker daemon. It must be audited, if applicable.","Auditing generates quite big log files. Ensure to rotate and archive them periodically. Also,
create a separate partition of audit to avoid filling root file system."
"1.12","CIS Docker Community Edition Benchmark","Docker","Ensure auditing is configured for Docker files and directories - /usr/bin/docker-containerd","Level 1","Scoring: Scored

Audit /usr/bin/docker-containerd, if applicable.

Default Value:
By default, Docker related files and directories are not audited. The file /usr/bin/docker-
containerd may not be available on the system. In that case, this recommendation is not
applicable.","","","Add a rule for /usr/bin/docker-containerd file.
For example,
Add the line as below in /etc/audit/audit.rules file:
-w /usr/bin/docker-containerd -k docker
Then, restart the audit daemon. For example,
service auditd restart","","true","1. https://access.redhat.com/documentation/en-
US/Red_Hat_Enterprise_Linux/6/html/Security_Guide/chap-system_auditing.html
2. https://github.com/docker/docker/pull/20662
3. https://containerd.tools/","Verify that there is an audit rule corresponding to /usr/bin/docker-containerd file.
For example, execute below command:
auditctl -l | grep /usr/bin/docker-containerd
This should list a rule for /usr/bin/docker-containerd file.","Apart from auditing your regular Linux file system and system calls, audit all Docker
related files and directories. Docker daemon runs with root privileges. Its behavior
depends on some key files and directories. /usr/bin/docker-containerd is one such file.
Docker now relies on containerdand runC to spawn containers. It must be audited, if
applicable.","Auditing generates quite big log files. Ensure to rotate and archive them periodically. Also,
create a separate partition of audit to avoid filling root file system."
"1.13","CIS Docker Community Edition Benchmark","Docker","Ensure auditing is configured for Docker files and directories - /usr/bin/docker-runc","Level 1","Scoring: Scored

Audit /usr/bin/docker-runc, if applicable.

Default Value:
By default, Docker related files and directories are not audited. The file/usr/bin/docker-
runc may not be available on the system. In that case, this recommendation is not
applicable.","","","Add a rule for /usr/bin/docker-runc file.
For example,
Add the line as below in /etc/audit/audit.rules file:
-w /usr/bin/docker-runc -k docker
Then, restart the audit daemon. For example,
service auditd restart","","true","1. https://access.redhat.com/documentation/en-
US/Red_Hat_Enterprise_Linux/6/html/Security_Guide/chap-system_auditing.html
2. https://github.com/docker/docker/pull/20662
3. https://containerd.tools/
4. https://github.com/opencontainers/runc","Verify that there is an audit rule corresponding to /usr/bin/docker-runc file.
For example, execute below command:
auditctl -l | grep /usr/bin/docker-runc
This should list a rule for /usr/bin/docker-runc file.","Apart from auditing your regular Linux file system and system calls, audit all Docker
related files and directories. Docker daemon runs with root privileges. Its behavior
depends on some key files and directories. /usr/bin/docker-runc is one such file. Docker
now relies on containerd and runC to spawn containers. It must be audited, if applicable.","Auditing generates quite big log files. Ensure to rotate and archive them periodically. Also,
create a separate partition of audit to avoid filling root file system."
"2.1","CIS Docker Community Edition Benchmark","Docker","Ensure network traffic is restricted between containers on the default bridge","Level 1","Scoring: Scored

By default, all network traffic is allowed between containers on the same host on the
default network bridge. If not desired, restrict all the inter-container communication. Link
specific containers together that require communication. Alternatively, you can create
custom network and only join containers that need to communicate to that custom
network.

Default Value:
By default, all inter-container communication is allowed on the default network bridge.","","","Run the docker in daemon mode and pass --icc=false as an argument.
For Example,
dockerd --icc=false
Alternatively, you can follow the Docker documentation and create a custom network and
only join containers that need to communicate to that custom network. The --icc
parameter only applies to the default docker bridge, if custom networks are used then the
approach of segmenting networks should be adopted instead.","","true","1. https://docs.docker.com/engine/userguide/networking/
2. https://docs.docker.com/engine/userguide/networking/default_network/containe
r-communication/#communication-between-containers","Run the below command and verify that the default network bridge has been configured to
restrict inter-container communication.
docker network ls --quiet | xargs docker network inspect --format '{{ .Name
}}: {{ .Options }}'
It should return com.docker.network.bridge.enable_icc:false for the default network
bridge.","By default, unrestricted network traffic is enabled between all containers on the same host
on the default network bridge. Thus, each container has the potential of reading all packets
across the container network on the same host. This might lead to an unintended and
unwanted disclosure of information to other containers. Hence, restrict the inter-container
communication on the default network bridge.","The inter-container communication would be disabled on the default network bridge. If
any communication between containers on the same host is desired, then it needs to be
explicitly defined using container linking or alternatively custom networks have to be
defined."
"2.2","CIS Docker Community Edition Benchmark","Docker","Ensure the logging level is set to 'info'","Level 1","Scoring: Scored

Set Docker daemon log level to info.

Default Value:
By default, Docker daemon is set to log level of info.","","","Run the Docker daemon as below:
dockerd --log-level=""info""","","true","1. https://docs.docker.com/edge/engine/reference/commandline/dockerd/","ps -ef | grep docker
Ensure that either the --log-level parameter is not present or if present, then it is set to
info.","Setting up an appropriate log level, configures the Docker daemon to log events that you
would want to review later. A base log level of info and above would capture all logs
except debug logs. Until and unless required, you should not run Docker daemon at debug
log level.","None."
"2.3","CIS Docker Community Edition Benchmark","Docker","Ensure Docker is allowed to make changes to iptables","Level 1","Scoring: Scored

Iptables are used to set up, maintain, and inspect the tables of IP packet filter rules in the
Linux kernel. Allow the Docker daemon to make changes to the iptables.

Default Value:
By default, iptables is set to true.","","","Do not run the Docker daemon with --iptables=false parameter. For example, do not
start the Docker daemon as below:
dockerd --iptables=false","","true","1. https://docs.docker.com/engine/userguide/networking/default_network/containe
r-communication/
2. https://fralef.me/docker-and-iptables.html","ps -ef | grep dockerd
Ensure that the --iptables parameter is either not present or not set to false.","Docker will never make changes to your system iptables rules if you choose to do so.
Docker server would automatically make the needed changes to iptables based on how you
choose your networking options for the containers if it is allowed to do so. It is
recommended to let Docker server make changes to iptablesautomatically to avoid
networking misconfiguration that might hamper the communication between containers
and to the outside world. Additionally, it would save you hassles of updating
iptablesevery time you choose to run the containers or modify networking options.","Docker daemon service start requires iptables rules to be enabled before it starts. Any
restarts of iptables during docker daemon operation may result in losing docker-created
rules. Adding iptables-persistent to your iptables install can assist with mitigating this
impact."
"2.4","CIS Docker Community Edition Benchmark","Docker","Ensure insecure registries are not used","Level 1","Scoring: Scored

Docker considers a private registry either secure or insecure. By default, registries are
considered secure.

Default Value:
By default, Docker assumes all, but local, registries are secure.","","","Do not use any insecure registries.
For example, do not start the Docker daemon as below:
dockerd --insecure-registry 10.1.0.0/16","","true","1. https://docs.docker.com/registry/insecure/","Run docker info or execute the below command to find out if any insecure registries are
used:
ps -ef | grep dockerd
Ensure that the --insecure-registry parameter is not present.","A secure registry uses TLS. A copy of registry's CA certificate is placed on the Docker host at
/etc/docker/certs.d/<registry-name>/ directory. An insecure registry is the one not
having either valid registry certificate or is not using TLS. You should not be using any
insecure registries in the production environment. Insecure registries can be tampered
with leading to possible compromise to your production system.
Additionally, If a registry is marked as insecure then docker pull, docker push, and
docker search commands will not result in an error message and the user might be
indefinitely working with insecure registries without ever being notified of potential
danger.","None."
"2.5","CIS Docker Community Edition Benchmark","Docker","Ensure aufs storage driver is not used","Level 1","Scoring: Scored

Do not use aufs as storage driver for your Docker instance.

Default Value:
By default, Docker uses devicemapper as the storage driver on most of the platforms.
Default storage driver can vary based on your OS vendor. You should use the storage driver
that is best supported by your preferred vendor.","","","Do not explicitly use aufs as storage driver.
For example, do not start Docker daemon as below:
dockerd --storage-driver aufs","","true","1. https://docs.docker.com/engine/userguide/storagedriver/selectadriver/#support
ed-backing-filesystems
2. http://muehe.org/posts/switching-docker-from-aufs-to-devicemapper/
3. http://jpetazzo.github.io/assets/2015-03-05-deep-dive-into-docker-storage-
drivers.html#1
4. https://docs.docker.com/engine/userguide/storagedriver/","Execute the below command and verify that aufs is not used as storage driver:
docker info | grep -e ""^Storage Driver:\s*aufs\s*$""
The above command should not return anything.","The aufs storage driver is the oldest storage driver. It is based on a Linux kernel patch-set
that is unlikely to be merged into the main Linux kernel. aufs driver is also known to cause
some serious kernel crashes. aufs just has legacy support from Docker. Most importantly,
aufs is not a supported driver in many Linux distributions using latest Linux kernels.","aufs is the only storage driver that allows containers to share executable and shared
library memory. It might be useful if you are running thousands of containers with the
same program or libraries."
"2.6","CIS Docker Community Edition Benchmark","Docker","Ensure TLS authentication for Docker daemon is configured","Level 1","Scoring: Scored

It is possible to make the Docker daemon to listen on a specific IP and port and any other
Unix socket other than default Unix socket. Configure TLS authentication to restrict access
to Docker daemon via IP and port.

Default Value:
By default, TLS authentication is not configured.","","","Follow the steps mentioned in the Docker documentation or other references.","","true","1. https://docs.docker.com/engine/security/https/","ps -ef | grep dockerd
Ensure that the below parameters are present:
--tlsverify
--tlscacert
--tlscert
--tlskey","By default, Docker daemon binds to a non-networked Unix socket and runs with root
privileges. If you change the default docker daemon binding to a TCP port or any other Unix
socket, anyone with access to that port or socket can have full access to Docker daemon
and in turn to the host system. Hence, you should not bind the Docker daemon to another
IP/port or a Unix socket.
If you must expose the Docker daemon via a network socket, configure TLS authentication
for the daemon and Docker Swarm APIs (if using). This would restrict the connections to
your Docker daemon over the network to a limited number of clients who could
successfully authenticate over TLS.","You would need to manage and guard certificates and keys for Docker daemon and Docker
clients."
"2.7","CIS Docker Community Edition Benchmark","Docker","Ensure the default ulimit is configured appropriately","Level 1","Scoring: Not Scored

Set the default ulimit options as appropriate in your environment.

Default Value:
By default, no ulimit is set.","","","Run the docker in daemon mode and pass --default-ulimit as argument with respective
ulimits as appropriate in your environment.
For Example,
dockerd --default-ulimit nproc=1024:2048 --default-ulimit nofile=100:200","","true","1. https://docs.docker.com/edge/engine/reference/commandline/dockerd/#default-
ulimits","ps -ef | grep dockerd
Ensure that the --default-ulimit parameter is set as appropriate.","ulimit provides control over the resources available to the shell and to processes started
by it. Setting system resource limits judiciously saves you from many disasters such as a
fork bomb. Sometimes, even friendly users and legitimate processes can overuse system
resources and in-turn can make the system unusable.
Setting default ulimit for the Docker daemon would enforce the ulimit for all container
instances. You would not need to setup ulimit for each container instance. However, the
default ulimit can be overridden during container runtime, if needed. Hence, to control the
system resources, define a default ulimit as needed in your environment.","If the ulimits are not set properly, the desired resource control might not be achieved and
might even make the system unusable."
"2.8","CIS Docker Community Edition Benchmark","Docker","Enable user namespace support","Level 2","Scoring: Scored

Enable user namespace support in Docker daemon to utilize container user to host user re-
mapping. This recommendation is beneficial where containers you are using do not have an
explicit container user defined in the container image. If container images that you are
using have a pre-defined non-root user, this recommendation may be skipped since this
feature is still in its infancy and might give you unpredictable issues and complexities.

Default Value:
By default, user namespace is not remapped.","","","Please consult Docker documentation for various ways in which this can be configured
depending upon your requirements. Your steps might also vary based on platform - For
example, on Red Hat, sub-UIDs and sub-GIDs mapping creation does not work
automatically. You might have to create your own mapping.
However, the high-level steps are as below:
Step 1: Ensure that the files /etc/subuid and /etc/subgid exist.
touch /etc/subuid /etc/subgid
Step 2: Start the docker daemon with --userns-remap flag
dockerd --userns-remap=default","","true","1. http://man7.org/linux/man-pages/man7/user_namespaces.7.html
2. https://docs.docker.com/engine/reference/commandline/dockerd/#daemon-user-
namespace-options
3. http://events.linuxfoundation.org/sites/events/files/slides/User%20Namespaces
%20-%20ContainerCon%202015%20-%2016-9-final_0.pdf","ps -p $(docker inspect --format='{{ .State.Pid }}' <CONTAINER ID>) -o
pid,user
The above command would find the PID of the container and then would list the host user
associated with the container process. If the container process is running as root, then this
recommendation is non-compliant.
Alternatively, you can run docker info to ensure that the userns is listed under Security
Options:
docker info --format '{{ .SecurityOptions }}'","The Linux kernel user namespace support in Docker daemon provides additional security
for the Docker host system. It allows a container to have a unique range of user and group
IDs which are outside the traditional user and group range utilized by the host system.
For example, the root user will have expected administrative privilege inside the container
but can effectively be mapped to an unprivileged UID on the host system.","User namespace remapping makes quite a few Docker features incompatible and also
currently breaks a few functionalities. Check out the Docker documentation and referenced
links for details."
"2.9","CIS Docker Community Edition Benchmark","Docker","Ensure the default cgroup usage has been confirmed","Level 2","Scoring: Scored

The --cgroup-parent option allows you to set the default cgroup parent to use for all the
containers. If there is no specific use case, this setting should be left at its default.

Default Value:
By default, docker daemon uses /docker for fs cgroup driver and system.slice for
systemd cgroup driver.","","","The default setting is good enough and can be left as-is. If you want to specifically set a non-
default cgroup, pass --cgroup-parent parameter to the docker daemon when starting it.
For Example,
dockerd --cgroup-parent=/foobar","","true","1. https://docs.docker.com/engine/reference/commandline/dockerd/#default-
cgroup-parent","ps -ef | grep dockerd
Ensure that the --cgroup-parent parameter is either not set or is set as appropriate non-
default cgroup.","System administrators typically define cgroups under which containers are supposed to
run. Even if cgroups are not explicitly defined by the system administrators, containers run
under docker cgroup by default.
It is possible to attach to a different cgroup other than that is the default. This usage should
be monitored and confirmed. By attaching to a different cgroup than the one that is a
default, it is possible to share resources unevenly and thus might starve the host for
resources.","None."
"2.10","CIS Docker Community Edition Benchmark","Docker","Ensure base device size is not changed until needed","Level 2","Scoring: Scored

In certain circumstances, you might need containers bigger than 10G in size. In these cases,
carefully choose the base device size.

Default Value:
The default base device size is 10G.","","","Do not set --storage-opt dm.basesize until needed.","","true","1. https://docs.docker.com/engine/reference/commandline/dockerd/#storage-
driver-options","ps -ef | grep dockerd
Execute the above command and it should not show any --storage-opt dm.basesize
parameters.","The base device size can be increased at daemon restart. Increasing the base device size
allows all future images and containers to be of the new base device size. A user can use
this option to expand the base device size however shrinking is not permitted. This value
affects the system-wide “base” empty filesystem that may already be initialized and
inherited by pulled images.
Though the file system does not allot the increased size if it is empty, it will use more space
for the empty case depending upon the device size. This may cause a denial of service by
ending up in file system being over-allocated or full.","None."
"2.11","CIS Docker Community Edition Benchmark","Docker","Ensure that authorization for Docker client commands is enabled","Level 2","Scoring: Scored

Use native Docker authorization plugins or a third party authorization mechanism with
Docker daemon to manage access to Docker client commands.

Default Value:
By default, authorization plugins are not set up.","","","Step 1: Install/Create an authorization plugin.
Step 2: Configure the authorization policy as desired.
Step 3: Start the docker daemon as below:
dockerd --authorization-plugin=<PLUGIN_ID>","","true","1. https://docs.docker.com/engine/reference/commandline/dockerd/#access-
authorization
2. https://docs.docker.com/engine/extend/plugins_authorization/
3. https://github.com/twistlock/authz
Notes:
As a scored control, focus should be on a PASS/FAIL if the authentication occurs when a
docker client command is executed against docker daemon to enforce authentication. The
native docker authentication plugin is just one method to enforce this control.","ps -ef | grep dockerd
Ensure that the --authorization-plugin parameter is set as appropriate if using docker
native authorization.
docker search hello-world
Ensure that docker daemon requires authorization to perform the above command.","Docker’s out-of-the-box authorization model is all or nothing. Any user with permission to
access the Docker daemon can run any Docker client command. The same is true for callers
using Docker’s remote API to contact the daemon. If you require greater access control, you
can create authorization plugins and add them to your Docker daemon configuration. Using
an authorization plugin, a Docker administrator can configure granular access policies for
managing access to Docker daemon.
Third party integrations of Docker may implement their own authorization models to
require authorization with the Docker daemon outside of docker's native authorization
plugin (i.e. Kubernetes, Cloud Foundry, Openshift).","Each docker command specifically passes through authorization plugin mechanism. This
might introduce a slight performance drop.
Third party use of alternative container engines that utilize the docker daemon may
provide alternative mechanisms to provide this security control."
"2.12","CIS Docker Community Edition Benchmark","Docker","Ensure centralized and remote logging is configured","Level 2","Scoring: Scored

Docker now supports various log drivers. A preferable way to store logs is the one that
supports centralized and remote logging.

Default Value:
By default, container logs are maintained as json files","","","Step 1: Setup the desired log driver by following its documentation.
Step 2: Start the docker daemon with that logging driver.
For example,
dockerd --log-driver=syslog --log-opt syslog-address=tcp://192.xxx.xxx.xxx","","true","1. https://docs.docker.com/engine/admin/logging/overview/","Run docker info and ensure that the Logging Driverproperty set as appropriate.
docker info --format '{{ .LoggingDriver }}'
Alternatively, the below command would give you the --log-driver setting, if configured.
Ensure that it is set as appropriate.
ps -ef | grep dockerd","Centralized and remote logging ensures that all important log records are safe despite
catastrophic events. Docker now supports various such logging drivers. Use the one that
suits your environment the best.","None."
"2.13","CIS Docker Community Edition Benchmark","Docker","Ensure operations on legacy registry (v1) are Disabled","Level 1","Scoring: Scored

The latest Docker registry is v2. All operations on the legacy registry version (v1) should be
restricted.

Default Value:
By default, legacy registry operations are allowed.","","","Start the docker daemon as below:
dockerd --disable-legacy-registry","","true","1. https://docs.docker.com/edge/engine/reference/commandline/dockerd/#legacy-
registries
2. https://docs.docker.com/registry/spec/api/
3. https://the.binbashtheory.com/creating-private-docker-registry-2-0-with-token-
authentication-service/
4. https://blog.docker.com/2015/07/new-tool-v1-registry-docker-trusted-registry-
v2-open-source/
5. http://www.slideshare.net/Docker/docker-registry-v2","ps -ef | grep dockerd
The above command should list --disable-legacy-registry as an option passed to the
docker daemon.","Docker registry v2 brings in many performance and security improvements over v1. It
supports container image provenance and other security features such as image signing
and verification. Hence, operations on Docker legacy registry should be restricted.","Legacy registry operations would be restricted."
"2.14","CIS Docker Community Edition Benchmark","Docker","Ensure live restore is Enabled","Level 1","Scoring: Scored

The --live-restore enables full support of daemon-less containers in docker. It ensures
that docker does not stop containers on shutdown or restore and properly reconnects to
the container when restarted.

Default Value:
By default, --live-restore is not enabled.","","","Run the docker in daemon mode and pass --live-restore as an argument.
For Example,
dockerd --live-restore","","true","1. https://docs.docker.com/engine/admin/live-restore/","Run docker info and ensure that the Live Restore Enabled property is set to true.
docker info --format '{{ .LiveRestoreEnabled }}'
Alternatively run the below command and ensure that --live-restore is used.
ps -ef | grep dockerd","One of the important security triads is availability. Setting --live-restore flag in the
docker daemon ensures that container execution is not interrupted when the docker
daemon is not available. This also means that it is now easier to update and patch the
docker daemon without execution downtime.","None."
"2.15","CIS Docker Community Edition Benchmark","Docker","Ensure Userland Proxy is Disabled","Level 1","Scoring: Scored

The docker daemon starts a userland proxy service for port forwarding whenever a port is
exposed. Where hairpin NAT is available, this service is generally superfluous to
requirements and can be disabled.

Default Value:
By default, the userland proxy is enabled.","","","Run the Docker daemon as below:
dockerd --userland-proxy=false","","true","1. http://windsock.io/the-docker-proxy/
2. https://github.com/docker/docker/issues/14856
3. https://github.com/docker/docker/issues/22741
4. https://docs.docker.com/engine/userguide/networking/default_network/binding/","ps -ef | grep dockerd
Ensure that the --userland-proxy parameter is set to false.","Docker engine provides two mechanisms for forwarding ports from the host to containers,
hairpin NAT, and a userland proxy. In most circumstances, the hairpin NAT mode is
preferred as it improves performance and makes use of native Linux iptables functionality
instead of an additional component.
Where hairpin NAT is available, the userland proxy should be disabled on startup to reduce
the attack surface of the installation.","Some systems with older Linux kernels may not be able to support hairpin NAT and
therefore require the userland proxy service. Also, some networking setups can be
impacted by the removal of the userland proxy."
"2.16","CIS Docker Community Edition Benchmark","Docker","Ensure daemon-wide custom seccomp profile is applied, if needed","Level 2","Scoring: Not Scored

You can choose to apply your custom seccomp profile at the daemon-wide level if needed
and override Docker's default seccomp profile.

Default Value:
By default, Docker applies a seccomp profile.","","","By default, Docker's default seccomp profile is applied. If this is good for your environment,
no action is necessary. Alternatively, if you choose to apply your own seccomp profile, use
the --seccomp-profile flag at daemon start or put it in the daemon runtime parameters
file.
dockerd --seccomp-profile </path/to/seccomp/profile>","","true","1. https://docs.docker.com/engine/security/seccomp/
2. https://github.com/docker/docker/pull/26276","Run the below command and review the seccomp profile listed in the Security Options
section. If it is default, that means, Docker's default seccomp profile is applied.
docker info --format '{{ .SecurityOptions }}'","A large number of system calls are exposed to every userland process with many of them
going unused for the entire lifetime of the process. Most of the applications do not need all
the system calls and thus benefit by having a reduced set of available system calls. The
reduced set of system calls reduces the total kernel surface exposed to the application and
thus improvises application security.
You could apply your own custom seccomp profile instead of Docker's default seccomp
profile. Alternatively, if Docker's default profile is good for your environment, you can
choose to ignore this recommendation.","A misconfigured seccomp profile could possibly interrupt your container environment.
Docker-default blocked calls have been carefully scrutinized. These address some critical
vulnerabilities/issues within container environments (for example, kernel key ring calls).
So, you should be very careful while overriding the defaults."
"2.17","CIS Docker Community Edition Benchmark","Docker","Ensure experimental features are avoided in production","Level 1","Scoring: Scored

Avoid experimental features in production.

Default Value:
By default, experimental features are not activated on the docker daemon.","","","Do not pass --experimental as a runtime parameter to the docker daemon.","","true","1. https://docs.docker.com/edge/engine/reference/commandline/dockerd/#options","Run the below command and ensure that the Experimental property is set to false in the
Server section.
docker version --format '{{ .Server.Experimental }}'","Experimental is now a runtime docker daemon flag instead of a separate build. Passing --
experimental as a runtime flag to the docker daemon, activates experimental features.
Experimental is now considered a stable release, but with a couple of features which might
not have tested and guaranteed API stability.","None"
"2.18","CIS Docker Community Edition Benchmark","Docker","Ensure containers are restricted from acquiring new privileges","Level 1","Scoring: Scored

Restrict containers from acquiring additional privileges via suid or sgid bits, by default.

Default Value:
By default, containers are not restricted from acquiring new privileges.","","","Run the Docker daemon as below:
dockerd --no-new-privileges","","true","1. https://github.com/moby/moby/pull/29984
2. https://github.com/moby/moby/pull/20727","ps -ef | grep dockerd
Ensure that the --no-new-privileges parameter is present and is not set to false.","A process can set the no_new_priv bit in the kernel. It persists across fork, clone and
execve. The no_new_priv bit ensures that the process or its children processes do not gain
any additional privileges via suid or sgid bits. This way a lot of dangerous operations
become a lot less dangerous because there is no possibility of subverting privileged
binaries.
Setting this at the daemon level ensures that by default all new containers are restricted
from acquiring new privileges.","no_new_priv prevents LSMs like SELinux from transitioning to process labels that have
access not allowed to the current process."
"3.1","CIS Docker Community Edition Benchmark","Docker","Ensure that docker.service file ownership is set to root:root","Level 1","Scoring: Scored

Verify that the docker.service file ownership and group-ownership are correctly set to
root.

Default Value:
This file may not be present on the system. In that case, this recommendation is not
applicable. By default, if the file is present, the ownership and group-ownership for this file
is correctly set to root.","","","Step 1: Find out the file location:
systemctl show -p FragmentPath docker.service
Step 2: If the file does not exist, this recommendation is not applicable. If the file exists,
execute the below command with the correct file path to set the ownership and group
ownership for the file to root.
For example,
chown root:root /usr/lib/systemd/system/docker.service","","true","1. https://docs.docker.com/engine/admin/systemd/","Step 1: Find out the file location:
systemctl show -p FragmentPath docker.service
Step 2: If the file does not exist, this recommendation is not applicable. If the file exists,
execute the below command with the correct file path to verify that the file is owned and
group-owned by root.
For example,
stat -c %U:%G /usr/lib/systemd/system/docker.service | grep -v root:root
The above command should not return anything.","docker.service file contains sensitive parameters that may alter the behavior of Docker
daemon. Hence, it should be owned and group-owned by root to maintain the integrity of
the file.","None."
"3.2","CIS Docker Community Edition Benchmark","Docker","Ensure that docker.service file permissions are set to 644 or more restrictive","Level 1","Scoring: Scored

Verify that the docker.service file permissions are correctly set to 644 or more restrictive.

Default Value:
This file may not be present on the system. In that case, this recommendation is not
applicable. By default, if the file is present, the file permissions are correctly set to 644.","","","Step 1: Find out the file location:
systemctl show -p FragmentPath docker.service
Step 2: If the file does not exist, this recommendation is not applicable. If the file exists,
execute the below command with the correct file path to set the file permissions to 644.
For example,
chmod 644 /usr/lib/systemd/system/docker.service","","true","1. https://docs.docker.com/articles/systemd/","Step 1: Find out the file location:
systemctl show -p FragmentPath docker.service
Step 2: If the file does not exist, this recommendation is not applicable. If the file exists,
execute the below command with the correct file path to verify that the file permissions are
set to 644 or more restrictive.
For example,
stat -c %a /usr/lib/systemd/system/docker.service","docker.service file contains sensitive parameters that may alter the behavior of Docker
daemon. Hence, it should not be writable by any other user other than root to maintain the
integrity of the file.","None."
"3.3","CIS Docker Community Edition Benchmark","Docker","Ensure that docker.socket file ownership is set to root:root","Level 1","Scoring: Scored

Verify that the docker.socket file ownership and group ownership is correctly set to root.

Default Value:
This file may not be present on the system. In that case, this recommendation is not
applicable. By default, if the file is present, the ownership and group-ownership for this file
is correctly set to root.","","","Step 1: Find out the file location:
systemctl show -p FragmentPath docker.socket
Step 2: If the file does not exist, this recommendation is not applicable. If the file exists,
execute the below command with the correct file path to set the ownership and group
ownership for the file to root.
For example,
chown root:root /usr/lib/systemd/system/docker.socket","","true","1. https://docs.docker.com/engine/reference/commandline/dockerd/#daemon-
socket-option
2. https://github.com/docker/docker-
ce/blob/master/components/packaging/deb/systemd/docker.socket","Step 1: Find out the file location:
systemctl show -p FragmentPath docker.socket
Step 2: If the file does not exist, this recommendation is not applicable. If the file exists,
execute the below command with the correct file path to verify that the file is owned and
group-owned by root.
For example,
stat -c %U:%G /usr/lib/systemd/system/docker.socket | grep -v root:root
The above command should not return anything.","docker.socket file contains sensitive parameters that may alter the behavior of Docker
remote API. Hence, it should be owned and group-owned by root to maintain the integrity
of the file.","None."
"3.4","CIS Docker Community Edition Benchmark","Docker","Ensure that docker.socket file permissions are set to 644 or more restrictive","Level 1","Scoring: Scored

Verify that the docker.socket file permissions are correctly set to 644 or more restrictive.

Default Value:
This file may not be present on the system. In that case, this recommendation is not
applicable. By default, if the file is present, the file permissions for this file are correctly set
to 644.","","","Step 1: Find out the file location:
systemctl show -p FragmentPath docker.socket
Step 2: If the file does not exist, this recommendation is not applicable. If the file exists,
execute the below command with the correct file path to set the file permissions to 644.
For example,
chmod 644 /usr/lib/systemd/system/docker.socket","","true","1. https://docs.docker.com/engine/reference/commandline/dockerd/#bind-docker-
to-another-hostport-or-a-unix-socket
2. https://github.com/YungSang/fedora-atomic-
packer/blob/master/oem/docker.socket
3. http://daviddaeschler.com/2014/12/14/centos-7rhel-7-and-docker-containers-
on-boot/","Step 1: Find out the file location:
systemctl show -p FragmentPath docker.socket
Step 2: If the file does not exist, this recommendation is not applicable. If the file exists,
execute the below command with the correct file path to verify that the file permissions are
set to 644 or more restrictive.
For example,
stat -c %a /usr/lib/systemd/system/docker.socket","docker.socket file contains sensitive parameters that may alter the behavior of Docker
remote API. Hence, it should be writable only by root to maintain the integrity of the file.","None."
"3.5","CIS Docker Community Edition Benchmark","Docker","Ensure that /etc/docker directory ownership is set to root:root","Level 1","Scoring: Scored

Verify that the /etc/docker directory ownership and group-ownership is correctly set to
root.

Default Value:
By default, the ownership and group-ownership for this directory is correctly set to root.","","","chown root:root /etc/docker
This would set the ownership and group-ownership for the directory to root.","","true","1. https://docs.docker.com/engine/security/https/","Execute the below command to verify that the directory is owned and group-owned by
root:
stat -c %U:%G /etc/docker | grep -v root:root
The above command should not return anything.","/etc/docker directory contains certificates and keys in addition to various sensitive files.
Hence, it should be owned and group-owned by root to maintain the integrity of the
directory.","None."
"3.6","CIS Docker Community Edition Benchmark","Docker","Ensure that /etc/docker directory permissions are set to 755 or more restrictive","Level 1","Scoring: Scored

Verify that the /etc/docker directory permissions are correctly set to 755 or more
restrictive.

Default Value:
By default, the permissions for this directory are correctly set to 755.","","","chmod 755 /etc/docker
This would set the permissions for the directory to 755.","","true","1. https://docs.docker.com/engine/security/https/","Execute the below command to verify that the directory has permissions of 755 or more
restrictive:
stat -c %a /etc/docker","/etc/docker directory contains certificates and keys in addition to various sensitive files.
Hence, it should only be writable by root to maintain the integrity of the directory.","None."
"3.7","CIS Docker Community Edition Benchmark","Docker","Ensure that registry certificate file ownership is set to root:root","Level 1","Scoring: Scored

Verify that all the registry certificate files (usually found under
/etc/docker/certs.d/<registry-name> directory) are owned and group-owned by root.

Default Value:
By default, the ownership and group-ownership for registry certificate files is correctly set
to root.","","","chown root:root /etc/docker/certs.d/<registry-name>/*
This would set the ownership and group-ownership for the registry certificate files to root.","","true","1. https://docs.docker.com/registry/insecure/","Execute the below command to verify that the registry certificate files are owned and
group-owned by root:
stat -c %U:%G /etc/docker/certs.d/* | grep -v root:root
The above command should not return anything.","/etc/docker/certs.d/<registry-name> directory contains Docker registry certificates.
These certificate files must be owned and group-owned by root to maintain the integrity of
the certificates.","None."
"3.8","CIS Docker Community Edition Benchmark","Docker","Ensure that registry certificate file permissions are set to 444 or more restrictive","Level 1","Scoring: Scored

Verify that all the registry certificate files (usually found under
/etc/docker/certs.d/<registry-name> directory) have permissions of 444 or more
restrictive.

Default Value:
By default, the permissions for registry certificate files might not be 444. The default file
permissions are governed by the system or user specific umaskvalues.","","","chmod 444 /etc/docker/certs.d/<registry-name>/*
This would set the permissions for registry certificate files to 444.","","true","1. https://docs.docker.com/registry/insecure/","Execute the below command to verify that the registry certificate files have permissions of
444 or more restrictive:
stat -c %a /etc/docker/certs.d/<registry-name>/*","/etc/docker/certs.d/<registry-name> directory contains Docker registry certificates.
These certificate files must have permissions of 444 to maintain the integrity of the
certificates.","None."
"3.9","CIS Docker Community Edition Benchmark","Docker","Ensure that TLS CA certificate file ownership is set to root:root","Level 1","Scoring: Scored

Verify that the TLS CA certificate file (the file that is passed alongwith --tlscacert
parameter) is owned and group-owned by root.

Default Value:
By default, the ownership and group-ownership for TLS CA certificate file is correctly set to
root.","","","chown root:root <path to TLS CA certificate file>
This would set the ownership and group-ownership for the TLS CA certificate file to root.","","true","1. https://docs.docker.com/registry/insecure/
2. https://docs.docker.com/engine/security/https/","Execute the below command to verify that the TLS CA certificate file is owned and group-
owned by root:
stat -c %U:%G <path to TLS CA certificate file> | grep -v root:root
The above command should not return anything.","The TLS CA certificate file should be protected from any tampering. It is used to
authenticate Docker server based on given CA certificate. Hence, it must be owned and
group-owned by root to maintain the integrity of the CA certificate.","None."
"3.10","CIS Docker Community Edition Benchmark","Docker","Ensure that TLS CA certificate file permissions are set to 444 or more restrictive","Level 1","Scoring: Scored

Verify that the TLS CA certificate file (the file that is passed alongwith --tlscacert
parameter) has permissions of 444 or more restrictive.

Default Value:
By default, the permissions for TLS CA certificate file might not be 444. The default file
permissions are governed by the system or user specific umask values.","","","chmod 444 <path to TLS CA certificate file>
This would set the file permissions of the TLS CA file to 444.","","true","1. https://docs.docker.com/registry/insecure/
2. https://docs.docker.com/engine/security/https/","Execute the below command to verify that the TLS CA certificate file has permissions of 444
or more restrictive:
stat -c %a <path to TLS CA certificate file>","The TLS CA certificate file should be protected from any tampering. It is used to
authenticate Docker server based on given CA certificate. Hence, it must have permissions
of 444 to maintain the integrity of the CA certificate.","None."
"3.11","CIS Docker Community Edition Benchmark","Docker","Ensure that Docker server certificate file ownership is set to root:root","Level 1","Scoring: Scored

Verify that the Docker server certificate file (the file that is passed alongwith --tlscert
parameter) is owned and group-owned by root.

Default Value:
By default, the ownership and group-ownership for Docker server certificate file is
correctly set to root.","","","chown root:root <path to Docker server certificate file>
This would set the ownership and group-ownership for the Docker server certificate file to
root.","","true","1. https://docs.docker.com/registry/insecure/
2. https://docs.docker.com/engine/security/https/","Execute the below command to verify that the Docker server certificate file is owned and
group-owned by root:
stat -c %U:%G <path to Docker server certificate file> | grep -v root:root
The above command should not return anything.","The Docker server certificate file should be protected from any tampering. It is used to
authenticate Docker server based on the given server certificate. Hence, it must be owned
and group-owned by root to maintain the integrity of the certificate.","None."
"3.12","CIS Docker Community Edition Benchmark","Docker","Ensure that Docker server certificate file permissions are set to 444 or more restrictive","Level 1","Scoring: Scored

Verify that the Docker server certificate file (the file that is passed alongwith --tlscert
parameter) has permissions of 444 or more restrictive.

Default Value:
By default, the permissions for Docker server certificate file might not be 444. The default
file permissions are governed by the system or user specific umask values.","","","chmod 444 <path to Docker server certificate file>
This would set the file permissions of the Docker server file to 444.","","true","1. https://docs.docker.com/registry/insecure/
2. https://docs.docker.com/engine/security/https/","Execute the below command to verify that the Docker server certificate file has
permissions of 444 or more restrictive:
stat -c %a <path to Docker server certificate file>","The Docker server certificate file should be protected from any tampering. It is used to
authenticate Docker server based on the given server certificate. Hence, it must have
permissions of 444 to maintain the integrity of the certificate.","None."
"3.13","CIS Docker Community Edition Benchmark","Docker","Ensure that Docker server certificate key file ownership is set to root:root","Level 1","Scoring: Scored

Verify that the Docker server certificate key file (the file that is passed alongwith --tlskey
parameter) is owned and group-owned by root.

Default Value:
By default, the ownership and group-ownership for Docker server certificate key file is
correctly set to root.","","","chown root:root <path to Docker server certificate key file>
This would set the ownership and group-ownership for the Docker server certificate key
file to root.","","true","1. https://docs.docker.com/registry/insecure/
2. https://docs.docker.com/engine/security/https/","Execute the below command to verify that the Docker server certificate key file is owned
and group-owned by root:
stat -c %U:%G <path to Docker server certificate key file> | grep -v
root:root
The above command should not return anything.","The Docker server certificate key file should be protected from any tampering or unneeded
reads. It holds the private key for the Docker server certificate. Hence, it must be owned
and group-owned by root to maintain the integrity of the Docker server certificate.","None."
"3.14","CIS Docker Community Edition Benchmark","Docker","Ensure that Docker server certificate key file permissions are set to 400","Level 1","Scoring: Scored

Verify that the Docker server certificate key file (the file that is passed alongwith --tlskey
parameter) has permissions of 400.

Default Value:
By default, the permissions for Docker server certificate key file might not be 400. The
default file permissions are governed by the system or user specific umask values.","","","chmod 400 <path to Docker server certificate key file>
This would set the Docker server certificate key file permissions to 400.","","true","1. https://docs.docker.com/registry/insecure/
2. https://docs.docker.com/engine/security/https/","Execute the below command to verify that the Docker server certificate key file has
permissions of 400:
stat -c %a <path to Docker server certificate key file>","The Docker server certificate key file should be protected from any tampering or unneeded
reads. It holds the private key for the Docker server certificate. Hence, it must have
permissions of 400 to maintain the integrity of the Docker server certificate.","None."
"3.15","CIS Docker Community Edition Benchmark","Docker","Ensure that Docker socket file ownership is set to root:docker","Level 1","Scoring: Scored

Verify that the Docker socket file is owned by root and group-owned by docker.

Default Value:
By default, the ownership and group-ownership for Docker socket file is correctly set to
root:docker.","","","chown root:docker /var/run/docker.sock
This would set the ownership to root and group-ownership to docker for default Docker
socket file.","","true","1. https://docs.docker.com/engine/reference/commandline/dockerd/#daemon-
socket-option
2. https://docs.docker.com/engine/reference/commandline/dockerd/#bind-docker-
to-another-hostport-or-a-unix-socket","Execute the below command to verify that the Docker socket file is owned by root and
group-owned by docker:
stat -c %U:%G /var/run/docker.sock | grep -v root:docker
The above command should not return anything.","Docker daemon runs as root. The default Unix socket hence must be owned by root. If any
other user or process owns this socket, then it might be possible for that non-privileged
user or process to interact with Docker daemon. Also, such a non-privileged user or
process might interact with containers. This is neither secure nor desired behavior.
Additionally, the Docker installer creates a Unix group called docker. You can add users to
this group, and then those users would be able to read and write to default Docker Unix
socket. The membership to the docker group is tightly controlled by the system
administrator. If any other group owns this socket, then it might be possible for members
of that group to interact with Docker daemon. Also, such a group might not be as tightly
controlled as the docker group. This is neither secure nor desired behavior.
Hence, the default Docker Unix socket file must be owned by root and group-owned by
docker to maintain the integrity of the socket file.","None."
"3.16","CIS Docker Community Edition Benchmark","Docker","Ensure that Docker socket file permissions are set to 660 or more restrictive","Level 1","Scoring: Scored

Verify that the Docker socket file has permissions of 660 or more restrictive.

Default Value:
By default, the permissions for Docker socket file is correctly set to 660.","","","chmod 660 /var/run/docker.sock
This would set the file permissions of the Docker socket file to 660.","","true","1. https://docs.docker.com/engine/reference/commandline/dockerd/#daemon-
socket-option
2. https://docs.docker.com/engine/reference/commandline/dockerd/#bind-docker-
to-another-hostport-or-a-unix-socket","Execute the below command to verify that the Docker socket file has permissions of 660 or
more restrictive:
stat -c %a /var/run/docker.sock","Only root and members of docker group should be allowed to read and write to default
Docker Unix socket. Hence, the Docket socket file must have permissions of 660 or more
restrictive.","None."
"3.17","CIS Docker Community Edition Benchmark","Docker","Ensure that daemon.json file ownership is set to root:root","Level 1","Scoring: Scored

Verify that the daemon.json file ownership and group-ownership is correctly set to root.

Default Value:
This file may not be present on the system. In that case, this recommendation is not
applicable.","","","chown root:root /etc/docker/daemon.json
This would set the ownership and group-ownership for the file to root.","","true","1. https://docs.docker.com/engine/reference/commandline/dockerd/#daemon-
configuration-file","Execute the below command to verify that the file is owned and group-owned by root:
stat -c %U:%G /etc/docker/daemon.json | grep -v root:root
The above command should not return anything.","daemon.json file contains sensitive parameters that may alter the behavior of docker
daemon. Hence, it should be owned and group-owned by root to maintain the integrity of
the file.","None."
"3.18","CIS Docker Community Edition Benchmark","Docker","Ensure that daemon.json file permissions are set to 644 or more restrictive","Level 1","Scoring: Scored

Verify that the daemon.json file permissions are correctly set to 644 or more restrictive.

Default Value:
This file may not be present on the system. In that case, this recommendation is not
applicable.","","","chmod 644 /etc/docker/daemon.json
This would set the file permissions for this file to 644.","","true","1. https://docs.docker.com/engine/reference/commandline/dockerd/#daemon-
configuration-file","Execute the below command to verify that the file permissions are correctly set to 644 or
more restrictive:
stat -c %a /etc/docker/daemon.json","daemon.json file contains sensitive parameters that may alter the behavior of docker
daemon. Hence, it should be writable only by root to maintain the integrity of the file.","None."
"3.19","CIS Docker Community Edition Benchmark","Docker","Ensure that /etc/default/docker file ownership is set to root:root","Level 1","Scoring: Scored

Verify that the /etc/default/docker file ownership and group-ownership is correctly set
to root.

Default Value:
This file may not be present on the system. In that case, this recommendation is not
applicable.","","","chown root:root /etc/default/docker
This would set the ownership and group-ownership for the file to root.","","true","1. https://docs.docker.com/engine/admin/configuring/","Execute the below command to verify that the file is owned and group-owned by root:
stat -c %U:%G /etc/default/docker | grep -v root:root
The above command should not return anything.","/etc/default/docker file contains sensitive parameters that may alter the behavior of
docker daemon. Hence, it should be owned and group-owned by root to maintain the
integrity of the file.","None."
"3.20","CIS Docker Community Edition Benchmark","Docker","Ensure that /etc/default/docker file permissions are set to 644 or more restrictive","Level 1","Scoring: Scored

Verify that the /etc/default/docker file permissions are correctly set to 644 or more
restrictive.

Default Value:
This file may not be present on the system. In that case, this recommendation is not
applicable.","","","chmod 644 /etc/default/docker
This would set the file permissions for this file to 644.","","true","1. https://docs.docker.com/engine/admin/configuring/","Execute the below command to verify that the file permissions are correctly set to 644 or
more restrictive:
stat -c %a /etc/default/docker","/etc/default/docker file contains sensitive parameters that may alter the behavior of
docker daemon. Hence, it should be writable only by root to maintain the integrity of the
file.","None."
"4.1","CIS Docker Community Edition Benchmark","Docker","Ensure a user for the container has been created","Level 1","Scoring: Scored

Create a non-root user for the container in the Dockerfile for the container image.

Default Value:
By default, the containers are run with rootprivileges and as user rootinside the container.","","","Ensure that the Dockerfile for the container image contains below instruction:
USER <username or ID>
where username or ID refers to the user that could be found in the container base image. If
there is no specific user created in the container base image, then add a useradd command
to add the specific user before USER instruction.
For example, add the below lines in the Dockerfile to create a user in the container:
RUN useradd -d /home/username -m -s /bin/bash username
USER username
Note: If there are users in the image that the containers do not need, consider deleting
them. After deleting those users, commit the image and then generate new instances of
containers for use.","","true","1. https://github.com/docker/docker/issues/2918
2. https://github.com/docker/docker/pull/4572
3. https://github.com/docker/docker/issues/7906","docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}: User={{
.Config.User }}'
The above command should return container username or user ID. If it is blank it means,
the container is running as root.","It is a good practice to run the container as a non-root user, if possible. Though user
namespace mapping is now available, if a user is already defined in the container image, the
container is run as that user by default and specific user namespace remapping is not
required.","None."
"4.2","CIS Docker Community Edition Benchmark","Docker","Ensure that containers use trusted base images","Level 1","Scoring: Not Scored

Ensure that the container image is written either from scratch or is based on another
established and trusted base image downloaded over a secure channel.

Default Value:
Not Applicable.","",""," Configure and use Docker Content trust.
 Inspect Docker image history to evaluate their risk to operate on your network.
 Scan Docker images for vulnerabilities in their dependencies and configurations
they will impose upon your network.","","true","1. https://titanous.com/posts/docker-insecurity
2. https://registry.hub.docker.com/
3. http://blog.docker.com/2014/10/docker-1-3-signed-images-process-injection-
security-options-mac-shared-directories/
4. https://github.com/docker/docker/issues/8093
5. https://docs.docker.com/engine/reference/commandline/pull/
6. https://github.com/docker/docker/pull/11109
7. https://blog.docker.com/2015/11/docker-trusted-registry-1-4/","Step 1 - Inspect the Docker host for Docker images used by executing the below command:
docker images
This would list all the container images that are currently available for use on the Docker
host. Interview the system administrator and obtain a proof of evidence that the list of
images was obtained from trusted source over a secure channel or from a trusted, secure
private Docker registry.
Step 2 - For each Docker image found on the Docker host, inspect the image for how it was
built to verify if from trusted sources and hardened configuration:
docker history <imageName>","Official repositories are Docker images curated and optimized by the Docker community or
the vendor. There could be other potentially unsafe public repositories. Caution should be
exercised when obtaining container images from Docker and third parties to how they will
be used for your organization's data.","None."
"4.4","CIS Docker Community Edition Benchmark","Docker","Ensure images are scanned and rebuilt to include security patches","Level 1","Scoring: Not Scored

Images should be scanned ""frequently"" for any vulnerabilities. Rebuild the images to
include patches and then instantiate new containers from it.

Default Value:
By default, containers and images are not updated of their own.","","","Follow the below steps to rebuild the images with security patches:
Step 1: Pull all the base images (i.e., given your set of Dockerfiles, extract all images
declared in FROM instructions, and re-pull them to check for an updated/patched versions).
Patch the packages within the images too.
docker pull
Step 2: Force a rebuild of each image:
docker build --no-cache
Step 3: Restart all containers with the updated images.
You could also use ONBUILD directive in the Dockerfile to trigger particular update
instructions for images that you know are used as base images frequently.","","true","1. https://docs.docker.com/userguide/dockerimages/
2. https://docs.docker.com/docker-cloud/builds/image-scan/
3. https://blog.docker.com/2016/05/docker-security-scanning/
4. https://docs.docker.com/engine/reference/builder/#/onbuild","Step 1: List all the running instances of containers by executing below command:
docker ps --quiet
Step 2: For each container instance, execute the below or equivalent command to find the
list of packages installed within the container. Ensure that the security updates for various
affected packages are installed.
docker exec $INSTANCE_ID rpm -qa
Alternatively, you could run image vulnerability scanning tools which can scan all the
images in your ecosystem and then apply patches for the detected vulnerabilities based on
your patch management procedures.","Vulnerabilities are loopholes/bugs that can be exploited and security patches are updates
to resolve these vulnerabilities. We can use image vulnerability scanning tools to find any
kind of vulnerabilities within the images and then check for available patches to mitigate
these vulnerabilities. Patches update the system to the most recent code base. Being on the
current code base is important because that's where vendors focus on fixing problems.
Evaluate the security patches before applying and follow the patching best practices.
Also, it would be better if, image vulnerability scanning tools could perform binary level
analysis or hash based verification instead of just version string matching.","None"
"4.5","CIS Docker Community Edition Benchmark","Docker","Ensure Content trust for Docker is Enabled","Level 2","Scoring: Scored

Content trust is disabled by default. You should enable it.

Default Value:
By default, content trust is disabled.","","","To enable content trust in a bash shell, enter the following command:
export DOCKER_CONTENT_TRUST=1
Alternatively, set this environment variable in your profile file so that content trust in
enabled on every login.","","true","1. https://docs.docker.com/engine/security/trust/content_trust/
2. https://docs.docker.com/engine/reference/commandline/cli/#notary
3. https://docs.docker.com/engine/reference/commandline/cli/#environment-
variables","echo $DOCKER_CONTENT_TRUST
This should return 1.","Content trust provides the ability to use digital signatures for data sent to and received
from remote Docker registries. These signatures allow client-side verification of the
integrity and publisher of specific image tags. This ensures provenance of container images.","In an environment where DOCKER_CONTENT_TRUST is set, you are required to follow trust
procedures while working with images - build, create, pull, pushand run. You can use the
--disable-content-trust flag to run individual operations on tagged images without
content trust on an as-needed basis but that defeats the purpose of enabling content trust
and hence, should be avoided wherever possible.
Note: Content trust is currently only available for users of the public Docker Hub. It is
currently not available for the Docker Trusted Registry or for private registries."
"4.6","CIS Docker Community Edition Benchmark","Docker","Ensure HEALTHCHECK instructions have been added to the container image","Level 1","Scoring: Scored

Add HEALTHCHECK instruction in your docker container images to perform the health check
on running containers.

Default Value:
By default, HEALTHCHECK is not set.","","","Follow Docker documentation and rebuild your container image with HEALTHCHECK
instruction.","","true","1. https://docs.docker.com/engine/reference/builder/#healthcheck","Run the below command and ensure that the docker image has appropriate HEALTHCHECK
instruction set up.
docker inspect --format='{{ .Config.Healthcheck }}' <IMAGE>","One of the important security triads is availability. Adding HEALTHCHECK instruction to your
container image ensures that the docker engine periodically checks the running container
instances against that instruction to ensure that the instances are still working.
Based on the reported health status, the docker engine could then exit non-working
containers and instantiate new ones.","None."
"4.8","CIS Docker Community Edition Benchmark","Docker","Ensure setuid and setgid permissions are removed in the images","Level 2","Scoring: Not Scored

Removing setuid and setgid permissions in the images would prevent privilege escalation
attacks in the containers.

Default Value:
Not Applicable","","","Allow setuid and setgid permissions only on executables which need them. You could
remove these permissions during build time by adding the following command in your
Dockerfile, preferably towards the end of the Dockerfile:
RUN find / -perm +6000 -type f -exec chmod a-s {} \; || true","","true","1. http://www.oreilly.com/webops-perf/free/files/docker-security.pdf
2. http://container-
solutions.com/content/uploads/2015/06/15.06.15_DockerCheatSheet_A2.pdf
3. http://man7.org/linux/man-pages/man2/setuid.2.html
4. http://man7.org/linux/man-pages/man2/setgid.2.html","Run the below command on the image to list the executables having setuid and setgid
permissions:
docker run <Image_ID> find / -perm +6000 -type f -exec ls -ld {} \; 2>
/dev/null
Carefully, review the list and ensure that it is legitimate.","setuid and setgid permissions could be used for elevating privileges. While these
permissions are at times legitimately needed, these could potentially be used in privilege
escalation attacks. Thus, you should consider dropping these permissions for the packages
which do not need them within the images.","Above command breaks all the executables that depend on setuid or setgid permissions
including the legitimate ones. Hence, be careful to modify the command to suit your
requirements so that it does not drop the permissions of legitimate programs. This
requires a careful examination of each executable and fine tuning the permissions."
"4.9","CIS Docker Community Edition Benchmark","Docker","Ensure COPY is used instead of ADD in Dockerfile","Level 1","Scoring: Not Scored

Use COPY instruction instead of ADD instruction in the Dockerfile.

Default Value:
Not Applicable","","","Use COPY instructions in Dockerfiles.","","true","1. https://docs.docker.com/engine/userguide/eng-image/dockerfile_best-
practices/#add-or-copy","Step 1: Run the below command to get the list of images:
docker images
Step 2: Run the below command for each image in the list above and look for any ADD
instructions:
docker history <Image_ID>
Alternatively, if you have access to Dockerfile for the image, verify that there are no ADD
instructions.","COPY instruction just copies the files from the local host machine to the container file
system. ADD instruction potentially could retrieve files from remote URLs and perform
operations such as unpacking. Thus, ADD instruction introduces risks such as adding
malicious files from URLs without scanning and unpacking procedure vulnerabilities.","You would need to take care of the functionalities provided by ADD instructions such as
fetching files from remote URLs."
"4.10","CIS Docker Community Edition Benchmark","Docker","Ensure secrets are not stored in Dockerfiles","Level 1","Scoring: Not Scored

Do not store any secrets in Dockerfiles.

Default Value:
By default, there are no restrictions on storing config secrets in the Dockerfiles.","","","Do not store any kind of secrets within Dockerfiles.","","true","1. https://github.com/docker/docker/issues/13490
2. http://12factor.net/config
3. https://avicoder.me/2016/07/22/Twitter-Vine-Source-code-dump/","Step 1: Run the below command to get the list of images:
docker images
Step 2: Run the below command for each image in the list above, and look for any secrets:
docker history <Image_ID>
Alternatively, if you have access to Dockerfile for the image, verify that there are no secrets
as described above.","Dockerfiles could be backtracked easily by using native Docker commands such as docker
history and various tools and utilities. Also, as a general practice, image publishers
provide Dockerfiles to build the credibility for their images. Hence, the secrets within these
Dockerfiles could be easily exposed and potentially be exploited.","You would need to identify a way to handle secrets for your Docker images."
"4.11","CIS Docker Community Edition Benchmark","Docker","Ensure verified packages are only Installed","Level 2","Scoring: Not Scored

Verify authenticity of the packages before installing them in the image.

Default Value:
Not Applicable","","","Use GPG keys for downloading and verifying packages or any other secure package
distribution mechanism of your choice.","","true","1. http://www.oreilly.com/webops-perf/free/files/docker-security.pdf
2. https://github.com/docker-
library/httpd/blob/12bf8c8883340c98b3988a7bade8ef2d0d6dcf8a/2.4/Dockerfil
e
3. https://github.com/docker-
library/php/blob/d8a4ccf4d620ec866d5b42335b699742df08c5f0/7.0/alpine/Doc
kerfile
4. https://access.redhat.com/security/team/key","Step 1: Run the below command to get the list of images:
docker images
Step 2: Run the below command for each image in the list above, and look for how the
authenticity of the packages is determined. This could be via the use of GPG keys or other
secure package distribution mechanisms
docker history <Image_ID>
Alternatively, if you have access to Dockerfile for the image, verify that the authenticity of
the packages is checked.","Verifying authenticity of the packages is essential for building a secure container image.
Tampered packages could potentially be malicious or have some known vulnerabilities that
could be exploited.","None"
"5.1","CIS Docker Community Edition Benchmark","Docker","Ensure AppArmor Profile is Enabled","Level 1","Scoring: Scored

AppArmor is an effective and easy-to-use Linux application security system. It is available
on quite a few Linux distributions by default such as Debian and Ubuntu.

Default Value:
By default, docker-default AppArmor profile is applied for running containers and this
profile can be found at /etc/apparmor.d/docker.","","","If AppArmor is applicable for your Linux OS, use it. You may have to follow below set of
steps:
1. Verify if AppArmor is installed. If not, install it.
2. Create or import a AppArmor profile for Docker containers.
3. Put this profile in enforcing mode.
4. Start your Docker container using the customized AppArmor profile. For example,
docker run --interactive --tty --security-opt=""apparmor:PROFILENAME"" centos
/bin/bash
Alternatively, you can keep the docker's default apparmor profile.","","true","1. https://docs.docker.com/engine/security/apparmor/
2. https://docs.docker.com/engine/reference/run/#security-configuration
3. https://docs.docker.com/engine/security/security/#other-kernel-security-features","docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:
AppArmorProfile={{ .AppArmorProfile }}'
The above command should return a valid AppArmor Profile for each container instance.","AppArmor protects the Linux OS and applications from various threats by enforcing
security policy which is also known as AppArmor profile. You can create your own
AppArmor profile for containers or use the Docker's default AppArmor profile. This would
enforce security policies on the containers as defined in the profile.","The container (process) would have set of restrictions as defined in AppArmor profile. If
your AppArmor profile is mis-configured, then the container may not entirely work as
expected."
"5.2","CIS Docker Community Edition Benchmark","Docker","Ensure SELinux security options are set, if applicable","Level 2","Scoring: Scored

SELinux is an effective and easy-to-use Linux application security system. It is available on
quite a few Linux distributions by default such as Red Hat and Fedora.

Default Value:
By default, no SELinux security options are applied on containers.","","","If SELinux is applicable for your Linux OS, use it. You may have to follow below set of steps:
1. Set the SELinux State.
2. Set the SELinux Policy.
3. Create or import a SELinux policy template for Docker containers.
4. Start Docker in daemon mode with SELinux enabled. For example,
docker daemon --selinux-enabled
5. Start your Docker container using the security options. For example,
docker run --interactive --tty --security-opt label=level:TopSecret centos
/bin/bash","","true","1. https://docs.docker.com/engine/security/security/#other-kernel-security-features
2. https://docs.docker.com/engine/reference/run/#security-configuration
3. http://docs.fedoraproject.org/en-US/Fedora/13/html/Security-Enhanced_Linux/
4. https://access.redhat.com/documentation/en-
us/red_hat_enterprise_linux_atomic_host/7/html/container_security_guide/docker_
selinux_security_policy","docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:
SecurityOpt={{ .HostConfig.SecurityOpt }}'
The above command should return all the security options currently configured for the
containers.","SELinux provides a Mandatory Access Control (MAC) system that greatly augments the
default Discretionary Access Control (DAC) model. You can thus add an extra layer of safety
by enabling SELinux on your Linux host, if applicable.","The container (process) would have set of restrictions as defined in SELinux policy. If your
SELinux policy is mis-configured, then the container may not entirely work as expected."
"5.3","CIS Docker Community Edition Benchmark","Docker","Ensure Linux Kernel Capabilities are restricted within containers","Level 1","Scoring: Scored

By default, Docker starts containers with a restricted set of Linux Kernel Capabilities. It
means that any process may be granted the required capabilities instead of root access.
Using Linux Kernel Capabilities, the processes do not have to run as root for almost all the
specific areas where root privileges are usually needed.

Default Value:
By default, below capabilities are available for containers:
AUDIT_WRITE
CHOWN
DAC_OVERRIDE
FOWNER
FSETID
KILL
MKNOD
NET_BIND_SERVICE
NET_RAW
SETFCAP
SETGID
SETPCAP
SETUID
SYS_CHROOT","","","Execute the below command to add needed capabilities:
$> docker run --cap-add={""Capability 1"",""Capability 2""}
For example,
docker run --interactive --tty --cap-add={""NET_ADMIN"",""SYS_ADMIN""}
centos:latest /bin/bash
Execute the below command to drop unneeded capabilities:
$> docker run --cap-drop={""Capability 1"",""Capability 2""}
For example,
docker run --interactive --tty --cap-drop={""SETUID"",""SETGID""} centos:latest
/bin/bash
Alternatively,
You may choose to drop all capabilities and add only add the needed ones:
$> docker run --cap-drop=all --cap-add={""Capability 1"",""Capability 2""}
For example,
docker run --interactive --tty --cap-drop=all --cap-
add={""NET_ADMIN"",""SYS_ADMIN""} centos:latest /bin/bash","","true","1. https://docs.docker.com/engine/security/security/#linux-kernel-capabilities
2. http://man7.org/linux/man-pages/man7/capabilities.7.html
3. http://www.oreilly.com/webops-perf/free/files/docker-security.pdf","docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}: CapAdd={{
.HostConfig.CapAdd }} CapDrop={{ .HostConfig.CapDrop }}'
Verify that the added and dropped Linux Kernel Capabilities are in line with the ones
needed for container process for each container instance.","Docker supports the addition and removal of capabilities, allowing the use of a non-default
profile. This may make Docker more secure through capability removal, or less secure
through the addition of capabilities. It is thus recommended to remove all capabilities
except those explicitly required for your container process.
For example, capabilities such as below are usually not needed for container process:
NET_ADMIN
SYS_ADMIN
SYS_MODULE","Based on what Linux Kernel Capabilities were added or dropped, restrictions within the
container would apply."
"5.4","CIS Docker Community Edition Benchmark","Docker","Ensure privileged containers are not used","Level 1","Scoring: Scored

Using the --privileged flag gives all Linux Kernel Capabilities to the container thus
overwriting the --cap-add and --cap-drop flags. Ensure that it is not used.

Default Value:
False.","","","Do not run container with the --privileged flag.
For example, do not start a container as below:
docker run --interactive --tty --privileged centos /bin/bash","","true","1. https://docs.docker.com/engine/reference/run/#runtime-privilege-and-linux-
capabilities","docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:
Privileged={{ .HostConfig.Privileged }}'
The above command should return Privileged=false for each container instance.","The --privileged flag gives all capabilities to the container, and it also lifts all the
limitations enforced by the device cgroup controller. In other words, the container can then
do almost everything that the host can do. This flag exists to allow special use-cases, like
running Docker within Docker.","Linux Kernel Capabilities other than defaults would not be available for use within
container."
"5.5","CIS Docker Community Edition Benchmark","Docker","Ensure sensitive host system directories are not mounted on containers","Level 1","Scoring: Scored

Sensitive host system directories such as below should not be allowed to be mounted as
container volumes especially in read-write mode.
/
/boot
/dev
/etc
/lib
/proc
/sys
/usr

Default Value:
Docker defaults to a read-write volume but you can also mount a directory read-only. By
default, no sensitive host directories are mounted on containers.","","","Do not mount host sensitive directories on containers especially in read-write mode.","","true","1. https://docs.docker.com/engine/tutorials/dockervolumes/","docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:
Volumes={{ .Mounts }}'
The above commands would return the list of current mapped directories and whether
they are mounted in read-write mode for each container instance.","If sensitive directories are mounted in read-write mode, it would be possible to make
changes to files within those sensitive directories. The changes might bring down security
implications or unwarranted changes that could put the Docker host in compromised state.","None."
"5.6","CIS Docker Community Edition Benchmark","Docker","Ensure ssh is not run within containers","Level 1","Scoring: Scored

SSH server should not be running within the container. You should SSH into the Docker
host, and use nsenter tool to enter a container from a remote host.

Default Value:
By default, SSH server is not running inside the container. Only one process per container is
allowed.","","","Uninstall SSH server from the container and use nsenteror any other commands such as
docker exec or docker attach to interact with the container instance.
docker exec --interactive --tty $INSTANCE_ID sh
OR
docker attach $INSTANCE_ID","","true","1. http://blog.docker.com/2014/06/why-you-dont-need-to-run-sshd-in-docker/","Step 1: List all the running instances of containers by executing below command:
docker ps --quiet
Step 2: For each container instance, execute the below command:
docker exec $INSTANCE_ID ps -el
Ensure that there is no process for SSH server.","Running SSH within the container increases the complexity of security management by
making it
 Difficult to manage access policies and security compliance for SSH server
 Difficult to manage keys and passwords across various containers
 Difficult to manage security upgrades for SSH server
It is possible to have shell access to a container without using SSH, the needlessly
increasing the complexity of security management should be avoided.","None."
"5.7","CIS Docker Community Edition Benchmark","Docker","Ensure privileged ports are not mapped within containers","Level 1","Scoring: Scored

The TCP/IP port numbers below 1024are considered privileged ports. Normal users and
processes are not allowed to use them for various security reasons. Docker allows a
container port to be mapped to a privileged port.

Default Value:
By default, mapping a container port to a privileged port on the host is allowed.
Note: There might be certain cases where you want to map privileged ports, because if you
forbid it, then the corresponding application has to run outside of a container.
For example: HTTP and HTTPS load balancers have to bind 80/tcp and 443/tcp
respectively. Forbidding to map privileged ports effectively forbids from running those in a
container, and mandates using an external load balancer. In such cases, those containers
instances should be marked as exceptions for this recommendation.","","","Do not map the container ports to privileged host ports when starting a container. Also,
ensure that there is no such container to host privileged port mapping declarations in the
Dockerfile.","","true","1. https://docs.docker.com/engine/userguide/networking/","List all running containers instances and their port mapping by executing the below
command:
docker ps --quiet | xargs docker inspect --format '{{ .Id }}: Ports={{
.NetworkSettings.Ports }}'
Review the list and ensure that container ports are not mapped to host port numbers
below 1024.","By default, if the user does not specifically declare the container port to host port mapping,
Docker automatically and correctly maps the container port to one available in 49153-
65535 block on the host. But, Docker allows a container port to be mapped to a privileged
port on the host if the user explicitly declared it. This is so because containers are executed
with NET_BIND_SERVICE Linux kernel capability that does not restrict the privileged port
mapping. The privileged ports receive and transmit various sensitive and privileged data.
Allowing containers to use them can bring serious implications.","None."
"5.8","CIS Docker Community Edition Benchmark","Docker","Ensure only needed ports are open on the container","Level 1","Scoring: Scored

Dockerfile for a container image defines the ports to be opened by default on a container
instance. The list of ports may or may not be relevant to the application you are running
within the container.

Default Value:
By default, all the ports that are listed in the Dockerfile under EXPOSE instruction for an
image are opened when a container is run with -P or --publish-all flag.","","","Fix the Dockerfile of the container image to expose only needed ports by your
containerized application. You can also completely ignore the list of ports defined in the
Dockerfile by NOT using -P (UPPERCASE) or --publish-all flag when starting the
container. Use the -p (lowercase) or --publish flag to explicitly define the ports that you
need for a particular container instance.
For example,
docker run --interactive --tty --publish 5000 --publish 5001 --publish 5002
centos /bin/bash","","true","1. https://docs.docker.com/engine/userguide/networking/","List all the running instances of containers and their port mapping by executing the below
command:
docker ps --quiet | xargs docker inspect --format '{{ .Id }}: Ports={{
.NetworkSettings.Ports }}'
Review the list and ensure that the ports mapped are the ones that are really needed for
the container.","A container can be run just with the ports defined in the Dockerfile for its image or can be
arbitrarily passed run time parameters to open a list of ports. Additionally, Overtime,
Dockerfile may undergo various changes and the list of exposed ports may or may not be
relevant to the application you are running within the container. Opening unneeded ports
increase the attack surface of the container and the containerized application. As a
recommended practice, do not open unneeded ports.","None."
"5.9","CIS Docker Community Edition Benchmark","Docker","Ensure the host's network namespace is not shared","Level 1","Scoring: Scored

The networking mode on a container when set to --net=host, skips placing the container
inside separate network stack. In essence, this choice tells Docker to not containerize the
container's networking. This would network-wise mean that the container lives ""outside""
in the main Docker host and has full access to its network interfaces.

Default Value:
By default, container connects to Docker bridge.","","","Do not pass --net=host option when starting the container.","","true","1. https://docs.docker.com/engine/userguide/networking/
2. https://docs.docker.com/engine/reference/run/#network-settings","docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:
NetworkMode={{ .HostConfig.NetworkMode }}'
If the above command returns NetworkMode=host, it means that --net=host option was
passed when container was started. This would be non-compliant.","This is potentially dangerous. It allows the container process to open low-numbered ports
like any other root process. It also allows the container to access network services like D-
bus on the Docker host. Thus, a container process can potentially do unexpected things
such as shutting down the Docker host. You should not use this option.","None."
"5.10","CIS Docker Community Edition Benchmark","Docker","Ensure memory usage for container is limited","Level 1","Scoring: Scored

By default, all containers on a Docker host share the resources equally. By using the
resource management capabilities of Docker host, such as memory limit, you can control
the amount of memory that a container may consume.

Default Value:
By default, all containers on a Docker host share the resources equally. No memory limits
are enforced.","","","Run the container with only as much memory as required. Always run the container using
the --memory argument.
For example, you could run a container as below:
docker run --interactive --tty --memory 256m centos /bin/bash
In the above example, the container is started with a memory limit of 256 MB.
Note: Please note that the output of the below command would return values in scientific
notation if memory limits are in place.
docker inspect --format='{{.Config.Memory}}' 7c5a2d4c7fe0
For example, if the memory limit is set to 256 MB for the above container instance, the
output of the above command would be 2.68435456e+08 and NOT 256m. You should
convert this value using a scientific calculator or programmatic methods.","","true","1. https://goldmann.pl/blog/2014/09/11/resource-management-in-docker/
2. https://docs.docker.com/engine/reference/commandline/run/#options
3. https://docs.docker.com/engine/admin/runmetrics/","docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}: Memory={{
.HostConfig.Memory }}'
If the above command returns 0, it means the memory limits are not in place. If the above
command returns a non-zero value, it means memory limits are in place.","By default, container can use all of the memory on the host. You can use memory limit
mechanism to prevent a denial of service arising from one container consuming all of the
host’s resources such that other containers on the same host cannot perform their intended
functions. Having no limit on memory can lead to issues where one container can easily
make the whole system unstable and as a result unusable.","If you do not set proper limits, the container process may have to starve."
"5.11","CIS Docker Community Edition Benchmark","Docker","Ensure CPU priority is set appropriately on the container","Level 1","Scoring: Scored

By default, all containers on a Docker host share the resources equally. By using the
resource management capabilities of Docker host, such as CPU shares, you can control the
host CPU resources that a container may consume.

Default Value:
By default, all containers on a Docker host share the resources equally. No CPU shares are
enforced.","","","Manage the CPU shares between your containers. To do so start the container using the --
cpu-shares argument.
For example, you could run a container as below:
docker run --interactive --tty --cpu-shares 512 centos /bin/bash
In the above example, the container is started with CPU shares of 50% of what the other
containers use. So, if the other container has CPU shares of 80%, this container will have
CPU shares of 40%.
Note: Every new container will have 1024 shares of CPU by default. However, this value is
shown as 0 if you run the command mentioned in the audit section.
Alternatively,
1. Navigate to /sys/fs/cgroup/cpu/system.slice/ directory.
2. Check your container instance ID using docker ps.
3. Now, inside the above directory (in step 1), you would have a directory by name
docker-<Instance ID>.scope. For example, docker-
4acae729e8659c6be696ee35b2237cc1fe4edd2672e9186434c5116e1a6fbed6.scope.
Navigate to this directory.
4. You will find a file named cpu.shares. Execute cat cpu.shares. This will always
give you the CPU share value based on the system. So, even if there is no CPU shares
configured using -c or --cpu-shares argument in the docker run command, this
file will have a value of 1024.
If we set one container’s CPU shares to 512 it will receive half of the CPU time compared to
the other container. So, take 1024 as 100% and then do quick math to derive the number
that you should set for respective CPU shares. For example, use 512 if you want to set 50%
and 256 if you want to set 25%.","","true","1. https://goldmann.pl/blog/2014/09/11/resource-management-in-docker/
2. https://docs.docker.com/engine/reference/commandline/run/#options
3. https://docs.docker.com/engine/admin/runmetrics/","docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:
CpuShares={{ .HostConfig.CpuShares }}'
If the above command returns 0 or 1024, it means the CPU shares are not in place. If the
above command returns a non-zero value other than 1024, it means CPU shares are in
place.","By default, CPU time is divided between containers equally. If it is desired, to control the
CPU time amongst the container instances, you can use CPU sharing feature. CPU sharing
allows to prioritize one container over the other and forbids the lower priority container to
claim CPU resources more often. This ensures that the high priority containers are served
better.","If you do not set proper CPU shares, the container process may have to starve if the
resources on the host are not available. If the CPU resources on the host are free, CPU
shares do not place any restrictions on the CPU that the container may use."
"5.12","CIS Docker Community Edition Benchmark","Docker","Ensure the container's root filesystem is mounted as read only","Level 1","Scoring: Scored

The container's root filesystem should be treated as a 'golden image' by using Docker run's
--read-only option. This prevents any writes to the container's root filesystem at
container runtime and enforces the principle of immutable infrastructure.

Default Value:
By default, a container will have its root filesystem writable allowing all container
processes to write files owned by the container's runtime user.","","","Add a --read-only flag at a container's runtime to enforce the container's root filesystem
to be mounted as read only.
docker run <Run arguments> --read-only <Container Image Name or ID> <Command>
Enabling the --read-only option at a container's runtime should be used by administrators
to force a container's executable processes to only write container data to explicit storage
locations during the container's runtime.
Examples of explicit storage locations during a container's runtime include, but not limited
to:
1. Use the --tmpfs option to mount a temporary file system for non-persistent data
writes.
docker run --interactive --tty --read-only --tmpfs ""/run"" --tmpfs ""/tmp""
centos /bin/bash
2. Enabling Docker rw mounts at a container's runtime to persist container data
directly on the Docker host filesystem.
docker run --interactive --tty --read-only -v /opt/app/data:/run/app/data:rw
centos /bin/bash
3. Utilizing Docker shared-storage volume plugins for Docker data volume to persist
container data.
docker volume create -d convoy --opt o=size=20GB my-named-volume
docker run --interactive --tty --read-only -v my-named-volume:/run/app/data
centos /bin/bash
3. Transmitting container data outside of the docker during the container's runtime
for container data to persist container data. Examples include hosted databases,
network file shares, and APIs.","","true","1. http://docs.docker.com/reference/commandline/cli/#run
2. https://docs.docker.com/engine/tutorials/dockervolumes/
3. http://www.projectatomic.io/blog/2015/12/making-docker-images-write-only-in-
production/
4. https://docs.docker.com/engine/reference/commandline/run/#mount-tmpfs-
tmpfs
5. https://docs.docker.com/engine/tutorials/dockervolumes/#creating-and-
mounting-a-data-volume-container","Run the following command on the docker host:
docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:
ReadonlyRootfs={{ .HostConfig.ReadonlyRootfs }}'
If the above command returns true, it means the container's root filesystem is mounted
read-only.
If the above command returns false, it means the container's root filesystem is writable.","Enabling this option forces containers at runtime to explicitly define their data writing
strategy to persist or not persist their data.
This also reduces security attack vectors since the container instance's filesystem cannot
be tampered with or written to unless it has explicit read-write permissions on its
filesystem folder and directories.","Enabling --read-only at container runtime may break some container OS packages if a
data writing strategy is not defined.
Define what the container's data should and should not persist at runtime to determine
which recommendation procedure to utilize.
Example:
 Enable use --tmpfs for temporary file writes to /tmp
 Use Docker shared data volumes for persistent data writes"
"5.13","CIS Docker Community Edition Benchmark","Docker","Ensure incoming container traffic is binded to a specific host interface","Level 1","Scoring: Scored

By default, Docker containers can make connections to the outside world, but the outside
world cannot connect to containers. Each outgoing connection will appear to originate
from one of the host machine's own IP addresses. Only allow container services to be
contacted through a specific external interface on the host machine.

Default Value:
By default, Docker exposes the container ports on 0.0.0.0, the wildcard IP address that
will match any possible incoming network interface on the host machine.","","","Bind the container port to a specific host interface on the desired host port.
For example,
docker run --detach --publish 10.2.3.4:49153:80 nginx
In the example above, the container port 80 is bound to the host port on 49153 and would
accept incoming connection only from 10.2.3.4 external interface.","","true","1. https://docs.docker.com/engine/userguide/networking/","List all the running instances of containers and their port mapping by executing the below
command:
docker ps --quiet | xargs docker inspect --format '{{ .Id }}: Ports={{
.NetworkSettings.Ports }}'
Review the list and ensure that the exposed container ports are tied to a particular
interface and not to the wildcard IP address - 0.0.0.0.
For example, if the above command returns as below, then this is non-compliant and the
container can accept connections on any host interface on the specified port 49153.
Ports=map[443/tcp:<nil> 80/tcp:[map[HostPort:49153 HostIp:0.0.0.0]]]
However, if the exposed port is tied to a particular interface on the host as below, then this
recommendation is configured as desired and is compliant.
Ports=map[443/tcp:<nil> 80/tcp:[map[HostIp:10.2.3.4 HostPort:49153]]]","If you have multiple network interfaces on your host machine, the container can accept
connections on the exposed ports on any network interface. This might not be desired and
may not be secured. Many a times a particular interface is exposed externally and services
such as intrusion detection, intrusion prevention, firewall, load balancing, etc. are run on
those interfaces to screen incoming public traffic. Hence, you should not accept incoming
connections on any interface. You should only allow incoming connections from a
particular external interface.","None."
"5.14","CIS Docker Community Edition Benchmark","Docker","Ensure 'on-failure' container restart policy is set to '5'","Level 1","Scoring: Scored

Using the --restart flag in docker run command you can specify a restart policy for how a
container should or should not be restarted on exit. You should choose the on-failure
restart policy and limit the restart attempts to 5.

Default Value:
By default, containers are not configured with restart policies. Hence, containers do not
attempt to restart of their own.","","","If a container is desired to be restarted of its own, then, for example, you could start the
container as below:
docker run --detach --restart=on-failure:5 nginx","","true","1. https://docs.docker.com/engine/reference/commandline/run/#restart-policies-
restart","docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:
RestartPolicyName={{ .HostConfig.RestartPolicy.Name }} MaximumRetryCount={{
.HostConfig.RestartPolicy.MaximumRetryCount }}'
 If the above command returns RestartPolicyName=always, then the system is not
configured as desired and hence this recommendation is non-compliant.
 If the above command returns RestartPolicyName=no or just RestartPolicyName=,
then the restart policies are not being used and the container would never be
restarted of its own. This recommendation is then Not Applicable and can be
assumed to be compliant.
 If the above command returns RestartPolicyName=on-failure, then verify that the
number of restart attempts is set to 5 or less by looking at MaximumRetryCount.","If you indefinitely keep trying to start the container, it could possibly lead to a denial of
service on the host. It could be an easy way to do a distributed denial of service attack
especially if you have many containers on the same host. Additionally, ignoring the exit
status of the container and always attempting to restart the container leads to non-
investigation of the root cause behind containers getting terminated. If a container gets
terminated, you should investigate on the reason behind it instead of just attempting to
restart it indefinitely. Thus, it is recommended to use on-failure restart policy and limit it
to maximum of 5 restart attempts.","The container would attempt to restart only for 5 times."
"5.15","CIS Docker Community Edition Benchmark","Docker","Ensure the host's process namespace is not shared","Level 1","Scoring: Scored

Process ID (PID) namespaces isolate the process ID number space, meaning that processes
in different PID namespaces can have the same PID. This is process level isolation between
containers and the host.

Default Value:
By default, all containers have the PID namespace enabled and the host's process
namespace is not shared with the containers.","","","Do not start a container with --pid=host argument.
For example, do not start a container as below:
docker run --interactive --tty --pid=host centos /bin/bash","","true","1. https://docs.docker.com/engine/reference/run/#pid-settings-pid
2. http://man7.org/linux/man-pages/man7/pid_namespaces.7.html","docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:
PidMode={{ .HostConfig.PidMode }}'
If the above command returns host, it means the host PID namespace is shared with the
container else this recommendation is compliant.","PID namespace provides separation of processes. The PID Namespace removes the view of
the system processes, and allows process ids to be reused including PID 1. If the host's PID
namespace is shared with the container, it would basically allow processes within the
container to see all of the processes on the host system. This breaks the benefit of process
level isolation between the host and the containers. Someone having access to the
container can eventually know all the processes running on the host system and can even
kill the host system processes from within the container. This can be catastrophic. Hence,
do not share the host's process namespace with the containers.","Container processes cannot see the processes on the host system. In certain cases, you
want your container to share the host's process namespace. For example, you could build a
container with debugging tools like strace or gdb, but want to use these tools when
debugging processes within the container. If this is desired, then share only one (or
needed) host process by using the -p switch.
For example,
docker run --pid=host rhel7 strace -p 1234"
"5.16","CIS Docker Community Edition Benchmark","Docker","Ensure the host's IPC namespace is not shared","Level 1","Scoring: Scored

IPC (POSIX/SysV IPC) namespace provides separation of named shared memory segments,
semaphores and message queues. IPC namespace on the host thus should not be shared
with the containers and should remain isolated.

Default Value:
By default, all containers have the IPC namespace enabled and host IPC namespace is not
shared with any container.","","","Do not start a container with --ipc=host argument. For example, do not start a container
as below:
docker run --interactive --tty --ipc=host centos /bin/bash","","true","1. https://docs.docker.com/engine/reference/run/#ipc-settings-ipc
2. http://man7.org/linux/man-pages/man7/namespaces.7.html","docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:
IpcMode={{ .HostConfig.IpcMode }}'
If the above command returns host, it means the host IPC namespace is shared with the
container. If the above command returns nothing, then the host's IPC namespace is not
shared. This recommendation is then compliant.","IPC namespace provides separation of IPC between the host and containers. If the host's
IPC namespace is shared with the container, it would basically allow processes within the
container to see all of the IPC on the host system. This breaks the benefit of IPC level
isolation between the host and the containers. Someone having access to the container can
eventually manipulate the host IPC. This can be catastrophic. Hence, do not share the host's
IPC namespace with the containers.","Shared memory segments are used to accelerate inter-process communication. It is
commonly used by high-performance applications. If such applications are containerized
into multiple containers, you might need to share the IPC namespace of the containers to
achieve high performance. In such cases, you should still be sharing container specific IPC
namespaces only and not the host IPC namespace. You may share the container's IPC
namespace with another container as below:
For example,
docker run --interactive --tty --ipc=container:e3a7a1a97c58 centos /bin/bash"
"5.18","CIS Docker Community Edition Benchmark","Docker","Ensure the default ulimit is overwritten at runtime, only if needed","Level 1","Scoring: Not Scored

The default ulimit is set at the Docker daemon level. However, you may override the default
ulimit setting, if needed, during container runtime.

Default Value:
Container instances inherit the default ulimit settings set at the Docker daemon level.","","","Only override the default ulimit settings if needed.
For example, to override default ulimit settings start a container as below:
docker run --ulimit nofile=1024:1024 --interactive --tty centos /bin/bash","","true","1. https://docs.docker.com/engine/reference/commandline/run/#set-ulimits-in-
container-ulimit
2. http://www.oreilly.com/webops-perf/free/files/docker-security.pdf","docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:
Ulimits={{ .HostConfig.Ulimits }}'
The above command should return Ulimits=<no value> for each container instance until
and unless there is an exception and a need to override the default ulimit settings.","ulimit provides control over the resources available to the shell and to processes started
by it. Setting system resource limits judiciously saves you from many disasters such as a
fork bomb. Sometimes, even friendly users and legitimate processes can overuse system
resources and in-turn can make the system unusable.
The default ulimit set at the Docker daemon level should be honored. If the default ulimit
settings are not appropriate for a particular container instance, you may override them as
an exception. But, do not make this a practice. If most of the container instances are
overriding default ulimit settings, consider changing the default ulimit settings to
something that is appropriate for your needs.","If the ulimits are not set properly, the desired resource control might not be achieved and
might even make the system unusable."
"5.19","CIS Docker Community Edition Benchmark","Docker","Ensure mount propagation mode is not set to shared","Level 1","Scoring: Scored

Mount propagation mode allows mounting volumes in shared, slave or private mode on a
container. Do not use shared mount propagation mode until needed.

Default Value:
By default, the container mounts are private.","","","Do not mount volumes in shared mode propagation.
For example, do not start container as below:
docker run <Run arguments> --volume=/hostPath:/containerPath:shared
<Container Image Name or ID> <Command>","","true","1. https://github.com/docker/docker/pull/17034
2. https://docs.docker.com/engine/reference/run/#volume-shared-filesystems
3. https://www.kernel.org/doc/Documentation/filesystems/sharedsubtree.txt","docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:
Propagation={{range $mnt := .Mounts}} {{json $mnt.Propagation}} {{end}}'
The above command would return the propagation mode for mounted volumes.
Propagation mode should not be set to shared unless needed. The above command might
throw errors if there are no mounts. In that case, this recommendation is not applicable.","A shared mount is replicated at all mounts and the changes made at any mount point are
propagated to all mounts. Mounting a volume in shared mode does not restrict any other
container to mount and make changes to that volume. This might be catastrophic if the
mounted volume is sensitive to changes. Do not set mount propagation mode to shared
until needed.","None."
"5.20","CIS Docker Community Edition Benchmark","Docker","Ensure the host's UTS namespace is not shared","Level 1","Scoring: Scored

UTS namespaces provide isolation of two system identifiers: the hostname and the NIS
domain name. It is used for setting the hostname and the domain that is visible to running
processes in that namespace. Processes running within containers do not typically require
to know hostname and domain name. Hence, the namespace should not be shared with the
host.

Default Value:
By default, all containers have the UTS namespace enabled and host UTS namespace is not
shared with any container.","","","Do not start a container with --uts=host argument.
For example, do not start a container as below:
docker run --rm --interactive --tty --uts=host rhel7.2","","true","1. https://docs.docker.com/engine/reference/run/#uts-settings-uts
2. http://man7.org/linux/man-pages/man7/namespaces.7.html","docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:
UTSMode={{ .HostConfig.UTSMode }}'
If the above command returns host, it means the host UTS namespace is shared with the
container and this recommendation is non-compliant. If the above command returns
nothing, then the host's UTS namespace is not shared. This recommendation is then
compliant.","Sharing the UTS namespace with the host provides full permission to the container to
change the hostname of the host. This is insecure and should not be allowed.","None."
"5.21","CIS Docker Community Edition Benchmark","Docker","Ensure the default seccomp profile is not Disabled","Level 1","Scoring: Scored

Seccomp filtering provides a means for a process to specify a filter for incoming system
calls. The default Docker seccomp profile works on whitelist basis and allows 311 system
calls blocking all others. It should not be disabled unless it hinders your container
application usage.

Default Value:
When you run a container, it uses the default profile unless you override it with the --
security-opt option.","","","By default, seccomp profiles are enabled. You do not need to do anything unless you want
to modify and use the modified seccomp profile.","","true","1. http://blog.scalock.com/new-docker-security-features-and-what-they-mean-
seccomp-profiles
2. https://docs.docker.com/engine/reference/run/#security-configuration
3. https://github.com/docker/docker/blob/master/profiles/seccomp/default.json
4. https://docs.docker.com/engine/security/seccomp/
5. https://www.kernel.org/doc/Documentation/prctl/seccomp_filter.txt
6. https://github.com/docker/docker/issues/22870","docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:
SecurityOpt={{ .HostConfig.SecurityOpt }}'
The above command should return <no value> or your modified seccomp profile. If it
returns [seccomp:unconfined], that means this recommendation is non-compliant and the
container is running without any seccomp profiles.","A large number of system calls are exposed to every userland process with many of them
going unused for the entire lifetime of the process. Most of the applications do not need all
the system calls and thus benefit by having a reduced set of available system calls. The
reduced set of system calls reduces the total kernel surface exposed to the application and
thus improvises application security.","With Docker 1.10 and greater, the default seccomp profile blocks syscalls, regardless of --
cap-add passed to the container. You should create your own custom seccomp profile in
such cases. You may also disable the default seccomp profile by passing --security-
opt=seccomp:unconfined on docker run."
"5.22","CIS Docker Community Edition Benchmark","Docker","Ensure docker exec commands are not used with privileged option","Level 2","Scoring: Scored

Do not docker exec with --privileged option.

Default Value:
By default, docker exec command runs without --privileged option.","","","Do not use --privileged option in docker exec command.","","true","1. https://docs.docker.com/engine/reference/commandline/exec/","If you have auditing enabled as prescribed in Section 1, you can use the below command to
filter out docker exec commands that used --privileged option.
ausearch -k docker | grep exec | grep privileged","Using --privileged option in docker exec gives extended Linux capabilities to the
command. This could potentially be insecure and unsafe to do especially when you are
running containers with dropped capabilities or with enhanced restrictions.","None. If you need enhanced capabilities within the container, then run the container with
the needed capabilities."
"5.23","CIS Docker Community Edition Benchmark","Docker","Ensure docker exec commands are not used with user option","Level 2","Scoring: Scored

Do not docker exec with --user option.

Default Value:
By default, docker exec command runs without --user option.","","","Do not use --user option in docker exec command.","","true","1. https://docs.docker.com/engine/reference/commandline/exec/","If you have auditing enabled as prescribed in Section 1, you can use the below command to
filter out docker exec commands that used --user option.
ausearch -k docker | grep exec | grep user","Using --user option in docker exec executes the command within the container as that
user. This could potentially be insecure and unsafe to do especially when you are running
containers with dropped capabilities or with enhanced restrictions.
For example, suppose your container is running as tomcat user (or any other non-root
user), it would be possible to run a command through docker exec as rootwith --
user=root option. This could potentially be dangerous.","None."
"5.24","CIS Docker Community Edition Benchmark","Docker","Ensure cgroup usage is confirmed","Level 1","Scoring: Scored

It is possible to attach to a particular cgroup on container run. Confirming cgroup usage
would ensure that containers are running under defined cgroups.

Default Value:
By default, containers run under docker cgroup.","","","Do not use --cgroup-parent option in docker run command unless needed.","","true","1. https://docs.docker.com/engine/reference/run/#specify-custom-cgroups
2. https://access.redhat.com/documentation/en-
US/Red_Hat_Enterprise_Linux/6/html/Resource_Management_Guide/ch01.html","docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:
CgroupParent={{ .HostConfig.CgroupParent }}'
The above command would return the cgroup under which the containers are running. If it
is blank, it means containers are running under default docker cgroup. In that case, this
recommendation is compliant. If the containers are found to be running under cgroup
other than the one that was expected, this recommendation is non-compliant.","System administrators typically define cgroups under which containers are supposed to
run. Even if cgroups are not explicitly defined by the system administrators, containers run
under docker cgroup by default.
At run-time, it is possible to attach to a different cgroup other than the one that was
expected to be used. This usage should be monitored and confirmed. By attaching to a
different cgroup than the one that is expected, excess permissions and resources might be
granted to the container and thus, can prove to be unsafe.","None."
"5.25","CIS Docker Community Edition Benchmark","Docker","Ensure the container is restricted from acquiring additional privileges","Level 1","Scoring: Scored

Restrict the container from acquiring additional privileges via suid or sgid bits.

Default Value:
By default, new privileges are not restricted.","","","For example, you should start your container as below:
docker run --rm -it --security-opt=no-new-privileges ubuntu bash","","true","1. https://github.com/projectatomic/atomic-site/issues/269
2. https://github.com/docker/docker/pull/20727
3. https://www.kernel.org/doc/Documentation/prctl/no_new_privs.txt
4. https://lwn.net/Articles/475678/
5. https://lwn.net/Articles/475362/","docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:
SecurityOpt={{ .HostConfig.SecurityOpt }}'
The above command should return all the security options currently configured for the
containers. no-new-privileges should also be one of them.","A process can set the no_new_priv bit in the kernel. It persists across fork, clone and
execve. The no_new_priv bit ensures that the process or its children processes do not gain
any additional privileges via suid or sgid bits. This way a lot of dangerous operations
become a lot less dangerous because there is no possibility of subverting privileged
binaries.","no_new_priv prevents LSMs like SELinux from transitioning to process labels that have
access not allowed to the current process."
"5.26","CIS Docker Community Edition Benchmark","Docker","Ensure container health is checked at runtime","Level 1","Scoring: Scored

If the container image does not have an HEALTHCHECK instruction defined, use --health-cmd
parameter at container runtime for checking container health.

Default Value:
By default, health checks are not done at container runtime.","","","Run the container using --health-cmd and the other parameters.
For example,
docker run -d --health-cmd='stat /etc/passwd || exit 1' nginx","","true","1. https://docs.docker.com/engine/reference/run/#healthcheck","Run the below command and ensure that all the containers are reporting health status:
docker ps --quiet | xargs docker inspect --format '{{ .Id }}: Health={{
.State.Health.Status }}'","One of the important security triads is availability. If the container image you are using
does not have a pre-defined HEALTHCHECK instruction, use the --health-cmd parameter to
check container health at runtime.
Based on the reported health status, you could take necessary actions.","None."
"5.27","CIS Docker Community Edition Benchmark","Docker","Ensure docker commands always get the latest version of the image","Level 1","Scoring: Not Scored

Always ensure that you are using the latest version of the image within your repository and
not the cached older versions.

Default Value:
By default, docker commands extract the local copy unless version pinning mechanisms are
used or the local cache is cleared.","","","Use proper version pinning mechanisms (the latest tag which is assigned by default is still
vulnerable to caching attacks) to avoid extracting the cached older versions. Version
pinning mechanisms should be used for base images, packages, and entire images too. You
can customize version pinning rules as per your requirements.","","true","1. https://github.com/docker/docker/pull/16609","Step 1: Open your image repository and list the image version history for the image you
are inspecting.
Step 2: Observe the status when the docker pull command is triggered.
If the status is shown as Image is up to date, it means that you are getting the cached
version of the image.
Step 3: Match the version of the image you are running with the latest version reported in
your repository which tells if you are running the cached version or the latest copy.","Multiple docker commands such as docker pull, docker run, etc. are known to have an
issue that by default, they extract the local copy of the image, if present, even though there
is an updated version of the image with the ""same tag"" in the upstream repository. This
could lead to using older and vulnerable images.","None"
"5.28","CIS Docker Community Edition Benchmark","Docker","Ensure PIDs cgroup limit is used","Level 1","Scoring: Scored

Use --pids-limit flag at container runtime.

Default Value:
The Default value for --pids-limit is 0 which means there is no restriction on the number
of forks. Also, note that PIDs cgroup limit works only for the kernel versions 4.3+.","","","Use --pids-limit flag while launching the container with an appropriate value.
For example,
docker run -it --pids-limit 100 <Image_ID>
In the above example, the number of processes allowed to run at any given time is set to
100. After a limit of 100 concurrently running processes is reached, docker would restrict
any new process creation.","","true","1. https://github.com/docker/docker/pull/18697
2. https://docs.docker.com/engine/reference/commandline/run/#options","Run the below command and ensure that PidsLimit is not set to 0 or -1. A PidsLimit of 0
or -1 means that any number of processes can be forked inside the container concurrently.
docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:
PidsLimit={{ .HostConfig.PidsLimit }}'","Attackers could launch a fork bomb with a single command inside the container. This fork
bomb can crash the entire system and requires a restart of the host to make the system
functional again. PIDs cgroup --pids-limit will prevent this kind of attacks by restricting
the number of forks that can happen inside a container at a given time.","Set the PIDs limit value as appropriate. Incorrect values might leave the containers
unusable."
"5.29","CIS Docker Community Edition Benchmark","Docker","Ensure Docker's default bridge docker0 is not used","Level 2","Scoring: Not Scored

Do not use Docker's default bridge docker0. Use docker's user-defined networks for
container networking.

Default Value:
By default, docker runs containers on its docker0 bridge.","","","Follow Docker documentation and setup a user-defined network. Run all the containers in
the defined network.","","true","1. https://github.com/nyantec/narwhal
2. https://arxiv.org/pdf/1501.02967
3. https://docs.docker.com/engine/userguide/networking/","Run the below command, and verify that containers are on a user-defined network and not
the default docker0 bridge.
docker network ls --quiet | xargs xargs docker network inspect --format '{{
.Name }}: {{ .Options }}'","Docker connects virtual interfaces created in the bridge mode to a common bridge called
docker0. This default networking model is vulnerable to ARP spoofing and MAC flooding
attacks since there is no filtering applied.","You have to manage the user-defined networks."
"5.30","CIS Docker Community Edition Benchmark","Docker","Ensure the host's user namespaces is not shared","Level 1","Scoring: Scored

Do not share the host's user namespaces with the containers.

Default Value:
By default, the host user namespace is shared with the containers until user namespace
support is enabled.","","","Do not share user namespaces between host and containers.
For example, do not run a container as below:
docker run --rm -it --userns=host ubuntu bash","","true","1. https://docs.docker.com/engine/security/userns-remap/
2. https://docs.docker.com/engine/reference/commandline/run/#options
3. https://github.com/docker/docker/pull/12648
4. https://events.linuxfoundation.org/sites/events/files/slides/User%20Namespaces
%20-%20ContainerCon%202015%20-%2016-9-final_0.pdf","Run the below command and ensure that it does not return any value for UsernsMode. If it
returns a value of host, it means the host user namespace is shared with the containers.
docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:
UsernsMode={{ .HostConfig.UsernsMode }}'","User namespaces ensure that a root process inside the container will be mapped to a non-
root process outside the container. Sharing the user namespaces of the host with the
container thus does not isolate users on the host with users on the containers.","None"
"5.31","CIS Docker Community Edition Benchmark","Docker","Ensure the Docker socket is not mounted inside any containers","Level 1","Scoring: Scored

The docker socket docker.sock should not be mounted inside a container.

Default Value:
By default, docker.sock is not mounted inside containers.","","","Ensure that no containers mount docker.sock as a volume.","","true","1. https://raesene.github.io/blog/2016/03/06/The-Dangers-Of-Docker.sock/
2. https://forums.docker.com/t/docker-in-docker-vs-mounting-var-run-docker-
sock/9450/2
3. https://github.com/docker/docker/issues/21109","docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:
Volumes={{ .Mounts }}' | grep docker.sock
The above command would return any instances where docker.sock had been mapped to
a container as a volume.","If the docker socket is mounted inside a container it would allow processes running within
the container to execute docker commands which effectively allows for full control of the
host.","None"
"6.1","CIS Docker Community Edition Benchmark","Docker","Ensure image sprawl is avoided","Level 1","Scoring: Not Scored

Do not keep a large number of container images on the same host. Use only tagged images
as appropriate.

Default Value:
Images and layered filesystems remain accessible on the host until the administrator
removes all tags that refer to those images or layers.","","","Keep the set of the images that you actually need and establish a workflow to remove old or
stale images from the host. Additionally, use features such as pull-by-digest to get specific
images from the registry.
Additionally, you can follow below set of steps to find out unused images on the system and
delete them.
Step 1 Make a list of all image IDs that are currently instantiated by executing below
command:
docker images --quiet | xargs docker inspect --format '{{ .Id }}: Image={{
.Config.Image }}'
Step 2: List all the images present on the system by executing below command:
docker images
Step 3: Compare the list of image IDs populated from Step 1 and Step 2 and find out images
that are currently not being instantiated.
Step 4: Decide if you want to keep the images that are not currently in use. If not delete
them by executing below command:
docker rmi $IMAGE_ID","","true","1. http://craiccomputing.blogspot.in/2014/09/clean-up-unused-docker-containers-
and.html
2. https://forums.docker.com/t/command-to-remove-all-unused-images/20/8
3. https://github.com/docker/docker/issues/9054
4. https://docs.docker.com/engine/reference/commandline/rmi/
5. https://docs.docker.com/engine/reference/commandline/pull/
6. https://github.com/docker/docker/pull/11109","Step 1 Make a list of all image IDs that are currently instantiated by executing below
command:
docker images --quiet | xargs docker inspect --format '{{ .Id }}: Image={{
.Config.Image }}'
Step 2: List all the images present on the system by executing below command:
docker images
Step 3: Compare the list of image IDs populated from Step 1 and Step 2 and find out images
that are currently not being instantiated. If any such unused or old images are found,
discuss with the system administrator the need to keep such images on the system. If such
a need is not justified enough, then this recommendation is non-compliant.","Tagged images are useful to fall back from ""latest"" to a specific version of an image in
production. Images with unused or old tags may contain vulnerabilities that might be
exploited, if instantiated. Additionally, if you fail to remove unused images from the system
and there are various such redundant and unused images, the host filesystem may become
full and could lead to denial of service.","None"
"6.2","CIS Docker Community Edition Benchmark","Docker","Ensure container sprawl is avoided","Level 1","Scoring: Not Scored

Do not keep a large number of containers on the same host.

Default Value:
By default, Docker does not restrict the number of containers you may have on a host.","","","Periodically check your container inventory per host and clean up the stopped containers
using the below command:
docker container prune","","true","1. https://zeltser.com/security-risks-and-benefits-of-docker-application/
2. http://searchsdn.techtarget.com/feature/Docker-networking-How-Linux-
containers-will-change-your-network","Step 1 - Find the total number of containers you have on the host:
docker info --format '{{ .Containers }}'
Step 2 - Execute the below commands to find the total number of containers that are
actually running or in the stopped state on the host.
docker info --format '{{ .ContainersStopped }}'
docker info --format '{{ .ContainersRunning }}'
If the difference between the number of containers that are stopped on the host and the
number of containers that are actually running on the host is large (say 25 or more), then
perhaps, the containers are sprawled on the host.","The flexibility of containers makes it easy to run multiple instances of applications and
indirectly leads to Docker images that exist at varying security patch levels. It also means
that you are consuming host resources that otherwise could have been used for running
'useful' containers. Having more than just the manageable number of containers on a
particular host makes the situation vulnerable to mishandling, misconfiguration and
fragmentation. Thus, avoid container sprawl and keep the number of containers on a host
to a manageable total.","If you keep way too few number of containers per host, then perhaps you are not utilizing
your host resources very adequately."
"7.1","CIS Docker Community Edition Benchmark","Docker","Ensure swarm mode is not Enabled, if not needed","Level 1","Scoring: Scored

Do not enable swarm mode on a docker engine instance unless needed.

Default Value:
By default, docker swarm mode is not enabled.","","","If swarm mode has been enabled on a system in error, run
docker swarm leave","","true","1. https://docs.docker.com/engine/reference/commandline/swarm_init/","Review the output of the docker info command. If the output includes Swarm: active it
indicates that swarm mode has been activated on the Docker engine. Confirm if swarm
mode on the docker engine instance is actually needed.","By default, a Docker engine instance will not listen on any network ports, with all
communications with the client coming over the Unix socket. When Docker swarm mode is
enabled on a docker engine instance, multiple network ports are opened on the system and
made available to other systems on the network for the purposes of cluster management
and node communications.
Opening network ports on a system increase its attack surface and this should be avoided
unless required.","None."
"7.2","CIS Docker Community Edition Benchmark","Docker","Ensure the minimum number of manager nodes have been created in a swarm","Level 1","Scoring: Scored

Ensure that the minimum number of required manager nodes is created in a swarm.

Default Value:
A single manager is all that is required to start a given cluster.","","","If an excessive number of managers is configured, the excess can be demoted as worker
using the following command:
docker node demote <ID>
Where is the node ID value of the manager to be demoted.","","true","1. https://docs.docker.com/engine/swarm/manage-nodes/
2. https://docs.docker.com/engine/swarm/admin_guide/#/add-manager-nodes-for-
fault-tolerance","Run docker info and verify the number of managers.
docker info --format '{{ .Swarm.Managers }}'
Alternatively run the below command.
docker node ls | grep 'Leader'","Manager nodes within a swarm have control over the swarm and change its configuration
modifying security parameters. Having excessive manager nodes could render the swarm
more susceptible to compromise.
If fault tolerance is not required in the manager nodes, a single node should be elected as a
manger. If fault tolerance is required then the smallest practical odd number to achieve the
appropriate level of tolerance should be configured.","None"
"7.3","CIS Docker Community Edition Benchmark","Docker","Ensure swarm services are binded to a specific host interface","Level 1","Scoring: Scored

By default, the docker swarm services will listen to all interfaces on the host, which may
not be necessary for the operation of the swarm where the host has multiple network
interfaces.

Default Value:
By default, docker swarm services listen on all available host interfaces.","","","Remediation of this requires re-initialization of the swarm specifying a specific interface
for the --listen-addr parameter.","","true","1. https://docs.docker.com/engine/reference/commandline/swarm_init/#--listen-
addr
2. https://docs.docker.com/engine/swarm/admin_guide/#recover-from-disaster
Notes:
A couple of points I noted looking at this one. there doesn't seem to be a parameter for
docker swarm update to change the listen-addr. For the remediation I did wonder if --
force-new-swarm could be used to change this, but I'm not sure what other effects that
would have on the swarm so just left with a general requirement to re-initialize the swarm.
Also interestingly the node communication service running on 7946/TCP doesn't respect
the --listen-addr parameter. this seems like a bug to me, I'll likely file an issue on github for
it after a bit more exploration.","List the network listener on port 2377/TCP (the default for docker swarm) and confirm
that it is only listening on specific interfaces. For example, using ubuntu this could be done
with the following command:
netstat -lt | grep -i 2377","When a swarm is initialized the default value for the --listen-addr flag is 0.0.0.0:2377
which means that the swarm services will listen on all interfaces on the host. If a host has
multiple network interfaces this may be undesirable as it may expose the docker swarm
services to networks which are not involved in the operation of the swarm.
By passing a specific IP address to the --listen-addr, a specific network interface can be
specified limiting this exposure.","None"
"7.4","CIS Docker Community Edition Benchmark","Docker","Ensure data exchanged between containers are encrypted on different nodes on the overlay network","Level 1","Scoring: Scored

Encrypt data exchanged between containers on different nodes on the overlay network.

Default Value:
By default, data exchanged between containers on different nodes on the overlay network
are not encrypted in the Docker swarm mode.","","","Create overlay network with --opt encrypted flag.","","true","1. https://docs.docker.com/engine/userguide/networking/overlay-security-model/
2. https://github.com/docker/docker/issues/24253","Run the below command and ensure that each overlay network has been encrypted.
docker network ls --filter driver=overlay --quiet | xargs docker network
inspect --format '{{.Name}} {{ .Options }}'","By default, data exchanged between containers on different nodes on the overlay network
is not encrypted. This could potentially expose traffic between the container nodes.","None"
"7.5","CIS Docker Community Edition Benchmark","Docker","Ensure Docker's secret management commands are used for managing secrets in a Swarm cluster","Level 2","Scoring: Not Scored

Use Docker's in-built secret management command.

Default Value:
Not Applicable","","","Follow docker secret documentation and use it to manage secrets effectively.","","true","1. https://docs.docker.com/engine/reference/commandline/secret/","On a swarm manager node, run the below command and ensure docker secret
management is used in your environment, if applicable.
docker secret ls","Docker has various commands for managing secrets in a Swarm cluster. This is the
foundation for future secret support in Docker with potential improvements such as
Windows support, different backing stores, etc.","None"
"7.6","CIS Docker Community Edition Benchmark","Docker","Ensure swarm manager is run in auto-lock mode","Level 1","Scoring: Scored

Run Docker swarm manager in auto-lock mode.

Default Value:
By default, swarm manager does not run in auto-lock mode.","","","If you are initializing swarm, use the below command.
docker swarm init --autolock
If you want to set --autolock on an existing swarm manager node, use the below
command.
docker swarm update --autolock","","true","1. https://docs.docker.com/engine/swarm/swarm_manager_locking/","Run the below command. If it outputs the key, it means swarm was initialized with the --
autolock flag. If the output is no unlock key is set, it means that swarm was NOT
initialized with the --autolock flag and is non-compliant with respect to this
recommendation.
docker swarm unlock-key","When Docker restarts, both the TLS key used to encrypt communication among swarm
nodes, and the key used to encrypt and decrypt Raft logs on disk, are loaded into each
manager node's memory. You should protect the mutual TLS encryption key and the key
used to encrypt and decrypt Raft logs at rest. This protection could be enabled by
initializing swarm with --autolock flag.
With --autolockenabled, when Docker restarts, you must unlock the swarm first, using a
key encryption key generated by Docker when the swarm was initialized.","A swarm in auto-lock mode won't recover from a re-start without manual intervention
from a user to enter the unlock key. In some deployments, this might not be good for
availability."
"7.8","CIS Docker Community Edition Benchmark","Docker","Ensure node certificates are rotated as appropriate","Level 2","Scoring: Not Scored

Rotate swarm node certificates as appropriate.

Default Value:
By default, node certificates are rotated automatically every 90 days.","","","Run the below command to set the desired expiry time.
For example,
docker swarm update --cert-expiry 48h","","true","1. https://docs.docker.com/engine/reference/commandline/swarm_update/#exampl
es","Run the below command and ensure that the node certificate Expiry Duration is set as
appropriate.
docker info | grep ""Expiry Duration""","Docker Swarm uses mutual TLS for clustering operations amongst its nodes. Certificate
rotation ensures that in an event such as compromised node or key, it is difficult to
impersonate a node. By default, node certificates are rotated every 90 days. You should
rotate it more often or as appropriate in your environment.","None"
"7.9","CIS Docker Community Edition Benchmark","Docker","Ensure CA certificates are rotated as appropriate","Level 2","Scoring: Not Scored

Rotate root CA certificates as appropriate.

Default Value:
By default, root CA certificates are not rotated.","","","Run the below command to rotate the certificate.
docker swarm ca --rotate","","true","1. https://docs.docker.com/engine/swarm/how-swarm-mode-works/pki/#rotating-
the-ca-certificate","Based on your installation path, check the time stamp on the root CA certificate file.
For example,
ls -l /var/lib/docker/swarm/certificates/swarm-root-ca.crt
The certificate should have been rotated at the established frequency.","Docker Swarm uses mutual TLS for clustering operations amongst its nodes. Certificate
rotation ensures that in an event such as compromised node or key, it is difficult to
impersonate a node. Node certificates depend upon root CA certificates. For operational
security, it is important to rotate these frequently. Currently, root CA certificates are not
rotated automatically. You should thus establish a process to rotate it at the desired
frequency.","None"
"7.10","CIS Docker Community Edition Benchmark","Docker","Ensure management plane traffic has been separated from data plane traffic","Level 2","Scoring: Not Scored

Separate management plane traffic from data plane traffic.

Default Value:
By default, the data plane traffic is not separated from management plane traffic.","","","Initialize Swarm with dedicated interfaces for management and data planes respectively.
For example,
docker swarm init --advertise-addr=192.168.0.1 --data-path-addr=17.1.0.3","","true","1. https://docs.docker.com/engine/reference/commandline/swarm_init/#--data-
path-addr
2. https://github.com/moby/moby/issues/33938
3. https://github.com/moby/moby/pull/32717","Run the below command on each swarm node and ensure that the management plane
address is different from data plane address.
docker node inspect --format '{{ .Status.Addr }}' self
Note: At the time of writing of this benchmark, there is no way to inspect data plane
address. An issue has been raised and is in the reference link.","Separating the management plane traffic from data plane traffic ensures that these traffics
are on their respective paths. These paths could then be individually monitored and could
be tied to different traffic control policies and monitoring. It also ensures that management
plane is always reachable despite the huge volume of data flow.","You would require 2 network interface cards per node."
"1.1.1.1","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Syslog logging should be configured","Level 1","Syslog logging is a standard logging protocol that is widely supported. It is
recommended for a level 1 deployment only, as syslog does not support encryption.

Default Value:
By default no external logging is defined","","","Navigate to Device > Server Profiles > Syslog Choose Add Assign a Name to the
Profile. Choose Add, and assign a server name in the Name field, add an IP address or
FQDN in the Syslog Server field. Edit other fields as appropriate for your server.
Repeat if multiple Syslog destinations are required.
Navigate to Device > Log Settings Under System, add an entry. Define a Name and
a Filter setting. Under Forward Methods, add a Syslog Profile in the Syslog
section. Ensure that at least one of the Log Settings Configuration entries has it's
Filter setting at All Logs
Under Configuration, add an entry. Define a Name and a Filter setting. Under
Forward Methods, add a Syslog Profile in the Syslog section. Ensure that at least
one of the Log Settings Configuration entries has it's Filter setting at All Logs
Under User-ID, add an entry. Define a Name and a Filter setting. Under Forward
Methods, add a Syslog Profile in the Syslog section. Ensure that at least one of the
Log Settings Configuration entries has it's Filter setting at All Logs
Under HIP Match (Host Information Profile), add an entry. Define a Name and a Filter
setting. Under Forward Methods, add a Syslog Profile in the Syslog section.
Ensure that at least one of the Log Settings Configuration entries has it's Filter setting
at All Logs
Under IP-Tag, add an entry. Define a Name and a Filter setting. Under Forward
Methods, add a Syslog Profile in the Syslog section. Ensure that at least one of the
Log Settings Configuration entries has it's Filter setting at All Logs","","true","1. “PAN-OS Administrator's Guide 11.1 (English) - Configure Syslog Monitoring” -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/monitoring/use-
syslog-for-monitoring/configure-syslog-monitoring","Navigate to Device > Server Profiles > Syslog Ensure that a valid Syslog profile
is configured, and that it points to a valid Syslog host. Navigate to Device > Log
Settings Under System, verify that at least one Syslog entry exists and that at least
one entry has ""All Logs"" selected. Each Syslog entry must have a valid Syslog Profile
attached.
Under Configuration, verify that at least one Syslog entry exists and that at least one
entry has ""All Logs"" selected. Each Syslog entry must have a valid Syslog Profile
attached.
Under User-ID, verify that at least one Syslog entry exists and that at least one entry
has ""All Logs"" selected. Each Syslog entry must have a valid Syslog Profile attached.
Under HIP Match (Host Information Profile), verify that at least one Syslog entry exists
and that at least one entry has ""All Logs"" selected. Each Syslog entry must have a valid
Syslog Profile attached.
Under IP-Tag, verify that at least one Syslog entry exists and that at least one entry has
""All Logs"" selected. Each Syslog entry must have a valid Syslog Profile attached.","Sending all system logs to a remote host is recommended to provide protected, long
term storage and archiving. This also places a copy of the logs in a second location, in
case the primary (on the firewall) logs are compromised. Storing logs on a remote host
also allows for more flexible log searches and log processing, as well as many methods
of triggering events or scripts based on specific log events or combinations of events.
Finally, remote logging provides many organizations with the opportunity to combine
logs from disparate infrastructure in a SIEM (Security Information and Event
Management) system.
Logging to an external system is also usually required by most regulatory frameworks.","Failure to properly store and archive logs for critical infrastructure leaves an
organization without the tools required to establish trends in events or activity, or to
retrospectively analyze security or operational events beyond the log timespan stored
on the firewall. Not having remote logs also puts many organizations outside of
compliance with many regulatory frameworks. Finally, not logging to a remote host
leaves organizations without recourse in the event of a compromise of logs on the
primary device. It is imperative that organizations log critical infrastructure appropriately,
store and archive these logs in a central location, and have a robust set of tools to
analyze logs both in real time and after the fact."
"1.1.1.2","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","SNMPv3 traps should be configured","Level 2","SNMP v3 can be used for remote logging, and is the recommended protocol in higher
security situations as it fully supports encryption of logs.

Default Value:
By default no external logging is defined","","","Navigate to Device > Server Profiles > SNMP Trap Choose Add Assign a Name to
the Profile, and specify version V3. Choose Add, and assign a server name in the Name
field, add an IP address or FQDN in the SNMP Manager field. Edit the Password fields
as appropriate for your server. Repeat if multiple Syslog destinations are required.
Navigate to Device > Log Settings Under System, add an entry. Define a Name and
a Filter setting. Under Forward Methods, add a SNMP Profile in the SNMP
section. Ensure that at least one of the Log Settings Configuration entries has its
Filter setting at All Logs
Under Configuration, add an entry. Define a Name and a Filter setting. Under
Forward Methods, add a SNMP Profile in the SNMP section. Ensure that at least one
of the Log Settings Configuration entries has its Filter setting at All Logs
Under User-ID, add an entry. Define a Name and a Filter setting. Under Forward
Methods, add a SNMP Profile in the SNMP section. Ensure that at least one of the Log
Settings Configuration entries has its Filter setting at All Logs
Under HIP Match (Host Information Profile), add an entry. Define a Name and a Filter
setting. Under Forward Methods, add a SNMP Profile in the SNMP section. Ensure
that at least one of the Log Settings Configuration entries has its Filter setting at All
Logs
Under IP-Tag, add an entry. Define a Name and a Filter setting. Under Forward
Methods, add a SNMP Profile in the SNMP section. Ensure that at least one of the Log
Settings Configuration entries has its Filter setting at All Logs","","true","1. “PAN-OS Administrator's Guide 11.1 (English) - Forward Traps to an SNMP
Manager” - https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-
admin/monitoring/snmp-monitoring-and-traps/forward-traps-to-an-snmp-manager","Navigate to Device > Server Profiles > SNMP Traps
Ensure that a valid SNMP profile is configured, that version V3 is selected, and that it
points to a valid SNMPv3 host. User, EngineID and Password fields should be
completed appropriately
Navigate to Device > Log Settings Under System, verify that at least one SNMP
entry exists, corresponding to an SNMPv3 Server Profile and that at least one entry has
""All Logs"" selected.
Under Configuration, verify that at least one SNMP entry exists, corresponding to an
SNMPv3 Server Profile and that at least one entry has ""All Logs"" selected.
Under User-ID, verify that at least one SNMP entry exists, corresponding to an
SNMPv3 Server Profile and that at least one entry has ""All Logs"" selected.
Under HIP Match (Host Information Profile), verify that at least one SNMP entry exists,
corresponding to an SNMPv3 Server Profile and that at least one entry has ""All Logs""
selected.
Under IP-Tag, verify that at least one SNMP entry exists, corresponding to an SNMPv3
Server Profile and that at least one entry has ""All Logs"" selected.","Sending all system logs to a remote host is recommended to provide protected, long
term storage and archiving. This also places a copy of the logs in a second location, in
case the primary (on the firewall) logs are compromised. Storing logs on a remote host
also allows for more flexible log searches and log processing, as well as many methods
of triggering events or scripts based on specific log events or combinations of events.
Finally, remote logging provides many organizations with the opportunity to combine
logs from disparate infrastructure in a SIEM (Security Information and Event
Management) system.
Logging to an external system is also usually required by most regulatory frameworks.","Failure to properly store and archive logs for critical infrastructure leaves an
organization without the tools required to establish trends in events or activity, or to
retrospectively analyze security or operational events beyond the log timespan stored
on the firewall. Not having remote logs also puts many organizations outside of
compliance with many regulatory frameworks. Finally, not logging to a remote host
leaves organizations without recourse in the event of a compromise of logs on the
primary device. It is imperative that organizations log critical infrastructure appropriately,
store and archive these logs in a central location, and have a robust set of tools to
analyze logs both in real time and after the fact. Not encrypting log data as it transits the
network allows an attacker to mount a ""MiTM"" (Monkey in the Middle) attack, which
allows them to intercept and/or modify logs as they transit from the source to the
destination."
"1.1.2","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure 'Login Banner' is set","Level 1","Configure a login banner, ideally approved by the organization’s legal team. This banner
should, at minimum, prohibit unauthorized access, provide notice of logging or
monitoring, and avoid using the word “welcome” or similar words of invitation.

Default Value:
Not configured","","","Navigate to Device > Setup > Management > General Settings.
Set Login Banner as appropriate for your organization.","","true","1. “PAN-OS Administrator's Guide 11.1 (English) - Configuring Logon Banners” -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/firewall-
administration/use-the-web-interface/configure-banners-message-of-the-day-
and-logos","Navigate to Device > Setup > Management > General Settings.
Verify that Login Banner is set appropriately for your organization.","Through a properly stated login banner, the risk of unintentional access to the device by
unauthorized users is reduced. Should legal action take place against a person
accessing the device without authorization, the login banner greatly diminishes a
defendant’s claim of ignorance.",""
"1.1.3","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure 'Enable Log on High DP Load' is enabled","Level 1","Enable the option 'Enable Log on High DP Load' feature. When this option is selected, a
system log entry is created when the device’s packet processing load reaches 100%
utilization.

Default Value:
Not enabled","","","Navigate to Device > Setup > Management > Logging and Reporting Settings
> Log Export and Reporting.
Set the Enable Log on High DP Load box to checked.","","true","1. ""Logging Best Practices"" - https://live.paloaltonetworks.com/t5/best-practice-
assessment-device/logging-and-reporting-settings-log-on-high-dp-mode/ta-
p/336964","Navigate to Device > Setup > Management > Logging and Reporting Settings
> Log Export and Reporting.
Verify Enable Log on High DP Load is checked.","When the device’s packet processing load reaches 100%, a degradation in the
availability of services accessed through the device can occur. Logging this event can
help with troubleshooting system performance.","Sustained attacks, especially volumetric DOS and DDOS attacks will often affect CPU
utilization. This setting will generate an event that is easily monitored for and alerted on.
While setting CPU utilization watermarks in a Network Management System is a
standard practice, this setting does not depend on even having an NMS, it doesn't
require anything other than standard logging to implement."
"1.2.1","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure 'Permitted IP Addresses' is set to those necessary for device management","Level 1","Permit only the necessary IP addresses to be used to manage the device.

Default Value:
Not enabled (all addresses that can reach the interface are permitted)","","","Navigate to Device > Setup > Interfaces > Management.
Set Permitted IP Addresses to only those necessary for device management for the
SSH and HTTPS protocols. If no profile exists, create one that has these addresses set.","","true","1. ""How to Allow Certain IP Addresses on the Management Interface"" -
https://live.paloaltonetworks.com/docs/DOC-8432
2. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing
Administrative Access"": https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-
admin/getting-started/best-practices-for-securing-administrative-access.html#","Navigate to Device > Setup > Interfaces > Management.
Verify that Permitted IP Addresses is limited only to those necessary for device
management.","Management access to the device should be restricted to the IP addresses or subnets
used by firewall administrators. Permitting management access from other IP addresses
increases the risk of unauthorized access through password guessing, stolen
credentials, or other means.",""
"1.2.2","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure 'Permitted IP Addresses' is set for all management profiles where SSH, HTTPS, or SNMP is enabled","Level 1","For all management profiles, only the IP addresses required for device management
should be specified.

Default Value:
Not enabled","","","Navigate to Network > Network Profiles > Interface Management.
In each profile, for each of the target protocols (SNMP, HTTPS, SSH), set Permitted
IP Addresses to only include those necessary for device management. If no profile
exists, create one that has these options set.","","true","1. ""How to Allow Certain IP Addresses on the Management Interface"" -
https://live.paloaltonetworks.com/docs/DOC-8432
2. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing
Administrative Access"": https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-
admin/getting-started/best-practices-for-securing-administrative-access.html#","Navigate to Network > Network Profiles > Interface Management.
In each profile, for each of the target protocols (SNMP, HTTPS, SSH), verify that
Permitted IP Addresses is limited to those necessary for device management.","If a Permitted IP Addresses list is either not specified or is too broad, an attacker may
gain the ability to attempt management access from unintended locations, such as the
Internet. The “Ensure 'Security Policy' denying any/all traffic exists at the bottom of the
security policies ruleset” recommendation in this benchmark can provide additional
protection by requiring a security policy specifically allowing device management
access.",""
"1.2.3","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure HTTP and Telnet options are disabled for the management interface","Level 1","HTTP and Telnet options should not be enabled for device management.

Default Value:
Not set. (HTTP and Telnet are disabled by default)","","","Navigate to Device > Setup > Interfaces > Management.
Set the HTTP and Telnet boxes to unchecked.","","true","1. ""How to Configure a Layer 3 Interface to act as a Management Port"" -
https://live.paloaltonetworks.com/t5/Configuration-Articles/How-to-Configure-a-
Layer-3-Interface-to-act-as-a-Management-Port/ta-p/59024
2. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing
Administrative Access"": https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-
admin/getting-started/best-practices-for-securing-administrative-access.html#","Navigate to Device > Setup > Interfaces > Management.
Verify that the HTTP and Telnet options are both unchecked.","Management access over cleartext services such as HTTP or Telnet could result in a
compromise of administrator credentials and other sensitive information related to
device management. Theft of either administrative credentials or session data is easily
accomplished with a ""Man in the Middle"" attack.",""
"1.2.4","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure HTTP and Telnet options are disabled for all management profiles","Level 1","HTTP and Telnet options should not be enabled for device management.","","","Navigate to Network > Network Profiles > Interface Management. For each
Profile, set the HTTP and Telnet boxes to unchecked.","","true","1. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing
Administrative Access"": https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-
admin/getting-started/best-practices-for-securing-administrative-access.html#
2. “PAN-OS Administrator's Guide 9.0 (English) - Use Interface Management
Profiles to Restrict Access"": https://docs.paloaltonetworks.com/pan-os/9-0/pan-
os-admin/networking/configure-interfaces/use-interface-management-profiles-to-
restrict-access.html#","Navigate to Network > Network Profiles > Interface Management. For each
Interface Management profile verify that the HTTP and Telnet options are both
unchecked.","Management access over cleartext services such as HTTP or Telnet could result in a
compromise of administrator credentials and other sensitive information related to
device management.",""
"1.2.5","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure valid certificate is set for browser-based administrator interface","Level 2","In most cases, a browser HTTPS interface is used to administer the Palo Alto
appliance. The certificate used to secure this session should satisfy the following
criteria:
1. A valid certificate from a trusted source should be used. While a certificate from a
trusted Public Certificate Authority is certainly valid, one from a trusted Private
Certificate Authority is absolutely acceptable for this purpose.
2. The certificate should have a valid date. It should not have a ""to"" date in the past
(it should not be expired), and should not have a ""from"" date in the future.
3. The certificate should use an acceptable cipher and encryption level.

Default Value:
A self-signed certificate is installed by default for the administrative interface.

Additional Information:
Verify that the clock is both accurate and reliable on both the Palo Alto and on the
administrative workstations before setting the SSL/TLS Service Profile. Inaccurate or
mismatched clocks will result in certificate errors and can result in loss of HTTPS
administrative access.","","","Create or acquire a certificate that meets the stated criteria and set it:
Navigate to Device > Certificate Management > Certificates
Import an appropriate Certificate for your administrative session, from a trusted
Certificate Authority.
Navigate to Device > Certificate Management > SSL/TLS Service Profile
Choose or import the certificate you want to use for the web based administrative
session.
Navigate to Device > Setup > Management > General Settings > SSL/TLS
Service Profile
Choose the Service Profile that you have configured","","true","1. ""How to Configure a Certificate for Secure Web GUI Access"" -
https://live.paloaltonetworks.com/t5/Configuration-Articles/How-to-configure-a-
certificate-for-secure-web-gui-access/ta-p/68653
2. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing
Administrative Access"": https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-
admin/getting-started/best-practices-for-securing-administrative-access.html#","Verify that the certificate used to secure HTTPS sessions meets the criteria by
reviewing the appropriate certificate:
Navigate to Device > Certificate Management > Certificates
Verify that this Certificate is properly applied to the Management Interface:
Navigate to Device > Setup > Management > General Settings > SSL/TLS
Service Profile","If a certificate that is self-signed, expired, or otherwise invalid is used for the browser
HTTPS interface, administrators in most cases will not be able to tell if their session is
being eavesdropped on or injected into by a ""Man in the Middle"" attack.","If the default self-signed certificate is used, an administrator will not be able to clearly
tell if their HTTPS session is being hijacked or not. Using a trusted certificate ensures
that the session is both encrypted and trusted."
"1.3.1","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure 'Minimum Password Complexity' is enabled","Level 1","This checks all new passwords to ensure that they meet basic requirements for strong
passwords.

Default Value:
Not enabled.","","","Navigate to Device > Setup > Management > Minimum Password Complexity.
Set Enabled to be checked
Set that the various password settings to values that are appropriate to your
organization. It is suggested that there at least be some special characters enforced,
and that a minimum length be set. Ensure that non-zero values are set for Minimum
Uppercase, Lowercase and Special Characters. ""Block Username Inclusion"" should be
enabled.
Operationally, dictionary words should be avoided for all passwords - passphrases are a
much better alternative.","","true","1. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing
Administrative Access” - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-
admin/getting-started/best-practices-for-securing-administrative-access.html","Navigate to Device > Setup > Management > Minimum Password Complexity.
Verify Enabled is checked
Ensure that the various password settings to values that are appropriate to your
organization. Non-zero values should be set for Minimum Uppercase, Lowercase and
Special Characters. ""Block Username Inclusion"" should be enabled.","Password complexity recommendations are derived from the USGCB (United States
Government Configuration Baseline), Common Weakness Enumeration, and
benchmarks published by the CIS (Center for Internet Security). Password complexity
adds entropy to a password, in comparison to a simple password of the same length. A
complex password is more difficult to attack, either directly against administrative
interfaces or cryptographically, against captured password hashes. However, making a
password of greater length will generally have a greater impact in this regard, in
comparison to making a shorter password more complex.","Simple passwords make an attacker's job very easy. There is a reasonably short list of
commonly used admin passwords for network infrastructure, not enforcing password
lengths and complexity can lend itself to making an attacker's brute force attack
successful."
"1.3.2","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure 'Minimum Length' is greater than or equal to 12","Level 1","This determines the least number of characters that make up a password for a user
account.

Default Value:
Not enabled.","","","Navigate to Device > Setup > Management > Minimum Password Complexity.
Set Minimum Length to greater than or equal to 12","","true","1. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing
Administrative Access” - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-
admin/getting-started/best-practices-for-securing-administrative-access.html","Navigate to Device > Setup > Management > Minimum Password Complexity.
Verify Minimum Length is greater than or equal to 12","A longer password is much more difficult to attack, either directly against administrative
interfaces or cryptographically, against captured password hashes. Making a password
of greater length will generally have a greater impact in this regard, in comparison to
making a shorter password more complex. Passphrases are a commonly used
recommendation, to make longer passwords more palatable to end users.
Administrative staff however generally use ""password safe"" applications, so a long and
complex password is more easily implemented for most infrastructure administrative
interfaces.","Longer passwords are much more difficult to attack. This is true of attacks against the
administrative interfaces themselves, or of decryption attacks against captured hashes.
A longer password will almost always have a more positive impact than a shorter but
more complex password."
"1.3.3","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure 'Minimum Uppercase Letters' is greater than or equal to 1","Level 1","This checks all new passwords to ensure that they contain at least one English
uppercase character (A through Z).

Default Value:
Not enabled.","","","Navigate to Device > Setup > Management > Minimum Password Complexity
Set Minimum Uppercase Letters to greater than or equal to 1","","true","1. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing
Administrative Access” - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-
admin/getting-started/best-practices-for-securing-administrative-access.html","Navigate to Device > Setup > Management > Minimum Password Complexity
Verify Minimum Uppercase Letters is greater than or equal to 1","This is one of several settings that, when taken together, ensure that passwords are
sufficiently complex as to thwart brute force and dictionary attacks.",""
"1.3.4","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure 'Minimum Lowercase Letters' is greater than or equal to 1","Level 1","This checks all new passwords to ensure that they contain at least one English
lowercase character (a through z).

Default Value:
Not enabled.","","","Navigate to Device > Setup > Management > Minimum Password Complexity
Set Minimum Lowercase Letters to greater than or equal to 1","","true","1. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing
Administrative Access” - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-
admin/getting-started/best-practices-for-securing-administrative-access.html","Navigate to Device > Setup > Management > Minimum Password Complexity
Verify Minimum Lowercase Letters is greater than or equal to 1","This is one of several settings that, when taken together, ensure that passwords are
sufficiently complex as to thwart brute force and dictionary attacks.",""
"1.3.5","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure 'Minimum Numeric Letters' is greater than or equal to 1","Level 1","This checks all new passwords to ensure that they contain at least one base 10 digit (0
through 9).

Default Value:
Not enabled.","","","Navigate to Device > Setup > Management > Minimum Password Complexity
Set Minimum Numeric Letters to greater than or equal to 1","","true","1. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing
Administrative Access” - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-
admin/getting-started/best-practices-for-securing-administrative-access.html","Navigate to Device > Setup > Management > Minimum Password Complexity`
Verify Minimum Numeric Letters is greater than or equal to 1","This is one of several settings that, when taken together, ensure that passwords are
sufficiently complex as to thwart brute force and dictionary attacks.",""
"1.3.6","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure 'Minimum Special Characters' is greater than or equal to 1","Level 1","This checks all new passwords to ensure that they contain at least one non-alphabetic
character (for example, !, $, #, %).

Default Value:
Not enabled.","","","Navigate to Device > Setup > Management > Minimum Password Complexity
Set Minimum Special Characters to greater than or equal to 1","","true","1. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing
Administrative Access” - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-
admin/getting-started/best-practices-for-securing-administrative-access.html","Navigate to Device > Setup > Management > Minimum Password Complexity
Verify Minimum Special Characters is greater than or equal to 1","This is one of several settings that, when taken together, ensure that passwords are
sufficiently complex as to thwart brute force and dictionary attacks.",""
"1.3.7","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure 'Required Password Change Period' is less than or equal to 90 days","Level 1","This defines how long a user can use a password before it expires.

Default Value:
Not enabled.

Additional Information:
This guidance is currently under some debate in the community. If the password length
is sufficient and password complexity is enforced, then in many organizations it is likely
that the password change period can be increased to 6, 9 or even 12 months.","","","Navigate to Device > Setup > Management > Minimum Password Complexity.
Set Required Password Change Period (days) to less than or equal to 90","","true","1. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing
Administrative Access” - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-
admin/getting-started/best-practices-for-securing-administrative-access.html","Navigate to Device > Setup > Management > Minimum Password Complexity.
Verify Required Password Change Period (days) is less than or equal to 90","The longer a password exists, the higher the likelihood that it will be compromised by a
brute force attack, by an attacker gaining general knowledge about the user and
guessing the password, or by the user sharing the password.","Failure to change administrative passwords can result in a slow ""creep"" of people who
have access. Especially in a situation with high staff turnover (for instance, in a NOC or
SOC situation), administrative passwords need to be changed frequently.
Administrative credentials should not be shared across multiple devices. In a NOC/SOC
situation, it's important to not share administrative credentials between operators
(names accounts should be used), and in particular administrative credentials should
never be shared across different customer infrastructures."
"1.3.8","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure 'New Password Differs By Characters' is greater than or equal to 3","Level 1","This checks all new passwords to ensure that they differ by at least three characters
from the previous password.

Default Value:
Not enabled.","","","Navigate to Device > Setup > Management > Minimum Password Complexity
Set New Password Differs By Characters to 3 or more","","true","1. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing
Administrative Access” - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-
admin/getting-started/best-practices-for-securing-administrative-access.html","Navigate to Device > Setup > Management > Minimum Password Complexity
Verify New Password Differs By Characters is set to greater than or equal to 3","This is one of several settings that, when taken together, ensure that passwords are
sufficiently complex as to thwart brute force and dictionary attacks.","This prevents the use of passwords that fall into a predictable pattern. Especially in
situations that involve staff turnover, having a pattern to password changes should be
avoided."
"1.3.9","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure 'Prevent Password Reuse Limit' is set to 24 or more passwords","Level 1","This determines the number of unique passwords that have to be most recently used for
a user account before a previous password can be reused.

Default Value:
Not enabled.","","","Navigate to Device > Setup > Management > Minimum Password Complexity.
Set Prevent Password Reuse Limit to greater than or equal to 24","","true","1. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing
Administrative Access” - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-
admin/getting-started/best-practices-for-securing-administrative-access.html","Navigate to Device > Setup > Management > Minimum Password Complexity.
Verify Prevent Password Reuse Limit is greater than or equal to 24","The longer a user uses the same password, the greater the chance that an attacker can
determine the password through brute force attacks. Also, any accounts that may have
been compromised will remain exploitable for as long as the password is left
unchanged. If password changes are required but password reuse is not prevented, or if
users continually reuse a small number of passwords, the effectiveness of a good
password policy is greatly reduced. While current guidance emphasizes password
length above frequent password changes, not enforcing password re-use guidance
adds the temptation of using a small pool of passwords, which can make an attacker's
job easier across an entire infrastructure.",""
"1.3.10","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure 'Password Profiles' do not exist","Level 1","Password profiles that are weaker than the recommended minimum password
complexity settings must not exist.

Default Value:
Not configured","","","Navigate to Device > Password Profiles.
Ensure Password Profiles weaker than the recommended minimum password
complexity settings do not exist.","","true","1. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing
Administrative Access” - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-
admin/getting-started/best-practices-for-securing-administrative-access.html","Navigate to Device > Password Profiles.
Verify Password Profiles weaker than the recommended minimum password complexity
settings do not exist.","As password profiles override any 'Minimum Password Complexity' settings defined in
the device, they generally should not exist. If these password profiles do exist, they
should enforce stronger password policies than what is set in the 'Minimum Password
Complexity' settings.",""
"1.4.1","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure 'Idle timeout' is less than or equal to 10 minutes for device management","Level 1","Set the Idle Timeout value for device management to 10 minutes or less to
automatically close inactive sessions.

Default Value:
Not configured","","","Navigate to Device > Setup > Management > Authentication Settings.
Set Idle Timeout to less than or equal to 10.","","true","1. “How to Change the Admin Session Timeout Value” -
https://live.paloaltonetworks.com/docs/DOC-5557
2. “PAN-OS Administrator's Guide 11.1 (English) - Device - Setup - Management” -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-
help/device/device-setup-management#","Navigate to Device > Setup > Management > Authentication Settings.
Verify Idle Timeout is less than or equal to 10.","An unattended computer with an open administrative session to the device could allow
an unauthorized user access to the firewall’s management interface.",""
"1.4.2","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure 'Failed Attempts' and 'Lockout Time' for Authentication Profile are properly configured","Level 1","Configure values for Failed Login Attempts and Account Lockout Time set to
organization-defined values (for example, 3 failed attempts and a 15 minute lockout
time). Do not set Failed Attempts and Lockout Time in the Authentication Settings
section; any Failed Attempts or Lockout Time settings within the selected Authentication
Profile do not apply in the Authentication Settings section.

Default Value:
Not configured

Additional Information:
Both values must be set. If either value is not set, account lockout does not occur.","","","Navigate to Device > Authentication Profile.
Set Failed Attempts to the non-zero organization-defined value.
Set Lockout Time to the non-zero organization-defined value.","","true","1. “PAN-OS Administrator's Guide 11.1 (English) - Device - Setup - Management” -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-
help/device/device-setup-management#
2. “PAN-OS Administrator's Guide 11.1 (English) - Authentication Profile"" -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-
help/device/device-authentication-profile","Navigate to Device > Authentication Profile.
Verify Failed Attempts is set a non-zero organization-defined value.
Verify Lockout Time is set to a non-zero organization-defined value.","Without a lockout limit, an attacker can continuously guess administrators’ passwords.
From the other point of view, if lockout settings are configured in the Authentication
Settings section it may be possible for an attacker to continuously lock out all
administrative accounts from accessing the device. This potential situation indicates the
importance of using named administrative accounts, instead of the default, single
shared ""admin"" account.",""
"1.5.1","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure 'V3' is selected for SNMP polling","Level 1","For SNMP polling, only SNMPv3 should be used.

Default Value:
Not configured","","","Navigate to Device > Setup > Operations > Miscellaneous > SNMP Setup
Select V3.
In order to be usable, the User and View sections of this dialog should also be
completed. These settings need to match the settings in the organization's NMS
(Network Management System)","","true","1. https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-
help/device/device-setup-operations/enable-snmp-monitoring","Navigate to Device > Setup > Operations > Miscellaneous > SNMP Setup
Verify V3 is selected.","SNMPv3 utilizes AES-128 encryption, message integrity, user authorization, and device
authentication security features. SNMPv2c does not provide these security features. If
an SNMPv2c community string is intercepted or otherwise obtained, an attacker could
gain read access to the firewall. Note that SNMP write access is not possible.","Any clear-text administrative protocol (such as SNMPv2) can expose valuable
information to any attacker that is in a position to eavesdrop on that protocol."
"1.6.1","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure 'Verify Update Server Identity' is enabled","Level 1","This setting determines whether or not the identity of the update server must be verified
before performing an update session. Note that if an SSL Forward Proxy is configured
to intercept the update session, this option may need to be disabled (because the SSL
Certificate will not match).

Default Value:
Not configured","","","Navigate to Device > Setup > Services > Services.
Set the Verify Update Server Identity box to checked.","","true","1. “PAN-OS Administrator's Guide 9.0 (English) - Install Content Updates"" -
https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/software-and-
content-updates/install-content-and-software-updates.html","Navigate to Device > Setup > Services > Services.
Verify that the Verify Update Server Identity box is checked.","Verifying the update server identity before package download ensures the packages
originate from a trusted source. Without this, it is possible to receive and install an
update from a malicious source.","This setting protects the device from an ""evilgrade"" attack, where a successful DNS
attack can redirect the firewall to an attacker-controlled update server, which can then
serve a modified update."
"1.6.2","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure redundant NTP servers are configured appropriately","Level 1","These settings enable use of primary and secondary NTP servers to provide
redundancy in case of a failure involving the primary NTP server.

Default Value:
Not configured","","","Navigate to Device > Setup > Services > Services.
Set Primary NTP Server Address appropriately.
Set Secondary NTP Server Address appropriately.","","true","1. “The NIST Authenticated NTP Service” -
http://www.nist.gov/pml/div688/grp40/authntp.cfm
2. https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-
help/device/device-setup-services/global-services-settings
3. ""How to Configure Authenticated NTP"" -
https://live.paloaltonetworks.com/t5/Configuration-Articles/How-to-Configure-
Authenticated-NTP/ta-p/54495","Navigate to Device > Setup > Services > Services.
Verify Primary NTP Server Address is set appropriately.
Verify Secondary NTP Server Address is set appropriately.","NTP enables the device to maintain an accurate time and date when receiving updates
from a reliable NTP server. Accurate timestamps are critical when correlating events
with other systems, troubleshooting, or performing investigative work. Logs and certain
cryptographic functions, such as those utilizing certificates, rely on accurate time and
date parameters. In addition, rules referencing a Schedule object will not function as
intended if the device’s time and date are incorrect.
For additional security, authenticated NTP can be utilized. If Symmetric Key
authentication is selected, only SHA1 should be used, as MD5 is considered severely
compromised.
Most organizations will maintain a pair of internal NTP servers for all internal time
services. These servers will either be self-contained atomic clocks, or will collect time
from a known reliable source (often GPS or a well-known internet server pool will be
used).",""
"1.6.3","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure that the Certificate Securing Remote Access VPNs is Valid","Level 1","The Certificate used to secure Remote Access VPNs should satisfy the following
criteria:
• It should be a valid certificate from a trusted source. In almost cases this means
a trusted Public Certificate Authority, as in most cases remote access VPN users
will not have access to any Private Certificate Authorities for Certificate
validation.
• The certificate should have a valid date. It should not have a ""to"" date in the past
(it should not be expired), and should not have a ""from"" date in the future.
• The key length used to encrypt the certificate should be 2048 bits or more.
• The hash used to sign the certificate should be SHA-2 or better.
• When the Certificate is applied, the TLS version should be 1.1 or higher (1.2 is
recommended)

Default Value:
Not configured","","","Create a CSR and install a certificate from a public CA (Certificate Authority) here:
Navigate to Device > Certificate Management > Certificates
Apply a valid certificate to the HTTPS portal:
Navigate to Network > GlobalProtect > Portals > Portal Configuration >
Authentication > SSL/TLS Profile
Apply a valid certificate to the GlobalProtect Gateway:
Navigate to Network > GlobalProtect > Gateways > Authentication > SSL/TLS
Service Profile Configure the Service Profile to use the correct certificate
Ensure that the Minimum TLS version is set to 1.1 or 1.2 (1.2 is recommended).","","true","1. “PAN-OS Administrator's Guide 9.0 (English) - GlobalProtect Certificate Best
Practices"" - https://docs.paloaltonetworks.com/globalprotect/9-0/globalprotect-
admin/get-started/enable-ssl-between-globalprotect-components/globalprotect-
certificate-best-practices.html
2. “PAN-OS Administrator's Guide 9.0 (English) - Deploy Server Certificates to the
GlobalProtect Components"" - https://docs.paloaltonetworks.com/globalprotect/9-
0/globalprotect-admin/get-started/enable-ssl-between-globalprotect-
components/deploy-server-certificates-to-the-globalprotect-components.html#","Verify that the certificate being used to secure the VPN meets the criteria listed above:
Navigate to Device > Certificate Management > Certificates
Ensure that a valid certificate is applied to the HTTPS portal:
Navigate to Network > GlobalProtect > Portals > Portal Configuration >
(Select the Portal being assessed) > Authentication > SSL/TLS Profile
Ensure that a valid certificate is applied to the GlobalProtect Gateway:
Navigate to Network > GlobalProtect > Gateways > (Select the Gateway
being Assessed) > Authentication > SSL/TLS Service Profile
Ensure that the correct Certificate is selected. Ensure that the Minimum TLS version is
configured to be 1.1 or higher (TLSv1.2 is recommended).","If presented with a certificate error, the end user in most cases will not be able to tell if
their session is using a self-signed or expired certificate, or if their session is being
eavesdropped on or injected into by a ""Man in the Middle"" attack. This means that self-
signed or invalid certificates should never be used for VPN connections.","Not using a trusted Certificate, issued by a trusted Public Certificate Authority means
that clients establishing VPN sessions will always see an error indicating an untrusted
Certificate. This means that they will have no method of validating if their VPN session
is being hijacked by a ""Monkey in the Middle"" (MitM) attack. It also ""trains"" them to
bypass certificate warnings for other services, making MitM attacks easier for those
other services as well."
"1.7.1","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Enabling Post-Quantum (PQ) on IKEv2 VPNs","Level 2","For VPN that has IKEv2 enabled, enable PQ for more secure way to exchange pre-
shared secret to defend against ""Harvest Now, Decrypt Later"" attack technique.

Default Value:
Not Configured","","","Navigate to Network > Network Profiles > IKE Gateways.
On gateways that has IKEv2 enabled, click into it and navigate to Advanced Options.
On IKEv2 section, navigate to PQ PPK section.
Check Enable Post-Quantum Pre-Shared Key (PPK) option.
Negotiation mode should be set to Mandatory if both sides of VPN supports PQ.
Negotiation mode should be set to Preferred if you don't know or don't have control
over whether the peer supports RFC 8784. Preferred mode preserves backward
compatibility to ensure connections fall back instead of dropping.
If both sides of VPN supports more than 1 PPK key ID, then multiple PPK key ID should
be configured. Configuring multiple PQ PPKs is most secure because it adds a random
element to PQ PPK selection.","","true","1. “PAN-OS Administrator's Guide 11.1 (English) - Network Security"" -
https://docs.paloaltonetworks.com/network-security/quantum-
security/administration/configure-quantum-resistant-ikev2-vpns/configure-post-
quantum-ikev2-vpns","Navigate to Network > Network Profiles > IKE Gateways.
On gateways that has IKEv2 enabled, click into it and navigate to Advanced Options.
On IKEv2 section, navigate to PQ PPK section.
Verify that Enable Post-Quantum Pre-Shared Key (PPK) is checked.
Negotiation mode should be set to Mandatory if both sides of VPN supports PQ.
Negotiation mode should be set to Preferred if you don't know or don't have control
over whether the peer supports RFC 8784. Preferred mode preserves backward
compatibility to ensure connections fall back instead of dropping.
If both sides of VPN supports more than 1 PPK key ID, then multiple PPK key ID should
be configured. Configuring multiple PQ PPKs is most secure because it adds a random
element to PQ PPK selection.","Post-quantum IKEv2 VPNs based on RFC 8784 work by transmitting a pre-shared
secret separately (out-of-band) from the initial peering exchange (the IKE_SA_INIT
Exchange). Instead of transmitting the pre-shared secret in the peering exchange,
which an attacker could compromise or harvest now and decrypt later, the peering
exchange only transmits a Key ID. A Key ID and a pre-shared secret comprise a unique
pair called a post-quantum pre-shared key (PQ PPK).
Each IKEv2 peer uses the Key ID to look up the pre-shared secret, which is transmitted
securely between administrators or pushed by Panorama, and stored locally on each
IKEv2 peer. The pre-shared key is never part of the peering exchange and never
traverses the post-quantum VPN, so an attacker using a quantum computer can't steal
it, crack it, and use it to decrypt data harvested from a VPN.
Both IKEv2 peers must have the same active pairs of Key ID plus pre-shared secret so
that when peers negotiate the connection, each peer can look up the same Key ID and
retrieve the same pre-shared secret. If the responding peer doesn't have a matching
Key ID or if the pre-shared secret associated with the Key ID differs from the initiator,
the connection is aborted.",""
"2.1","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure that IP addresses are mapped to usernames","Level 2","Configure appropriate settings to map IP addresses to usernames. Mapping userids to
IP addresses is what permits the firewall to create rules based on userids and groups
rather than IP addresses and subnets, as well as log events by userids rather than IP
addresses or DNS names. The specifics of how to achieve IP-to-username mapping is
highly dependent on the environment. It can be enabled by integrating the firewall with a
domain controller, Exchange server, captive portal, Terminal Server, User-ID Agent,
XML API, or syslog data from a variety of devices.","","","To Set User-ID Agents:
Navigate to Device > User Identification > User-ID Agents
Set the Name, IP Address and Port of the User-ID Agent`
Enable User Identification for each monitored zone that will have user accounts:
Navigate to Network > Zone, for each relevant zone enable User
Identification
To Set Terminal Services Agents:
Navigate to Device > Terminal Services Agents Set the Name, IP Address and
Port of the Terminal Services Agent
Enable User Identification for each monitored zone that will have Terminal Servers:
Navigate to Network > Zone, enable User Identification","","true","1. “Best Practices for Securing User-ID Deployments” -
https://live.paloaltonetworks.com/docs/DOC-7912
2. “How to Configure Group Mapping settings?” -
https://live.paloaltonetworks.com/docs/DOC-4994
3. https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/user-id
4. https://paloaltonetworks.com/content/dam/paloaltonetworks-
com/en_US/assets/pdf/tech-briefs/techbrief-user-id.pdf","To validate if this recommendation has been met, look at the Source User column in
the URL Filtering or Traffic logs (Monitor > Logs > URL Filtering and Logs >
Traffic Logs, respectively.)
User traffic originating from a trusted zone should identify a username.","Understanding which user is involved in a security incident allows appropriate personnel
to move quickly between the detection and reaction phases of incident response. In
environments with either short DHCP lease times, or where users may move frequently
between systems, the ability to analyze or report, or alert on events based on user
accounts or user groups is a tremendous advantage. For forensics tasks when DHCP
lease information may not be available, the Source User information may be the only
way to tie together related data.",""
"2.2","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure that WMI probing is disabled","Level 2","Disable WMI probing if it is not required for User-ID functionality in the environment.

Default Value:
Not configured","","","Navigate to Device > User Identification > User Mapping > Palo Alto
Networks User ID Agent Setup.
Set Enable Probing so it is unchecked.","","true","1. “R7-2014-16: Palo Alto Networks User-ID Credential Exposure” -
https://blog.rapid7.com/2014/10/14/palo-alto-networks-userid-credential-
exposure/
2. “Best Practices for Securing User-ID Deployments” -
https://live.paloaltonetworks.com/docs/DOC-7912
3. “PAN-OS Administrator's Guide 11.1 (English) - Client Probing"" -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/user-id/user-id-
concepts/user-mapping/client-probing","Navigate to Device > User Identification > User Mapping > Palo Alto
Networks User ID Agent Setup.
Verify that Enable Probing is not checked.","WMI probing normally requires a domain administrator account. A malicious user could
capture the encrypted password hash for offline cracking or relayed authentication
attacks. Relying on other forms of user identification, such as using UserID Agents or
security log monitoring, mitigates this risk.
In addition, it is easy to mis-configure this feature such that it is enabled on untrusted
interfaces. This can result in a domain administrator account and the associated
password hash being sent to untrusted hosts on the internet, where malicious users can
then capture that hash for offline cracking.","While this removes the exposure of having the WMI user account password being
compromised, it also reduces the effectiveness of user identification during operation of
the firewall (applying rules and policies). This trade-off should be weighed carefully for
all installations."
"2.3","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure that User-ID is only enabled for internal trusted interfaces","Level 1","Only enable the User-ID option for interfaces that are both internal and trusted. There is
rarely a legitimate need to allow WMI probing (or any user-id identification) on an
untrusted interface. The exception to this is identification of remote-access VPN users,
who are identified as they connect.

Default Value:
By default WMI probing and all User-ID functions are disabled.","","","Navigate to Network > Network Profiles > Interface Management.
Set User-ID to be checked only for interfaces that are both internal and trusted;
uncheck it for all other interfaces.","","true","1. “Customer advisory: Security Impact of User-ID Misconfiguration” -
https://live.paloaltonetworks.com/docs/DOC-8125
2. “R7-2014-16: Palo Alto Networks User-ID Credential Exposure” -
https://blog.rapid7.com/2014/10/14/palo-alto-networks-userid-credential-
exposure/
3. “Best Practices for Securing User-ID Deployments” -
https://live.paloaltonetworks.com/docs/DOC-7912
4. “User-ID Best Practices” - https://live.paloaltonetworks.com/docs/DOC-6591
5. “PAN-OS Administrator's Guide 11.1 (English) - Client Probing"" -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/user-id/user-id-
concepts/user-mapping/client-probing","Navigate to Network > Network Profiles > Interface Management.
Verify that User-ID is only enabled for interfaces that are both internal and trusted.","PAN released a customer advisory in October of 2014 warning of WMI probing on
untrusted interfaces with User-ID enabled. This can result in theft of the password hash
for the account used in WMI probing.","If WMI probing is enabled without limiting the scope, internet hosts that are sources or
destinations of traffic will be probed, and the password hash of the configured Domain
Admin account can be captured by an outside attacker on such a host."
"2.4","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure that 'Include/Exclude Networks' is used if User-ID is enabled","Level 1","If User-ID is configured, use the Include/Exclude Networks section to limit the User-ID
scope to operate only on trusted networks. There is rarely a legitimate need to allow
WMI probing or other User identification on an untrusted network.

Default Value:
Not configured","","","Navigate to Device > User Identification > User Mapping > Include/Exclude
Networks.
Set all trusted internal networks to have a Discovery value of Include.
Set all untrusted external networks to have a Discovery value of Exclude. Note that any
value in the trusted networks list implies that all other networks are untrusted.","","true","1. Best Practices for Securing User-ID Deployments -
https://live.paloaltonetworks.com/docs/DOC-7912","Navigate to Device > User Identification > User Mapping > Include/Exclude
Networks.
Verify that all trusted internal networks have a Discovery value of Include.
Verify that all untrusted external networks have a Discovery value of Exclude. Note that
any value in the trusted networks list implies that all other networks are untrusted.","The Include/Exclude Networks feature allow users to configure boundaries for the User-
ID service. By using the feature to limit User-ID probing to only trusted internal
networks, the risks of privileged information disclosure through sent probes can be
reduced. Note that if an entry appears in the Include/Exclude Networks section, an
implicit exclude-all-networks policy will take effect for all other networks.","Not restricting the networks subject to User Identification means that the administrative
credentials (userid and password hash) used for this task will transit untrusted networks,
or be sent to untrusted hosts. Capturing these credentials exposes them to offline
cracking attacks."
"2.5","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure that the User-ID Agent has minimal permissions if User-ID is enabled","Level 1","If the integrated (on-device) User-ID Agent is utilized, the Active Directory account for
the agent should only be a member of the Event Log Readers group, Distributed COM
Users group, and Domain Users group. If the Windows User-ID agent is utilized, the
Active Directory account for the agent should only be a member of the Event Log
Readers group, Server Operators group, and Domain Users group.

Default Value:
Not configured","","","Navigate to Active Directory Users and Computers.
Set the service account for the User-ID agent so that it is only a member of the Event
Log Readers, Distributed COM Users, and Domain Users (for the integrated, on-device
User-ID agent) or the Event Log Readers, Server Operators, and Domain Users groups
(for the Windows User-ID agent.)","","true","1. “Best Practices for Securing User-ID Deployments” -
https://live.paloaltonetworks.com/docs/DOC-7912
2. “User-ID Best Practices” - https://live.paloaltonetworks.com/docs/DOC-6591
3. “PAN-OS Administrator's Guide 11.1 (English) - Configure User Mapping Using
the Windows User-ID Agent” - https://docs.paloaltonetworks.com/pan-os/11-
1/pan-os-admin/user-id/map-ip-addresses-to-users/configure-user-mapping-
using-the-windows-user-id-agent
4. “PAN-OS Administrator's Guide 11.1 (English) - Configure User Mapping Using
the PAN-OS Integrated User-ID Agent” - https://docs.paloaltonetworks.com/pan-
os/11-1/pan-os-admin/user-id/map-ip-addresses-to-users/configure-user-
mapping-using-the-pan-os-integrated-user-id-agent","Navigate to Active Directory Users and Computers for the Active Directory under
consideration.
Verify that the service account for the User-ID agent is not a member of any groups
other than Event Log Readers, Distributed COM Users, and Domain Users (for the
integrated, on-device User-ID agent) or Event Log Readers, Server Operators, and
Domain Users (for the Windows User-ID agent.)","As a principle of least privilege, user accounts should have only minimum necessary
permissions. If an attacker compromises a User-ID service account with domain admin
rights, the organization is at far greater risk than if the service account were only
granted minimum rights.","Using accounts with full administrative privileges when those rights are not required is
always a bad idea. This is particularly true for service accounts of this type, which in
many organizations do not see strong passwords or frequent password changes. In
addition, service passwords are stored in the Windows Registry, and are recoverable
with the user of appropriate malicious tools. The principal of least privilege means that
any compromised accounts of this type have less value to an attacker, and expose
fewer assets based on their rights."
"2.6","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure that the User-ID service account does not have interactive logon rights","Level 1","Restrict the User-ID service account from interactively logging on to systems in the
Active Directory domain.

Default Value:
Not configured","","","Navigate to Active Directory Group Policies.
Set Group Policies to restrict the interactive logon privilege for the User-ID service
account.
or
Navigate to Active Directory Managed Service Accounts.
Set Managed Service Accounts to restrict the interactive logon privilege for the User-ID
service account.","","true","1. “Best Practices for Securing User-ID Deployments” -
https://live.paloaltonetworks.com/docs/DOC-7912
2. “PAN-OS Administrator's Guide 11.1 (English) - Configure User Mapping Using
the Windows User-ID Agent” - https://docs.paloaltonetworks.com/pan-os/11-
1/pan-os-admin/user-id/map-ip-addresses-to-users/configure-user-mapping-
using-the-windows-user-id-agent
3. “PAN-OS Administrator's Guide 11.1 (English) - Configure User Mapping Using
the PAN-OS Integrated User-ID Agent” - https://docs.paloaltonetworks.com/pan-
os/11-1/pan-os-admin/user-id/map-ip-addresses-to-users/configure-user-
mapping-using-the-pan-os-integrated-user-id-agent
4. “User-ID Best Practices” - https://live.paloaltonetworks.com/docs/DOC-6591","Navigate to Active Directory Group Policies.
Verify that Group Policies restricts the interactive logon privilege for the User-ID service
account.
or
Navigate to Active Directory Managed Service Accounts.
Verify that Managed Service Accounts restricts the interactive logon privilege for the
User-ID service account.","In the event of a compromised User-ID service account, restricting interactive logins
forbids the attacker from utilizing services such as RDP against computers in the Active
Directory domain of the organization. This reduces the impact of a User-ID service
account compromise.",""
"2.7","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure remote access capabilities for the User-ID service account are forbidden.","Level 1","Restrict the User-ID service account’s ability to gain remote access into the
organization. This capability could be made available through a variety of technologies,
such as VPN, Citrix GoToMyPC, or TeamViewer. Remote services that integrate
authentication with the organization’s Active Directory may unintentionally allow the
User-ID service account to gain remote access.

Default Value:
Not configured","","","Remove this account from all groups that might grant remote access to the network, or
to any network services or hosts. Remediation is operating-system dependent. For
instance, in Windows Active Directory, this account should be removed from any group
that grants the account access to VPN or Wireless access. In addition, domain
administrative accounts by default have remote desktop (RDP) access to all domain
member workstations - this should be explicitly denied for this account.","","true","1. “Best Practices for Securing User-ID Deployments” -
https://live.paloaltonetworks.com/docs/DOC-7912
2. “User-ID Best Practices” - https://live.paloaltonetworks.com/docs/DOC-6591
3. “PAN-OS Administrator's Guide 11.1 (English) - Configure User Mapping Using
the Windows User-ID Agent” - https://docs.paloaltonetworks.com/pan-os/11-
1/pan-os-admin/user-id/map-ip-addresses-to-users/configure-user-mapping-
using-the-windows-user-id-agent
4. “PAN-OS Administrator's Guide 11.1 (English) - Configure User Mapping Using
the PAN-OS Integrated User-ID Agent” - https://docs.paloaltonetworks.com/pan-
os/11-1/pan-os-admin/user-id/map-ip-addresses-to-users/configure-user-
mapping-using-the-pan-os-integrated-user-id-agent","Auditing is operating-system dependent. For instance, in Windows Active Directory, this
account should not be included in any group that grants the account access to VPN or
Wireless access. In addition, domain administrative accounts should not have remote
desktop (RDP) access to all domain member workstations.","In the event of a compromised User-ID service account, restricting the account’s ability
to remotely access resources within the organization’s internal network reduces the
impact of a service account compromise.",""
"2.8","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure that security policies restrict User-ID Agent traffic from crossing into untrusted zones","Level 1","Create security policies to deny Palo Alto User-ID traffic originating from the interface
configured for the UID Agent service that are destined to any untrusted zone.","","","Navigate to Device > Setup > Services > Services Features > Service Route
Configuration > Customize.
Click on the protocol in use (IPv4 and/or IPv6).
Click UID Agent.
Click on the address object for the UID Agent's IP address.
Set SOURCE/NAME to 'Deny msrpc to untrusted'.
Set SOURCE/ZONE to 'INSIDE'.
Set SOURCE/Address to the Address object for the UID Agent.
Set DESTINATION/ZONE to 'GUEST' and 'OUTSIDE'.
Set DESTINATION/Address to 'any'.
Set DESTINATION/Application to 'msrpc'.
Set DESTINATION/Service to 'application-default'.
Set DESTINATION/Action to 'Block' (red circle with diagonal line).","","true","1. “Best Practices for Securing User-ID Deployments” -
https://live.paloaltonetworks.com/docs/DOC-7912
2. “User-ID Best Practices” - https://live.paloaltonetworks.com/docs/DOC-6591
3. “PAN-OS Administrator's Guide 11.1 (English) - Configure User Mapping Using
the Windows User-ID Agent” - https://docs.paloaltonetworks.com/pan-os/11-
1/pan-os-admin/user-id/map-ip-addresses-to-users/configure-user-mapping-
using-the-windows-user-id-agent
4. “PAN-OS Administrator's Guide 11.1 (English) - Configure User Mapping Using
the PAN-OS Integrated User-ID Agent” - https://docs.paloaltonetworks.com/pan-
os/11-1/pan-os-admin/user-id/map-ip-addresses-to-users/configure-user-
mapping-using-the-pan-os-integrated-user-id-agent","Navigate to Device > Setup > Services > Services Features > Service Route
Configuration > Customize.
Click on the protocol in use (IPv4 and/or IPv6).
Click UID Agent.
Click on the address object for the UID Agent's IP address.
Verify SOURCE/NAME is set to 'Deny msrpc to untrusted'.
Verify SOURCE/ZONE is set to 'INSIDE'.
Verify SOURCE/Address is set to the Address object for the UID Agent.
Verify DESTINATION/ZONE is set to 'GUEST' and 'OUTSIDE'.
Verify DESTINATION/Address is set to 'any'.
Verify DESTINATION/Application is set to 'msrpc'.
Verify DESTINATION/Service is set to 'application-default'.
Verify DESTINATION/Action is set to 'Block' (red circle with diagonal line).","If User-ID and WMI probes are sent to untrusted zones, the risk of privileged information
disclosure exists. The information disclosed can include the User-ID Agent service
account name, domain name, and encrypted password hashes sent in User-ID and
WMI probes. To prevent this exposure, msrpc traffic originating from the firewall to
untrusted networks should be explicitly denied. This security policy should be in effect
even for environments not currently using WMI probing to help guard against possible
probe misconfigurations in the future.
This setting is a ""fail safe"" to prevent exposure of this information if any of the other
WMI User control settings are misconfigured.",""
"3.1","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure a fully-synchronized High Availability peer is configured","Level 1","Ensure a High Availability peer is fully synchronized and in a passive or active state.

Default Value:
Not Configured","","","Navigate to Device > High Availability > HA Communications.
Click HA Communications. Click Data Link (HA2). Select the correct interface.
Select the desired protocol (IPv4 or IPv6). Select the correct Transport. Set the
Enable Session Synchronization box to be checked.
Choose Save Configuration.","","true","1. “PAN-OS Administrator's Guide 11.1 (English) - High Availability"" -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-
help/device/device-high-availability","Navigate to Device > High Availability > HA Communications.
In the HA Communications. >Data Link (HA2) section, verify that the correct
interface is selected. Verify the desired protocol (IPv4 or IPv6) is selected. Verify
the correct Transport is selected. Verify the Enable Session Synchronization box is
checked.","To ensure availability of both the firewall and the resources it protects, a High
Availability peer is required. In the event a single firewall fails, or when maintenance
such as a software update is required, the HA peer can be used to automatically fail
over session states and maintain overall availability","Not configuring High Availability (HA) correctly directly impacts the Availability of the
system. With HA in place, standard maintenance such as OS updates, network and
power cabling can be accomplished with no outage or a minimum impact."
"3.2","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure 'High Availability' requires Link Monitoring and/or Path Monitoring","Level 1","Configure Link Monitoring and/or Path Monitoring under High Availability options. If Link
Monitoring is utilized, all links critical to traffic flow should be monitored.

Default Value:
Not Configured","","","To set Link Monitoring from GUI:
Navigate to Device > High Availability > Link and Path Monitoring. Click
Link Monitoring. Set the correct interfaces to the Link Group and Group Failure
Conditions. Click Link Monitoring. Set Failure Condition to Any. Check Enabled
button.
To set Path Monitoring from GUI:
Navigate to Device > High Availability > Link and Path Monitoring. Click
Path Monitoring. Set Option correctly. Set Failure Condition to Any. Set Name,
IP Address, Failure Condition correctly. Set Default setting to Any. Check
Enabled button.","","true","1. “PAN-OS Administrator's Guide 11.1 (English) - High Availability"" -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-
help/device/device-high-availability","To verify Link Monitoring from GUI:
Navigate to Device > High Availability > Link and Path Monitoring. In the
Link Monitoring section, verify the correct interfaces are in the Link Group and
Group Failure Conditions Under the Link Monitoring section, verify Failure
Condition is set to Any. Verify Enabled button is checked.
To verify Path Monitoring from GUI:
Navigate to Device > High Availability > Link and Path Monitoring. In the
Path Monitoring section, verify Option is set correctly. Verify Failure Condition is
set to Any. Verify Name, IP Address, Failure Condition is set correctly. Verify
Default setting is set to Any. Verify Enabled button is checked.","If Link or Path Monitoring is not enabled, the standby router will not automatically take
over as active if a critical link fails on the active firewall. Services through the firewall
could become unavailable as a result.","Not configuring High Availability (HA) correctly directly impacts the Availability of the
system. With HA in place, standard maintenance such as OS updates, network and
power cabling can be accomplished with no outage or a minimum impact.
Without Link and Path monitoring in particular, failover will only occur when the primary
device fails completely. Link and path monitoring permits failover if a critical interface
loses link (either due to cabling or an upstream switch failover), or if a route or path fails
(indicating an upstream issue that affects local Layer 3)."
"3.3","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure 'Passive Link State' and 'Preemptive' are configured appropriately","Level 1","Set the Passive Link State to auto, and uncheck the Preemptive option to disable it.

Default Value:
Not Configured","","","To set Active/Passive Settings correctly:
Navigate to Device > High Availability > General > Active/Passive
Settings.
Set Passive Link State to auto.
To set Election Settings correctly:
Navigate to Device > High Availability > Election Settings.
Set Preemptive to be disabled.","","true","1. “PAN-OS Administrator's Guide 11.1 (English) - High Availability"" -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-
help/device/device-high-availability","To ensure Active/Passive Settings are configured correctly:
Navigate to Device > High Availability > General > Active/Passive
Settings.
Verify Passive Link State is set to auto.
To ensure Election Settings are configured correctly:
Navigate to Device > High Availability > Election Settings.
Verify Preemptive is disabled.","Simultaneously enabling the 'Preemptive' option and setting the 'Passive Link State'
option to 'Shutdown' could cause a 'preemptive loop' if Link and Path Monitoring are
both configured. This will negatively impact the availability of the firewall and network
services, should a monitored failure occur.","Incorrectly configuring this setting will adversely affect availability, rather than positively
affect it."
"4.1","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure 'Antivirus Update Schedule' is set to download and install updates hourly","Level 1","Set Antivirus Update Schedule to download and install updates hourly.

Default Value:
Not Configured","","","Navigate to Device > Dynamic Updates > Antivirus Update Schedule.
Set Action to Download and Install.
Set Recurrence to Hourly.","","true","1. “Tips for Managing Content Updates” -
https://live.paloaltonetworks.com/docs/DOC-1578
2. “PAN-OS Administrator's Guide 9.0 (English) -Dynamic Content Updates"" -
https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/software-and-
content-updates/dynamic-content-updates.html
3. “PAN-OS Administrator's Guide 9.0 (English) - Install Content Updates"" -
https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/software-and-
content-updates/install-content-and-software-updates.html","Navigate to Device > Dynamic Updates > Antivirus Update Schedule.
Verify that Action is set to Download and Install.
Verify that Recurrence is set to Hourly.","New antivirus definitions may be released at any time. With an hourly update schedule,
the firewall can ensure threats with new definitions are quickly mitigated. A daily update
schedule could leave an organization vulnerable to a known virus for nearly 24 hours, in
a worst-case scenario. Setting an appropriate threshold value reduces the risk of a bad
definition file negatively affecting traffic.",""
"4.2","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure 'Applications and Threats Update Schedule' is set to download and install updates at daily or shorter intervals","Level 1","Set the Applications and Threats Update Schedule to download and install updates at
daily or shorter intervals.

Default Value:
This setting is by default set to Weekly.","","","Navigate to Device > Dynamic Updates > Application and Threats Update
Schedule.
Set Action to Download and Install.
Set Recurrence to Daily, Hourly or Every 30 Minutes","","true","1. “Tips for Managing Content Updates” -
https://live.paloaltonetworks.com/docs/DOC-1578
2. “PAN-OS Administrator's Guide 9.0 (English) -Dynamic Content Updates"" -
https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/software-and-
content-updates/dynamic-content-updates.html
3. “PAN-OS Administrator's Guide 9.0 (English) - Install Content Updates"" -
https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/software-and-
content-updates/install-content-and-software-updates.html","Navigate to Device > Dynamic Updates > Application and Threats Update
Schedule.
Verify that Action is set to Download and Install.
Verify that Recurrence is set to Daily, Hourly or Every 30 Minutes","New Applications and Threats file versions may be released at any time. With a
frequent update schedule, the firewall can ensure threats with new signatures are
quickly mitigated, and the latest application signatures are applied.",""
"5.1","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure that WildFire file size upload limits are maximized","Level 1","The default file size limits on the firewall are designed to include the majority of malware
in the wild (which is smaller than the default size limits) and to exclude large files that
are very unlikely to be malicious and that can impact WildFire file-forwarding capacity.

Default Value:
In PAN-OS 9.x, the default file sizes for WildFire are:
• pe (Portable Executable) - 16MB
• apk (Android Application)- 10MB
• pdf (Portable Document Format) - 3072KB
• ms-office (Microsoft Office) — 16384KB
• jar (Packaged Java class file) — 5MB
• flash (Adobe Flash) — 5MB
• MacOSX (DMG/MAC-APP/MACH-O PKG files) — 10MB
• archive (RAR and 7z files) — 50MB
• linux (ELF files) — 50MB
• script (JScript, VBScript, PowerShell, and Shell Script)- 20KB","","","Navigate to Device > Setup > WildFire.
Click the General Settings edit icon.
Set the maximum size for each file type are larger than the defaults, to a size that is as
large enough to account for ""large"" files, but not large enough to affect performance of
the hardware.
In PAN-OS 9.x and higher, the default file sizes for WildFire are:
• pe (Portable Executable) - 16MB
• apk (Android Application)- 10MB
• pdf (Portable Document Format) - 3072KB
• ms-office (Microsoft Office) — 16384KB
• jar (Packaged Java class file) — 5MB
• flash (Adobe Flash) — 5MB
• MacOSX (DMG/MAC-APP/MACH-O PKG files) — 10MB
• archive (RAR and 7z files) — 50MB
• linux (ELF files) — 50MB
• script (JScript, VBScript, PowerShell, and Shell Script)- 20KB
In PAN-OS 9.x and higher, the maximum file sizes for Wildfire are:
• pe (Portable Executable) - 50MB
• apk (Android Application)- 50MB
• pdf (Portable Document Format) - 51200KB
• ms-office (Microsoft Office) — 51200KB
• jar (Packaged Java class file) — 20MB
• flash (Adobe Flash) — 10MB
• MacOSX (DMG/MAC-APP/MACH-O PKG files) — 50MB
• archive (RAR and 7z files) — 50MB
• linux (ELF files) — 50MB
• script (JScript, VBScript, PowerShell, and Shell Script)- 4096KB","","true","1. “How to Configure WildFire” - https://live.paloaltonetworks.com/docs/DOC-3252
2. https://docs.paloaltonetworks.com/wildfire/10-2/wildfire-admin/wildfire-
deployment-best-practices/wildfire-best-practices","Navigate to Device > Setup > WildFire.
Navigate to the General Settings sections.
Verify the maximum size for each file type at the defaults or larger, to a size that is as
large enough to account for ""large"" files, but not large enough to affect performance of
the hardware.","Because the firewall has a specific capacity reserved to forward files for WildFire
analysis, forwarding high numbers of large files can cause the firewall to skip forwarding
of some files. This condition occurs when the maximum file size limits are configured for
a file type that is traversing the firewall at a high rate. In this case, a potentially
malicious file might not get forwarded for WildFire analysis. Consider this possible
condition if you would like to increase the size limit for files other than PEs beyond their
default size limit.","Using larger file filtering can cause the system to skip files in the event multiple larger
files are sent."
"5.2","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure a WildFire Analysis profile is enabled for all security policies","Level 1","Ensure that all files traversing the firewall are inspected by WildFire by setting a Wildfire
file blocking profile on all security policies.

Default Value:
Not Configured","","","To Set File Blocking Profile:
• Navigate to Objects > Security Profiles > WildFire Analysis Profile.
• Create a WildFire profile that has 'Application Any', 'File Types Any', and
'Direction Both'
To Set WildFire Analysis Rules:
• Navigate to Policies > Security.
• For each Security Policy Rule where the action is ""Allow"", Navigate to Actions >
Profile Setting > WildFire Analysis and set a WildFire Analysis profile.
Group Profiles can also be used. To take this approach:
• Navigate to Objects > Security Profile Groups. Create a Security Profile
Group, and ensure that (among other settings) the Wildfire Analysis
Profile is set to the created profile.
• Navigate to Policies > Security. For each Security Policy Rule where the
action is ""Allow"", Navigate to Actions > Profile Setting. Modify the Profile
Type to Group, and set the Group Profile to the created Security Profile Group.","","true","1. “Wildfire Administrator's Guide 9.0 (English)"" -
https://docs.paloaltonetworks.com/wildfire/9-0/wildfire-admin.html","To verify WildFire Analysis Profile:
• Navigate to Objects > Security Profiles > WildFire Analysis Profile
verify that a profile exists.
To verify File Blocking Rules:
• For each Security Policy were the action is set to Allow, edit the Rule and
navigate to Actions > Profile Setting. Ensure that the WildFire
Analysis is set to Allow and verify that a profile is set.
If Group Profiles are used:
• Navigate to Policies > Security
• For each Security Policy were the action is set to Allow, edit the Rule and
navigate to Actions > Profile Setting. Ensure that the Profile Type is set
to Group.
• Navigate to Objects > Security Profile Groups. Open the Security Profile Group
used above, and ensure that the Wildfire Analysis Profile is set.","Traffic matching security policies that do not include a WildFire file blocking profile will
not utilize WildFire for file analysis. Wildfire analysis is one of the key security measures
available on this platform. Without Wildfire analysis enabled, inbound malware can only
be analyzed by signature - which industry wide is roughly 40-60% effective. In a
targeted attack, the success of signature-based-only analysis drops even further.",""
"5.3","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure forwarding of decrypted content to WildFire is enabled","Level 1","Allow the firewall to forward decrypted content to WildFire. Note that SSL Forward-
Proxy must also be enabled and configured for this setting to take effect on inside-to-
outside traffic flows.

Default Value:
Not Configured","","","Navigate to Device > Setup > Content-ID > Content-ID Settings.
Set Allow forwarding of decrypted content to be checked. Note that SSL
Forward Proxy must be configured for this setting to be effective.","","true","1. “WildFire Fails Forwarding File to Cloud for Encrypted Traffic” -
https://live.paloaltonetworks.com/docs/DOC-6845
2. “Wildfire Administrator's Guide 9.0 (English) - Forward Decrypted SSL Traffic for
Wildfire Analysis"" - https://docs.paloaltonetworks.com/wildfire/9-0/wildfire-
admin/submit-files-for-wildfire-analysis/forward-decrypted-ssl-traffic-for-wildfire-
analysis.html#
3. “Wildfire Administrator's Guide 9.0 (English) - Wildfire Best Practices"" -
https://docs.paloaltonetworks.com/wildfire/9-0/wildfire-admin/wildfire-deployment-
best-practices/wildfire-best-practices.html#","Navigate to Device > Setup > Content-ID > Content-ID Settings.
Verify that Allow forwarding of decrypted content is checked.","As encrypted Internet traffic continues to proliferate, WildFire becomes less effective
unless it is allowed to act on decrypted content. For example, if a user downloads a
malicious pdf over SSL, WildFire can only provide analysis if 1) the session is decrypted
by the firewall and 2) forwarding of decrypted content is enabled. In today's internet,
roughly 70-80% of all user traffic is encrypted. If Wildfire is not configured to analyze
encrypted content, the effectiveness of Wildfire is drastically reduced.",""
"5.4","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure all WildFire session information settings are enabled","Level 1","Enable all options under Session Information Settings for WildFire.

Default Value:
All Session Information Settings are enabled by default. These include:
• Source IP
• Source port
• Destination IP
• Destination port
• Virtual System
• Application
• User
• URL
• File name
• Email sender
• Email recipient
• Email subject","","","Navigate to Device > Setup > WildFire > Session Information Settings.
Set every option to be enabled.","","true","1. “Wildfire Administrator's Guide 9.0 (English)"" -
https://docs.paloaltonetworks.com/wildfire/9-0/wildfire-admin.html#
2. “Wildfire Administrator's Guide 9.0 (English) - Wildfire Best Practices"" -
/https://docs.paloaltonetworks.com/wildfire/9-0/wildfire-admin/wildfire-
deployment-best-practices/wildfire-best-practices.html","Navigate to Device > Setup > WildFire > Session Information Settings.
Verify that every option is enabled.","Permitting the firewall to send all of this information to WildFire creates more detailed
reports, thereby making the process of tracking down potentially infected devices more
efficient. This could prevent an infected system from further infecting the environment.
Environments with security policies restricting sending this data to the WildFire cloud
can instead utilize an on-premises WildFire appliance. In addition, risk can be analyzed
in the context of the destination host and user account, either during analysis or during
incident response.",""
"5.5","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure alerts are enabled for malicious files detected by WildFire","Level 1","Configure WildFire to send an alert when a malicious or greyware file is detected. This
alert could be sent by whichever means is preferable, including email, SNMP trap, or
syslog message.
Alternatively, configure the WildFire cloud to generate alerts for malicious files. The
cloud can generate alerts in addition to or instead of the local WildFire implementation.
Note that the destination email address of alerts configured in the WildFire cloud portal
is tied to the logged in account, and cannot be modified. Also, new systems added to
the WildFire cloud portal will not be automatically set to email alerts.

Default Value:
Not Configured","","","From GUI, configure some combination of the following Server Profiles:
Configure the Email Server: Select Device > Server Profiles > Email Click Add
Enter a name for the Profile. Select the virtual system from the Location drop down
menu (if applicable) Click Add
Configure the Syslog Server: Select Device > Server Profiles > Syslog > Add
Enter Name, Display Name, Syslog Server, Transport, Port, Format,
Facility Click OK Click Commit to save the configuration
Configure the SMTP Server: Select Device > Server Profiles > Email Select
Add, Name, Display Name, From, To, Additional Recipients, Gateway IP
or Hostname Click OK Click Commit to save the configuration
Navigate to Objects, Log Forwarding Choose Add, set the log type to ""wildfire"", add
the filter ""(verdict neq benign)"", then add log destinations for SNMP, Syslog, Email or
HTTP as required.","","true","1. “WildFire Email Alerts: Subscribe or Add Additional Recipients” -
https://live.paloaltonetworks.com/docs/DOC-7740
2. “Wildfire Administrator's Guide 9.0 (English)"" -
https://docs.paloaltonetworks.com/wildfire/9-0/wildfire-admin.html","Navigate to Objects > Log Forwarding.
Verify that the WildFire log type is configured to generate alerts using the desired
alerting mechanism(s).","WildFire analyzes files that have already been downloaded and possibly executed. A
WildFire verdict of malicious indicates that a computer could already be infected. In
addition, because WildFire only analyzes files it has not already seen that were not
flagged by the firewall’s antivirus filter, files deemed malicious by WildFire are more
likely to evade detection by desktop antivirus products.",""
"5.6","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure 'WildFire Update Schedule' is set to download and install updates in real-time","Level 1","Set the WildFire update schedule to download and install updates in real-time.

Default Value:
Not Configured","","","Navigate to Device > Dynamic Updates > WildFire Update Schedule.
Set Recurrence is set to Real-time.","","true","1. “Wildfire What's New in 10.0 (English)"" -
https://docs.paloaltonetworks.com/wildfire/u-v/wildfire-whats-new/wildfire-
features-in-panos-100/wildfire-real-time-signature-updates
2. “How to Configure WildFire” - https://live.paloaltonetworks.com/docs/DOC-3252
3. “Tips for Managing Content Updates” -
https://live.paloaltonetworks.com/docs/DOC-1578","Navigate to Device > Dynamic Updates > WildFire Update Schedule.
Verify that Recurrence is set to Real-time.","WildFire definitions may contain signatures to block immediate, active threats to the
environment. With updates in real-time, the firewall can ensure threats with new
definitions are quickly mitigated.",""
"5.7","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Choosing Wildfire public cloud region","Level 2","By default, all relevant files are uploaded to Wildfire datacenter located in US. Palo Alto
Networks has been adding more WildFire regional clouds around the world. From
having just 3 regional clouds back in PanOS 8.x, now to more than 10 regional clouds
all over the world.

Default Value:
wildfire.paloaltonetworks.com","","","Navigate to Device > Setup > WildFire.
Navigate to the General Settings sections.
Click the General Settings edit icon.
Change the WildFire Public Cloud to your appropriate region.","","true","1. ""List of Available Wildfire Regions"" -
https://docs.paloaltonetworks.com/advanced-wildfire/administration/advanced-
wildfire-overview/advanced-wildfire-deployments/advanced-wildfire-global-cloud
2. ""Announcements as More Regions are Added"" -
https://docs.paloaltonetworks.com/wildfire","Navigate to Device > Setup > WildFire.
Navigate to the General Settings sections.
Verify that WildFire Public Cloud is set to your appropriate region.","Depending on regulations, files is only allowed to be uploaded to local country / region.
Besides, uploading to local country or even nearest country decreases file uploading
speed.
Refer to the available regions in the references below.","With default values, all relevant files are uploaded to wildfire.paloaltonetworks.com
which is located in US."
"6.1","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure that antivirus profiles are set to reset-both on all decoders except 'imap' and 'pop3'","Level 1","Configure antivirus profiles to a value of 'reset-both' for all decoders except imap and
pop3 under both Action and WildFire Action. If required by the organization's email
implementation, configure imap and pop3 decoders to 'alert' under both Action and
WildFire Action.

Default Value:
Not Configured","","","Navigate to Objects > Security Profiles > Antivirus.
Set antivirus profiles to have all decoders set to reset-both for both Action and
Wildfire Action. If imap and pop3 are required in the organization, set the imap and
pop3 decoders to alert for both Action and Wildfire Action.","","true","1. “Threat Prevention Deployment Tech Note” -
https://live.paloaltonetworks.com/docs/DOC-3094
2. “PAN-OS Administrator's Guide 11.1 (English) - Security Profiles” -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/policy/security-
profiles
3. ""KB on reset-server, reset-client or silent drop"" -
https://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA10g000000
ClTaCAK","Navigate to Objects > Security Profiles > Antivirus
Verify that antivirus profiles have all decoders set to reset-both for both Action and
Wildfire Action. If imap and pop3 are required in the organization, verify that the
imap and pop3 decoders are set to alert for both Action and Wildfire Action.","Antivirus signatures produce low false positives. By blocking any detected malware
through the specified decoders, the threat of malware propagation through the firewall is
greatly reduced. It is recommended to mitigate malware found in pop3 and imap
through a dedicated antivirus gateway. Due to the nature of the pop3 and imap
protocols, the firewall is not able to block only a single email message containing
malware. Instead, the entire session would be terminated, potentially affecting benign
email messages.",""
"6.2","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure a secure antivirus profile is applied to all relevant security policies","Level 1","Create a secure antivirus profile and apply it to all security policies that could pass
HTTP, SMTP, IMAP, POP3, FTP, or SMB traffic. The antivirus profile may be applied to
the security policies directly or through a profile group.

Default Value:
No Antivirus Profiles are enabled on any default or new Security Policy","","","Navigate to Policies > Security . For each policy, navigate to [Policy Name] >
Actions
Set an Antivirus profile or a Profile Group containing an AV profile for each
security policy passing traffic - regardless of protocol.","","true","1. “PAN-OS Administrator's Guide 11.1 (English) - Security Policies ” -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/policy/security-
policy
2. “PAN-OS Administrator's Guide 11.1 (English) - Security Profiles” -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/policy/security-
profiles","Navigate to Policies > Security . For each policy, navigate to [Policy Name] >
Actions Verify there is a secure Antivirus profile applied to all security policies
passing traffic - regardless of protocol. This can be set by Profiles or by Profile Group.","By applying a secure antivirus profile to all applicable traffic, the threat of malware
propagation through the firewall is greatly reduced. Without an antivirus profile assigned
to any potential hostile zone, the first protection in the path against malware is removed,
leaving in most cases only the desktop endpoint protection application to detect and
remediate any potential malware.","Not having an AV Profile on a Security Policy allows signature-based malware to transit
the security boundary without blocks or alerts. In most cases this leaves only the
Endpoint Security application to block or alert malware."
"6.3","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure an anti-spyware profile is configured to block on specified spyware severity levels, categories, and threats","Level 1","If a single rule exists within the anti-spyware profile, configure it to block on Critical,
High, and Medium spyware severity level, any category, and any threat. If multiple rules
exist within the anti-spyware profile, ensure all spyware categories, threats, and severity
levels (Critical, High, and Medium) are set to be blocked. Additional rules may exist for
packet capture or exclusion purposes.

Default Value:
Two Anti-Spyware Security Profiles are configured by default ""strict"" and ""default"".","","","Navigate to Objects > Security Profiles > Anti-Spyware. Click on existing
profile in used or create a new profile.
Navigate to Signature Policies tab. Add new policy by giving it a name Policy
Name.
Set a Policy Name exists within the anti-spyware profile that is configured to perform
the reset-both on Critical, High, and Medium Severity level, any
Category, and any Threat Name.","","true","1. ""PAN OS Administrator's Guide 11.1 (English) - Anti-Spyware Profile"" -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-
help/objects/objects-security-profiles-anti-spyware-profile","Navigate to Objects > Security Profiles > Anti-Spyware. Click on existing
profile in used or create a new profile.
Navigate to Signature Policies tab. Add new policy by giving it a name Policy
Name.
Verify a Policy Name exists within the anti-spyware profile that is configured to perform
the reset-both on Critical, High, and Medium Severity level, any
Category, and any Threat Name.","Requiring a blocking policy for all spyware threats, categories, and severities (Critical,
High, and Medium) reduces the risk of spyware traffic from successfully exiting the
organization. Without an anti-spyware profile assigned to any potential hostile zone, the
first protection in the path against malware is removed, leaving in most cases only the
desktop endpoint protection application to detect and remediate any potential spyware.",""
"6.4","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure DNS sinkholing is configured on all anti-spyware profiles in use","Level 1","Configure DNS sinkholing for all anti-spyware profiles in use. All internal requests to the
selected sinkhole IP address must traverse the firewall. Any device attempting to
communicate with the DNS sinkhole IP address should be considered infected.

Default Value:
Not Configured","","","Navigate to Objects > Security Profiles > Anti-Spyware.
Within the each anti-spyware profile, under its DNS Policies tab, set the Signature
Source List: default-paloalto-dns should have as its Policy Action set to
sinkhole If licensed, the DNS Security should have as its Policy Action set to
sinkhole
Verify the 'Sinkhole IPv4' IP address is correct. This should be set to
sinkhole.paloaltnetworks.com, or if an internal host is set then that host IP or
FQDN should be in that field
Verify the 'Sinkhole IPv6' IP address is correct. This should be set to IPv6 Loopback
IP (::1), or if an internal DNS Sinkhole host is set then that host IP or FQDN should
be in that field
Navigate to Policies > Security Policies For each outbound security Policy, in
the Actions tab, set the Anti-Spyware setting to include the Spyware Profile created,
either explicitly or as a Group Profile","","true","1. “How to Deal with Conficker using DNS Sinkhole” -
https://live.paloaltonetworks.com/docs/DOC-6628
2. “Threat Prevention Deployment Tech Note” -
https://live.paloaltonetworks.com/docs/DOC-3094
3. ""PAN OS Administrator's Guide 11.1 (English) - Anti-Spyware Profile"" -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-
help/objects/objects-security-profiles-anti-spyware-profile","Navigate to Objects > Security Profiles > Anti-Spyware.
Within the each anti-spyware profile, under its DNS Policies tab, verify the Signature
Source List: default-paloalto-dns should have as its Policy Action set to
sinkhole If licensed, the DNS Security should have as its Policy Action set to
sinkhole
Verify the 'Sinkhole IPv4' IP address is correct. This should be set to
sinkhole.paloaltnetworks.com, or if an internal host is set then that host IP or
FQDN should be in that field
Verify the 'Sinkhole IPv6' IP address is correct. This should be set to IPv6 Loopback
IP (::1), or if an internal DNS Sinkhole host is set then that host IP or FQDN should
be in that field
Navigate to Policies > Security Policies For each outbound security Policy, in
the Actions tab, verify that the Anti-Spyware setting includes the Spyware Profile
created, either explicitly or as a Group Profile
To verify correct operation of DNS Security, from an internal station make a DNS
request to each of the following hosts:
• test-malware.testpanw.com to test Malware DNS Signature checks
• test-c2.testpanw.com to test C2 DNS Signature checks
• test-dga.testpanw.com to test DGA (Domain Generation Algorithm) DNS attack
checks
• test-dnstun.testpanw.com to test DNS Tunneling attack checks Each of
these DNS requests should be redirected to the configured DNS Sinkhole server
IP address Each of these DNS requests should appear in the firewall logs, under
Monitor > Logs > Threat. If configured, each of these requests should
generate an alert in the organization's SIEM.","DNS sinkholing helps to identify infected clients by spoofing DNS responses for
malware domain queries. Without sinkholing, the DNS server itself may be seen as
infected, while the truly infected device remains unidentified. In addition, sinkholing also
ensures that DNS queries that might be indicators of compromise do not transit the
internet, where they could be potentially used to negatively impact the ""ip reputation"" of
the organization's internet network subnets.",""
"6.5","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure a secure anti-spyware profile is applied to all security policies permitting traffic to the Internet","Level 1","Create one or more anti-spyware profiles and collectively apply them to all security
policies permitting traffic to the Internet. The anti-spyware profiles may be applied to the
security policies directly or through a profile group.

Default Value:
Not Configured","","","Navigate to Objects > Security Profiles > Anti-Spyware.
Also navigate to Policies > Security.
Set one or more anti-spyware profiles to collectively apply to all inside to outside traffic
from any address to any address and any application and service.","","true","1. “Threat Prevention Deployment Tech Note” -
https://live.paloaltonetworks.com/docs/DOC-3094
2. “PAN-OS Administrator's Guide 9.0 (English) - Security Profiles” -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/policy/security-
profiles","Navigate to Objects > Security Profiles > Anti-Spyware.
Also navigate to Policies > Security.
Verify there are one or more anti-spyware profiles that collectively apply to all inside to
outside traffic from any address to any address and any application and service.","By applying secure anti-spyware profiles to all applicable traffic, the threat of sensitive
data exfiltration or command-and-control traffic successfully passing through the firewall
is greatly reduced. Anti-spyware profiles are not restricted to particular protocols like
antivirus profiles, so anti-spyware profiles should be applied to all security policies
permitting traffic to the Internet. Assigning an anti-spyware profile to each trusted zone
will quickly and easily identify trusted hosts that have been infected with spyware, by
identifying the infection from their outbound network traffic. In addition, that outbound
network traffic will be blocked by the profile.",""
"6.6","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure a Vulnerability Protection Profile is set to block attacks against critical and high vulnerabilities, and set to default on medium, low, and informational vulnerabilities","Level 1","Configure a Vulnerability Protection Profile set to block attacks against any critical or
high vulnerabilities, at minimum, and set to default on any medium, low, or informational
vulnerabilities. Configuring an alert action for low and informational, instead of default,
will produce additional information at the expense of greater log utilization.

Default Value:
Two Vulnerability Protection Profiles are configured by default - ""strict"" and ""default"".","","","Navigate to Objects > Security Profiles > Vulnerability Protection.
Set a Vulnerability Protection Profile to block attacks against any critical or high
vulnerabilities (minimum), and to default on attacks against any medium, low, or
informational vulnerabilities.","","true","1. “Threat Prevention Deployment Tech Note” -
https://live.paloaltonetworks.com/docs/DOC-3094
2. “PAN-OS Administrator's Guide 11.1 (English) - Security Profiles” -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/policy/security-
profiles","Navigate to Objects > Security Profiles > Vulnerability Protection.
Verify a Vulnerability Protection Profile is set to block attacks against any critical or high
vulnerabilities (minimum), and set to default on attacks against any medium, low, or
informational vulnerabilities.","A Vulnerability Protection Profile helps to protect assets by alerting on, or blocking,
network attacks. The default action for attacks against many critical and high
vulnerabilities is to only alert on the attack - not to block.","Not configuring a Vulnerability Protection Profile means that network attacks will not be
logged, alerted on or blocked."
"6.7","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure a secure Vulnerability Protection Profile is applied to all security rules allowing traffic","Level 1","For any security rule allowing traffic, apply a securely configured Vulnerability Protection
Profile. Careful analysis of the target environment should be performed before
implementing this configuration, as outlined by PAN’s “Threat Prevention Deployment
Tech Note” in the references section.

Default Value:
Not Configured","","","Navigate to Policies > Security.
For each Policy, under the Actions tab, select Vulnerability Protection.
Set it to use either the 'Strict' or the 'Default' profile, or a custom profile that complies
with the organization's policies, legal and regulatory requirements.","","true","1. “Threat Prevention Deployment Tech Note” -
https://live.paloaltonetworks.com/docs/DOC-3094
2. “PAN-OS Administrator's Guide 11.1 (English) - Security Policies” -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/policy/security-
policy
3. “PAN-OS Administrator's Guide 11.1 (English) - Security Profiles” -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/policy/security-
profiles","Navigate to Policies > Security.
For each Policy, under the Actions tab, select Vulnerability Protection.
Verify either the 'Strict' or the 'Default' profile is selected, or a custom profile that
complies with the organization's policies, legal and regulatory requirements.","A Vulnerability Protection Profile helps to protect assets by alerting on, or blocking
network attacks. By applying a secure Vulnerability Protection Profile to all security rules
permitting traffic, all network traffic traversing the firewall will be inspected for attacks.
This protects both organizational assets from attack and organizational reputation from
damage.
Note that encrypted sessions do not allow for complete inspection.","Not configuring a Vulnerability Protection Profile means that network attacks will not be
logged, alerted on or blocked."
"6.8","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure that PAN-DB URL Filtering is used","Level 1","Configure the device to use PAN-DB URL Filtering instead of BrightCloud.

Default Value:
Not Configured","","","Navigate to Device > Licenses.
Click on PAN-DB URL Filtering.
Set Active to Yes.","","true","1. “PAN-OS Administrator's Guide 9.0 (English) - URL Filtering” -
https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/url-filtering.html
2. “PAN-OS Administrator's Guide 9.0 (English) - URL Filtering Best Practices"" -
https://docs.paloaltonetworks.com/advanced-url-
filtering/administration/configuring-url-filtering/url-filtering-best-practices","Navigate to Device > Licenses.
Click on PAN-DB URL Filtering.
Verify Active is set to Yes.","Standard URL filtering provides protection against inappropriate and malicious URLs
and IP addresses. PAN-DB URL Filtering is slightly less granular than the BrightCloud
URL filtering. However the PAN-DB Filter offers additional malware protection and PAN
threat intelligence by using the Wildfire service as an additional input, which is currently
not available in the BrightCloud URL Filtering license. This makes the PAN-DB filter
more responsive to specific malware ""campaigns"".","Not having an effective URL Filtering configuration can leave an organization open to
legal action, internal HR issues, non-compliance with regulatory policies or productivity
loss."
"6.9","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure that URL Filtering uses the action of “block” or “override” on the URL categories","Level 1","Ideally, deciding which URL categories to block, and which to allow, is a joint effort
between IT and another entity of authority within an organization—such as the legal
department or administration. For most organizations, blocking or requiring an override
on the following categories represents a minimum baseline: adult, hacking, command-
and-control, copyright-infringement, extremism, malware, phishing, proxy-avoidance-
and-anonymizers, and parked. Some organizations may add ""unknown"" and ""dynamic-
dns"" to this list, at the expense of some support calls on those topics.

Default Value:
Not Configured","","","Navigate to Objects > Security Profiles > URL Filtering.
Set a URL filter so that all URL categories designated by the organization are listed.
Navigate to the Actions tab.
Set the action to Block.","","true","1. “PAN-OS Administrator's Guide 11.1 (English) - Security Profiles” -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/policy/security-
profiles
2. “PAN-OS Administrator's Guide 9.0 (English) - URL Filtering” -
https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/url-filtering.html
3. “PAN-OS Admin Guide 9.0 (English) - URL Filtering Best Practices"" -
https://docs.paloaltonetworks.com/advanced-url-
filtering/administration/configuring-url-filtering/url-filtering-best-practices","Navigate to Objects > Security Profiles > URL Filtering.
Verify that all URL categories designated by the organization are listed, and the action
is set to Block.","Certain URL categories pose a technology-centric threat, such as command-and-
control, copyright-infringement, extremism, malware, phishing, proxy-avoidance-and-
anonymizers, and parked. Users visiting websites in these categories, many times
unintentionally, are at greater risk of compromising the security of their system. Other
categories, such as adult, may pose a legal liability and will be blocked for those
reasons.","Not having an effective URL Filtering configuration can leave an organization open to
legal action, internal HR issues, non-compliance with regulatory policies or productivity
loss."
"6.10","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure that access to every URL is logged","Level 1","URL filters should not specify any categories as Allow Categories.

Default Value:
A default URL Filtering Security Profile is configured, with the following categories set to
""block"": abused-drugs adult gambling hacking malware phishing questionable weapons
3 Categories are set to alert in the default policy, and 58 Categories are set to allow
(which means they are not logged)","","","Navigate to Objects > Security Profiles > URL Filtering.
For each permitted category, set the Site Access actioun to alert","","true","1. “PAN-OS Administrator's Guide 11.1 (English) - URL Filtering Best Practices"" -
https://docs.paloaltonetworks.com/advanced-url-
filtering/administration/configuring-url-filtering/url-filtering-best-practices
2. “PAN-OS Administrator's Guide 9.0 (English) - URL Filtering” -
https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/url-filtering.html","Navigate to Objects > Security Profiles > URL Filtering.
Verify that the for all allowed categories, that the Site Access action is set to alert","Setting a URL filter to have one or more entries under Allow Categories will cause no
log entries to be produced in the URL Filtering logs for access to URLs in those
categories. For forensic, legal, and HR purposes, it is advisable to log access to every
URL. In many cases failure to log all URL access is a violation of corporate policy, legal
requirements or regulatory requirements.","Not having an effective URL Filtering configuration can leave an organization open to
legal action, internal HR issues, non-compliance with regulatory policies or productivity
loss."
"6.11","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure all HTTP Header Logging options are enabled","Level 1","Enable all options (User-Agent, Referer, and X-Forwarded-For) for HTTP header
logging.

Default Value:
Not Configured","","","Navigate to Objects > Security Profiles > URL Filtering > URL Filtering
Profile > URL Filtering Settings.
Set the following four settings:
a. Log container page only box is un-checked
b. Check the User-Agent box
c. Check the Referer box
d. Check the X-Forwarded-For box","","true","1. “PAN-OS Administrator's Guide 11.1 (English) - URL Filtering Best Practices"" -
https://docs.paloaltonetworks.com/advanced-url-
filtering/administration/configuring-url-filtering/url-filtering-best-practices","Navigate to Objects > Security Profiles > URL Filtering > URL Filtering
Profile > URL Filtering Settings.
Verify these four settings:
a. Log container page only box is un-checked
b. User-Agent box is checked
c. Referer box is checked
d. X-Forwarded-For box is checked","Logging HTTP header information provides additional information in the URL logs,
which may be useful during forensic investigations. The User-Agent option logs which
browser was used during the web session, which could provide insight to the vector
used for malware retrieval. The Referer option logs the source webpage responsible for
referring the user to the logged webpage. The X-Forwarded-For option is useful for
preserving the user’s source IP address, such as if a user traverses a proxy server prior
to the firewall. Un-checking the Log container page only box produces substantially
more information about web activity, with the expense of producing far more entries in
the URL logs. If this option remains checked, a URL filter log entry showing details of a
malicious file download may not exist.","Not having an effective URL Filtering configuration can leave an organization open to
legal action, internal HR issues, non-compliance with regulatory policies or productivity
loss."
"6.12","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure secure URL filtering is enabled for all security policies allowing traffic to the Internet","Level 1","Apply a secure URL filtering profile to all security policies permitting traffic to the
Internet. The URL Filtering profile may be applied to the security policies directly or
through a profile group.

Default Value:
Not Configured","","","To Set URL Filtering: For each Security Profile that transits traffic to the internet,
navigate to Policies > Security > Security Profiles > [Policy Name] >
Actions.
Set a URL Filtering profile that complies with the policies of the organization is applied
to all Security Policies that transit traffic to the public internet.","","true","1. “PAN-OS Administrator's Guide 11.1 (English) - URL Filtering Best Practices"" -
https://docs.paloaltonetworks.com/advanced-url-
filtering/administration/configuring-url-filtering/url-filtering-best-practices","To Verify URL Filtering:
For each Security Policy that transits traffic to the public internet, navigate to Policies
> Security > Security Profiles > [Policy Name] > Actions.
Verify there is a URL Filtering profile that complies with the policies of the organization
is applied to all Security Policies that transit traffic to the public internet.","URL Filtering policies dramatically reduce the risk of users visiting malicious or
inappropriate websites. In addition, a complete URL history log for all devices is
invaluable when performing forensic analysis in the event of a security incident.
Applying complete and approved URL filtering to outbound traffic is a frequent
requirement in corporate policies, legal requirements or regulatory requirements.","Not having an effective URL Filtering configuration can leave an organization open to
legal action, internal HR issues, non-compliance with regulatory policies or productivity
loss."
"6.13","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure alerting after a threshold of credit card or Social Security numbers is detected is enabled","Level 1","This guideline is highly specific to an organization. While blocking of credit card or
Social Security numbers will not occur with the recommended settings below, careful
tuning is also recommended.

Default Value:
Not Configured","","","Navigate to Objects > Custom Objects > Data Patterns.
Create an appropriate Data Pattern that accounts for sensitive information within your
organization. In most cases this will include Credit Card Numbers, and your jurisdiction's
equivalent of Social Insurance Numbers. In many cases these can simply be picked
from the list of Predefined Patterns.
Navigate to Objects > Security Profiles > Data Filtering.
Create appropriate Data Filtering Profile, using the created Data Patterns.
Ensure that an Alert Threshold is set that generates alerts appropriately. A typical
starting value for Alert Threshold is 20, but this should be adjusted after appropriate
testing.","","true","1. “What are the Data Filtering Best Practices?” -
https://live.paloaltonetworks.com/docs/DOC-2513
2. “PAN-OS Administrator's Guide 9.0 (English) - Setting up Data Filtering"" -
https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/threat-
prevention/set-up-data-filtering.html#","Navigate to Objects > Custom Objects > Data Patterns.
Verify an appropriate Data Pattern has been created that accounts for sensitive
information within your organization. In most cases this will include Credit Card
Numbers, and your jurisdiction's equivalent of Social Insurance Numbers. In many
cases these can simply be picked from the list of Predefined Patterns.
Navigate to Objects > Security Profiles > Data Filtering.
Verify an appropriate Data Filtering Profile has been created, using the created
Data Patterns. Ensure that an Alert Threshold is set that generates alerts
appropriately. A typical starting value for Alert Threshold is 20, but this should be
adjusted after appropriate testing.","Credit card and Social Security numbers are sensitive, and should never traverse an
organization’s Internet connection in clear text. Passing sensitive data within an
organization should also be avoided whenever possible. Detecting and blocking known
sensitive information is a basic protection against a data breach or data loss. Not
implementing these defenses can lead to loss of regulatory accreditation (such as PCI,
HIPAA etc), or can lead to legal action from injured parties or regulatory bodies.",""
"6.14","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure a secure Data Filtering profile is applied to all security policies allowing traffic to or from the Internet","Level 1","Create a secure Data Filtering profile and apply it to all security policies permitting traffic
to or from the Internet. The Data Filtering profile may be applied to security policies
directly or through a profile group.

Default Value:
Not Configured","","","Navigate to Objects > Custom Objects > Data Patterns. Add patterns to match
the various data that you wish to monitor or make blocking decisions on.
Navigate to Objects > Security Profiles > Data Filtering Add a Filtering
Profile that matches the data you wish to monitor, with appropriate values for Alert
Threshold (typically 20), Block Threshold (typically 0) and Log Serverity
Finally, apply the Filtering Profile to a Security Profile. Navigate to Policies >
Security. Edit all appropriate policies, and for each Policy choose the Actions tab,
and add the appropriate Data Filtering Policy (either as an individual Profile or
as part of a Group Profile)","","true","1. “PAN-OS Administrator's Guide 9.0 (English) - Setting up Data Filtering"" -
https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/threat-
prevention/set-up-data-filtering.html#","Navigate to Objects > Custom Objects > Data Patterns. Verify that the patterns
defined match the various data that you wish to monitor or make blocking decisions on.
Navigate to Objects > Security Profiles > Data Filtering For each Filtering
Profile, verify that the Data Patterns defined matches the data you wish to monitor,
with appropriate values for Alert Threshold (typically 20), Block Threshold
(typically 0) and Log Severity.
Finally, navigate to Policies > Security. Open all appropriate policies, for each
Policy choose the Actions tab, and verify that the appropriate Data Filtering
Policy is applied (either as an individual Profile or as part of a Group Profile)","A Data Filtering profile helps prevent certain types of sensitive information from
traversing an organization’s Internet connection, especially in clear text. Detecting and
blocking known sensitive information is a basic protection against a data breach or data
loss. Not implementing these defenses can lead to loss of regulatory accreditation (such
as PCI, HIPAA etc), or can lead to legal action from injured parties or regulatory bodies.
Before starting, be very aware that Data Filtering will often block data that you didn't
anticipate, false positives will definitely occur. Even the prebuilt filters will frequently
match on unintended data in files or websites. Work very closely with your user
community to ensure that required data is blocked or alerted on, but a minimum of false
positive blocks occur. As false positives occur, ensure that your user community has a
clear and timely procedure to get the configuration updated.",""
"6.15","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure that a Zone Protection Profile with an enabled SYN Flood Action of SYN Cookies is attached to all untrusted zones","Level 1","Enable the SYN Flood Action of SYN Cookies for all untrusted zones. The Alert,
Activate, and Maximum settings for SYN Flood Protection depend highly on the
environment and device used. Perform traffic analysis on the specific environment and
firewall to determine accurate thresholds. Do not rely on default values to be
appropriate for an environment.
Setting these values for all interfaces is an approach that should be considered by many
organizations, as traffic floods can result from internal testing or malware as well.
As a rough ballpark for most environments, an Activate value of 50% of the firewall’s
maximum “New sessions per second”/CPS is a conservative setting. The following is a
list of maximum new sessions per second for each platform:
PA-4xx series = 73,000 CPS
PA-8xx series = 13,100 CPS
PA-14xx series = 140,000 CPS
PA-32xx series = 84,000 CPS
PA-34xx series = 268,000 CPS
PA-52xx series = 500,000 CPS
PA-54xx series = 3,600,000 CPS
PA-70xx series = 6,000,000 CPS

Default Value:
Not Configured","","","From GUI:
Navigate to Network > Network Profiles > Zone Protection > Zone
Protection Profile > Flood Protection tab.
Check the SYN box. Set the Action dropdown to SYN Cookies Set Alert to 20000 (or
appropriate for org). Set Activate to 25000 (50% of maximum for firewall model). Set
Maximum to 1000000 (or appropriate for org)
Navigate to Network > Zones. Open the zone facing any untrusted network, if one
does not exist create it. Set Zone Protection to the Zone Protection Profile
created.","","true","1. “Understanding DoS Protection” - https://live.paloaltonetworks.com/docs/DOC-
5078
2. ""Syn Cookie Operation” - https://live.paloaltonetworks.com/docs/DOC-1542
3. “How to Determine if Configured DoS Classify TCP SYN Cookie Alarm, Activate
and Maximal Rate is Triggered” - https://live.paloaltonetworks.com/docs/DOC-
6801
4. “Threat Prevention Deployment Tech Note” -
https://live.paloaltonetworks.com/docs/DOC-3094
5. “What are the Differences between DoS Protection and Zone Protection?” -
https://live.paloaltonetworks.com/docs/DOC-4501
6. “Application DDoS Mitigation” - https://live.paloaltonetworks.com/docs/DOC-7158
7. PANOS 11.1 Admin Guide - Zone Protection . Flood Protection -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-
help/network/network-network-profiles/network-network-profiles-zone-
protection/flood-protection","From GUI:
Navigate to Network > Network Profiles > Zone Protection > Zone
Protection Profile > Flood Protection tab.
Verify the SYN box is checked. Verify the Action dropdown is SYN Cookies. Verify Alert
is 20000 (or appropriate for org). Verify Activate is 25000 (50% of maximum for firewall
model). Verify Maximum is 1000000 (or appropriate for org).
Navigate to Network > Zones. Open the zone facing any untrusted network. Verify that
Zone Protection has the Zone Protection Profile set to the Profile created.","Protecting resources and the firewall itself against DoS/DDoS attacks requires a layered
approach. Firewalls alone cannot mitigate all DoS attacks, however, many attacks can
be successfully mitigated. Utilizing SYN Cookies helps to mitigate SYN flood attacks,
where the CPU and/or memory buffers of the victim device become overwhelmed by
incomplete TCP sessions. SYN Cookies are preferred over Random Early Drop.","Not configuring a Network Zone Protection Profile on untrusted interfaces leaves an
organization exposed to common attacks and reconnaissance from those untrusted
networks. Not configuring a Zone Protection Profile for internal networks leaves an
organization vulnerable to malware, software or hardware causes of traffic flooding from
internal sources."
"6.16","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure that a Zone Protection Profile with tuned Flood Protection settings enabled for all flood types is attached to all untrusted zones","Level 2","Enable all Flood Protection options in the Zone Protection Profile attached to all
untrusted zones. The Alert, Activate, and Maximum settings for Flood Protection
depend highly on the environment and device used. Perform traffic analysis on the
specific environment and firewall to determine accurate thresholds. Do not rely on
default values to be appropriate for an environment.
Setting these values for all interfaces is an approach that should be considered by many
organizations, as traffic floods can result from internal testing or malware as well.

Default Value:
Not Configured","","","In the GUI:
Navigate to Network > Network Profiles > Zone Protection > Flood
Protection.
Set all settings to ""enabled"" with at least the default values.
Navigate to Network > Zones, select each untrusted zone in turn, and set the Zone
Protection Profile.","","true","1. “Understanding DoS Protection” - https://live.paloaltonetworks.com/docs/DOC-
5078
2. “Threat Prevention Deployment Tech Note” -
https://live.paloaltonetworks.com/docs/DOC-3094
3. “What are the Differences between DoS Protection and Zone Protection?” -
https://live.paloaltonetworks.com/docs/DOC-4501
4. PANOS 11.1 Admin Guide - Network Profiles / Zone Protection / Flood Protection
- https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-
help/network/network-network-profiles/network-network-profiles-zone-
protection/flood-protection","In the GUI:
Navigate to Network > Network Profiles > Zone Protection > Flood
Protection.
Ensure that all settings are enabled with at least the default values.
Navigate to Network > Zones, select each untrusted zone in turn, and ensure that the
Zone Protection Profile is set.","Without flood protection, it may be possible for an attacker, through the use of a botnet
or other means, to overwhelm network resources. Flood protection does not completely
eliminate this risk; rather, it provides a layer of protection. Without a properly configured
zone protection profile applied to untrusted interfaces, the protected / trusted networks
are susceptible to large number of attacks. While many of these involve denial of
service, some of these attacks are designed to evade IPS systems (fragmentation
attacks for instance) or to evade basic firewall protections (source routing and record
route attacks).","Not configuring and applying a Network Zone Protection Profile leaves an organization
exposed to common attacks and reconnaissance from untrusted networks.
Not configuring a Zone Protection Profile for internal networks leaves an organization
vulnerable to malware, software or hardware causes of traffic flooding from internal
sources."
"6.17","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure that all zones have Zone Protection Profiles with all Reconnaissance Protection settings enabled, tuned, and set to appropriate actions","Level 1","Enable all three scan options in a Zone Protection profile. Do not configure an action of
Allow for any scan type. The exact interval and threshold values must be tuned to the
specific environment. Less aggressive settings are typically appropriate for trusted
zones, such as setting an action of alert for all scan types.
Attach appropriate Zone Protection profiles meeting these criteria to all zones. Separate
Zone Protection profiles for trusted and untrusted zones is a best practice.

Default Value:
Not Configured","","","Navigate to Network > Network Profiles > Zone Protection > Zone
Protection Profile > Reconnaissance Protection.
Set TCP Port Scan to enabled, its Action to block-ip, its Interval to 5, and its
Threshold to 20. For block-ip, set the ""Track By"" is set to source and ""Duration"" is set
to 600 seconds.
Set Host Sweep to enabled, its Action to block, its Interval to 10, and its Threshold to
30.
Set UDP Port Scan to enabled, its Action to alert, its Interval to 10, and its Threshold
to 20.","","true","1. “Host Sweep Triggering Method in Zone Protection Profile” -
https://live.paloaltonetworks.com/docs/DOC-8703
2. “Understanding DoS Protection” - https://live.paloaltonetworks.com/docs/DOC-
5078
3. “Threat Prevention Deployment Tech Note” -
https://live.paloaltonetworks.com/docs/DOC-3094
4. “What are the Differences between DoS Protection and Zone Protection?” -
https://live.paloaltonetworks.com/docs/DOC-4501
5. PANOS 11.1 Admin Guide - Network Profiles / Zone Protection /
Reconnaissance Protection - https://docs.paloaltonetworks.com/pan-os/11-
1/pan-os-web-interface-help/network/network-network-profiles/network-network-
profiles-zone-protection/reconnaissance-protection","Navigate to Network > Network Profiles > Zone Protection > Zone
Protection Profile > Reconnaissance Protection.
Verify that TCP Port Scan is enabled, its Action is set to block-ip, its Interval is set to
5, and its Threshold is set to 20. For block-ip, ensure the ""Track By"" is set to source
and ""Duration"" is set to 600 seconds.
Verify that Host Sweep is enabled, its Action is set to block, its Interval is set to 10,
and its Threshold is set to 30.
Verify that UDP Port Scan is enabled, its Action is set to alert, its Interval is set to 10,
and its Threshold is set to 20.","Port scans and host sweeps are common in the reconnaissance phase of an attack.
Bots scouring the Internet in search of a vulnerable target may also scan for open ports
and available hosts. Reconnaissance Protection will allow for these attacks to be either
alerted on or blocked altogether.","Not configuring a Network Zone Protection Profile leaves an organization exposed to
common attacks and reconnaissance from untrusted networks."
"6.18","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure all zones have Zone Protection Profiles that drop specially crafted packets","Level 1","For all zones, attach a Zone Protection Profile that is configured to drop packets with a
spoofed IP address or a mismatched overlapping TCP segment, and packets with
malformed, strict source routing, or loose source routing IP options set.

Default Value:
Not Configured","","","Navigate to Network > Network Profiles > Zone Protection > Zone
Protection Profile > Packet Based Attack Protection > TCP/IP Drop.
Set Spoofed IP address to be checked.
Set Mismatched overlapping TCP segment to be checked.
Under IP Option Drop, set Strict Source Routing, Loose Source Routing, and
Malformed to all be checked. Additional options may also be set if desired.","","true","1. “Understanding DoS Protection” - https://live.paloaltonetworks.com/docs/DOC-
5078
2. “Threat Prevention Deployment Tech Note” -
https://live.paloaltonetworks.com/docs/DOC-3094
3. “What are the Differences between DoS Protection and Zone Protection?” -
https://live.paloaltonetworks.com/docs/DOC-4501
4. PANOS 11.1 Admin Guide - Network Profiles / Zone Protection / Packet Based
Attack Protection - https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-
interface-help/network/network-network-profiles/network-network-profiles-zone-
protection/packet-based-attack-protection","Navigate to Network > Network Profiles > Zone Protection > Zone
Protection Profile > Packet Based Attack Protection > TCP/IP Drop.
Verify Spoofed IP address is checked.
Verify Mismatched overlapping TCP segment is checked.
Under IP Option Drop, verify that Strict Source Routing, Loose Source
Routing, and Malformed are all checked. Additional options may also be checked.","Using specially crafted packets, an attacker may attempt to evade or diminish the
effectiveness of network security devices. Enabling the options in this recommendation
lowers the risk of these attacks.","Not configuring a Network Zone Protection Profile leaves an organization exposed to
common attacks and reconnaissance from untrusted networks."
"6.19","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure that User Credential Submission uses the action of “block” or “continue” on the URL categories","Level 1","Ideally user names and passwords user within an organization are not used with third
party sites. Some sanctioned SAS applications may have connections to the corporate
domain, in which case they will need to be exempt from the user credential submission
policy through a custom URL category.

Default Value:
Not Configured","","","Navigate to Objects > Security Profiles > URL Filtering.
Choose the Categories tab. Set the User Credential Submitting action on all
enabled URL categories is either block or continue, as appropriate to your
organization and the category.
Under the User Credential Detection tab set the User Credential Detection
value to a setting appropriate to your organization, any value except Disabled. Set the
Log Severity to a value appropriate to your organization and your logging or SIEM
solution.","","true","1. PAN OS 11.1 Admin Guide - URL Filtering / User Credential Detection -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-
help/objects/objects-security-profiles-url-filtering/user-credential-detection","Navigate to Objects > Security Profiles > URL Filtering.
Choose the Categories tab. Verify that the User Credential Submitting action on
all enabled URL categories is set to either block or continue.
Under the User Credential Detection tab ensure the User Credential
Detection is set to a value appropriate to your organization, and is not set to
Disabled. Verify that the Log Severity value is set to a value appropriate to your
organization and your logging or SIEM solution.","Preventing users from having the ability to submit their corporate credentials to the
Internet could stop credential phishing attacks and the potential that a breach at a site
where a user reused credentials could lead to a credential stuffing attack.","Not preventing users from submitting their corporate credentials to the Internet can
leave them open to phishing attacks or allow for credential reuse on unauthorized sites.
Using internal email accounts provides malicious actors with intelligence information,
which can be used for phishing, credential stuffing and other attacks. Using internal
passwords will often provide authenticated access directly to sensitive information. Not
only that, but a pattern of credential re-use can expose personal information from
multiple online sources."
"6.20","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure that 'Wildfire Inline ML Action' on antivirus profiles are set to reset-both on all decoders except 'imap' and 'pop3'","Level 1","Configure 'Wildfire Inline ML Action' on antivirus profiles to a value of 'reset-both' for all
decoders except imap and pop3 under 'Wildfire Inline ML Action'. If required by the
organization's email implementation, configure imap and pop3 decoders to 'alert' under
'Wildfire Inline ML Action'.

Default Value:
Not Configured","","","Navigate to Objects > Security Profiles > Antivirus
Set antivirus profiles to have all decoders set to reset-both for Wildfire Inline ML
Action. If imap and pop3 are required in the organization, set the imap and pop3
decoders are set to alert for Wildfire Inline ML Action.","","true","1. “PAN-OS Administrator's Guide 11.1 (English) - Security Profiles” -
https://docs.paloaltonetworks.com/advanced-wildfire/administration/configure-
advanced-wildfire-analysis/enable-advanced-wildfire-inline-ml","Navigate to Objects > Security Profiles > Antivirus
Verify that antivirus profiles have all decoders set to reset-both for Wildfire Inline
ML Action. If imap and pop3 are required in the organization, verify that the imap and
pop3 decoders are set to alert for Wildfire Inline ML Action.","Starting from PanOS 10, Wildfire supports real-time detection and blocking. As more
attacks are designed to bypass signature-based protection, real-time signatureless-
based protection is needed. Antivirus signatures produce low false positives. By
blocking any detected malware through the specified decoders, the threat of malware
propagation through the firewall is greatly reduced. It is recommended to mitigate
malware found in pop3 and imap through a dedicated antivirus gateway. Due to the
nature of the pop3 and imap protocols, the firewall is not able to block only a single
email message containing malware. Instead, the entire session would be terminated,
potentially affecting benign email messages.",""
"6.21","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure that 'Wildfire Inline ML' on antivirus profiles are set to enable for all file types","Level 1","Configure 'Wildfire Inline ML' on antivirus profiles to a value of 'enable' for all file types.

Default Value:
Not Configured","","","Navigate to Objects > Security Profiles > Antivirus
Go to Wildfire Inline ML tab. Set enable (inherit per-protocol actions) for
all Model on Action Setting.","","true","1. “PAN-OS Administrator's Guide 11.1 (English) - Security Profiles” -
https://docs.paloaltonetworks.com/advanced-wildfire/administration/configure-
advanced-wildfire-analysis/enable-advanced-wildfire-inline-ml","Navigate to Objects > Security Profiles > Antivirus
Go to Wildfire Inline ML tab. Verify that all Action Setting are set to enable
(inherit per-protocol actions).","Starting from PanOS 10, Wildfire supports real-time detection and blocking. As more
attacks are designed to bypass signature-based protection, real-time signatureless-
based protection is needed. With this new functionality, common file types used for
malware delivery such as Windows Executables, PowerShell Script, MSOffice, Shell,
and Executable Linked Format (ELF) can be inspected using Wildfire and malicious files
are blocked in real-time.",""
"6.22","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure that 'Inline Cloud Analysis' on Vulnerability Protection profiles are enabled if 'Advanced Threat Prevention' is available","Level 1","Enable 'Inline Cloud Analysis' on Vulnerability Protection profiles to combat zero-day
threats.

Default Value:
Not Configured","","","Navigate to Objects > Security Profiles > Vulnerability Protection
Go to Inline Cloud Analysis tab. Tick the checkbox for Enable cloud inline
analysis. Verify that all Model action is set as alert.
Note that, firewall device certificate is used to authenticate to the Advanced Threat
Prevention inline cloud analysis service. This step is required before 'Inline Cloud
Analysis' can be used. Refer to reference for detailed guide.","","true","1. “Configuring Vulnerability Protection Inline Cloud Analysis Guide (English)” -
https://docs.paloaltonetworks.com/pan-os/11-0/pan-os-new-features/content-
inspection-features/vuln-protection-inline-cloud-analysis","Navigate to Objects > Security Profiles > Vulnerability Protection
Go to Inline Cloud Analysis tab. Verify that it is enabled and all Model action is set
as alert.","Starting from PanOS 11, Palo Alto Networks now operates new inline deep learning
detection engines in the Advanced Threat Prevention cloud to analyze traffic for
command injection and SQL injection vulnerabilities in real-time to protect users against
zero-day threats. By operating cloud-based detection engines, you can access a wide
array of detection mechanisms that are updated and deployed automatically without
requiring the user to download update packages or operate process intensive, firewall-
based analyzers which can sap resources.
It is recommended to set the action as 'alert' during initial deployment and monitor it's
false positive, configure the exclusion URL and IP before moving to 'reset-both' action.",""
"6.23","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure that 'Cloud Inline Categorization' on URL Filtering profiles are enabled if 'Advanced Threat Prevention' is available","Level 1","Enable both 'Local Inline Categorization' and 'Cloud Inline Categorization' on URL
Filtering profiles to evaluate suspicious web page contents in real-time to protect users
against zero-day threats.

Default Value:
Not Configured","","","Navigate to Objects > Security Profiles > URL Filtering
Go to Inline Categorization tab. Tick the checkbox for both Enable local inline
categorization and Enable cloud inline categorization.
Note that:
1. Firewall device certificate is used to authenticate to the Advanced Threat
Prevention inline cloud analysis service. This step is required before 'Inline Cloud
Analysis' can be used. Refer to reference for detailed guide.
2. 'Local Inline Categorization' can be enabled with just the URL Filtering license
(no Advanced Threat Prevention is needed).","","true","1. “Configuring Cloud Inline Categorization for URL Filtering Guide (English)” -
https://docs.paloaltonetworks.com/pan-os/10-2/pan-os-new-features/url-filtering-
features/cloud-inline-categorization
2. “PAN-OS Administrator's Guide 11.1 (English) - Inline Categorization” -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-
help/objects/objects-security-profiles-url-filtering/inline-categorization","Navigate to Objects > Security Profiles > URL Filtering
Go to Inline Categorization tab. Verify that it is enabled for both Enable local
inline categorization and Enable cloud inline categorization.","Starting from PanOS 10, Palo Alto Networks Advanced URL Filtering now operates a
series of inline cloud-based deep learning detectors that evaluate suspicious web page
contents in real-time to protect users against zero-day threats. This includes cloaked
websites, multi-step attacks, CAPTCHA challenges, and previously unseen one-time-
use URLs.",""
"6.24","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure that 'Inline Cloud Analysis' on Anti-Spyware profiles are enabled if 'Advanced Threat Prevention' is available","Level 1","Enable 'Inline Cloud Analysis' on Anti-Spyware profiles to detect and protection against
advanced, highly-evasive zero-day command-and-control (C2) threats.

Default Value:
Not Configured","","","Navigate to Objects > Security Profiles > Anti-Spyware
Go to Inline Cloud Analysis tab. Tick the checkbox for Enable cloud inline
analysis. Verify that all Model action is set as reset-both.
Note that, firewall device certificate is used to authenticate to the Advanced Threat
Prevention inline cloud analysis service. This step is required before Inline Cloud
Analysis can be used. Refer to reference for detailed guide.","","true","1. “Configuring Inline Cloud Analysis Guide (English)” -
https://docs.paloaltonetworks.com/advanced-threat-
prevention/administration/configure-threat-prevention/configure-inline-cloud-
analysis#idcf1fc426-b522-4e84-9098-ac82f2d784ae","Navigate to Objects > Security Profiles > Anti-Spyware
Go to Inline Cloud Analysis tab. Verify that it is enabled and all Model action is set
as reset-both.","Starting from PanOS 10, Palo Alto Networks now operates a series of ML-based
detection engines in the Advanced Threat Prevention cloud to analyze traffic for
advanced C2 (command-and-control) and spyware threats in real-time to protect users
against zero-day threats. By operating cloud-based detection engines, you can access
a wide array of detection mechanisms that are updated and deployed automatically
without requiring the user to download update packages or operate process intensive,
firewall-based analyzers which can sap resources.
The cloud-based detection engine logic is continuously monitored and updated using
C2 traffic datasets from WildFire, with additional support through manual updates by
Palo Alto Networks threat researchers, who provide human intervention for highly
accurized detection enhancements.",""
"6.25","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure that 'DNS Policies' is configured on Anti-Spyware profiles if 'DNS Security' license is available","Level 1","DNS security is an extensible cloud-based service capable of generating DNS
signatures using advanced predictive analytics and machine learning. DNS Security
protects from sophisticated DNS-based attacks.

Default Value:
Not Configured","","","Navigate to Objects > Security Profiles > Anti-Spyware
Go to DNS Policies tab. Configure policy action to sinkhole for all DNS Security
categories.
On Command and control Domains category, set the packet capture option to
extended-capture.","","true","1. “Configuring DNS Security” - https://docs.paloaltonetworks.com/dns-
security/administration/configure-dns-security/enable-dns-security#tabs-
id066476b2-c4dd-4fc0-b7e4-f4ba32e19f60
2. ""DNS Security Best Practices"" - https://docs.paloaltonetworks.com/advanced-
threat-prevention/administration/threat-prevention/best-practices-for-securing-
your-network-from-layer-4-and-layer-7-evasions","Navigate to Objects > Security Profiles > Anti-Spyware
Go to DNS Policies tab. Verify that policy action is set to sinkhole for all DNS
Security categories.
On Command and control Domains category, verify that the packet capture option to
extended-capture.Navigate to Objects > Security Profiles > Anti-Spyware
Go to DNS Policies tab. Configure policy action to sinkhole for all DNS Security
categories.
On Command and control Domains category, set the packet capture option to
extended-capture","DNS traffic are normally allowed on firewall. With this in mind, attackers leverage on this
attack surface to evade detections or extract out data. Starting from PanOS 9, Palo Alto
Networks has launched DNS Security services to combat against evassive malwares
and to detect DNS tunneling activities.
For DNS Security to be effective, ""Threat Prevention"" or ""Advanced Threat Prevention""
license must be purchased in addition of ""DNS Security"" license.",""
"7.1","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure application security policies exist when allowing traffic from an untrusted zone to a more trusted zone","Level 1","When permitting traffic from an untrusted zone, such as the Internet or guest network, to
a more trusted zone, such as a DMZ segment, create security policies specifying which
specific applications are allowed.
**Enhanced Security Recommendation: ** Require specific application policies when
allowing any traffic, regardless of the trust level of a zone. Do not rely solely on port
permissions. This may require SSL interception, and may also not be possible in all
environments.

Default Value:
Not Configured","","","Navigate to Policies > Security.
For all Security Policies that transit from a less trusted to a more trusted interface,
set the Application and Service values to match the exposed application. For
instance, for a web server exposed to the internet from a DMZ: Source tab: Zone set to
OUTSIDE / Address set to Any Destination tab: Zone set to DMZ / Address set to [DMZ
Host Object] Application tab: set to web-browsing Service/URL Category tab:
set Service to ether:
• application-default or:
• service-http and/or service-https
**Enhanced Security Recommendation: **
Set these values for Policies on all Interfaces, for traffic in all directions. For each
Security Policy, set the Application and Service values to match the exposed
application.","","true","1. “PAN-OS Administrator's Guide 11.1 (English) - Security Policies / Applications
and Usage ” - https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-
interface-help/policies/policies-security/applications-and-usage","Navigate to Policies > Security.
For all Security Policies that transit from a less trusted to a more trusted interface, that
the appropriate Application and Service values are set. For instance, for a web
server exposed to the internet from a DMZ: Source tab: Zone set to OUTSIDE / Address
set to Any Destination tab: Zone set to DMZ / Address set to [DMZ Host Object]
Application tab: set to web-browsing Service/URL Category tab: set Service to
ether:
• application-default or:
• service-http and/or service-https
**Enhanced Security Recommendation: **
Assess this setting for Policies on all Interfaces, for traffic in all directions. Ensure that
for each Security Policy that the appropriate settings are set for both Application and
Service","To avoid unintentionally exposing systems and services, rules allowing traffic from
untrusted zones to trusted zones should be as specific as possible. Application-based
rules, as opposed to service/port rules, further tighten what traffic is allowed to pass.
Similarly, traffic from trusted to untrusted networks should have a security policy set,
with application-based rules. A ""catch-all"" rule that allows all applications will also allow
malware traffic. The goal should be to understand both inbound and outbound traffic,
permit what is known, and block all other traffic.","Setting application based rules on both inbound and outbound traffic ensures that the
traffic on the protocol and port being specified is actually the application that you expect.
For outbound traffic, the days of ""we trust our users"" is well past us, that statement also
implies that we trust the malware on the user workstations, which is obviously not the
case.
For traffic from trusted to less trusted interfaces, the applications should be
characterized over time, with the end goal being that all applications in in the rules, and
a final ""block all"" rule is in place. Not having this goal gives both attackers and malware
the leeway they need to accomplish their goals.
Trusting only Port permissions to control traffic exposes an organization to ""tunneling""
style attacks that can exfiltrate data or facilitate Command and Control (C2) sessions."
"7.2","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure 'Service setting of ANY' in a security policy allowing traffic does not exist","Level 1","Create security policies specifying application-default for the Service setting, in addition
to the specific ports desired. The Service setting of any should not be used for any
policies that allow traffic.

Default Value:
Not Configured","","","Navigate to Policies > Security.
For each exposed host, set a Security Policy exists with:
• Source tab: Zone set to OUTSIDE Address set to any
• Destination tab: Zone set to DMZ / Address set to <DMZ Host Object>
• Application tab: Application set to web-browsing (or appropriate
application)
• Service tab: Service set to application-default. The value of any should
never be used","","true","1. “Security Policy Guidelines” - https://live.paloaltonetworks.com/docs/DOC-3469
2. “Security Bulletin: App-ID Cache Pollution” -
http://researchcenter.paloaltonetworks.com/2012/12/app-id-cache-pollution-
response/
3. “PAN-OS Administrator's Guide 11.1 (English) - Security Policiy Overview ” -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-
help/policies/policies-security/security-policy-overview","Navigate to Policies > Security.
For each exposed host, verify that a Security Policy exists with:
• Source tab: Zone set to OUTSIDE Address set to any
• Destination tab: Zone set to DMZ / Address set to <DMZ Host Object>
• Application tab: Application set to web-browsing (or appropriate
application)
• Service tab: Service set to application-default. The value of any should
never be used","App-ID requires a number of packets to traverse the firewall before an application can
be identified and either allowed or dropped. Due to this behavior, even when an
application is defined in a security policy, a service setting of any may allow a device in
one zone to perform ports scans on IP addresses in a different zone. In addition, this
recommendation helps to avoid an App-ID cache pollution attack.
Because of how App-ID works, configuring the service setting to ""Any"" allows some
initial traffic to reach the target host before App-ID can recognize and appropriately
restrict the traffic. Setting the Service Setting to application specific at least restricts the
traffic to the target applications or protocols for that initial volume of traffic.",""
"7.3","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure 'Security Policy' denying any/all traffic to/from IP addresses on Trusted Threat Intelligence Sources Exists","Level 1","Create a pair of security rules at the top of the security policies ruleset to block traffic to
and from IP addresses known to be malicious.
Note: This recommendation (as written) requires a Palo Alto Networks ""Threat
Prevention License"". Third Party and Open Source Threat Intelligence Feeds can also
be used for this purpose.

Default Value:
Not Configured","","","Navigate to Policies > Security
Create a Security Policy similar to:
• General tab: Name set to Deny to Malicious IP
• Source tab: Source Zone set to Any,
• Destination tab: Destination Zone set to Any, Destination Address set to
Palo Alto Networks - Known malicious IP addresses,Palo Alto
Networks - High risk IP addresses, Palo Alto Networks - Tor exit
IP addresses, Palo Alto Networks - Bulletproof IP addresses
• Application tab: Application set to Any
• Service/URL Category tab: Service set to Any
• Actions tab: Action set to Block, Profile Type set to None
Create a Security Policy similar to:
• General tab: Name set to Deny from Malicious IP
• Source tab: Source Zone set to Any, Source Address set to Palo Alto
Networks - Known malicious IP addresses,Palo Alto Networks - High
risk IP addresses, Palo Alto Networks - Tor exit IP addresses, Palo
Alto Networks - Bulletproof IP addresses
• Destination tab: Destination Zone set to Any
• Application tab: Application set to Any
• Service/URL Category tab: Service set to Any
• Actions tab: Action set to Block, Profile Type set to None
Note: This recommendation requires a Palo Alto Networks ""Threat Prevention License""","","true","1. ""PAN-OS 11.1 Admin Guide: Built-in External Dynamic Lists"":
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/policy/use-an-
external-dynamic-list-in-policy/built-in-edls","Navigate to Policies > Security
Verify a Security Policy exists similar to:
• General tab: Name set to Deny to Malicious IP
• Source tab: Source Zone set to Any,
• Destination tab: Destination Zone set to Any, Destination Address set to
Palo Alto Networks - Known malicious IP addresses,Palo Alto
Networks - High risk IP addresses, Palo Alto Networks - Tor exit
IP addresses, Palo Alto Networks - Bulletproof IP addresses
• Application tab: Application set to Any
• Service/URL Category tab: Service set to Any
• Actions tab: Action set to Block, Profile Type set to None
Verify a Security Policy exists similar to:
• General tab: Name set to Deny from Malicious IP
• Source tab: Source Zone set to Any, Source Address set to Palo Alto
Networks - Known malicious IP addresses,Palo Alto Networks - High
risk IP addresses, Palo Alto Networks - Tor exit IP addresses, Palo
Alto Networks - Bulletproof IP addresses
• Destination tab: Destination Zone set to Any
• Application tab: Application set to Any
• Service/URL Category tab: Service set to Any
• Actions tab: Action set to Block, Profile Type set to None
Note: This recommendation requires a Palo Alto Networks ""Threat Prevention License""","Creating rules that block traffic to/from known malicious sites from Trusted Threat
Intelligence Sources protects you against IP addresses that Palo Alto Networks has
proven to be used almost exclusively to distribute malware, initiate command-and-
control activity, and launch attacks.","While not foolproof, simply blocking traffic from known malicious hosts allows more
resources to be devoted to analyzing traffic from other sources for malicious content.
This approach is a recommended part of most ""Defense in Depth"" recommendations,
allowing defenders to focus more deeply on traffic from uncategorized sources."
"7.4","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure that logging is enabled on built-in default security policies","Level 1","Enable logging on built-in default security policies ""intrazone-default"" and ""interzone-
default""

Default Value:
Disabled","","","Navigate to Policies > Security
Go to default policies intrazone-default and interzone-default. On Actions tab,
enable Log at Session End on log setting.","","true","1. “Gateway Firewall Best Practices on Default Policies Logging Configuration” -
https://docs.paloaltonetworks.com/best-practices/internet-gateway-best-
practices/best-practice-internet-gateway-security-policy/define-the-initial-internet-
gateway-security-policy/step-5-enable-logging-for-traffic-that-doesnt-match-any-
rules
2. “Datacenter Firewall Best Practices on Default Policies Logging Configuration” -
https://docs.paloaltonetworks.com/best-practices/10-2/data-center-best-
practices/data-center-best-practice-security-policy/log-and-monitor-data-center-
traffic/log-intra-data-center-traffic-that-matches-the-intrazone-allow-rule","Navigate to Policies > Security
Go to default policies intrazone-default and interzone-default. On Actions tab,
verify that log setting has Log at Session End is enabled.","By default, these default security policies does not have logging enabled. This enables
SOC or security analyst to do further investigations on security incidents especially on
threat hunting or incident response activities.",""
"8.1","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure 'SSL Forward Proxy Policy' for traffic destined to the Internet is configured","Level 1","Configure SSL Forward Proxy for all traffic destined to the Internet. In most
organizations, including all categories except financial-services, government and
health-and-medicine is recommended.

Default Value:
Not Configured","","","Navigate to Policies > Decryption. Create a Policy for all traffic destined to the
Internet. This Policy should include:
• Source tab: The Source Zone and/or Source Address should include all target
internal networks. Source User should include all target internal users
• Destination tab: The Destination Zone should include the untrusted target
zone (usually the internet). Destination Address is typically Any for an
internet destination.
• Service/URL Category tab: all URL Category entries should be included
except financial-services, government and health-and-medicine (this list
may vary depending on your organization and its policies).
• Options tab: Type set to SSL Forward Proxy","","true","1. “How to Implement SSL Decryption” -
https://live.paloaltonetworks.com/docs/DOC-1412
2. ““PAN-OS Administrator's Guide 11.1 (English) - Decryption (English)” -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/decryption","Navigate to Policies > Decryption. Verify SSL Forward Proxy is set for all traffic
destined to the Internet.
Verify each Decryption Policy Rule:
• Source tab: The Source Zone and/or Source Address should include all target
internal networks. Source User should include all target internal users
• Destination tab: The Destination Zone should include the untrusted target
zone (usually the internet). Destination Address is typically Any for an
internet destination.
• Service/URL Category tab: Verify that all URL Category entries are included
except financial-services, government and health-and-medicine (this list
may vary depending on your organization and its policies).
• Options tab: Verify that the Type is set to SSL Forward Proxy","Without SSL inspection, the firewall cannot apply many of its protection features against
encrypted traffic. The amount of encrypted malware traffic continues to rise, and
legitimate websites using SSL encryption are hacked or tricked into delivering malware
on a frequent basis. As encryption on the Internet continues to grow at a rapid rate, SSL
inspection is no longer optional as a practical security measure. If proper decryption is
not configured, it follows that the majority of traffic is not being fully inspected for
malicious content or policy violations. This is a major exposure, allowing delivery of
exploits and payloads direct to user desktops.
Note that, categories to be decrypted is highly dependant on each organization's policy.","Failure to decrypt outbound traffic allows attackers to mask attacks, data exfiltration
and/or command and control (C2) traffic by simply using standard TLS encryption.
Privacy concerns for your organization's users will dictate that some common categories
should be exempted from inspection and decryption. Personal banking or healthcare
information is almost always exempted, as are interactions with government entities.
Exemptions and inclusions to decryption policies should be negotiated internally and
governed by published Corporate Policies."
"8.2","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure 'SSL Inbound Inspection' is required for all untrusted traffic destined for servers using SSL or TLS","Level 1","Configure SSL Inbound Inspection for all untrusted traffic destined for servers using
SSL or TLS.

Default Value:
Not Configured","","","Navigate to Policies > Decryption.
Set SSL Inbound Inspection appropriately for all untrusted traffic destined for servers
using SSL or TLS.
Navigate to Policies > Decryption. For each service published to the internet (or
other untrusted zones), create a Policy and set the following options:
• General tab: Name set to a descriptive name
• Source: Source Zone set to the target zone (Internet in many cases). Source
Address set to the target address space (Any for internet traffic)
• Destination tab: Destination Zone should be set to the appropriate zone, or
Any. Destination Address set to the target host address
• Options tab: Type set to SSL Inbound Inspection","","true","1. “How to Implement SSL Decryption” -
https://live.paloaltonetworks.com/docs/DOC-1412
2. “PAN-OS Administrator's Guide 11.1 (English) - Decryption (English)” -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/decryption","Navigate to Policies > Decryption.
Verify SSL Inbound Inspection is set appropriately for all untrusted traffic destined for
servers using SSL or TLS.
Navigate to Policies > Decryption. For each service published to the internet (or
other untrusted zones), verify the following settings:
• General tab: Name set to a descriptive name
• Source: Source Zone set to the target zone (Internet in many cases). Source
Address set to the target address space (Any for internet traffic)
• Destination tab: Destination Zone should be set to the appropriate zone, or
Any. Destination Address set to the target host address
• Options tab: Type set to SSL Inbound Inspection","Without SSL Inbound Inspection, the firewall is not able to protect SSL or TLS-enabled
webservers against many threats.","Not decrypting inbound traffic to TLS encrypted services means that inspection for
many common attacks cannot occur on the firewall. This means that all defenses
against these attacks are up to the host."
"8.3","CIS Palo Alto Firewall 10 Benchmark","Palo Alto","Ensure that the Certificate used for Decryption is Trusted","Level 1","The CA Certificate used for in-line HTTP Man in the Middle should be trusted by target
users. For SSL Forward Proxy configurations, there are classes of users that need to
be considered.
1: Users that are members of the organization, users of machines under control of the
organization. For these people and machines, ensure that the CA Certificate is in one of
the Trusted CA certificate stores. This is easily done in Active Directory, using Group
Policies for instance. A MDM (Mobile Device Manager) can be used to accomplish the
same task for mobile devices such as telephones or tablets. Other central management
or orchestration tools can be used for Linux or ""IoT"" (Internet of Things) devices.
2: Users that are not member of the organization - often these are classed as ""Visitors""
in the policies of the organization. If a public CA Certificate is a possibility for your
organization, then that is one approach. A second approach is to not decrypt affected
traffic - this is easily done, but leaves the majority of ""visitor"" traffic uninspected and
potentially carrying malicious content. The final approach, and the one most commonly
seen, is to use the same certificate as is used for the hosting organization. In this last
case, visitors will see a certificate warning, but the issuing CA will be the organization
that they are visiting.

Default Value:
Decryption is not enabled by default.","","","Set the CA Certificate(s):
Navigate to Device > Certificate Management > Certificates. Import the
appropriate CA Certificates from any internal Certificate Authorities.
Alternatively, generate a self-signed certificate for an internal CA on the firewall, and
then import the root certificate for that CA into the trusted CA list of target clients. In an
Active Directory environment this can be facilitated using a Group Policy.
Set the Certificate Profile needed for the SSL Forward Proxy:
• Navigate to Device > Certificate Management > Certificate Profile.
Set the decryption profile to include the settings described in the SSL Forward Proxy
guidance in this document","","true","1. ""How to Implement and Test SSL Decryption"" -
https://live.paloaltonetworks.com/t5/Configuration-Articles/How-to-Implement-
and-Test-SSL-Decryption/ta-p/59719
2. “PAN-OS Administrator's Guide 11.1 (English) - Decryption (English)” -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/decryption
3. ""SSL Certificates Resource List on Configuring and Troubleshooting"" -
https://live.paloaltonetworks.com/t5/Management-Articles/SSL-certificates-
resource-list/ta-p/53068
4. ""Certificates"" - http://palo-alto.wikia.com/wiki/Certificates","Verify the CA Certificate(s):
Navigate to Device > Certificate Management > Certificates
• Verify that appropriate internal certificates are imported, and that all certificates in
the list are valid. In particular, verify the Subject, Issuer, CA, Expires,
Algorithm and Usage fields
• Alternatively, if an internal CA is implemented on the firewall, verify that target
clients have the root certificate for this CA imported into their list of trusted
certificate authorities.
Verify the Certificate Profile needed for the SSL Forward Proxy:
• Navigate to Device > Certificate Management > Certificate Profile.
Verify that an appropriate profile is created.","Using a self-signed certificate, or any certificate that generates a warning in the
browser, means that members of the organization have no method of determining if
they are being presented with a legitimate certificate, or an attacker's ""man in the
middle' certificate. It also very rapidly teaches members of the organization to bypass all
security warnings of this type.",""
"1.1.1.1","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Syslog logging should be configured","Level 1","Syslog logging is a standard logging protocol that is widely supported. It is
recommended for a level 1 deployment only, as syslog does not support encryption.

Default Value:
By default no external logging is defined","","","Navigate to Device > Server Profiles > Syslog Choose Add Assign a Name to the
Profile. Choose Add, and assign a server name in the Name field, add an IP address or
FQDN in the Syslog Server field. Edit other fields as appropriate for your server.
Repeat if multiple Syslog destinations are required.
Navigate to Device > Log Settings Under System, add an entry. Define a Name and
a Filter setting. Under Forward Methods, add a Syslog Profile in the Syslog
section. Ensure that at least one of the Log Settings Configuration entries has it's
Filter setting at All Logs
Under Configuration, add an entry. Define a Name and a Filter setting. Under
Forward Methods, add a Syslog Profile in the Syslog section. Ensure that at least
one of the Log Settings Configuration entries has it's Filter setting at All Logs
Under User-ID, add an entry. Define a Name and a Filter setting. Under Forward
Methods, add a Syslog Profile in the Syslog section. Ensure that at least one of the
Log Settings Configuration entries has it's Filter setting at All Logs
Under HIP Match (Host Information Profile), add an entry. Define a Name and a Filter
setting. Under Forward Methods, add a Syslog Profile in the Syslog section.
Ensure that at least one of the Log Settings Configuration entries has it's Filter setting
at All Logs
Under IP-Tag, add an entry. Define a Name and a Filter setting. Under Forward
Methods, add a Syslog Profile in the Syslog section. Ensure that at least one of the
Log Settings Configuration entries has it's Filter setting at All Logs","","true","1. “PAN-OS Administrator's Guide 11.1 (English) - Configure Syslog Monitoring” -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/monitoring/use-
syslog-for-monitoring/configure-syslog-monitoring","Navigate to Device > Server Profiles > Syslog Ensure that a valid Syslog profile
is configured, and that it points to a valid Syslog host. Navigate to Device > Log
Settings Under System, verify that at least one Syslog entry exists and that at least
one entry has ""All Logs"" selected. Each Syslog entry must have a valid Syslog Profile
attached.
Under Configuration, verify that at least one Syslog entry exists and that at least one
entry has ""All Logs"" selected. Each Syslog entry must have a valid Syslog Profile
attached.
Under User-ID, verify that at least one Syslog entry exists and that at least one entry
has ""All Logs"" selected. Each Syslog entry must have a valid Syslog Profile attached.
Under HIP Match (Host Information Profile), verify that at least one Syslog entry exists
and that at least one entry has ""All Logs"" selected. Each Syslog entry must have a valid
Syslog Profile attached.
Under IP-Tag, verify that at least one Syslog entry exists and that at least one entry has
""All Logs"" selected. Each Syslog entry must have a valid Syslog Profile attached.","Sending all system logs to a remote host is recommended to provide protected, long
term storage and archiving. This also places a copy of the logs in a second location, in
case the primary (on the firewall) logs are compromised. Storing logs on a remote host
also allows for more flexible log searches and log processing, as well as many methods
of triggering events or scripts based on specific log events or combinations of events.
Finally, remote logging provides many organizations with the opportunity to combine
logs from disparate infrastructure in a SIEM (Security Information and Event
Management) system.
Logging to an external system is also usually required by most regulatory frameworks.","Failure to properly store and archive logs for critical infrastructure leaves an
organization without the tools required to establish trends in events or activity, or to
retrospectively analyze security or operational events beyond the log timespan stored
on the firewall. Not having remote logs also puts many organizations outside of
compliance with many regulatory frameworks. Finally, not logging to a remote host
leaves organizations without recourse in the event of a compromise of logs on the
primary device. It is imperative that organizations log critical infrastructure appropriately,
store and archive these logs in a central location, and have a robust set of tools to
analyze logs both in real time and after the fact."
"1.1.1.2","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","SNMPv3 traps should be configured","Level 2","SNMP v3 can be used for remote logging, and is the recommended protocol in higher
security situations as it fully supports encryption of logs.

Default Value:
By default no external logging is defined","","","Navigate to Device > Server Profiles > SNMP Trap Choose Add Assign a Name to
the Profile, and specify version V3. Choose Add, and assign a server name in the Name
field, add an IP address or FQDN in the SNMP Manager field. Edit the Password fields
as appropriate for your server. Repeat if multiple Syslog destinations are required.
Navigate to Device > Log Settings Under System, add an entry. Define a Name and
a Filter setting. Under Forward Methods, add a SNMP Profile in the SNMP
section. Ensure that at least one of the Log Settings Configuration entries has its
Filter setting at All Logs
Under Configuration, add an entry. Define a Name and a Filter setting. Under
Forward Methods, add a SNMP Profile in the SNMP section. Ensure that at least one
of the Log Settings Configuration entries has its Filter setting at All Logs
Under User-ID, add an entry. Define a Name and a Filter setting. Under Forward
Methods, add a SNMP Profile in the SNMP section. Ensure that at least one of the Log
Settings Configuration entries has its Filter setting at All Logs
Under HIP Match (Host Information Profile), add an entry. Define a Name and a Filter
setting. Under Forward Methods, add a SNMP Profile in the SNMP section. Ensure
that at least one of the Log Settings Configuration entries has its Filter setting at All
Logs
Under IP-Tag, add an entry. Define a Name and a Filter setting. Under Forward
Methods, add a SNMP Profile in the SNMP section. Ensure that at least one of the Log
Settings Configuration entries has its Filter setting at All Logs","","true","1. “PAN-OS Administrator's Guide 11.1 (English) - Forward Traps to an SNMP
Manager” - https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-
admin/monitoring/snmp-monitoring-and-traps/forward-traps-to-an-snmp-manager","Navigate to Device > Server Profiles > SNMP Traps
Ensure that a valid SNMP profile is configured, that version V3 is selected, and that it
points to a valid SNMPv3 host. User, EngineID and Password fields should be
completed appropriately
Navigate to Device > Log Settings Under System, verify that at least one SNMP
entry exists, corresponding to an SNMPv3 Server Profile and that at least one entry has
""All Logs"" selected.
Under Configuration, verify that at least one SNMP entry exists, corresponding to an
SNMPv3 Server Profile and that at least one entry has ""All Logs"" selected.
Under User-ID, verify that at least one SNMP entry exists, corresponding to an
SNMPv3 Server Profile and that at least one entry has ""All Logs"" selected.
Under HIP Match (Host Information Profile), verify that at least one SNMP entry exists,
corresponding to an SNMPv3 Server Profile and that at least one entry has ""All Logs""
selected.
Under IP-Tag, verify that at least one SNMP entry exists, corresponding to an SNMPv3
Server Profile and that at least one entry has ""All Logs"" selected.","Sending all system logs to a remote host is recommended to provide protected, long
term storage and archiving. This also places a copy of the logs in a second location, in
case the primary (on the firewall) logs are compromised. Storing logs on a remote host
also allows for more flexible log searches and log processing, as well as many methods
of triggering events or scripts based on specific log events or combinations of events.
Finally, remote logging provides many organizations with the opportunity to combine
logs from disparate infrastructure in a SIEM (Security Information and Event
Management) system.
Logging to an external system is also usually required by most regulatory frameworks.","Failure to properly store and archive logs for critical infrastructure leaves an
organization without the tools required to establish trends in events or activity, or to
retrospectively analyze security or operational events beyond the log timespan stored
on the firewall. Not having remote logs also puts many organizations outside of
compliance with many regulatory frameworks. Finally, not logging to a remote host
leaves organizations without recourse in the event of a compromise of logs on the
primary device. It is imperative that organizations log critical infrastructure appropriately,
store and archive these logs in a central location, and have a robust set of tools to
analyze logs both in real time and after the fact. Not encrypting log data as it transits the
network allows an attacker to mount a ""MiTM"" (Monkey in the Middle) attack, which
allows them to intercept and/or modify logs as they transit from the source to the
destination."
"1.1.2","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure 'Login Banner' is set","Level 1","Configure a login banner, ideally approved by the organization’s legal team. This banner
should, at minimum, prohibit unauthorized access, provide notice of logging or
monitoring, and avoid using the word “welcome” or similar words of invitation.

Default Value:
Not configured","","","Navigate to Device > Setup > Management > General Settings.
Set Login Banner as appropriate for your organization.","","true","1. “PAN-OS Administrator's Guide 11.1 (English) - Configuring Logon Banners” -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/firewall-
administration/use-the-web-interface/configure-banners-message-of-the-day-
and-logos","Navigate to Device > Setup > Management > General Settings.
Verify that Login Banner is set appropriately for your organization.","Through a properly stated login banner, the risk of unintentional access to the device by
unauthorized users is reduced. Should legal action take place against a person
accessing the device without authorization, the login banner greatly diminishes a
defendant’s claim of ignorance.",""
"1.1.3","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure 'Enable Log on High DP Load' is enabled","Level 1","Enable the option 'Enable Log on High DP Load' feature. When this option is selected, a
system log entry is created when the device’s packet processing load reaches 100%
utilization.

Default Value:
Not enabled","","","Navigate to Device > Setup > Management > Logging and Reporting Settings
> Log Export and Reporting.
Set the Enable Log on High DP Load box to checked.","","true","1. ""Logging Best Practices"" - https://live.paloaltonetworks.com/t5/best-practice-
assessment-device/logging-and-reporting-settings-log-on-high-dp-mode/ta-
p/336964","Navigate to Device > Setup > Management > Logging and Reporting Settings
> Log Export and Reporting.
Verify Enable Log on High DP Load is checked.","When the device’s packet processing load reaches 100%, a degradation in the
availability of services accessed through the device can occur. Logging this event can
help with troubleshooting system performance.","Sustained attacks, especially volumetric DOS and DDOS attacks will often affect CPU
utilization. This setting will generate an event that is easily monitored for and alerted on.
While setting CPU utilization watermarks in a Network Management System is a
standard practice, this setting does not depend on even having an NMS, it doesn't
require anything other than standard logging to implement."
"1.2.1","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure 'Permitted IP Addresses' is set to those necessary for device management","Level 1","Permit only the necessary IP addresses to be used to manage the device.

Default Value:
Not enabled (all addresses that can reach the interface are permitted)","","","Navigate to Device > Setup > Interfaces > Management.
Set Permitted IP Addresses to only those necessary for device management for the
SSH and HTTPS protocols. If no profile exists, create one that has these addresses set.","","true","1. ""How to Allow Certain IP Addresses on the Management Interface"" -
https://live.paloaltonetworks.com/docs/DOC-8432
2. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing
Administrative Access"": https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-
admin/getting-started/best-practices-for-securing-administrative-access.html#","Navigate to Device > Setup > Interfaces > Management.
Verify that Permitted IP Addresses is limited only to those necessary for device
management.","Management access to the device should be restricted to the IP addresses or subnets
used by firewall administrators. Permitting management access from other IP addresses
increases the risk of unauthorized access through password guessing, stolen
credentials, or other means.",""
"1.2.2","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure 'Permitted IP Addresses' is set for all management profiles where SSH, HTTPS, or SNMP is enabled","Level 1","For all management profiles, only the IP addresses required for device management
should be specified.

Default Value:
Not enabled","","","Navigate to Network > Network Profiles > Interface Management.
In each profile, for each of the target protocols (SNMP, HTTPS, SSH), set Permitted
IP Addresses to only include those necessary for device management. If no profile
exists, create one that has these options set.","","true","1. ""How to Allow Certain IP Addresses on the Management Interface"" -
https://live.paloaltonetworks.com/docs/DOC-8432
2. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing
Administrative Access"": https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-
admin/getting-started/best-practices-for-securing-administrative-access.html#","Navigate to Network > Network Profiles > Interface Management.
In each profile, for each of the target protocols (SNMP, HTTPS, SSH), verify that
Permitted IP Addresses is limited to those necessary for device management.","If a Permitted IP Addresses list is either not specified or is too broad, an attacker may
gain the ability to attempt management access from unintended locations, such as the
Internet. The “Ensure 'Security Policy' denying any/all traffic exists at the bottom of the
security policies ruleset” recommendation in this benchmark can provide additional
protection by requiring a security policy specifically allowing device management
access.",""
"1.2.3","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure HTTP and Telnet options are disabled for the management interface","Level 1","HTTP and Telnet options should not be enabled for device management.

Default Value:
Not set. (HTTP and Telnet are disabled by default)","","","Navigate to Device > Setup > Interfaces > Management.
Set the HTTP and Telnet boxes to unchecked.","","true","1. ""How to Configure a Layer 3 Interface to act as a Management Port"" -
https://live.paloaltonetworks.com/t5/Configuration-Articles/How-to-Configure-a-
Layer-3-Interface-to-act-as-a-Management-Port/ta-p/59024
2. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing
Administrative Access"": https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-
admin/getting-started/best-practices-for-securing-administrative-access.html#","Navigate to Device > Setup > Interfaces > Management.
Verify that the HTTP and Telnet options are both unchecked.","Management access over cleartext services such as HTTP or Telnet could result in a
compromise of administrator credentials and other sensitive information related to
device management. Theft of either administrative credentials or session data is easily
accomplished with a ""Man in the Middle"" attack.",""
"1.2.4","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure HTTP and Telnet options are disabled for all management profiles","Level 1","HTTP and Telnet options should not be enabled for device management.","","","Navigate to Network > Network Profiles > Interface Management. For each
Profile, set the HTTP and Telnet boxes to unchecked.","","true","1. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing
Administrative Access"": https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-
admin/getting-started/best-practices-for-securing-administrative-access.html#
2. “PAN-OS Administrator's Guide 9.0 (English) - Use Interface Management
Profiles to Restrict Access"": https://docs.paloaltonetworks.com/pan-os/9-0/pan-
os-admin/networking/configure-interfaces/use-interface-management-profiles-to-
restrict-access.html#","Navigate to Network > Network Profiles > Interface Management. For each
Interface Management profile verify that the HTTP and Telnet options are both
unchecked.","Management access over cleartext services such as HTTP or Telnet could result in a
compromise of administrator credentials and other sensitive information related to
device management.",""
"1.2.5","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure valid certificate is set for browser-based administrator interface","Level 2","In most cases, a browser HTTPS interface is used to administer the Palo Alto
appliance. The certificate used to secure this session should satisfy the following
criteria:
1. A valid certificate from a trusted source should be used. While a certificate from a
trusted Public Certificate Authority is certainly valid, one from a trusted Private
Certificate Authority is absolutely acceptable for this purpose.
2. The certificate should have a valid date. It should not have a ""to"" date in the past
(it should not be expired), and should not have a ""from"" date in the future.
3. The certificate should use an acceptable cipher and encryption level.

Default Value:
A self-signed certificate is installed by default for the administrative interface.

Additional Information:
Verify that the clock is both accurate and reliable on both the Palo Alto and on the
administrative workstations before setting the SSL/TLS Service Profile. Inaccurate or
mismatched clocks will result in certificate errors and can result in loss of HTTPS
administrative access.","","","Create or acquire a certificate that meets the stated criteria and set it:
Navigate to Device > Certificate Management > Certificates
Import an appropriate Certificate for your administrative session, from a trusted
Certificate Authority.
Navigate to Device > Certificate Management > SSL/TLS Service Profile
Choose or import the certificate you want to use for the web based administrative
session.
Navigate to Device > Setup > Management > General Settings > SSL/TLS
Service Profile
Choose the Service Profile that you have configured","","true","1. ""How to Configure a Certificate for Secure Web GUI Access"" -
https://live.paloaltonetworks.com/t5/Configuration-Articles/How-to-configure-a-
certificate-for-secure-web-gui-access/ta-p/68653
2. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing
Administrative Access"": https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-
admin/getting-started/best-practices-for-securing-administrative-access.html#","Verify that the certificate used to secure HTTPS sessions meets the criteria by
reviewing the appropriate certificate:
Navigate to Device > Certificate Management > Certificates
Verify that this Certificate is properly applied to the Management Interface:
Navigate to Device > Setup > Management > General Settings > SSL/TLS
Service Profile","If a certificate that is self-signed, expired, or otherwise invalid is used for the browser
HTTPS interface, administrators in most cases will not be able to tell if their session is
being eavesdropped on or injected into by a ""Man in the Middle"" attack.","If the default self-signed certificate is used, an administrator will not be able to clearly
tell if their HTTPS session is being hijacked or not. Using a trusted certificate ensures
that the session is both encrypted and trusted."
"1.3.1","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure 'Minimum Password Complexity' is enabled","Level 1","This checks all new passwords to ensure that they meet basic requirements for strong
passwords.

Default Value:
Not enabled.","","","Navigate to Device > Setup > Management > Minimum Password Complexity.
Set Enabled to be checked
Set that the various password settings to values that are appropriate to your
organization. It is suggested that there at least be some special characters enforced,
and that a minimum length be set. Ensure that non-zero values are set for Minimum
Uppercase, Lowercase and Special Characters. ""Block Username Inclusion"" should be
enabled.
Operationally, dictionary words should be avoided for all passwords - passphrases are a
much better alternative.","","true","1. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing
Administrative Access” - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-
admin/getting-started/best-practices-for-securing-administrative-access.html","Navigate to Device > Setup > Management > Minimum Password Complexity.
Verify Enabled is checked
Ensure that the various password settings to values that are appropriate to your
organization. Non-zero values should be set for Minimum Uppercase, Lowercase and
Special Characters. ""Block Username Inclusion"" should be enabled.","Password complexity recommendations are derived from the USGCB (United States
Government Configuration Baseline), Common Weakness Enumeration, and
benchmarks published by the CIS (Center for Internet Security). Password complexity
adds entropy to a password, in comparison to a simple password of the same length. A
complex password is more difficult to attack, either directly against administrative
interfaces or cryptographically, against captured password hashes. However, making a
password of greater length will generally have a greater impact in this regard, in
comparison to making a shorter password more complex.","Simple passwords make an attacker's job very easy. There is a reasonably short list of
commonly used admin passwords for network infrastructure, not enforcing password
lengths and complexity can lend itself to making an attacker's brute force attack
successful."
"1.3.2","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure 'Minimum Length' is greater than or equal to 12","Level 1","This determines the least number of characters that make up a password for a user
account.

Default Value:
Not enabled.","","","Navigate to Device > Setup > Management > Minimum Password Complexity.
Set Minimum Length to greater than or equal to 12","","true","1. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing
Administrative Access” - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-
admin/getting-started/best-practices-for-securing-administrative-access.html","Navigate to Device > Setup > Management > Minimum Password Complexity.
Verify Minimum Length is greater than or equal to 12","A longer password is much more difficult to attack, either directly against administrative
interfaces or cryptographically, against captured password hashes. Making a password
of greater length will generally have a greater impact in this regard, in comparison to
making a shorter password more complex. Passphrases are a commonly used
recommendation, to make longer passwords more palatable to end users.
Administrative staff however generally use ""password safe"" applications, so a long and
complex password is more easily implemented for most infrastructure administrative
interfaces.","Longer passwords are much more difficult to attack. This is true of attacks against the
administrative interfaces themselves, or of decryption attacks against captured hashes.
A longer password will almost always have a more positive impact than a shorter but
more complex password."
"1.3.3","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure 'Minimum Uppercase Letters' is greater than or equal to 1","Level 1","This checks all new passwords to ensure that they contain at least one English
uppercase character (A through Z).

Default Value:
Not enabled.","","","Navigate to Device > Setup > Management > Minimum Password Complexity
Set Minimum Uppercase Letters to greater than or equal to 1","","true","1. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing
Administrative Access” - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-
admin/getting-started/best-practices-for-securing-administrative-access.html","Navigate to Device > Setup > Management > Minimum Password Complexity
Verify Minimum Uppercase Letters is greater than or equal to 1","This is one of several settings that, when taken together, ensure that passwords are
sufficiently complex as to thwart brute force and dictionary attacks.",""
"1.3.4","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure 'Minimum Lowercase Letters' is greater than or equal to 1","Level 1","This checks all new passwords to ensure that they contain at least one English
lowercase character (a through z).

Default Value:
Not enabled.","","","Navigate to Device > Setup > Management > Minimum Password Complexity
Set Minimum Lowercase Letters to greater than or equal to 1","","true","1. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing
Administrative Access” - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-
admin/getting-started/best-practices-for-securing-administrative-access.html","Navigate to Device > Setup > Management > Minimum Password Complexity
Verify Minimum Lowercase Letters is greater than or equal to 1","This is one of several settings that, when taken together, ensure that passwords are
sufficiently complex as to thwart brute force and dictionary attacks.",""
"1.3.5","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure 'Minimum Numeric Letters' is greater than or equal to 1","Level 1","This checks all new passwords to ensure that they contain at least one base 10 digit (0
through 9).

Default Value:
Not enabled.","","","Navigate to Device > Setup > Management > Minimum Password Complexity
Set Minimum Numeric Letters to greater than or equal to 1","","true","1. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing
Administrative Access” - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-
admin/getting-started/best-practices-for-securing-administrative-access.html","Navigate to Device > Setup > Management > Minimum Password Complexity`
Verify Minimum Numeric Letters is greater than or equal to 1","This is one of several settings that, when taken together, ensure that passwords are
sufficiently complex as to thwart brute force and dictionary attacks.",""
"1.3.6","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure 'Minimum Special Characters' is greater than or equal to 1","Level 1","This checks all new passwords to ensure that they contain at least one non-alphabetic
character (for example, !, $, #, %).

Default Value:
Not enabled.","","","Navigate to Device > Setup > Management > Minimum Password Complexity
Set Minimum Special Characters to greater than or equal to 1","","true","1. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing
Administrative Access” - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-
admin/getting-started/best-practices-for-securing-administrative-access.html","Navigate to Device > Setup > Management > Minimum Password Complexity
Verify Minimum Special Characters is greater than or equal to 1","This is one of several settings that, when taken together, ensure that passwords are
sufficiently complex as to thwart brute force and dictionary attacks.",""
"1.3.7","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure 'Required Password Change Period' is less than or equal to 90 days","Level 1","This defines how long a user can use a password before it expires.

Default Value:
Not enabled.

Additional Information:
This guidance is currently under some debate in the community. If the password length
is sufficient and password complexity is enforced, then in many organizations it is likely
that the password change period can be increased to 6, 9 or even 12 months.","","","Navigate to Device > Setup > Management > Minimum Password Complexity.
Set Required Password Change Period (days) to less than or equal to 90","","true","1. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing
Administrative Access” - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-
admin/getting-started/best-practices-for-securing-administrative-access.html","Navigate to Device > Setup > Management > Minimum Password Complexity.
Verify Required Password Change Period (days) is less than or equal to 90","The longer a password exists, the higher the likelihood that it will be compromised by a
brute force attack, by an attacker gaining general knowledge about the user and
guessing the password, or by the user sharing the password.","Failure to change administrative passwords can result in a slow ""creep"" of people who
have access. Especially in a situation with high staff turnover (for instance, in a NOC or
SOC situation), administrative passwords need to be changed frequently.
Administrative credentials should not be shared across multiple devices. In a NOC/SOC
situation, it's important to not share administrative credentials between operators
(names accounts should be used), and in particular administrative credentials should
never be shared across different customer infrastructures."
"1.3.8","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure 'New Password Differs By Characters' is greater than or equal to 3","Level 1","This checks all new passwords to ensure that they differ by at least three characters
from the previous password.

Default Value:
Not enabled.","","","Navigate to Device > Setup > Management > Minimum Password Complexity
Set New Password Differs By Characters to 3 or more","","true","1. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing
Administrative Access” - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-
admin/getting-started/best-practices-for-securing-administrative-access.html","Navigate to Device > Setup > Management > Minimum Password Complexity
Verify New Password Differs By Characters is set to greater than or equal to 3","This is one of several settings that, when taken together, ensure that passwords are
sufficiently complex as to thwart brute force and dictionary attacks.","This prevents the use of passwords that fall into a predictable pattern. Especially in
situations that involve staff turnover, having a pattern to password changes should be
avoided."
"1.3.9","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure 'Prevent Password Reuse Limit' is set to 24 or more passwords","Level 1","This determines the number of unique passwords that have to be most recently used for
a user account before a previous password can be reused.

Default Value:
Not enabled.","","","Navigate to Device > Setup > Management > Minimum Password Complexity.
Set Prevent Password Reuse Limit to greater than or equal to 24","","true","1. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing
Administrative Access” - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-
admin/getting-started/best-practices-for-securing-administrative-access.html","Navigate to Device > Setup > Management > Minimum Password Complexity.
Verify Prevent Password Reuse Limit is greater than or equal to 24","The longer a user uses the same password, the greater the chance that an attacker can
determine the password through brute force attacks. Also, any accounts that may have
been compromised will remain exploitable for as long as the password is left
unchanged. If password changes are required but password reuse is not prevented, or if
users continually reuse a small number of passwords, the effectiveness of a good
password policy is greatly reduced. While current guidance emphasizes password
length above frequent password changes, not enforcing password re-use guidance
adds the temptation of using a small pool of passwords, which can make an attacker's
job easier across an entire infrastructure.",""
"1.3.10","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure 'Password Profiles' do not exist","Level 1","Password profiles that are weaker than the recommended minimum password
complexity settings must not exist.

Default Value:
Not configured

Additional Information:
This recommendation has been marked as automated so that vendors can certify
against this. If using CISCAT the benchmark will need to be tailored and the user will
have to write the xpath with organization specific information","","","Navigate to Device > Password Profiles.
Ensure Password Profiles weaker than the recommended minimum password
complexity settings do not exist.","","true","1. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing
Administrative Access” - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-
admin/getting-started/best-practices-for-securing-administrative-access.html","Navigate to Device > Password Profiles.
Verify Password Profiles weaker than the recommended minimum password complexity
settings do not exist.","As password profiles override any 'Minimum Password Complexity' settings defined in
the device, they generally should not exist. If these password profiles do exist, they
should enforce stronger password policies than what is set in the 'Minimum Password
Complexity' settings.",""
"1.4.1","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure 'Idle timeout' is less than or equal to 10 minutes for device management","Level 1","Set the Idle Timeout value for device management to 10 minutes or less to
automatically close inactive sessions.

Default Value:
Not configured","","","Navigate to Device > Setup > Management > Authentication Settings.
Set Idle Timeout to less than or equal to 10.","","true","1. “How to Change the Admin Session Timeout Value” -
https://live.paloaltonetworks.com/docs/DOC-5557
2. “PAN-OS Administrator's Guide 11.1 (English) - Device - Setup - Management” -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-
help/device/device-setup-management#","Navigate to Device > Setup > Management > Authentication Settings.
Verify Idle Timeout is less than or equal to 10.","An unattended computer with an open administrative session to the device could allow
an unauthorized user access to the firewall’s management interface.",""
"1.4.2","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure 'Failed Attempts' and 'Lockout Time' for Authentication Profile are properly configured","Level 1","Configure values for Failed Login Attempts and Account Lockout Time set to
organization-defined values (for example, 3 failed attempts and a 15 minute lockout
time). Do not set Failed Attempts and Lockout Time in the Authentication Settings
section; any Failed Attempts or Lockout Time settings within the selected Authentication
Profile do not apply in the Authentication Settings section.

Default Value:
Not configured

Additional Information:
Both values must be set. If either value is not set, account lockout does not occur.","","","Navigate to Device > Authentication Profile.
Set Failed Attempts to the non-zero organization-defined value.
Set Lockout Time to the non-zero organization-defined value.","","true","1. “PAN-OS Administrator's Guide 11.1 (English) - Device - Setup - Management” -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-
help/device/device-setup-management#
2. “PAN-OS Administrator's Guide 11.1 (English) - Authentication Profile"" -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-
help/device/device-authentication-profile","Navigate to Device > Authentication Profile.
Verify Failed Attempts is set a non-zero organization-defined value.
Verify Lockout Time is set to a non-zero organization-defined value.","Without a lockout limit, an attacker can continuously guess administrators’ passwords.
From the other point of view, if lockout settings are configured in the Authentication
Settings section it may be possible for an attacker to continuously lock out all
administrative accounts from accessing the device. This potential situation indicates the
importance of using named administrative accounts, instead of the default, single
shared ""admin"" account.",""
"1.5.1","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure 'V3' is selected for SNMP polling","Level 1","For SNMP polling, only SNMPv3 should be used.

Default Value:
Not configured","","","Navigate to Device > Setup > Operations > Miscellaneous > SNMP Setup
Select V3.
In order to be usable, the User and View sections of this dialog should also be
completed. These settings need to match the settings in the organization's NMS
(Network Management System)","","true","1. https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-
help/device/device-setup-operations/enable-snmp-monitoring","Navigate to Device > Setup > Operations > Miscellaneous > SNMP Setup
Verify V3 is selected.","SNMPv3 utilizes AES-128 encryption, message integrity, user authorization, and device
authentication security features. SNMPv2c does not provide these security features. If
an SNMPv2c community string is intercepted or otherwise obtained, an attacker could
gain read access to the firewall. Note that SNMP write access is not possible.","Any clear-text administrative protocol (such as SNMPv2) can expose valuable
information to any attacker that is in a position to eavesdrop on that protocol."
"1.6.1","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure 'Verify Update Server Identity' is enabled","Level 1","This setting determines whether or not the identity of the update server must be verified
before performing an update session. Note that if an SSL Forward Proxy is configured
to intercept the update session, this option may need to be disabled (because the SSL
Certificate will not match).

Default Value:
Not configured","","","Navigate to Device > Setup > Services > Services.
Set the Verify Update Server Identity box to checked.","","true","1. “PAN-OS Administrator's Guide 9.0 (English) - Install Content Updates"" -
https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/software-and-
content-updates/install-content-and-software-updates.html","Navigate to Device > Setup > Services > Services.
Verify that the Verify Update Server Identity box is checked.","Verifying the update server identity before package download ensures the packages
originate from a trusted source. Without this, it is possible to receive and install an
update from a malicious source.","This setting protects the device from an ""evilgrade"" attack, where a successful DNS
attack can redirect the firewall to an attacker-controlled update server, which can then
serve a modified update."
"1.6.2","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure redundant NTP servers are configured appropriately","Level 1","These settings enable use of primary and secondary NTP servers to provide
redundancy in case of a failure involving the primary NTP server.

Default Value:
Not configured","","","Navigate to Device > Setup > Services > Services.
Set Primary NTP Server Address appropriately.
Set Secondary NTP Server Address appropriately.","","true","1. “The NIST Authenticated NTP Service” -
http://www.nist.gov/pml/div688/grp40/authntp.cfm
2. https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-
help/device/device-setup-services/global-services-settings
3. ""How to Configure Authenticated NTP"" -
https://live.paloaltonetworks.com/t5/Configuration-Articles/How-to-Configure-
Authenticated-NTP/ta-p/54495","Navigate to Device > Setup > Services > Services.
Verify Primary NTP Server Address is set appropriately.
Verify Secondary NTP Server Address is set appropriately.","NTP enables the device to maintain an accurate time and date when receiving updates
from a reliable NTP server. Accurate timestamps are critical when correlating events
with other systems, troubleshooting, or performing investigative work. Logs and certain
cryptographic functions, such as those utilizing certificates, rely on accurate time and
date parameters. In addition, rules referencing a Schedule object will not function as
intended if the device’s time and date are incorrect.
For additional security, authenticated NTP can be utilized. If Symmetric Key
authentication is selected, only SHA1 should be used, as MD5 is considered severely
compromised.
Most organizations will maintain a pair of internal NTP servers for all internal time
services. These servers will either be self-contained atomic clocks, or will collect time
from a known reliable source (often GPS or a well-known internet server pool will be
used).",""
"1.6.3","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure that the Certificate Securing Remote Access VPNs is Valid","Level 2","The Certificate used to secure Remote Access VPNs should satisfy the following
criteria:
• It should be a valid certificate from a trusted source. In almost cases this means
a trusted Public Certificate Authority, as in most cases remote access VPN users
will not have access to any Private Certificate Authorities for Certificate
validation.
• The certificate should have a valid date. It should not have a ""to"" date in the past
(it should not be expired), and should not have a ""from"" date in the future.
• The key length used to encrypt the certificate should be 2048 bits or more.
• The hash used to sign the certificate should be SHA-2 or better.
• When the Certificate is applied, the TLS version should be 1.1 or higher (1.2 is
recommended)

Default Value:
Not configured","","","Create a CSR and install a certificate from a public CA (Certificate Authority) here:
Navigate to Device > Certificate Management > Certificates
Apply a valid certificate to the HTTPS portal:
Navigate to Network > GlobalProtect > Portals > Portal Configuration >
Authentication > SSL/TLS Profile
Apply a valid certificate to the GlobalProtect Gateway:
Navigate to Network > GlobalProtect > Gateways > Authentication > SSL/TLS
Service Profile Configure the Service Profile to use the correct certificate
Ensure that the Minimum TLS version is set to 1.1 or 1.2 (1.2 is recommended).","","true","1. “PAN-OS Administrator's Guide 9.0 (English) - GlobalProtect Certificate Best
Practices"" - https://docs.paloaltonetworks.com/globalprotect/9-0/globalprotect-
admin/get-started/enable-ssl-between-globalprotect-components/globalprotect-
certificate-best-practices.html
2. “PAN-OS Administrator's Guide 9.0 (English) - Deploy Server Certificates to the
GlobalProtect Components"" - https://docs.paloaltonetworks.com/globalprotect/9-
0/globalprotect-admin/get-started/enable-ssl-between-globalprotect-
components/deploy-server-certificates-to-the-globalprotect-components.html#","Verify that the certificate being used to secure the VPN meets the criteria listed above:
Navigate to Device > Certificate Management > Certificates
Ensure that a valid certificate is applied to the HTTPS portal:
Navigate to Network > GlobalProtect > Portals > Portal Configuration >
(Select the Portal being assessed) > Authentication > SSL/TLS Profile
Ensure that a valid certificate is applied to the GlobalProtect Gateway:
Navigate to Network > GlobalProtect > Gateways > (Select the Gateway
being Assessed) > Authentication > SSL/TLS Service Profile
Ensure that the correct Certificate is selected. Ensure that the Minimum TLS version is
configured to be 1.1 or higher (TLSv1.2 is recommended).","If presented with a certificate error, the end user in most cases will not be able to tell if
their session is using a self-signed or expired certificate, or if their session is being
eavesdropped on or injected into by a ""Man in the Middle"" attack. This means that self-
signed or invalid certificates should never be used for VPN connections.","Not using a trusted Certificate, issued by a trusted Public Certificate Authority means
that clients establishing VPN sessions will always see an error indicating an untrusted
Certificate. This means that they will have no method of validating if their VPN session
is being hijacked by a ""Monkey in the Middle"" (MitM) attack. It also ""trains"" them to
bypass certificate warnings for other services, making MitM attacks easier for those
other services as well."
"1.7.1","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Enabling Post-Quantum (PQ) on IKEv2 VPNs","Level 2","For VPN that has IKEv2 enabled, enable PQ for more secure way to exchange pre-
shared secret to defend against ""Harvest Now, Decrypt Later"" attack technique.

Default Value:
Not Configured","","","Navigate to Network > Network Profiles > IKE Gateways.
On gateways that has IKEv2 enabled, click into it and navigate to Advanced Options.
On IKEv2 section, navigate to PQ PPK section.
Check Enable Post-Quantum Pre-Shared Key (PPK) option.
Negotiation mode should be set to Mandatory if both sides of VPN supports PQ.
Negotiation mode should be set to Preferred if you don't know or don't have control
over whether the peer supports RFC 8784. Preferred mode preserves backward
compatibility to ensure connections fall back instead of dropping.
If both sides of VPN supports more than 1 PPK key ID, then multiple PPK key ID should
be configured. Configuring multiple PQ PPKs is most secure because it adds a random
element to PQ PPK selection.","","true","1. “PAN-OS Administrator's Guide 11.1 (English) - Network Security"" -
https://docs.paloaltonetworks.com/network-security/quantum-
security/administration/configure-quantum-resistant-ikev2-vpns/configure-post-
quantum-ikev2-vpns","Navigate to Network > Network Profiles > IKE Gateways.
On gateways that has IKEv2 enabled, click into it and navigate to Advanced Options.
On IKEv2 section, navigate to PQ PPK section.
Verify that Enable Post-Quantum Pre-Shared Key (PPK) is checked.
Negotiation mode should be set to Mandatory if both sides of VPN supports PQ.
Negotiation mode should be set to Preferred if you don't know or don't have control
over whether the peer supports RFC 8784. Preferred mode preserves backward
compatibility to ensure connections fall back instead of dropping.
If both sides of VPN supports more than 1 PPK key ID, then multiple PPK key ID should
be configured. Configuring multiple PQ PPKs is most secure because it adds a random
element to PQ PPK selection.","Post-quantum IKEv2 VPNs based on RFC 8784 work by transmitting a pre-shared
secret separately (out-of-band) from the initial peering exchange (the IKE_SA_INIT
Exchange). Instead of transmitting the pre-shared secret in the peering exchange,
which an attacker could compromise or harvest now and decrypt later, the peering
exchange only transmits a Key ID. A Key ID and a pre-shared secret comprise a unique
pair called a post-quantum pre-shared key (PQ PPK).
Each IKEv2 peer uses the Key ID to look up the pre-shared secret, which is transmitted
securely between administrators or pushed by Panorama, and stored locally on each
IKEv2 peer. The pre-shared key is never part of the peering exchange and never
traverses the post-quantum VPN, so an attacker using a quantum computer can't steal
it, crack it, and use it to decrypt data harvested from a VPN.
Both IKEv2 peers must have the same active pairs of Key ID plus pre-shared secret so
that when peers negotiate the connection, each peer can look up the same Key ID and
retrieve the same pre-shared secret. If the responding peer doesn't have a matching
Key ID or if the pre-shared secret associated with the Key ID differs from the initiator,
the connection is aborted.",""
"2.1","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure that IP addresses are mapped to usernames","Level 2","Configure appropriate settings to map IP addresses to usernames. Mapping userids to
IP addresses is what permits the firewall to create rules based on userids and groups
rather than IP addresses and subnets, as well as log events by userids rather than IP
addresses or DNS names. The specifics of how to achieve IP-to-username mapping is
highly dependent on the environment. It can be enabled by integrating the firewall with a
domain controller, Exchange server, captive portal, Terminal Server, User-ID Agent,
XML API, or syslog data from a variety of devices.

Additional Information:
This recommendation has been marked as automated so that vendors can certify
against this. If using CISCAT the benchmark will need to be tailored and the user will
have to write the xpath with organization specific information","","","To Set User-ID Agents:
Navigate to Device > User Identification > User-ID Agents
Set the Name, IP Address and Port of the User-ID Agent`
Enable User Identification for each monitored zone that will have user accounts:
Navigate to Network > Zone, for each relevant zone enable User
Identification
To Set Terminal Services Agents:
Navigate to Device > Terminal Services Agents Set the Name, IP Address and
Port of the Terminal Services Agent
Enable User Identification for each monitored zone that will have Terminal Servers:
Navigate to Network > Zone, enable User Identification","","true","1. “Best Practices for Securing User-ID Deployments” -
https://live.paloaltonetworks.com/docs/DOC-7912
2. “How to Configure Group Mapping settings?” -
https://live.paloaltonetworks.com/docs/DOC-4994
3. https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/user-id
4. https://paloaltonetworks.com/content/dam/paloaltonetworks-
com/en_US/assets/pdf/tech-briefs/techbrief-user-id.pdf","To validate if this recommendation has been met, look at the Source User column in
the URL Filtering or Traffic logs (Monitor > Logs > URL Filtering and Logs >
Traffic Logs, respectively.)
User traffic originating from a trusted zone should identify a username.","Understanding which user is involved in a security incident allows appropriate personnel
to move quickly between the detection and reaction phases of incident response. In
environments with either short DHCP lease times, or where users may move frequently
between systems, the ability to analyze or report, or alert on events based on user
accounts or user groups is a tremendous advantage. For forensics tasks when DHCP
lease information may not be available, the Source User information may be the only
way to tie together related data.",""
"2.2","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure that WMI probing is disabled","Level 2","Disable WMI probing if it is not required for User-ID functionality in the environment.

Default Value:
Not configured

Additional Information:
This recommendation has been marked as automated so that vendors can certify
against this. If using CISCAT the benchmark will need to be tailored and the user will
have to write the xpath with organization specific information","","","Navigate to Device > User Identification > User Mapping > Palo Alto
Networks User ID Agent Setup.
Set Enable Probing so it is unchecked.","","true","1. “R7-2014-16: Palo Alto Networks User-ID Credential Exposure” -
https://blog.rapid7.com/2014/10/14/palo-alto-networks-userid-credential-
exposure/
2. “Best Practices for Securing User-ID Deployments” -
https://live.paloaltonetworks.com/docs/DOC-7912
3. “PAN-OS Administrator's Guide 11.1 (English) - Client Probing"" -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/user-id/user-id-
concepts/user-mapping/client-probing","Navigate to Device > User Identification > User Mapping > Palo Alto
Networks User ID Agent Setup.
Verify that Enable Probing is not checked.","WMI probing normally requires a domain administrator account. A malicious user could
capture the encrypted password hash for offline cracking or relayed authentication
attacks. Relying on other forms of user identification, such as using UserID Agents or
security log monitoring, mitigates this risk.
In addition, it is easy to mis-configure this feature such that it is enabled on untrusted
interfaces. This can result in a domain administrator account and the associated
password hash being sent to untrusted hosts on the internet, where malicious users can
then capture that hash for offline cracking.","While this removes the exposure of having the WMI user account password being
compromised, it also reduces the effectiveness of user identification during operation of
the firewall (applying rules and policies). This trade-off should be weighed carefully for
all installations."
"2.3","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure that User-ID is only enabled for internal trusted interfaces","Level 1","Only enable the User-ID option for interfaces that are both internal and trusted. There is
rarely a legitimate need to allow WMI probing (or any user-id identification) on an
untrusted interface. The exception to this is identification of remote-access VPN users,
who are identified as they connect.

Default Value:
By default WMI probing and all User-ID functions are disabled.","","","Navigate to Network > Network Profiles > Interface Management.
Set User-ID to be checked only for interfaces that are both internal and trusted;
uncheck it for all other interfaces.","","true","1. “Customer advisory: Security Impact of User-ID Misconfiguration” -
https://live.paloaltonetworks.com/docs/DOC-8125
2. “R7-2014-16: Palo Alto Networks User-ID Credential Exposure” -
https://blog.rapid7.com/2014/10/14/palo-alto-networks-userid-credential-
exposure/
3. “Best Practices for Securing User-ID Deployments” -
https://live.paloaltonetworks.com/docs/DOC-7912
4. “User-ID Best Practices” - https://live.paloaltonetworks.com/docs/DOC-6591
5. “PAN-OS Administrator's Guide 11.1 (English) - Client Probing"" -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/user-id/user-id-
concepts/user-mapping/client-probing","Navigate to Network > Network Profiles > Interface Management.
Verify that User-ID is only enabled for interfaces that are both internal and trusted.","PAN released a customer advisory in October of 2014 warning of WMI probing on
untrusted interfaces with User-ID enabled. This can result in theft of the password hash
for the account used in WMI probing.","If WMI probing is enabled without limiting the scope, internet hosts that are sources or
destinations of traffic will be probed, and the password hash of the configured Domain
Admin account can be captured by an outside attacker on such a host."
"2.4","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure that 'Include/Exclude Networks' is used if User-ID is enabled","Level 1","If User-ID is configured, use the Include/Exclude Networks section to limit the User-ID
scope to operate only on trusted networks. There is rarely a legitimate need to allow
WMI probing or other User identification on an untrusted network.

Default Value:
Not configured","","","Navigate to Device > User Identification > User Mapping > Include/Exclude
Networks.
Set all trusted internal networks to have a Discovery value of Include.
Set all untrusted external networks to have a Discovery value of Exclude. Note that any
value in the trusted networks list implies that all other networks are untrusted.","","true","1. Best Practices for Securing User-ID Deployments -
https://live.paloaltonetworks.com/docs/DOC-7912","Navigate to Device > User Identification > User Mapping > Include/Exclude
Networks.
Verify that all trusted internal networks have a Discovery value of Include.
Verify that all untrusted external networks have a Discovery value of Exclude. Note that
any value in the trusted networks list implies that all other networks are untrusted.","The Include/Exclude Networks feature allow users to configure boundaries for the User-
ID service. By using the feature to limit User-ID probing to only trusted internal
networks, the risks of privileged information disclosure through sent probes can be
reduced. Note that if an entry appears in the Include/Exclude Networks section, an
implicit exclude-all-networks policy will take effect for all other networks.","Not restricting the networks subject to User Identification means that the administrative
credentials (userid and password hash) used for this task will transit untrusted networks,
or be sent to untrusted hosts. Capturing these credentials exposes them to offline
cracking attacks."
"2.5","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure that the User-ID Agent has minimal permissions if User-ID is enabled","Level 1","If the integrated (on-device) User-ID Agent is utilized, the Active Directory account for
the agent should only be a member of the Event Log Readers group, Distributed COM
Users group, and Domain Users group. If the Windows User-ID agent is utilized, the
Active Directory account for the agent should only be a member of the Event Log
Readers group, Server Operators group, and Domain Users group.

Default Value:
Not configured","","","Navigate to Active Directory Users and Computers.
Set the service account for the User-ID agent so that it is only a member of the Event
Log Readers, Distributed COM Users, and Domain Users (for the integrated, on-device
User-ID agent) or the Event Log Readers, Server Operators, and Domain Users groups
(for the Windows User-ID agent.)","","true","1. “Best Practices for Securing User-ID Deployments” -
https://live.paloaltonetworks.com/docs/DOC-7912
2. “User-ID Best Practices” - https://live.paloaltonetworks.com/docs/DOC-6591
3. “PAN-OS Administrator's Guide 11.1 (English) - Configure User Mapping Using
the Windows User-ID Agent” - https://docs.paloaltonetworks.com/pan-os/11-
1/pan-os-admin/user-id/map-ip-addresses-to-users/configure-user-mapping-
using-the-windows-user-id-agent
4. “PAN-OS Administrator's Guide 11.1 (English) - Configure User Mapping Using
the PAN-OS Integrated User-ID Agent” - https://docs.paloaltonetworks.com/pan-
os/11-1/pan-os-admin/user-id/map-ip-addresses-to-users/configure-user-
mapping-using-the-pan-os-integrated-user-id-agent","Navigate to Active Directory Users and Computers for the Active Directory under
consideration.
Verify that the service account for the User-ID agent is not a member of any groups
other than Event Log Readers, Distributed COM Users, and Domain Users (for the
integrated, on-device User-ID agent) or Event Log Readers, Server Operators, and
Domain Users (for the Windows User-ID agent.)","As a principle of least privilege, user accounts should have only minimum necessary
permissions. If an attacker compromises a User-ID service account with domain admin
rights, the organization is at far greater risk than if the service account were only
granted minimum rights.","Using accounts with full administrative privileges when those rights are not required is
always a bad idea. This is particularly true for service accounts of this type, which in
many organizations do not see strong passwords or frequent password changes. In
addition, service passwords are stored in the Windows Registry, and are recoverable
with the user of appropriate malicious tools. The principal of least privilege means that
any compromised accounts of this type have less value to an attacker, and expose
fewer assets based on their rights."
"2.6","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure that the User-ID service account does not have interactive logon rights","Level 1","Restrict the User-ID service account from interactively logging on to systems in the
Active Directory domain.

Default Value:
Not configured

Additional Information:
This recommendation has been marked as automated so that vendors can certify
against this. If using CISCAT the benchmark will need to be tailored and the user will
have to write the xpath with organization specific information","","","Navigate to Active Directory Group Policies.
Set Group Policies to restrict the interactive logon privilege for the User-ID service
account.
or
Navigate to Active Directory Managed Service Accounts.
Set Managed Service Accounts to restrict the interactive logon privilege for the User-ID
service account.","","true","1. “Best Practices for Securing User-ID Deployments” -
https://live.paloaltonetworks.com/docs/DOC-7912
2. “PAN-OS Administrator's Guide 11.1 (English) - Configure User Mapping Using
the Windows User-ID Agent” - https://docs.paloaltonetworks.com/pan-os/11-
1/pan-os-admin/user-id/map-ip-addresses-to-users/configure-user-mapping-
using-the-windows-user-id-agent
3. “PAN-OS Administrator's Guide 11.1 (English) - Configure User Mapping Using
the PAN-OS Integrated User-ID Agent” - https://docs.paloaltonetworks.com/pan-
os/11-1/pan-os-admin/user-id/map-ip-addresses-to-users/configure-user-
mapping-using-the-pan-os-integrated-user-id-agent
4. “User-ID Best Practices” - https://live.paloaltonetworks.com/docs/DOC-6591","Navigate to Active Directory Group Policies.
Verify that Group Policies restricts the interactive logon privilege for the User-ID service
account.
or
Navigate to Active Directory Managed Service Accounts.
Verify that Managed Service Accounts restricts the interactive logon privilege for the
User-ID service account.","In the event of a compromised User-ID service account, restricting interactive logins
forbids the attacker from utilizing services such as RDP against computers in the Active
Directory domain of the organization. This reduces the impact of a User-ID service
account compromise.",""
"2.7","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure remote access capabilities for the User-ID service account are forbidden.","Level 1","Restrict the User-ID service account’s ability to gain remote access into the
organization. This capability could be made available through a variety of technologies,
such as VPN, Citrix GoToMyPC, or TeamViewer. Remote services that integrate
authentication with the organization’s Active Directory may unintentionally allow the
User-ID service account to gain remote access.

Default Value:
Not configured","","","Remove this account from all groups that might grant remote access to the network, or
to any network services or hosts. Remediation is operating-system dependent. For
instance, in Windows Active Directory, this account should be removed from any group
that grants the account access to VPN or Wireless access. In addition, domain
administrative accounts by default have remote desktop (RDP) access to all domain
member workstations - this should be explicitly denied for this account.","","true","1. “Best Practices for Securing User-ID Deployments” -
https://live.paloaltonetworks.com/docs/DOC-7912
2. “User-ID Best Practices” - https://live.paloaltonetworks.com/docs/DOC-6591
3. “PAN-OS Administrator's Guide 11.1 (English) - Configure User Mapping Using
the Windows User-ID Agent” - https://docs.paloaltonetworks.com/pan-os/11-
1/pan-os-admin/user-id/map-ip-addresses-to-users/configure-user-mapping-
using-the-windows-user-id-agent
4. “PAN-OS Administrator's Guide 11.1 (English) - Configure User Mapping Using
the PAN-OS Integrated User-ID Agent” - https://docs.paloaltonetworks.com/pan-
os/11-1/pan-os-admin/user-id/map-ip-addresses-to-users/configure-user-
mapping-using-the-pan-os-integrated-user-id-agent","Auditing is operating-system dependent. For instance, in Windows Active Directory, this
account should not be included in any group that grants the account access to VPN or
Wireless access. In addition, domain administrative accounts should not have remote
desktop (RDP) access to all domain member workstations.","In the event of a compromised User-ID service account, restricting the account’s ability
to remotely access resources within the organization’s internal network reduces the
impact of a service account compromise.",""
"2.8","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure that security policies restrict User-ID Agent traffic from crossing into untrusted zones","Level 1","Create security policies to deny Palo Alto User-ID traffic originating from the interface
configured for the UID Agent service that are destined to any untrusted zone.

Additional Information:
This recommendation has been marked as automated so that vendors can certify
against this. If using CISCAT the benchmark will need to be tailored and the user will
have to write the xpath with organization specific information","","","Navigate to Device > Setup > Services > Services Features > Service Route
Configuration > Customize.
Click on the protocol in use (IPv4 and/or IPv6).
Click UID Agent.
Click on the address object for the UID Agent's IP address.
Set SOURCE/NAME to 'Deny msrpc to untrusted'.
Set SOURCE/ZONE to 'INSIDE'.
Set SOURCE/Address to the Address object for the UID Agent.
Set DESTINATION/ZONE to 'GUEST' and 'OUTSIDE'.
Set DESTINATION/Address to 'any'.
Set DESTINATION/Application to 'msrpc'.
Set DESTINATION/Service to 'application-default'.
Set DESTINATION/Action to 'Block' (red circle with diagonal line).","","true","1. “Best Practices for Securing User-ID Deployments” -
https://live.paloaltonetworks.com/docs/DOC-7912
2. “User-ID Best Practices” - https://live.paloaltonetworks.com/docs/DOC-6591
3. “PAN-OS Administrator's Guide 11.1 (English) - Configure User Mapping Using
the Windows User-ID Agent” - https://docs.paloaltonetworks.com/pan-os/11-
1/pan-os-admin/user-id/map-ip-addresses-to-users/configure-user-mapping-
using-the-windows-user-id-agent
4. “PAN-OS Administrator's Guide 11.1 (English) - Configure User Mapping Using
the PAN-OS Integrated User-ID Agent” - https://docs.paloaltonetworks.com/pan-
os/11-1/pan-os-admin/user-id/map-ip-addresses-to-users/configure-user-
mapping-using-the-pan-os-integrated-user-id-agent","Navigate to Device > Setup > Services > Services Features > Service Route
Configuration > Customize.
Click on the protocol in use (IPv4 and/or IPv6).
Click UID Agent.
Click on the address object for the UID Agent's IP address.
Verify SOURCE/NAME is set to 'Deny msrpc to untrusted'.
Verify SOURCE/ZONE is set to 'INSIDE'.
Verify SOURCE/Address is set to the Address object for the UID Agent.
Verify DESTINATION/ZONE is set to 'GUEST' and 'OUTSIDE'.
Verify DESTINATION/Address is set to 'any'.
Verify DESTINATION/Application is set to 'msrpc'.
Verify DESTINATION/Service is set to 'application-default'.
Verify DESTINATION/Action is set to 'Block' (red circle with diagonal line).","If User-ID and WMI probes are sent to untrusted zones, the risk of privileged information
disclosure exists. The information disclosed can include the User-ID Agent service
account name, domain name, and encrypted password hashes sent in User-ID and
WMI probes. To prevent this exposure, msrpc traffic originating from the firewall to
untrusted networks should be explicitly denied. This security policy should be in effect
even for environments not currently using WMI probing to help guard against possible
probe misconfigurations in the future.
This setting is a ""fail safe"" to prevent exposure of this information if any of the other
WMI User control settings are misconfigured.",""
"3.1","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure a fully-synchronized High Availability peer is configured","Level 1","Ensure a High Availability peer is fully synchronized and in a passive or active state.

Default Value:
Not Configured

Additional Information:
This recommendation has been marked as automated so that vendors can certify
against this. If using CISCAT the benchmark will need to be tailored and the user will
have to write the xpath with organization specific information","","","Navigate to Device > High Availability > HA Communications.
Click HA Communications. Click Data Link (HA2). Select the correct interface.
Select the desired protocol (IPv4 or IPv6). Select the correct Transport. Set the
Enable Session Synchronization box to be checked.
Choose Save Configuration.","","true","1. “PAN-OS Administrator's Guide 11.1 (English) - High Availability"" -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-
help/device/device-high-availability","Navigate to Device > High Availability > HA Communications.
In the HA Communications. >Data Link (HA2) section, verify that the correct
interface is selected. Verify the desired protocol (IPv4 or IPv6) is selected. Verify
the correct Transport is selected. Verify the Enable Session Synchronization box is
checked.","To ensure availability of both the firewall and the resources it protects, a High
Availability peer is required. In the event a single firewall fails, or when maintenance
such as a software update is required, the HA peer can be used to automatically fail
over session states and maintain overall availability","Not configuring High Availability (HA) correctly directly impacts the Availability of the
system. With HA in place, standard maintenance such as OS updates, network and
power cabling can be accomplished with no outage or a minimum impact."
"3.2","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure 'High Availability' requires Link Monitoring and/or Path Monitoring","Level 1","Configure Link Monitoring and/or Path Monitoring under High Availability options. If Link
Monitoring is utilized, all links critical to traffic flow should be monitored.

Default Value:
Not Configured

Additional Information:
This recommendation has been marked as automated so that vendors can certify
against this. If using CISCAT the benchmark will need to be tailored and the user will
have to write the xpath with organization specific information","","","To set Link Monitoring from GUI:
Navigate to Device > High Availability > Link and Path Monitoring. Click
Link Monitoring. Set the correct interfaces to the Link Group and Group Failure
Conditions. Click Link Monitoring. Set Failure Condition to Any. Check Enabled
button.
To set Path Monitoring from GUI:
Navigate to Device > High Availability > Link and Path Monitoring. Click
Path Monitoring. Set Option correctly. Set Failure Condition to Any. Set Name,
IP Address, Failure Condition correctly. Set Default setting to Any. Check
Enabled button.","","true","1. “PAN-OS Administrator's Guide 11.1 (English) - High Availability"" -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-
help/device/device-high-availability","To verify Link Monitoring from GUI:
Navigate to Device > High Availability > Link and Path Monitoring. In the
Link Monitoring section, verify the correct interfaces are in the Link Group and
Group Failure Conditions Under the Link Monitoring section, verify Failure
Condition is set to Any. Verify Enabled button is checked.
To verify Path Monitoring from GUI:
Navigate to Device > High Availability > Link and Path Monitoring. In the
Path Monitoring section, verify Option is set correctly. Verify Failure Condition is
set to Any. Verify Name, IP Address, Failure Condition is set correctly. Verify
Default setting is set to Any. Verify Enabled button is checked.","If Link or Path Monitoring is not enabled, the standby router will not automatically take
over as active if a critical link fails on the active firewall. Services through the firewall
could become unavailable as a result.","Not configuring High Availability (HA) correctly directly impacts the Availability of the
system. With HA in place, standard maintenance such as OS updates, network and
power cabling can be accomplished with no outage or a minimum impact.
Without Link and Path monitoring in particular, failover will only occur when the primary
device fails completely. Link and path monitoring permits failover if a critical interface
loses link (either due to cabling or an upstream switch failover), or if a route or path fails
(indicating an upstream issue that affects local Layer 3)."
"3.3","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure 'Passive Link State' and 'Preemptive' are configured appropriately","Level 1","Set the Passive Link State to auto, and uncheck the Preemptive option to disable it.

Default Value:
Not Configured","","","To set Active/Passive Settings correctly:
Navigate to Device > High Availability > General > Active/Passive
Settings.
Set Passive Link State to auto.
To set Election Settings correctly:
Navigate to Device > High Availability > Election Settings.
Set Preemptive to be disabled.","","true","1. “PAN-OS Administrator's Guide 11.1 (English) - High Availability"" -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-
help/device/device-high-availability","To ensure Active/Passive Settings are configured correctly:
Navigate to Device > High Availability > General > Active/Passive
Settings.
Verify Passive Link State is set to auto.
To ensure Election Settings are configured correctly:
Navigate to Device > High Availability > Election Settings.
Verify Preemptive is disabled.","Simultaneously enabling the 'Preemptive' option and setting the 'Passive Link State'
option to 'Shutdown' could cause a 'preemptive loop' if Link and Path Monitoring are
both configured. This will negatively impact the availability of the firewall and network
services, should a monitored failure occur.","Incorrectly configuring this setting will adversely affect availability, rather than positively
affect it."
"4.1","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure 'Antivirus Update Schedule' is set to download and install updates hourly","Level 1","Set Antivirus Update Schedule to download and install updates hourly.

Default Value:
Not Configured","","","Navigate to Device > Dynamic Updates > Antivirus Update Schedule.
Set Action to Download and Install.
Set Recurrence to Hourly.","","true","1. “Tips for Managing Content Updates” -
https://live.paloaltonetworks.com/docs/DOC-1578
2. “PAN-OS Administrator's Guide 9.0 (English) -Dynamic Content Updates"" -
https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/software-and-
content-updates/dynamic-content-updates.html
3. “PAN-OS Administrator's Guide 9.0 (English) - Install Content Updates"" -
https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/software-and-
content-updates/install-content-and-software-updates.html","Navigate to Device > Dynamic Updates > Antivirus Update Schedule.
Verify that Action is set to Download and Install.
Verify that Recurrence is set to Hourly.","New antivirus definitions may be released at any time. With an hourly update schedule,
the firewall can ensure threats with new definitions are quickly mitigated. A daily update
schedule could leave an organization vulnerable to a known virus for nearly 24 hours, in
a worst-case scenario. Setting an appropriate threshold value reduces the risk of a bad
definition file negatively affecting traffic.",""
"4.2","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure 'Applications and Threats Update Schedule' is set to download and install updates at daily or shorter intervals","Level 1","Set the Applications and Threats Update Schedule to download and install updates at
daily or shorter intervals.

Default Value:
This setting is by default set to Weekly.","","","Navigate to Device > Dynamic Updates > Application and Threats Update
Schedule.
Set Action to Download and Install.
Set Recurrence to Daily, Hourly or Every 30 Minutes","","true","1. “Tips for Managing Content Updates” -
https://live.paloaltonetworks.com/docs/DOC-1578
2. “PAN-OS Administrator's Guide 9.0 (English) -Dynamic Content Updates"" -
https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/software-and-
content-updates/dynamic-content-updates.html
3. “PAN-OS Administrator's Guide 9.0 (English) - Install Content Updates"" -
https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/software-and-
content-updates/install-content-and-software-updates.html","Navigate to Device > Dynamic Updates > Application and Threats Update
Schedule.
Verify that Action is set to Download and Install.
Verify that Recurrence is set to Daily, Hourly or Every 30 Minutes","New Applications and Threats file versions may be released at any time. With a
frequent update schedule, the firewall can ensure threats with new signatures are
quickly mitigated, and the latest application signatures are applied.
It is recommended that 30 Minute intervals are used","Having a shorter update frequency can in rare occasions cause latency issues."
"5.1","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure that WildFire file size upload limits are maximized","Level 1","The default file size limits on the firewall are designed to include the majority of malware
in the wild (which is smaller than the default size limits) and to exclude large files that
are very unlikely to be malicious and that can impact WildFire file-forwarding capacity.

Default Value:
In PAN-OS 9.x, the default file sizes for WildFire are:
• pe (Portable Executable) - 16MB
• apk (Android Application)- 10MB
• pdf (Portable Document Format) - 3072KB
• ms-office (Microsoft Office) — 16384KB
• jar (Packaged Java class file) — 5MB
• flash (Adobe Flash) — 5MB
• MacOSX (DMG/MAC-APP/MACH-O PKG files) — 10MB
• archive (RAR and 7z files) — 50MB
• linux (ELF files) — 50MB
• script (JScript, VBScript, PowerShell, and Shell Script)- 20KB","","","Navigate to Device > Setup > WildFire.
Click the General Settings edit icon.
Set the maximum size for each file type are larger than the defaults, to a size that is as
large enough to account for ""large"" files, but not large enough to affect performance of
the hardware.
In PAN-OS 9.x and higher, the default file sizes for WildFire are:
• pe (Portable Executable) - 16MB
• apk (Android Application)- 10MB
• pdf (Portable Document Format) - 3072KB
• ms-office (Microsoft Office) — 16384KB
• jar (Packaged Java class file) — 5MB
• flash (Adobe Flash) — 5MB
• MacOSX (DMG/MAC-APP/MACH-O PKG files) — 10MB
• archive (RAR and 7z files) — 50MB
• linux (ELF files) — 50MB
• script (JScript, VBScript, PowerShell, and Shell Script)- 20KB
In PAN-OS 9.x and higher, the maximum file sizes for Wildfire are:
• pe (Portable Executable) - 50MB
• apk (Android Application)- 50MB
• pdf (Portable Document Format) - 51200KB
• ms-office (Microsoft Office) — 51200KB
• jar (Packaged Java class file) — 20MB
• flash (Adobe Flash) — 10MB
• MacOSX (DMG/MAC-APP/MACH-O PKG files) — 50MB
• archive (RAR and 7z files) — 50MB
• linux (ELF files) — 50MB
• script (JScript, VBScript, PowerShell, and Shell Script)- 4096KB","","true","1. “How to Configure WildFire” - https://live.paloaltonetworks.com/docs/DOC-3252
2. https://docs.paloaltonetworks.com/wildfire/10-2/wildfire-admin/wildfire-
deployment-best-practices/wildfire-best-practices","Navigate to Device > Setup > WildFire.
Navigate to the General Settings sections.
Verify the maximum size for each file type at the defaults or larger, to a size that is as
large enough to account for ""large"" files, but not large enough to affect performance of
the hardware.","Because the firewall has a specific capacity reserved to forward files for WildFire
analysis, forwarding high numbers of large files can cause the firewall to skip forwarding
of some files. This condition occurs when the maximum file size limits are configured for
a file type that is traversing the firewall at a high rate. In this case, a potentially
malicious file might not get forwarded for WildFire analysis. Consider this possible
condition if you would like to increase the size limit for files other than PEs beyond their
default size limit.","Using larger file filtering can cause the system to skip files in the event multiple larger
files are sent."
"5.2","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure a WildFire Analysis profile is enabled for all security policies","Level 1","Ensure that all files traversing the firewall are inspected by WildFire by setting a Wildfire
file blocking profile on all security policies.

Default Value:
Not Configured

Additional Information:
This recommendation has been marked as automated so that vendors can certify
against this. If using CISCAT the benchmark will need to be tailored and the user will
have to write the xpath with organization specific information","","","To Set File Blocking Profile:
• Navigate to Objects > Security Profiles > WildFire Analysis Profile.
• Create a WildFire profile that has 'Application Any', 'File Types Any', and
'Direction Both'
To Set WildFire Analysis Rules:
• Navigate to Policies > Security.
• For each Security Policy Rule where the action is ""Allow"", Navigate to Actions >
Profile Setting > WildFire Analysis and set a WildFire Analysis profile.
Group Profiles can also be used. To take this approach:
• Navigate to Objects > Security Profile Groups. Create a Security Profile
Group, and ensure that (among other settings) the Wildfire Analysis
Profile is set to the created profile.
• Navigate to Policies > Security. For each Security Policy Rule where the
action is ""Allow"", Navigate to Actions > Profile Setting. Modify the Profile
Type to Group, and set the Group Profile to the created Security Profile Group.","","true","1. “Wildfire Administrator's Guide 9.0 (English)"" -
https://docs.paloaltonetworks.com/wildfire/9-0/wildfire-admin.html","To verify WildFire Analysis Profile:
• Navigate to Objects > Security Profiles > WildFire Analysis Profile
verify that a profile exists.
To verify File Blocking Rules:
• For each Security Policy were the action is set to Allow, edit the Rule and
navigate to Actions > Profile Setting. Ensure that the WildFire
Analysis is set to Allow and verify that a profile is set.
If Group Profiles are used:
• Navigate to Policies > Security
• For each Security Policy were the action is set to Allow, edit the Rule and
navigate to Actions > Profile Setting. Ensure that the Profile Type is set
to Group.
• Navigate to Objects > Security Profile Groups. Open the Security Profile Group
used above, and ensure that the Wildfire Analysis Profile is set.","Traffic matching security policies that do not include a WildFire file blocking profile will
not utilize WildFire for file analysis. Wildfire analysis is one of the key security measures
available on this platform. Without Wildfire analysis enabled, inbound malware can only
be analyzed by signature - which industry wide is roughly 40-60% effective. In a
targeted attack, the success of signature-based-only analysis drops even further.",""
"5.4","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure all WildFire session information settings are enabled","Level 1","Enable all options under Session Information Settings for WildFire.

Default Value:
All Session Information Settings are enabled by default. These include:
• Source IP
• Source port
• Destination IP
• Destination port
• Virtual System
• Application
• User
• URL
• File name
• Email sender
• Email recipient
• Email subject

Additional Information:
This recommendation has been marked as automated so that vendors can certify
against this. If using CISCAT the benchmark will need to be tailored and the user will
have to write the xpath with organization specific information","","","Navigate to Device > Setup > WildFire > Session Information Settings.
Set every option to be enabled.","","true","1. “Wildfire Administrator's Guide 9.0 (English)"" -
https://docs.paloaltonetworks.com/wildfire/9-0/wildfire-admin.html#
2. “Wildfire Administrator's Guide 9.0 (English) - Wildfire Best Practices"" -
/https://docs.paloaltonetworks.com/wildfire/9-0/wildfire-admin/wildfire-
deployment-best-practices/wildfire-best-practices.html","Navigate to Device > Setup > WildFire > Session Information Settings.
Verify that every option is enabled.","Permitting the firewall to send all of this information to WildFire creates more detailed
reports, thereby making the process of tracking down potentially infected devices more
efficient. This could prevent an infected system from further infecting the environment.
Environments with security policies restricting sending this data to the WildFire cloud
can instead utilize an on-premises WildFire appliance. In addition, risk can be analyzed
in the context of the destination host and user account, either during analysis or during
incident response.",""
"5.5","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure alerts are enabled for malicious files detected by WildFire","Level 1","Configure WildFire to send an alert when a malicious or greyware file is detected. This
alert could be sent by whichever means is preferable, including email, SNMP trap, or
syslog message.
Alternatively, configure the WildFire cloud to generate alerts for malicious files. The
cloud can generate alerts in addition to or instead of the local WildFire implementation.
Note that the destination email address of alerts configured in the WildFire cloud portal
is tied to the logged in account, and cannot be modified. Also, new systems added to
the WildFire cloud portal will not be automatically set to email alerts.

Default Value:
Not Configured

Additional Information:
This recommendation has been marked as automated so that vendors can certify
against this. If using CISCAT the benchmark will need to be tailored and the user will
have to write the xpath with organization specific information","","","From GUI, configure some combination of the following Server Profiles:
Configure the Email Server: Select Device > Server Profiles > Email Click Add
Enter a name for the Profile. Select the virtual system from the Location drop down
menu (if applicable) Click Add
Configure the Syslog Server: Select Device > Server Profiles > Syslog > Add
Enter Name, Display Name, Syslog Server, Transport, Port, Format,
Facility Click OK Click Commit to save the configuration
Configure the SMTP Server: Select Device > Server Profiles > Email Select
Add, Name, Display Name, From, To, Additional Recipients, Gateway IP
or Hostname Click OK Click Commit to save the configuration
Navigate to Objects, Log Forwarding Choose Add, set the log type to ""wildfire"", add
the filter ""(verdict neq benign)"", then add log destinations for SNMP, Syslog, Email or
HTTP as required.","","true","1. “WildFire Email Alerts: Subscribe or Add Additional Recipients” -
https://live.paloaltonetworks.com/docs/DOC-7740
2. “Wildfire Administrator's Guide 9.0 (English)"" -
https://docs.paloaltonetworks.com/wildfire/9-0/wildfire-admin.html","Navigate to Objects > Log Forwarding.
Verify that the WildFire log type is configured to generate alerts using the desired
alerting mechanism(s).","WildFire analyzes files that have already been downloaded and possibly executed. A
WildFire verdict of malicious indicates that a computer could already be infected. In
addition, because WildFire only analyzes files it has not already seen that were not
flagged by the firewall’s antivirus filter, files deemed malicious by WildFire are more
likely to evade detection by desktop antivirus products.",""
"5.6","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure 'WildFire Update Schedule' is set to download and install updates in real-time","Level 1","Set the WildFire update schedule to download and install updates in real-time.

Default Value:
Not Configured","","","Navigate to Device > Dynamic Updates > WildFire Update Schedule.
Set Recurrence is set to Real-time.","","true","1. “Wildfire What's New in 10.0 (English)"" -
https://docs.paloaltonetworks.com/wildfire/u-v/wildfire-whats-new/wildfire-
features-in-panos-100/wildfire-real-time-signature-updates
2. “How to Configure WildFire” - https://live.paloaltonetworks.com/docs/DOC-3252
3. “Tips for Managing Content Updates” -
https://live.paloaltonetworks.com/docs/DOC-1578","Navigate to Device > Dynamic Updates > WildFire Update Schedule.
Verify that Recurrence is set to Real-time.","WildFire definitions may contain signatures to block immediate, active threats to the
environment. With updates in real-time, the firewall can ensure threats with new
definitions are quickly mitigated.",""
"5.7","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Choosing Wildfire public cloud region","Level 2","By default, all relevant files are uploaded to Wildfire datacenter located in US. Palo Alto
Networks has been adding more WildFire regional clouds around the world. From
having just 3 regional clouds back in PanOS 8.x, now to more than 10 regional clouds
all over the world.

Default Value:
wildfire.paloaltonetworks.com","","","Navigate to Device > Setup > WildFire.
Navigate to the General Settings sections.
Click the General Settings edit icon.
Change the WildFire Public Cloud to your appropriate region.","","true","1. ""List of Available Wildfire Regions"" -
https://docs.paloaltonetworks.com/advanced-wildfire/administration/advanced-
wildfire-overview/advanced-wildfire-deployments/advanced-wildfire-global-cloud
2. ""Announcements as More Regions are Added"" -
https://docs.paloaltonetworks.com/wildfire","Navigate to Device > Setup > WildFire.
Navigate to the General Settings sections.
Verify that WildFire Public Cloud is set to your appropriate region.","Depending on regulations, files is only allowed to be uploaded to local country / region.
Besides, uploading to local country or even nearest country decreases file uploading
speed.
Refer to the available regions in the references below.","With default values, all relevant files are uploaded to wildfire.paloaltonetworks.com
which is located in US."
"5.8","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure that 'Inline Cloud Analysis' on Wildfire profiles is enabled","Level 1","Enable 'Advanced WildFire Inline Cloud Analysis' on Wildfire profiles and forward PE
files for analysis. Palo Alto Networks Advanced WildFire operates a series of cloud-
based ML detection engines that provide inline analysis of PE (portable executable) files
traversing your network to detect and prevent advanced malware in real-time.

Default Value:
Not Configured","","","Navigate to Objects > Security Profiles > Wildfire
On relevant Wildfire profile, checked Enable cloud inline analysis box.
On Inline cloud analysis tab, configure a rule to forward files with the following
settings:
• Application set to Any
• File Type set to PE
• Direction set to Both
• Action set to Block","","true","1. “Advanced WildFire (English)” - https://docs.paloaltonetworks.com/advanced-
wildfire/administration/configure-advanced-wildfire-analysis/enable-advanced-
wildfire-inline-cloud-analysis","Navigate to Objects > Security Profiles > Wildfire
Verify that Wildfire profiles has Enable cloud inline analysis checked.
On Inline cloud analysis tab, verify that there is a rule to forward files with the
following settings:
• Application set to Any
• File Type set to PE
• Direction set to Both
• Action set to Block","Advanced WildFire Inline Cloud Analysis uses a lightweight forwarding mechanism on
the firewall to minimize performance impact. The cloud-based ML models are updated
seamlessly, to address the ever-changing threat landscape without requiring content
updates or feature release support.
Advanced WildFire Inline Cloud Analysis is enabled and configured through the WildFire
Analysis profile and requires PAN-OS 11.1 or later with an active Advanced WildFire
license.
As of PAN-OS 11.1, only PE file type is supported.",""
"6.1","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure that antivirus profiles are set to reset-both on all decoders except 'imap' and 'pop3'","Level 1","Configure antivirus profiles to a value of 'reset-both' for all decoders except imap and
pop3 under both Action and WildFire Action. If required by the organization's email
implementation, configure imap and pop3 decoders to 'alert' under both Action and
WildFire Action.

Default Value:
Not Configured

Additional Information:
This recommendation has been marked as automated so that vendors can certify
against this. If using CISCAT the benchmark will need to be tailored and the user will
have to write the xpath with organization specific information","","","Navigate to Objects > Security Profiles > Antivirus.
Set antivirus profiles to have all decoders set to reset-both for both Action and
Wildfire Action. If imap and pop3 are required in the organization, set the imap and
pop3 decoders to alert for both Action and Wildfire Action.","","true","1. “Threat Prevention Deployment Tech Note” -
https://live.paloaltonetworks.com/docs/DOC-3094
2. “PAN-OS Administrator's Guide 11.1 (English) - Security Profiles” -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/policy/security-
profiles
3. ""KB on reset-server, reset-client or silent drop"" -
https://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA10g000000
ClTaCAK","Navigate to Objects > Security Profiles > Antivirus
Verify that antivirus profiles have all decoders set to reset-both for both Action and
Wildfire Action. If imap and pop3 are required in the organization, verify that the
imap and pop3 decoders are set to alert for both Action and Wildfire Action.","Antivirus signatures produce low false positives. By blocking any detected malware
through the specified decoders, the threat of malware propagation through the firewall is
greatly reduced. It is recommended to mitigate malware found in pop3 and imap
through a dedicated antivirus gateway. Due to the nature of the pop3 and imap
protocols, the firewall is not able to block only a single email message containing
malware. Instead, the entire session would be terminated, potentially affecting benign
email messages.",""
"6.2","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure a secure antivirus profile is applied to all relevant security policies","Level 1","Create a secure antivirus profile and apply it to all security policies that could pass
HTTP, SMTP, IMAP, POP3, FTP, or SMB traffic. The antivirus profile may be applied to
the security policies directly or through a profile group.

Default Value:
No Antivirus Profiles are enabled on any default or new Security Policy","","","Navigate to Policies > Security . For each policy, navigate to [Policy Name] >
Actions
Set an Antivirus profile or a Profile Group containing an AV profile for each
security policy passing traffic - regardless of protocol.","","true","1. “PAN-OS Administrator's Guide 11.1 (English) - Security Policies ” -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/policy/security-
policy
2. “PAN-OS Administrator's Guide 11.1 (English) - Security Profiles” -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/policy/security-
profiles","Navigate to Policies > Security . For each policy, navigate to [Policy Name] >
Actions Verify there is a secure Antivirus profile applied to all security policies
passing traffic - regardless of protocol. This can be set by Profiles or by Profile Group.","By applying a secure antivirus profile to all applicable traffic, the threat of malware
propagation through the firewall is greatly reduced. Without an antivirus profile assigned
to any potential hostile zone, the first protection in the path against malware is removed,
leaving in most cases only the desktop endpoint protection application to detect and
remediate any potential malware.","Not having an AV Profile on a Security Policy allows signature-based malware to transit
the security boundary without blocks or alerts. In most cases this leaves only the
Endpoint Security application to block or alert malware."
"6.3","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure an anti-spyware profile is configured to block on specified spyware severity levels, categories, and threats","Level 1","If a single rule exists within the anti-spyware profile, configure it to block on Critical,
High, and Medium spyware severity level, any category, and any threat. If multiple rules
exist within the anti-spyware profile, ensure all spyware categories, threats, and severity
levels (Critical, High, and Medium) are set to be blocked. Additional rules may exist for
packet capture or exclusion purposes.

Default Value:
Two Anti-Spyware Security Profiles are configured by default ""strict"" and ""default"".

Additional Information:
This recommendation has been marked as automated so that vendors can certify
against this. If using CISCAT the benchmark will need to be tailored and the user will
have to write the xpath with organization specific information","","","Navigate to Objects > Security Profiles > Anti-Spyware. Click on existing
profile in used or create a new profile.
Navigate to Signature Policies tab. Add new policy by giving it a name Policy
Name.
Set a Policy Name exists within the anti-spyware profile that is configured to perform
the reset-both on Critical, High, and Medium Severity level, any
Category, and any Threat Name.","","true","1. ""PAN OS Administrator's Guide 11.1 (English) - Anti-Spyware Profile"" -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-
help/objects/objects-security-profiles-anti-spyware-profile","Navigate to Objects > Security Profiles > Anti-Spyware. Click on existing
profile in used or create a new profile.
Navigate to Signature Policies tab. Add new policy by giving it a name Policy
Name.
Verify a Policy Name exists within the anti-spyware profile that is configured to perform
the reset-both on Critical, High, and Medium Severity level, any
Category, and any Threat Name.","Requiring a blocking policy for all spyware threats, categories, and severities (Critical,
High, and Medium) reduces the risk of spyware traffic from successfully exiting the
organization. Without an anti-spyware profile assigned to any potential hostile zone, the
first protection in the path against malware is removed, leaving in most cases only the
desktop endpoint protection application to detect and remediate any potential spyware.",""
"6.4","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure DNS sinkholing is configured on all anti-spyware profiles in use","Level 1","Configure DNS sinkholing for all anti-spyware profiles in use. All internal requests to the
selected sinkhole IP address must traverse the firewall. Any device attempting to
communicate with the DNS sinkhole IP address should be considered infected.

Default Value:
Not Configured","","","Navigate to Objects > Security Profiles > Anti-Spyware.
Within the each anti-spyware profile, under its DNS Policies tab, set the Signature
Source List: default-paloalto-dns should have as its Policy Action set to
sinkhole If licensed, the DNS Security should have as its Policy Action set to
sinkhole
Verify the 'Sinkhole IPv4' IP address is correct. This should be set to
sinkhole.paloaltnetworks.com, or if an internal host is set then that host IP or
FQDN should be in that field
Verify the 'Sinkhole IPv6' IP address is correct. This should be set to IPv6 Loopback
IP (::1), or if an internal DNS Sinkhole host is set then that host IP or FQDN should
be in that field
Navigate to Policies > Security Policies For each outbound security Policy, in
the Actions tab, set the Anti-Spyware setting to include the Spyware Profile created,
either explicitly or as a Group Profile","","true","1. “How to Deal with Conficker using DNS Sinkhole” -
https://live.paloaltonetworks.com/docs/DOC-6628
2. “Threat Prevention Deployment Tech Note” -
https://live.paloaltonetworks.com/docs/DOC-3094
3. ""PAN OS Administrator's Guide 11.1 (English) - Anti-Spyware Profile"" -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-
help/objects/objects-security-profiles-anti-spyware-profile","Navigate to Objects > Security Profiles > Anti-Spyware.
Within the each anti-spyware profile, under its DNS Policies tab, verify the Signature
Source List: default-paloalto-dns should have as its Policy Action set to
sinkhole If licensed, the DNS Security should have as its Policy Action set to
sinkhole
Verify the 'Sinkhole IPv4' IP address is correct. This should be set to
sinkhole.paloaltnetworks.com, or if an internal host is set then that host IP or
FQDN should be in that field
Verify the 'Sinkhole IPv6' IP address is correct. This should be set to IPv6 Loopback
IP (::1), or if an internal DNS Sinkhole host is set then that host IP or FQDN should
be in that field
Navigate to Policies > Security Policies For each outbound security Policy, in
the Actions tab, verify that the Anti-Spyware setting includes the Spyware Profile
created, either explicitly or as a Group Profile
To verify correct operation of DNS Security, from an internal station make a DNS
request to each of the following hosts:
• test-malware.testpanw.com to test Malware DNS Signature checks
• test-c2.testpanw.com to test C2 DNS Signature checks
• test-dga.testpanw.com to test DGA (Domain Generation Algorithm) DNS attack
checks
• test-dnstun.testpanw.com to test DNS Tunneling attack checks Each of
these DNS requests should be redirected to the configured DNS Sinkhole server
IP address Each of these DNS requests should appear in the firewall logs, under
Monitor > Logs > Threat. If configured, each of these requests should
generate an alert in the organization's SIEM.","DNS sinkholing helps to identify infected clients by spoofing DNS responses for
malware domain queries. Without sinkholing, the DNS server itself may be seen as
infected, while the truly infected device remains unidentified. In addition, sinkholing also
ensures that DNS queries that might be indicators of compromise do not transit the
internet, where they could be potentially used to negatively impact the ""ip reputation"" of
the organization's internet network subnets.",""
"6.5","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure a secure anti-spyware profile is applied to all security policies permitting traffic to the Internet","Level 1","Create one or more anti-spyware profiles and collectively apply them to all security
policies permitting traffic to the Internet. The anti-spyware profiles may be applied to the
security policies directly or through a profile group.

Default Value:
Not Configured

Additional Information:
This recommendation has been marked as automated so that vendors can certify
against this. If using CISCAT the benchmark will need to be tailored and the user will
have to write the xpath with organization specific information","","","Navigate to Objects > Security Profiles > Anti-Spyware.
Also navigate to Policies > Security.
Set one or more anti-spyware profiles to collectively apply to all inside to outside traffic
from any address to any address and any application and service.","","true","1. “Threat Prevention Deployment Tech Note” -
https://live.paloaltonetworks.com/docs/DOC-3094
2. “PAN-OS Administrator's Guide 9.0 (English) - Security Profiles” -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/policy/security-
profiles","Navigate to Objects > Security Profiles > Anti-Spyware.
Also navigate to Policies > Security.
Verify there are one or more anti-spyware profiles that collectively apply to all inside to
outside traffic from any address to any address and any application and service.","By applying secure anti-spyware profiles to all applicable traffic, the threat of sensitive
data exfiltration or command-and-control traffic successfully passing through the firewall
is greatly reduced. Anti-spyware profiles are not restricted to particular protocols like
antivirus profiles, so anti-spyware profiles should be applied to all security policies
permitting traffic to the Internet. Assigning an anti-spyware profile to each trusted zone
will quickly and easily identify trusted hosts that have been infected with spyware, by
identifying the infection from their outbound network traffic. In addition, that outbound
network traffic will be blocked by the profile.",""
"6.6","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure a Vulnerability Protection Profile is set to block attacks against critical and high vulnerabilities, and set to default on medium, low, and informational vulnerabilities","Level 1","Configure a Vulnerability Protection Profile set to block attacks against any critical or
high vulnerabilities, at minimum, and set to default on any medium, low, or informational
vulnerabilities. Configuring an alert action for low and informational, instead of default,
will produce additional information at the expense of greater log utilization.

Default Value:
Two Vulnerability Protection Profiles are configured by default - ""strict"" and ""default"".","","","Navigate to Objects > Security Profiles > Vulnerability Protection.
Set a Vulnerability Protection Profile to block attacks against any critical or high
vulnerabilities (minimum), and to default on attacks against any medium, low, or
informational vulnerabilities.","","true","1. “Threat Prevention Deployment Tech Note” -
https://live.paloaltonetworks.com/docs/DOC-3094
2. “PAN-OS Administrator's Guide 11.1 (English) - Security Profiles” -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/policy/security-
profiles","Navigate to Objects > Security Profiles > Vulnerability Protection.
Verify a Vulnerability Protection Profile is set to block attacks against any critical or high
vulnerabilities (minimum), and set to default on attacks against any medium, low, or
informational vulnerabilities.","A Vulnerability Protection Profile helps to protect assets by alerting on, or blocking,
network attacks. The default action for attacks against many critical and high
vulnerabilities is to only alert on the attack - not to block.","Not configuring a Vulnerability Protection Profile means that network attacks will not be
logged, alerted on or blocked."
"6.7","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure a secure Vulnerability Protection Profile is applied to all security rules allowing traffic","Level 1","For any security rule allowing traffic, apply a securely configured Vulnerability Protection
Profile. Careful analysis of the target environment should be performed before
implementing this configuration, as outlined by PAN’s “Threat Prevention Deployment
Tech Note” in the references section.

Default Value:
Not Configured

Additional Information:
This recommendation has been marked as automated so that vendors can certify
against this. If using CISCAT the benchmark will need to be tailored and the user will
have to write the xpath with organization specific information","","","Navigate to Policies > Security.
For each Policy, under the Actions tab, select Vulnerability Protection.
Set it to use either the 'Strict' or the 'Default' profile, or a custom profile that complies
with the organization's policies, legal and regulatory requirements.","","true","1. “Threat Prevention Deployment Tech Note” -
https://live.paloaltonetworks.com/docs/DOC-3094
2. “PAN-OS Administrator's Guide 11.1 (English) - Security Policies” -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/policy/security-
policy
3. “PAN-OS Administrator's Guide 11.1 (English) - Security Profiles” -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/policy/security-
profiles","Navigate to Policies > Security.
For each Policy, under the Actions tab, select Vulnerability Protection.
Verify either the 'Strict' or the 'Default' profile is selected, or a custom profile that
complies with the organization's policies, legal and regulatory requirements.","A Vulnerability Protection Profile helps to protect assets by alerting on, or blocking
network attacks. By applying a secure Vulnerability Protection Profile to all security rules
permitting traffic, all network traffic traversing the firewall will be inspected for attacks.
This protects both organizational assets from attack and organizational reputation from
damage.
Note that encrypted sessions do not allow for complete inspection.","Not configuring a Vulnerability Protection Profile means that network attacks will not be
logged, alerted on or blocked."
"6.8","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure that PAN-DB URL Filtering is used","Level 1","Configure the device to use PAN-DB URL Filtering instead of BrightCloud.

Default Value:
Not Configured

Additional Information:
This recommendation has been marked as automated so that vendors can certify
against this. If using CISCAT the benchmark will need to be tailored and the user will
have to write the xpath with organization specific information","","","Navigate to Device > Licenses.
Click on PAN-DB URL Filtering.
Set Active to Yes.","","true","1. “PAN-OS Administrator's Guide 9.0 (English) - URL Filtering” -
https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/url-filtering.html
2. “PAN-OS Administrator's Guide 9.0 (English) - URL Filtering Best Practices"" -
https://docs.paloaltonetworks.com/advanced-url-
filtering/administration/configuring-url-filtering/url-filtering-best-practices","Navigate to Device > Licenses.
Click on PAN-DB URL Filtering.
Verify Active is set to Yes.","Standard URL filtering provides protection against inappropriate and malicious URLs
and IP addresses. PAN-DB URL Filtering is slightly less granular than the BrightCloud
URL filtering. However the PAN-DB Filter offers additional malware protection and PAN
threat intelligence by using the Wildfire service as an additional input, which is currently
not available in the BrightCloud URL Filtering license. This makes the PAN-DB filter
more responsive to specific malware ""campaigns"".","Not having an effective URL Filtering configuration can leave an organization open to
legal action, internal HR issues, non-compliance with regulatory policies or productivity
loss."
"6.9","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure that URL Filtering uses the action of “block” or “override” on the URL categories","Level 1","Ideally, deciding which URL categories to block, and which to allow, is a joint effort
between IT and another entity of authority within an organization—such as the legal
department or administration. For most organizations, blocking or requiring an override
on the following categories represents a minimum baseline: adult, hacking, command-
and-control, copyright-infringement, extremism, malware, phishing, proxy-avoidance-
and-anonymizers, and parked. Some organizations may add ""unknown"" and ""dynamic-
dns"" to this list, at the expense of some support calls on those topics.

Default Value:
Not Configured

Additional Information:
This recommendation has been marked as automated so that vendors can certify
against this. If using CISCAT the benchmark will need to be tailored and the user will
have to write the xpath with organization specific information","","","Navigate to Objects > Security Profiles > URL Filtering.
Set a URL filter so that all URL categories designated by the organization are listed.
Navigate to the Actions tab.
Set the action to Block.","","true","1. “PAN-OS Administrator's Guide 11.1 (English) - Security Profiles” -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/policy/security-
profiles
2. “PAN-OS Administrator's Guide 9.0 (English) - URL Filtering” -
https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/url-filtering.html
3. “PAN-OS Admin Guide 9.0 (English) - URL Filtering Best Practices"" -
https://docs.paloaltonetworks.com/advanced-url-
filtering/administration/configuring-url-filtering/url-filtering-best-practices","Navigate to Objects > Security Profiles > URL Filtering.
Verify that all URL categories designated by the organization are listed, and the action
is set to Block.","Certain URL categories pose a technology-centric threat, such as command-and-
control, copyright-infringement, extremism, malware, phishing, proxy-avoidance-and-
anonymizers, and parked. Users visiting websites in these categories, many times
unintentionally, are at greater risk of compromising the security of their system. Other
categories, such as adult, may pose a legal liability and will be blocked for those
reasons.","Not having an effective URL Filtering configuration can leave an organization open to
legal action, internal HR issues, non-compliance with regulatory policies or productivity
loss."
"6.10","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure that access to every URL is logged","Level 1","URL filters should not specify any categories as Allow Categories.

Default Value:
A default URL Filtering Security Profile is configured, with the following categories set to
""block"": abused-drugs adult gambling hacking malware phishing questionable weapons
3 Categories are set to alert in the default policy, and 58 Categories are set to allow
(which means they are not logged)

Additional Information:
This recommendation has been marked as automated so that vendors can certify
against this. If using CISCAT the benchmark will need to be tailored and the user will
have to write the xpath with organization specific information","","","Navigate to Objects > Security Profiles > URL Filtering.
For each permitted category, set the Site Access actioun to alert","","true","1. “PAN-OS Administrator's Guide 11.1 (English) - URL Filtering Best Practices"" -
https://docs.paloaltonetworks.com/advanced-url-
filtering/administration/configuring-url-filtering/url-filtering-best-practices
2. “PAN-OS Administrator's Guide 9.0 (English) - URL Filtering” -
https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/url-filtering.html","Navigate to Objects > Security Profiles > URL Filtering.
Verify that the for all allowed categories, that the Site Access action is set to alert","Setting a URL filter to have one or more entries under Allow Categories will cause no
log entries to be produced in the URL Filtering logs for access to URLs in those
categories. For forensic, legal, and HR purposes, it is advisable to log access to every
URL. In many cases failure to log all URL access is a violation of corporate policy, legal
requirements or regulatory requirements.","Not having an effective URL Filtering configuration can leave an organization open to
legal action, internal HR issues, non-compliance with regulatory policies or productivity
loss."
"6.11","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure all HTTP Header Logging options are enabled","Level 1","Enable all options (User-Agent, Referer, and X-Forwarded-For) for HTTP header
logging.

Default Value:
Not Configured

Additional Information:
This recommendation has been marked as automated so that vendors can certify
against this. If using CISCAT the benchmark will need to be tailored and the user will
have to write the xpath with organization specific information","","","Navigate to Objects > Security Profiles > URL Filtering > URL Filtering
Profile > URL Filtering Settings.
Set the following four settings:
a. Log container page only box is un-checked
b. Check the User-Agent box
c. Check the Referer box
d. Check the X-Forwarded-For box","","true","1. “PAN-OS Administrator's Guide 11.1 (English) - URL Filtering Best Practices"" -
https://docs.paloaltonetworks.com/advanced-url-
filtering/administration/configuring-url-filtering/url-filtering-best-practices","Navigate to Objects > Security Profiles > URL Filtering > URL Filtering
Profile > URL Filtering Settings.
Verify these four settings:
a. Log container page only box is un-checked
b. User-Agent box is checked
c. Referer box is checked
d. X-Forwarded-For box is checked","Logging HTTP header information provides additional information in the URL logs,
which may be useful during forensic investigations. The User-Agent option logs which
browser was used during the web session, which could provide insight to the vector
used for malware retrieval. The Referer option logs the source webpage responsible for
referring the user to the logged webpage. The X-Forwarded-For option is useful for
preserving the user’s source IP address, such as if a user traverses a proxy server prior
to the firewall. Un-checking the Log container page only box produces substantially
more information about web activity, with the expense of producing far more entries in
the URL logs. If this option remains checked, a URL filter log entry showing details of a
malicious file download may not exist.","Not having an effective URL Filtering configuration can leave an organization open to
legal action, internal HR issues, non-compliance with regulatory policies or productivity
loss."
"6.12","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure secure URL filtering is enabled for all security policies allowing traffic to the Internet","Level 1","Apply a secure URL filtering profile to all security policies permitting traffic to the
Internet. The URL Filtering profile may be applied to the security policies directly or
through a profile group.

Default Value:
Not Configured

Additional Information:
This recommendation has been marked as automated so that vendors can certify
against this. If using CISCAT the benchmark will need to be tailored and the user will
have to write the xpath with organization specific information","","","To Set URL Filtering: For each Security Profile that transits traffic to the internet,
navigate to Policies > Security > Security Profiles > [Policy Name] >
Actions.
Set a URL Filtering profile that complies with the policies of the organization is applied
to all Security Policies that transit traffic to the public internet.","","true","1. “PAN-OS Administrator's Guide 11.1 (English) - URL Filtering Best Practices"" -
https://docs.paloaltonetworks.com/advanced-url-
filtering/administration/configuring-url-filtering/url-filtering-best-practices","To Verify URL Filtering:
For each Security Policy that transits traffic to the public internet, navigate to Policies
> Security > Security Profiles > [Policy Name] > Actions.
Verify there is a URL Filtering profile that complies with the policies of the organization
is applied to all Security Policies that transit traffic to the public internet.","URL Filtering policies dramatically reduce the risk of users visiting malicious or
inappropriate websites. In addition, a complete URL history log for all devices is
invaluable when performing forensic analysis in the event of a security incident.
Applying complete and approved URL filtering to outbound traffic is a frequent
requirement in corporate policies, legal requirements or regulatory requirements.","Not having an effective URL Filtering configuration can leave an organization open to
legal action, internal HR issues, non-compliance with regulatory policies or productivity
loss."
"6.13","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure alerting after a threshold of credit card or Social Security numbers is detected is enabled","Level 1","This guideline is highly specific to an organization. While blocking of credit card or
Social Security numbers will not occur with the recommended settings below, careful
tuning is also recommended.

Default Value:
Not Configured

Additional Information:
This recommendation has been marked as automated so that vendors can certify
against this. If using CISCAT the benchmark will need to be tailored and the user will
have to write the xpath with organization specific information","","","Navigate to Objects > Custom Objects > Data Patterns.
Create an appropriate Data Pattern that accounts for sensitive information within your
organization. In most cases this will include Credit Card Numbers, and your jurisdiction's
equivalent of Social Insurance Numbers. In many cases these can simply be picked
from the list of Predefined Patterns.
Navigate to Objects > Security Profiles > Data Filtering.
Create appropriate Data Filtering Profile, using the created Data Patterns.
Ensure that an Alert Threshold is set that generates alerts appropriately. A typical
starting value for Alert Threshold is 20, but this should be adjusted after appropriate
testing.","","true","1. “What are the Data Filtering Best Practices?” -
https://live.paloaltonetworks.com/docs/DOC-2513
2. “PAN-OS Administrator's Guide 9.0 (English) - Setting up Data Filtering"" -
https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/threat-
prevention/set-up-data-filtering.html#","Navigate to Objects > Custom Objects > Data Patterns.
Verify an appropriate Data Pattern has been created that accounts for sensitive
information within your organization. In most cases this will include Credit Card
Numbers, and your jurisdiction's equivalent of Social Insurance Numbers. In many
cases these can simply be picked from the list of Predefined Patterns.
Navigate to Objects > Security Profiles > Data Filtering.
Verify an appropriate Data Filtering Profile has been created, using the created
Data Patterns. Ensure that an Alert Threshold is set that generates alerts
appropriately. A typical starting value for Alert Threshold is 20, but this should be
adjusted after appropriate testing.","Credit card and Social Security numbers are sensitive, and should never traverse an
organization’s Internet connection in clear text. Passing sensitive data within an
organization should also be avoided whenever possible. Detecting and blocking known
sensitive information is a basic protection against a data breach or data loss. Not
implementing these defenses can lead to loss of regulatory accreditation (such as PCI,
HIPAA etc), or can lead to legal action from injured parties or regulatory bodies.",""
"6.14","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure a secure Data Filtering profile is applied to all security policies allowing traffic to or from the Internet","Level 1","Create a secure Data Filtering profile and apply it to all security policies permitting traffic
to or from the Internet. The Data Filtering profile may be applied to security policies
directly or through a profile group.

Default Value:
Not Configured

Additional Information:
This recommendation has been marked as automated so that vendors can certify
against this. If using CISCAT the benchmark will need to be tailored and the user will
have to write the xpath with organization specific information","","","Navigate to Objects > Custom Objects > Data Patterns. Add patterns to match
the various data that you wish to monitor or make blocking decisions on.
Navigate to Objects > Security Profiles > Data Filtering Add a Filtering
Profile that matches the data you wish to monitor, with appropriate values for Alert
Threshold (typically 20), Block Threshold (typically 0) and Log Serverity
Finally, apply the Filtering Profile to a Security Profile. Navigate to Policies >
Security. Edit all appropriate policies, and for each Policy choose the Actions tab,
and add the appropriate Data Filtering Policy (either as an individual Profile or
as part of a Group Profile)","","true","1. “PAN-OS Administrator's Guide 9.0 (English) - Setting up Data Filtering"" -
https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/threat-
prevention/set-up-data-filtering.html#","Navigate to Objects > Custom Objects > Data Patterns. Verify that the patterns
defined match the various data that you wish to monitor or make blocking decisions on.
Navigate to Objects > Security Profiles > Data Filtering For each Filtering
Profile, verify that the Data Patterns defined matches the data you wish to monitor,
with appropriate values for Alert Threshold (typically 20), Block Threshold
(typically 0) and Log Severity.
Finally, navigate to Policies > Security. Open all appropriate policies, for each
Policy choose the Actions tab, and verify that the appropriate Data Filtering
Policy is applied (either as an individual Profile or as part of a Group Profile)","A Data Filtering profile helps prevent certain types of sensitive information from
traversing an organization’s Internet connection, especially in clear text. Detecting and
blocking known sensitive information is a basic protection against a data breach or data
loss. Not implementing these defenses can lead to loss of regulatory accreditation (such
as PCI, HIPAA etc), or can lead to legal action from injured parties or regulatory bodies.
Before starting, be very aware that Data Filtering will often block data that you didn't
anticipate, false positives will definitely occur. Even the prebuilt filters will frequently
match on unintended data in files or websites. Work very closely with your user
community to ensure that required data is blocked or alerted on, but a minimum of false
positive blocks occur. As false positives occur, ensure that your user community has a
clear and timely procedure to get the configuration updated.",""
"6.15","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure that a Zone Protection Profile with an enabled SYN Flood Action of SYN Cookies is attached to all untrusted zones","Level 1","Enable the SYN Flood Action of SYN Cookies for all untrusted zones. The Alert,
Activate, and Maximum settings for SYN Flood Protection depend highly on the
environment and device used. Perform traffic analysis on the specific environment and
firewall to determine accurate thresholds. Do not rely on default values to be
appropriate for an environment.
Setting these values for all interfaces is an approach that should be considered by many
organizations, as traffic floods can result from internal testing or malware as well.
As a rough ballpark for most environments, an Activate value of 50% of the firewall’s
maximum “New sessions per second”/CPS is a conservative setting. The following is a
list of maximum new sessions per second for each platform (listed here is for the largest
model for each series):
PA-4xx series = 73,000 CPS
PA-8xx series = 13,100 CPS
PA-14xx series = 140,000 CPS
PA-32xx series = 84,000 CPS
PA-34xx series = 268,000 CPS
PA-52xx series = 500,000 CPS
PA-54xx series = 3,600,000 CPS
PA-70xx series = 6,000,000 CPS
Note:
Please confirm the exact maximum CPS using latest datasheet published by Palo Alto
Networks based on the exact series model of a given platform.

Default Value:
Not Configured","","","From GUI:
Navigate to Network > Network Profiles > Zone Protection > Zone
Protection Profile > Flood Protection tab.
Check the SYN box. Set the Action dropdown to SYN Cookies Set Alert to 20000 (or
appropriate for org). Set Activate to 25000 (50% of maximum for firewall model). Set
Maximum to 1000000 (or appropriate for org)
Navigate to Network > Zones. Open the zone facing any untrusted network, if one
does not exist create it. Set Zone Protection to the Zone Protection Profile
created.","","true","1. “Understanding DoS Protection” - https://live.paloaltonetworks.com/docs/DOC-
5078
2. ""Syn Cookie Operation” - https://live.paloaltonetworks.com/docs/DOC-1542
3. “How to Determine if Configured DoS Classify TCP SYN Cookie Alarm, Activate
and Maximal Rate is Triggered” - https://live.paloaltonetworks.com/docs/DOC-
6801
4. “Threat Prevention Deployment Tech Note” -
https://live.paloaltonetworks.com/docs/DOC-3094
5. “What are the Differences between DoS Protection and Zone Protection?” -
https://live.paloaltonetworks.com/docs/DOC-4501
6. “Application DDoS Mitigation” - https://live.paloaltonetworks.com/docs/DOC-7158
7. PANOS 11.1 Admin Guide - Zone Protection . Flood Protection -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-
help/network/network-network-profiles/network-network-profiles-zone-
protection/flood-protection","From GUI:
Navigate to Network > Network Profiles > Zone Protection > Zone
Protection Profile > Flood Protection tab.
Verify the SYN box is checked. Verify the Action dropdown is SYN Cookies. Verify Alert
is 20000 (or appropriate for org). Verify Activate is 25000 (50% of maximum for firewall
model). Verify Maximum is 1000000 (or appropriate for org).
Navigate to Network > Zones. Open the zone facing any untrusted network. Verify that
Zone Protection has the Zone Protection Profile set to the Profile created.","Protecting resources and the firewall itself against DoS/DDoS attacks requires a layered
approach. Firewalls alone cannot mitigate all DoS attacks, however, many attacks can
be successfully mitigated. Utilizing SYN Cookies helps to mitigate SYN flood attacks,
where the CPU and/or memory buffers of the victim device become overwhelmed by
incomplete TCP sessions. SYN Cookies are preferred over Random Early Drop.","Not configuring a Network Zone Protection Profile on untrusted interfaces leaves an
organization exposed to common attacks and reconnaissance from those untrusted
networks. Not configuring a Zone Protection Profile for internal networks leaves an
organization vulnerable to malware, software or hardware causes of traffic flooding from
internal sources."
"6.16","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure that a Zone Protection Profile with tuned Flood Protection settings enabled for all flood types is attached to all untrusted zones","Level 2","Enable all Flood Protection options in the Zone Protection Profile attached to all
untrusted zones. The Alert, Activate, and Maximum settings for Flood Protection
depend highly on the environment and device used. Perform traffic analysis on the
specific environment and firewall to determine accurate thresholds. Do not rely on
default values to be appropriate for an environment.
Setting these values for all interfaces is an approach that should be considered by many
organizations, as traffic floods can result from internal testing or malware as well.

Default Value:
Not Configured","","","In the GUI:
Navigate to Network > Network Profiles > Zone Protection > Flood
Protection.
Set all settings to ""enabled"" with at least the default values.
Navigate to Network > Zones, select each untrusted zone in turn, and set the Zone
Protection Profile.","","true","1. “Understanding DoS Protection” - https://live.paloaltonetworks.com/docs/DOC-
5078
2. “Threat Prevention Deployment Tech Note” -
https://live.paloaltonetworks.com/docs/DOC-3094
3. “What are the Differences between DoS Protection and Zone Protection?” -
https://live.paloaltonetworks.com/docs/DOC-4501
4. PANOS 11.1 Admin Guide - Network Profiles / Zone Protection / Flood Protection
- https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-
help/network/network-network-profiles/network-network-profiles-zone-
protection/flood-protection","In the GUI:
Navigate to Network > Network Profiles > Zone Protection > Flood
Protection.
Ensure that all settings are enabled with at least the default values.
Navigate to Network > Zones, select each untrusted zone in turn, and ensure that the
Zone Protection Profile is set.","Without flood protection, it may be possible for an attacker, through the use of a botnet
or other means, to overwhelm network resources. Flood protection does not completely
eliminate this risk; rather, it provides a layer of protection. Without a properly configured
zone protection profile applied to untrusted interfaces, the protected / trusted networks
are susceptible to large number of attacks. While many of these involve denial of
service, some of these attacks are designed to evade IPS systems (fragmentation
attacks for instance) or to evade basic firewall protections (source routing and record
route attacks).","Not configuring and applying a Network Zone Protection Profile leaves an organization
exposed to common attacks and reconnaissance from untrusted networks.
Not configuring a Zone Protection Profile for internal networks leaves an organization
vulnerable to malware, software or hardware causes of traffic flooding from internal
sources."
"6.17","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure that all zones have Zone Protection Profiles with all Reconnaissance Protection settings enabled, tuned, and set to appropriate actions","Level 1","Enable all three scan options in a Zone Protection profile. Do not configure an action of
Allow for any scan type. The exact interval and threshold values must be tuned to the
specific environment. Less aggressive settings are typically appropriate for trusted
zones, such as setting an action of alert for all scan types.
Attach appropriate Zone Protection profiles meeting these criteria to all zones. Separate
Zone Protection profiles for trusted and untrusted zones is a best practice.

Default Value:
Not Configured

Additional Information:
This recommendation has been marked as automated so that vendors can certify
against this. If using CISCAT the benchmark will need to be tailored and the user will
have to write the xpath with organization specific information","","","Navigate to Network > Network Profiles > Zone Protection > Zone
Protection Profile > Reconnaissance Protection.
Set TCP Port Scan to enabled, its Action to block-ip, its Interval to 5, and its
Threshold to 20. For block-ip, set the ""Track By"" is set to source and ""Duration"" is set
to 600 seconds.
Set Host Sweep to enabled, its Action to block, its Interval to 10, and its Threshold to
30.
Set UDP Port Scan to enabled, its Action to alert, its Interval to 10, and its Threshold
to 20.","","true","1. “Host Sweep Triggering Method in Zone Protection Profile” -
https://live.paloaltonetworks.com/docs/DOC-8703
2. “Understanding DoS Protection” - https://live.paloaltonetworks.com/docs/DOC-
5078
3. “Threat Prevention Deployment Tech Note” -
https://live.paloaltonetworks.com/docs/DOC-3094
4. “What are the Differences between DoS Protection and Zone Protection?” -
https://live.paloaltonetworks.com/docs/DOC-4501
5. PANOS 11.1 Admin Guide - Network Profiles / Zone Protection /
Reconnaissance Protection - https://docs.paloaltonetworks.com/pan-os/11-
1/pan-os-web-interface-help/network/network-network-profiles/network-network-
profiles-zone-protection/reconnaissance-protection","Navigate to Network > Network Profiles > Zone Protection > Zone
Protection Profile > Reconnaissance Protection.
Verify that TCP Port Scan is enabled, its Action is set to block-ip, its Interval is set to
5, and its Threshold is set to 20. For block-ip, ensure the ""Track By"" is set to source
and ""Duration"" is set to 600 seconds.
Verify that Host Sweep is enabled, its Action is set to block, its Interval is set to 10,
and its Threshold is set to 30.
Verify that UDP Port Scan is enabled, its Action is set to alert, its Interval is set to 10,
and its Threshold is set to 20.","Port scans and host sweeps are common in the reconnaissance phase of an attack.
Bots scouring the Internet in search of a vulnerable target may also scan for open ports
and available hosts. Reconnaissance Protection will allow for these attacks to be either
alerted on or blocked altogether.","Not configuring a Network Zone Protection Profile leaves an organization exposed to
common attacks and reconnaissance from untrusted networks."
"6.18","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure all zones have Zone Protection Profiles that drop specially crafted packets","Level 1","For all zones, attach a Zone Protection Profile that is configured to drop packets with a
spoofed IP address or a mismatched overlapping TCP segment, and packets with
malformed, strict source routing, or loose source routing IP options set.

Default Value:
Not Configured","","","Navigate to Network > Network Profiles > Zone Protection > Zone
Protection Profile > Packet Based Attack Protection > TCP/IP Drop.
Set Spoofed IP address to be checked.
Set Mismatched overlapping TCP segment to be checked.
Under IP Option Drop, set Strict Source Routing, Loose Source Routing, and
Malformed to all be checked. Additional options may also be set if desired.","","true","1. “Understanding DoS Protection” - https://live.paloaltonetworks.com/docs/DOC-
5078
2. “Threat Prevention Deployment Tech Note” -
https://live.paloaltonetworks.com/docs/DOC-3094
3. “What are the Differences between DoS Protection and Zone Protection?” -
https://live.paloaltonetworks.com/docs/DOC-4501
4. PANOS 11.1 Admin Guide - Network Profiles / Zone Protection / Packet Based
Attack Protection - https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-
interface-help/network/network-network-profiles/network-network-profiles-zone-
protection/packet-based-attack-protection","Navigate to Network > Network Profiles > Zone Protection > Zone
Protection Profile > Packet Based Attack Protection > TCP/IP Drop.
Verify Spoofed IP address is checked.
Verify Mismatched overlapping TCP segment is checked.
Under IP Option Drop, verify that Strict Source Routing, Loose Source
Routing, and Malformed are all checked. Additional options may also be checked.","Using specially crafted packets, an attacker may attempt to evade or diminish the
effectiveness of network security devices. Enabling the options in this recommendation
lowers the risk of these attacks.","Not configuring a Network Zone Protection Profile leaves an organization exposed to
common attacks and reconnaissance from untrusted networks."
"6.19","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure that User Credential Submission uses the action of “block” or “continue” on the URL categories","Level 1","Ideally user names and passwords user within an organization are not used with third
party sites. Some sanctioned SAS applications may have connections to the corporate
domain, in which case they will need to be exempt from the user credential submission
policy through a custom URL category.

Default Value:
Not Configured

Additional Information:
This recommendation has been marked as automated so that vendors can certify
against this. If using CISCAT the benchmark will need to be tailored and the user will
have to write the xpath with organization specific information","","","Navigate to Objects > Security Profiles > URL Filtering.
Choose the Categories tab. Set the User Credential Submitting action on all
enabled URL categories is either block or continue, as appropriate to your
organization and the category.
Under the User Credential Detection tab set the User Credential Detection
value to a setting appropriate to your organization, any value except Disabled. Set the
Log Severity to a value appropriate to your organization and your logging or SIEM
solution.","","true","1. PAN OS 11.1 Admin Guide - URL Filtering / User Credential Detection -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-
help/objects/objects-security-profiles-url-filtering/user-credential-detection","Navigate to Objects > Security Profiles > URL Filtering.
Choose the Categories tab. Verify that the User Credential Submitting action on
all enabled URL categories is set to either block or continue.
Under the User Credential Detection tab ensure the User Credential
Detection is set to a value appropriate to your organization, and is not set to
Disabled. Verify that the Log Severity value is set to a value appropriate to your
organization and your logging or SIEM solution.","Preventing users from having the ability to submit their corporate credentials to the
Internet could stop credential phishing attacks and the potential that a breach at a site
where a user reused credentials could lead to a credential stuffing attack.","Not preventing users from submitting their corporate credentials to the Internet can
leave them open to phishing attacks or allow for credential reuse on unauthorized sites.
Using internal email accounts provides malicious actors with intelligence information,
which can be used for phishing, credential stuffing and other attacks. Using internal
passwords will often provide authenticated access directly to sensitive information. Not
only that, but a pattern of credential re-use can expose personal information from
multiple online sources."
"6.20","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure that 'Wildfire Inline ML Action' on antivirus profiles are set to reset-both on all decoders except 'imap' and 'pop3'","Level 1","Configure 'Wildfire Inline ML Action' on antivirus profiles to a value of 'reset-both' for all
decoders except imap and pop3 under 'Wildfire Inline ML Action'. If required by the
organization's email implementation, configure imap and pop3 decoders to 'alert' under
'Wildfire Inline ML Action'.

Default Value:
Not Configured","","","Navigate to Objects > Security Profiles > Antivirus
Set antivirus profiles to have all decoders set to reset-both for Wildfire Inline ML
Action. If imap and pop3 are required in the organization, set the imap and pop3
decoders are set to alert for Wildfire Inline ML Action.","","true","1. “PAN-OS Administrator's Guide 11.1 (English) - Security Profiles” -
https://docs.paloaltonetworks.com/advanced-wildfire/administration/configure-
advanced-wildfire-analysis/enable-advanced-wildfire-inline-ml","Navigate to Objects > Security Profiles > Antivirus
Verify that antivirus profiles have all decoders set to reset-both for Wildfire Inline
ML Action. If imap and pop3 are required in the organization, verify that the imap and
pop3 decoders are set to alert for Wildfire Inline ML Action.","Starting from PanOS 10, Wildfire supports real-time detection and blocking. As more
attacks are designed to bypass signature-based protection, real-time signatureless-
based protection is needed. Antivirus signatures produce low false positives. By
blocking any detected malware through the specified decoders, the threat of malware
propagation through the firewall is greatly reduced. It is recommended to mitigate
malware found in pop3 and imap through a dedicated antivirus gateway. Due to the
nature of the pop3 and imap protocols, the firewall is not able to block only a single
email message containing malware. Instead, the entire session would be terminated,
potentially affecting benign email messages.",""
"6.21","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure that 'Wildfire Inline ML' on antivirus profiles are set to enable for all file types","Level 1","Configure 'Wildfire Inline ML' on antivirus profiles to a value of 'enable' for all file types.

Default Value:
Not Configured

Additional Information:
This recommendation has been marked as automated so that vendors can certify
against this. If using CISCAT the benchmark will need to be tailored and the user will
have to write the xpath with organization specific information","","","Navigate to Objects > Security Profiles > Antivirus
Go to Wildfire Inline ML tab. Set enable (inherit per-protocol actions) for
all Model on Action Setting.","","true","1. “PAN-OS Administrator's Guide 11.1 (English) - Security Profiles” -
https://docs.paloaltonetworks.com/advanced-wildfire/administration/configure-
advanced-wildfire-analysis/enable-advanced-wildfire-inline-ml","Navigate to Objects > Security Profiles > Antivirus
Go to Wildfire Inline ML tab. Verify that all Action Setting are set to enable
(inherit per-protocol actions).","Starting from PanOS 10, Wildfire supports real-time detection and blocking. As more
attacks are designed to bypass signature-based protection, real-time signatureless-
based protection is needed. With this new functionality, common file types used for
malware delivery such as Windows Executables, PowerShell Script, MSOffice, Shell,
and Executable Linked Format (ELF) can be inspected using Wildfire and malicious files
are blocked in real-time.",""
"6.22","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure that 'Inline Cloud Analysis' on Vulnerability Protection profiles are enabled if 'Advanced Threat Prevention' is available","Level 1","Enable 'Inline Cloud Analysis' on Vulnerability Protection profiles to combat zero-day
threats.

Default Value:
Not Configured

Additional Information:
This recommendation has been marked as automated so that vendors can certify
against this. If using CISCAT the benchmark will need to be tailored and the user will
have to write the xpath with organization specific information","","","Navigate to Objects > Security Profiles > Vulnerability Protection
Go to Inline Cloud Analysis tab. Tick the checkbox for Enable cloud inline
analysis. Verify that all Model action is set as alert.
Note that, firewall device certificate is used to authenticate to the Advanced Threat
Prevention inline cloud analysis service. This step is required before 'Inline Cloud
Analysis' can be used. Refer to reference for detailed guide.","","true","1. “Configuring Vulnerability Protection Inline Cloud Analysis Guide (English)” -
https://docs.paloaltonetworks.com/pan-os/11-0/pan-os-new-features/content-
inspection-features/vuln-protection-inline-cloud-analysis","Navigate to Objects > Security Profiles > Vulnerability Protection
Go to Inline Cloud Analysis tab. Verify that it is enabled and all Model action is set
as alert.","Starting from PanOS 11, Palo Alto Networks now operates new inline deep learning
detection engines in the Advanced Threat Prevention cloud to analyze traffic for
command injection and SQL injection vulnerabilities in real-time to protect users against
zero-day threats. By operating cloud-based detection engines, you can access a wide
array of detection mechanisms that are updated and deployed automatically without
requiring the user to download update packages or operate process intensive, firewall-
based analyzers which can sap resources.
It is recommended to set the action as 'alert' during initial deployment and monitor it's
false positive, configure the exclusion URL and IP before moving to 'reset-both' action.",""
"6.23","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure that 'Cloud Inline Categorization' on URL Filtering profiles are enabled if 'Advanced Threat Prevention' is available","Level 1","Enable both 'Local Inline Categorization' and 'Cloud Inline Categorization' on URL
Filtering profiles to evaluate suspicious web page contents in real-time to protect users
against zero-day threats.

Default Value:
Not Configured

Additional Information:
This recommendation has been marked as automated so that vendors can certify
against this. If using CISCAT the benchmark will need to be tailored and the user will
have to write the xpath with organization specific information","","","Navigate to Objects > Security Profiles > URL Filtering
Go to Inline Categorization tab. Tick the checkbox for both Enable local inline
categorization and Enable cloud inline categorization.
Note that:
1. Firewall device certificate is used to authenticate to the Advanced Threat
Prevention inline cloud analysis service. This step is required before 'Inline Cloud
Analysis' can be used. Refer to reference for detailed guide.
2. 'Local Inline Categorization' can be enabled with just the URL Filtering license
(no Advanced Threat Prevention is needed).","","true","1. “Configuring Cloud Inline Categorization for URL Filtering Guide (English)” -
https://docs.paloaltonetworks.com/pan-os/10-2/pan-os-new-features/url-filtering-
features/cloud-inline-categorization
2. “PAN-OS Administrator's Guide 11.1 (English) - Inline Categorization” -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-
help/objects/objects-security-profiles-url-filtering/inline-categorization","Navigate to Objects > Security Profiles > URL Filtering
Go to Inline Categorization tab. Verify that it is enabled for both Enable local
inline categorization and Enable cloud inline categorization.","Starting from PanOS 10, Palo Alto Networks Advanced URL Filtering now operates a
series of inline cloud-based deep learning detectors that evaluate suspicious web page
contents in real-time to protect users against zero-day threats. This includes cloaked
websites, multi-step attacks, CAPTCHA challenges, and previously unseen one-time-
use URLs.",""
"6.24","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure that 'Inline Cloud Analysis' on Anti-Spyware profiles are enabled if 'Advanced Threat Prevention' is available","Level 1","Enable 'Inline Cloud Analysis' on Anti-Spyware profiles to detect and protection against
advanced, highly-evasive zero-day command-and-control (C2) threats.

Default Value:
Not Configured","","","Navigate to Objects > Security Profiles > Anti-Spyware
Go to Inline Cloud Analysis tab. Tick the checkbox for Enable cloud inline
analysis. Verify that all Model action is set as reset-both.
Note that, firewall device certificate is used to authenticate to the Advanced Threat
Prevention inline cloud analysis service. This step is required before Inline Cloud
Analysis can be used. Refer to reference for detailed guide.","","true","1. “Configuring Inline Cloud Analysis Guide (English)” -
https://docs.paloaltonetworks.com/advanced-threat-
prevention/administration/configure-threat-prevention/configure-inline-cloud-
analysis#idcf1fc426-b522-4e84-9098-ac82f2d784ae","Navigate to Objects > Security Profiles > Anti-Spyware
Go to Inline Cloud Analysis tab. Verify that it is enabled and all Model action is set
as reset-both.","Starting from PanOS 10, Palo Alto Networks now operates a series of ML-based
detection engines in the Advanced Threat Prevention cloud to analyze traffic for
advanced C2 (command-and-control) and spyware threats in real-time to protect users
against zero-day threats. By operating cloud-based detection engines, you can access
a wide array of detection mechanisms that are updated and deployed automatically
without requiring the user to download update packages or operate process intensive,
firewall-based analyzers which can sap resources.
The cloud-based detection engine logic is continuously monitored and updated using
C2 traffic datasets from WildFire, with additional support through manual updates by
Palo Alto Networks threat researchers, who provide human intervention for highly
accurized detection enhancements.",""
"6.25","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure that 'DNS Policies' is configured on Anti-Spyware profiles if 'DNS Security' license is available","Level 1","DNS security is an extensible cloud-based service capable of generating DNS
signatures using advanced predictive analytics and machine learning. DNS Security
protects from sophisticated DNS-based attacks.

Default Value:
Not Configured","","","Navigate to Objects > Security Profiles > Anti-Spyware
Go to DNS Policies tab. Configure policy action to sinkhole for all DNS Security
categories.
On Command and control Domains category, set the packet capture option to
extended-capture.","","true","1. “Configuring DNS Security” - https://docs.paloaltonetworks.com/dns-
security/administration/configure-dns-security/enable-dns-security#tabs-
id066476b2-c4dd-4fc0-b7e4-f4ba32e19f60
2. ""DNS Security Best Practices"" - https://docs.paloaltonetworks.com/advanced-
threat-prevention/administration/threat-prevention/best-practices-for-securing-
your-network-from-layer-4-and-layer-7-evasions","Navigate to Objects > Security Profiles > Anti-Spyware
Go to DNS Policies tab. Verify that policy action is set to sinkhole for all DNS
Security categories.
On Command and control Domains category, verify that the packet capture option to
extended-capture.Navigate to Objects > Security Profiles > Anti-Spyware
Go to DNS Policies tab. Configure policy action to sinkhole for all DNS Security
categories.
On Command and control Domains category, set the packet capture option to
extended-capture","DNS traffic are normally allowed on firewall. With this in mind, attackers leverage on this
attack surface to evade detections or extract out data. Starting from PanOS 9, Palo Alto
Networks has launched DNS Security services to combat against evassive malwares
and to detect DNS tunneling activities.
For DNS Security to be effective, ""Threat Prevention"" or ""Advanced Threat Prevention""
license must be purchased in addition of ""DNS Security"" license.",""
"7.1","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure application security policies exist when allowing traffic from an untrusted zone to a more trusted zone","Level 2","When permitting traffic from an untrusted zone, such as the Internet or guest network, to
a more trusted zone, such as a DMZ segment, create security policies specifying which
specific applications are allowed.
**Enhanced Security Recommendation: ** Require specific application policies when
allowing any traffic, regardless of the trust level of a zone. Do not rely solely on port
permissions. This may require SSL interception, and may also not be possible in all
environments.

Default Value:
Not Configured

Additional Information:
This recommendation has been marked as automated so that vendors can certify
against this. If using CISCAT the benchmark will need to be tailored and the user will
have to write the xpath with organization specific information","","","Navigate to Policies > Security.
For all Security Policies that transit from a less trusted to a more trusted interface,
set the Application and Service values to match the exposed application. For
instance, for a web server exposed to the internet from a DMZ: Source tab: Zone set to
OUTSIDE / Address set to Any Destination tab: Zone set to DMZ / Address set to [DMZ
Host Object] Application tab: set to web-browsing Service/URL Category tab:
set Service to ether:
• application-default or:
• service-http and/or service-https
**Enhanced Security Recommendation: **
Set these values for Policies on all Interfaces, for traffic in all directions. For each
Security Policy, set the Application and Service values to match the exposed
application.","","true","1. “PAN-OS Administrator's Guide 11.1 (English) - Security Policies / Applications
and Usage ” - https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-
interface-help/policies/policies-security/applications-and-usage","Navigate to Policies > Security.
For all Security Policies that transit from a less trusted to a more trusted interface, that
the appropriate Application and Service values are set. For instance, for a web
server exposed to the internet from a DMZ: Source tab: Zone set to OUTSIDE / Address
set to Any Destination tab: Zone set to DMZ / Address set to [DMZ Host Object]
Application tab: set to web-browsing Service/URL Category tab: set Service to
ether:
• application-default or:
• service-http and/or service-https
**Enhanced Security Recommendation: **
Assess this setting for Policies on all Interfaces, for traffic in all directions. Ensure that
for each Security Policy that the appropriate settings are set for both Application and
Service","To avoid unintentionally exposing systems and services, rules allowing traffic from
untrusted zones to trusted zones should be as specific as possible. Application-based
rules, as opposed to service/port rules, further tighten what traffic is allowed to pass.
Similarly, traffic from trusted to untrusted networks should have a security policy set,
with application-based rules. A ""catch-all"" rule that allows all applications will also allow
malware traffic. The goal should be to understand both inbound and outbound traffic,
permit what is known, and block all other traffic.","Setting application based rules on both inbound and outbound traffic ensures that the
traffic on the protocol and port being specified is actually the application that you expect.
For outbound traffic, the days of ""we trust our users"" is well past us, that statement also
implies that we trust the malware on the user workstations, which is obviously not the
case.
For traffic from trusted to less trusted interfaces, the applications should be
characterized over time, with the end goal being that all applications in in the rules, and
a final ""block all"" rule is in place. Not having this goal gives both attackers and malware
the leeway they need to accomplish their goals.
Trusting only Port permissions to control traffic exposes an organization to ""tunneling""
style attacks that can exfiltrate data or facilitate Command and Control (C2) sessions."
"7.2","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure 'Service setting of ANY' in a security policy allowing traffic does not exist","Level 1","Create security policies specifying application-default for the Service setting, in addition
to the specific ports desired. The Service setting of any should not be used for any
policies that allow traffic.

Default Value:
Not Configured

Additional Information:
This recommendation has been marked as automated so that vendors can certify
against this. If using CISCAT the benchmark will need to be tailored and the user will
have to write the xpath with organization specific information","","","Navigate to Policies > Security.
For each exposed host, set a Security Policy exists with:
• Source tab: Zone set to OUTSIDE Address set to any
• Destination tab: Zone set to DMZ / Address set to <DMZ Host Object>
• Application tab: Application set to web-browsing (or appropriate
application)
• Service tab: Service set to application-default. The value of any should
never be used","","true","1. “Security Policy Guidelines” - https://live.paloaltonetworks.com/docs/DOC-3469
2. “Security Bulletin: App-ID Cache Pollution” -
http://researchcenter.paloaltonetworks.com/2012/12/app-id-cache-pollution-
response/
3. “PAN-OS Administrator's Guide 11.1 (English) - Security Policiy Overview ” -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-
help/policies/policies-security/security-policy-overview","Navigate to Policies > Security.
For each exposed host, verify that a Security Policy exists with:
• Source tab: Zone set to OUTSIDE Address set to any
• Destination tab: Zone set to DMZ / Address set to <DMZ Host Object>
• Application tab: Application set to web-browsing (or appropriate
application)
• Service tab: Service set to application-default. The value of any should
never be used","App-ID requires a number of packets to traverse the firewall before an application can
be identified and either allowed or dropped. Due to this behavior, even when an
application is defined in a security policy, a service setting of any may allow a device in
one zone to perform ports scans on IP addresses in a different zone. In addition, this
recommendation helps to avoid an App-ID cache pollution attack.
Because of how App-ID works, configuring the service setting to ""Any"" allows some
initial traffic to reach the target host before App-ID can recognize and appropriately
restrict the traffic. Setting the Service Setting to application specific at least restricts the
traffic to the target applications or protocols for that initial volume of traffic.",""
"7.3","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure 'Security Policy' denying any/all traffic to/from IP addresses on Trusted Threat Intelligence Sources Exists","Level 1","Create a pair of security rules at the top of the security policies ruleset to block traffic to
and from IP addresses known to be malicious.
Note: This recommendation (as written) requires a Palo Alto Networks ""Threat
Prevention License"". Third Party and Open Source Threat Intelligence Feeds can also
be used for this purpose.

Default Value:
Not Configured

Additional Information:
This recommendation has been marked as automated so that vendors can certify
against this. If using CISCAT the benchmark will need to be tailored and the user will
have to write the xpath with organization specific information","","","Navigate to Policies > Security
Create a Security Policy similar to:
• General tab: Name set to Deny to Malicious IP
• Source tab: Source Zone set to Any,
• Destination tab: Destination Zone set to Any, Destination Address set to
Palo Alto Networks - Known malicious IP addresses,Palo Alto
Networks - High risk IP addresses, Palo Alto Networks - Tor exit
IP addresses, Palo Alto Networks - Bulletproof IP addresses
• Application tab: Application set to Any
• Service/URL Category tab: Service set to Any
• Actions tab: Action set to Block, Profile Type set to None
Create a Security Policy similar to:
• General tab: Name set to Deny from Malicious IP
• Source tab: Source Zone set to Any, Source Address set to Palo Alto
Networks - Known malicious IP addresses,Palo Alto Networks - High
risk IP addresses, Palo Alto Networks - Tor exit IP addresses, Palo
Alto Networks - Bulletproof IP addresses
• Destination tab: Destination Zone set to Any
• Application tab: Application set to Any
• Service/URL Category tab: Service set to Any
• Actions tab: Action set to Block, Profile Type set to None
Note: This recommendation requires a Palo Alto Networks ""Threat Prevention License""","","true","1. ""PAN-OS 11.1 Admin Guide: Built-in External Dynamic Lists"":
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/policy/use-an-
external-dynamic-list-in-policy/built-in-edls","Navigate to Policies > Security
Verify a Security Policy exists similar to:
• General tab: Name set to Deny to Malicious IP
• Source tab: Source Zone set to Any,
• Destination tab: Destination Zone set to Any, Destination Address set to
Palo Alto Networks - Known malicious IP addresses,Palo Alto
Networks - High risk IP addresses, Palo Alto Networks - Tor exit
IP addresses, Palo Alto Networks - Bulletproof IP addresses
• Application tab: Application set to Any
• Service/URL Category tab: Service set to Any
• Actions tab: Action set to Block, Profile Type set to None
Verify a Security Policy exists similar to:
• General tab: Name set to Deny from Malicious IP
• Source tab: Source Zone set to Any, Source Address set to Palo Alto
Networks - Known malicious IP addresses,Palo Alto Networks - High
risk IP addresses, Palo Alto Networks - Tor exit IP addresses, Palo
Alto Networks - Bulletproof IP addresses
• Destination tab: Destination Zone set to Any
• Application tab: Application set to Any
• Service/URL Category tab: Service set to Any
• Actions tab: Action set to Block, Profile Type set to None
Note: This recommendation requires a Palo Alto Networks ""Threat Prevention License""","Creating rules that block traffic to/from known malicious sites from Trusted Threat
Intelligence Sources protects you against IP addresses that Palo Alto Networks has
proven to be used almost exclusively to distribute malware, initiate command-and-
control activity, and launch attacks.","While not foolproof, simply blocking traffic from known malicious hosts allows more
resources to be devoted to analyzing traffic from other sources for malicious content.
This approach is a recommended part of most ""Defense in Depth"" recommendations,
allowing defenders to focus more deeply on traffic from uncategorized sources."
"7.4","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure that logging is enabled on built-in default security policies","Level 1","Enable logging on built-in default security policies ""intrazone-default"" and ""interzone-
default""

Default Value:
Disabled","","","Navigate to Policies > Security
Go to default policies intrazone-default and interzone-default. On Actions tab,
enable Log at Session End on log setting.","","true","1. “Gateway Firewall Best Practices on Default Policies Logging Configuration” -
https://docs.paloaltonetworks.com/best-practices/internet-gateway-best-
practices/best-practice-internet-gateway-security-policy/define-the-initial-internet-
gateway-security-policy/step-5-enable-logging-for-traffic-that-doesnt-match-any-
rules
2. “Datacenter Firewall Best Practices on Default Policies Logging Configuration” -
https://docs.paloaltonetworks.com/best-practices/10-2/data-center-best-
practices/data-center-best-practice-security-policy/log-and-monitor-data-center-
traffic/log-intra-data-center-traffic-that-matches-the-intrazone-allow-rule","Navigate to Policies > Security
Go to default policies intrazone-default and interzone-default. On Actions tab,
verify that log setting has Log at Session End is enabled.","By default, these default security policies does not have logging enabled. This enables
SOC or security analyst to do further investigations on security incidents especially on
threat hunting or incident response activities.",""
"8.1","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure 'SSL Forward Proxy Policy' for traffic destined to the Internet is configured","Level 1","Configure SSL Forward Proxy for all traffic destined to the Internet. In most
organizations, including all categories except financial-services, government and
health-and-medicine is recommended.

Default Value:
Not Configured

Additional Information:
This recommendation has been marked as automated so that vendors can certify
against this. If using CISCAT the benchmark will need to be tailored and the user will
have to write the xpath with organization specific information","","","Navigate to Policies > Decryption. Create a Policy for all traffic destined to the
Internet. This Policy should include:
• Source tab: The Source Zone and/or Source Address should include all target
internal networks. Source User should include all target internal users
• Destination tab: The Destination Zone should include the untrusted target
zone (usually the internet). Destination Address is typically Any for an
internet destination.
• Service/URL Category tab: all URL Category entries should be included
except financial-services, government and health-and-medicine (this list
may vary depending on your organization and its policies).
• Options tab: Type set to SSL Forward Proxy","","true","1. “How to Implement SSL Decryption” -
https://live.paloaltonetworks.com/docs/DOC-1412
2. ““PAN-OS Administrator's Guide 11.1 (English) - Decryption (English)” -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/decryption","Navigate to Policies > Decryption. Verify SSL Forward Proxy is set for all traffic
destined to the Internet.
Verify each Decryption Policy Rule:
• Source tab: The Source Zone and/or Source Address should include all target
internal networks. Source User should include all target internal users
• Destination tab: The Destination Zone should include the untrusted target
zone (usually the internet). Destination Address is typically Any for an
internet destination.
• Service/URL Category tab: Verify that all URL Category entries are included
except financial-services, government and health-and-medicine (this list
may vary depending on your organization and its policies).
• Options tab: Verify that the Type is set to SSL Forward Proxy","Without SSL inspection, the firewall cannot apply many of its protection features against
encrypted traffic. The amount of encrypted malware traffic continues to rise, and
legitimate websites using SSL encryption are hacked or tricked into delivering malware
on a frequent basis. As encryption on the Internet continues to grow at a rapid rate, SSL
inspection is no longer optional as a practical security measure. If proper decryption is
not configured, it follows that the majority of traffic is not being fully inspected for
malicious content or policy violations. This is a major exposure, allowing delivery of
exploits and payloads direct to user desktops.
Note that, categories to be decrypted is highly dependant on each organization's policy.","Failure to decrypt outbound traffic allows attackers to mask attacks, data exfiltration
and/or command and control (C2) traffic by simply using standard TLS encryption.
Privacy concerns for your organization's users will dictate that some common categories
should be exempted from inspection and decryption. Personal banking or healthcare
information is almost always exempted, as are interactions with government entities.
Exemptions and inclusions to decryption policies should be negotiated internally and
governed by published Corporate Policies."
"8.2","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure 'SSL Inbound Inspection' is required for all untrusted traffic destined for servers using SSL or TLS","Level 1","Configure SSL Inbound Inspection for all untrusted traffic destined for servers using
SSL or TLS.

Default Value:
Not Configured","","","Navigate to Policies > Decryption.
Set SSL Inbound Inspection appropriately for all untrusted traffic destined for servers
using SSL or TLS.
Navigate to Policies > Decryption. For each service published to the internet (or
other untrusted zones), create a Policy and set the following options:
• General tab: Name set to a descriptive name
• Source: Source Zone set to the target zone (Internet in many cases). Source
Address set to the target address space (Any for internet traffic)
• Destination tab: Destination Zone should be set to the appropriate zone, or
Any. Destination Address set to the target host address
• Options tab: Type set to SSL Inbound Inspection
Note:
1. Private key of the either the Root CA cert or Intermediate Root CA should be
imported into the firewall in order for it to perform SSL decryption.
2. This private key is the same one used by the internal application (behind the
firewall).","","true","1. “How to Implement SSL Decryption” -
https://live.paloaltonetworks.com/docs/DOC-1412
2. “PAN-OS Administrator's Guide 11.1 (English) - Decryption (English)” -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/decryption","Navigate to Policies > Decryption.
Verify SSL Inbound Inspection is set appropriately for all untrusted traffic destined for
servers using SSL or TLS.
Navigate to Policies > Decryption. For each service published to the internet (or
other untrusted zones), verify the following settings:
• General tab: Name set to a descriptive name
• Source: Source Zone set to the target zone (Internet in many cases). Source
Address set to the target address space (Any for internet traffic)
• Destination tab: Destination Zone should be set to the appropriate zone, or
Any. Destination Address set to the target host address
• Options tab: Type set to SSL Inbound Inspection","Without SSL Inbound Inspection, the firewall is not able to protect SSL or TLS-enabled
webservers against many threats.","Not decrypting inbound traffic to TLS encrypted services means that inspection for
many common attacks cannot occur on the firewall. This means that all defenses
against these attacks are up to the host."
"8.3","CIS Palo Alto Firewall 11 Benchmark","Palo Alto","Ensure that the Certificate used for Decryption is Trusted","Level 2","The CA Certificate used for in-line HTTP Man in the Middle should be trusted by target
users. For SSL Forward Proxy configurations, there are classes of users that need to
be considered.
1: Users that are members of the organization, users of machines under control of the
organization. For these people and machines, ensure that the CA Certificate is in one of
the Trusted CA certificate stores. This is easily done in Active Directory, using Group
Policies for instance. A MDM (Mobile Device Manager) can be used to accomplish the
same task for mobile devices such as telephones or tablets. Other central management
or orchestration tools can be used for Linux or ""IoT"" (Internet of Things) devices.
2: Users that are not member of the organization - often these are classed as ""Visitors""
in the policies of the organization. If a public CA Certificate is a possibility for your
organization, then that is one approach. A second approach is to not decrypt affected
traffic - this is easily done, but leaves the majority of ""visitor"" traffic uninspected and
potentially carrying malicious content. The final approach, and the one most commonly
seen, is to use the same certificate as is used for the hosting organization. In this last
case, visitors will see a certificate warning, but the issuing CA will be the organization
that they are visiting.

Default Value:
Decryption is not enabled by default.","","","Set the CA Certificate(s):
Navigate to Device > Certificate Management > Certificates. Import the
appropriate CA Certificates from any internal Certificate Authorities.
Alternatively, generate a self-signed certificate for an internal CA on the firewall, and
then import the root certificate for that CA into the trusted CA list of target clients. In an
Active Directory environment this can be facilitated using a Group Policy.
Set the Certificate Profile needed for the SSL Forward Proxy:
• Navigate to Device > Certificate Management > Certificate Profile.
Set the decryption profile to include the settings described in the SSL Forward Proxy
guidance in this document","","true","1. ""How to Implement and Test SSL Decryption"" -
https://live.paloaltonetworks.com/t5/Configuration-Articles/How-to-Implement-
and-Test-SSL-Decryption/ta-p/59719
2. “PAN-OS Administrator's Guide 11.1 (English) - Decryption (English)” -
https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/decryption
3. ""SSL Certificates Resource List on Configuring and Troubleshooting"" -
https://live.paloaltonetworks.com/t5/Management-Articles/SSL-certificates-
resource-list/ta-p/53068
4. ""Certificates"" - http://palo-alto.wikia.com/wiki/Certificates","Verify the CA Certificate(s):
Navigate to Device > Certificate Management > Certificates
• Verify that appropriate internal certificates are imported, and that all certificates in
the list are valid. In particular, verify the Subject, Issuer, CA, Expires,
Algorithm and Usage fields
• Alternatively, if an internal CA is implemented on the firewall, verify that target
clients have the root certificate for this CA imported into their list of trusted
certificate authorities.
Verify the Certificate Profile needed for the SSL Forward Proxy:
• Navigate to Device > Certificate Management > Certificate Profile.
Verify that an appropriate profile is created.","Using a self-signed certificate, or any certificate that generates a warning in the
browser, means that members of the organization have no method of determining if
they are being presented with a legitimate certificate, or an attacker's ""man in the
middle' certificate. It also very rapidly teaches members of the organization to bypass all
security warnings of this type.",""
