[
  {
    "rule_id": "1.1",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure a separate partition for containers has been created",
    "cis_level": " Level 1 - Linux Host OS",
    "description": "All Docker containers and their data and metadata is stored under /var/lib/docker\ndirectory. By default, /var/lib/docker would be mounted under / or /var partitions based\non availability.",
    "expected_values": "By default, /var/lib/docker would be mounted under / or /var partitions based on\navailability.",
    "validation_logic": "At the Docker host execute the below command:\ngrep /var/lib/docker /etc/fstab\nThis should return the partition details for /var/lib/docker mount point.",
    "remediation_steps": "For new installations, create a separate partition for /var/lib/docker mount point. For\nsystems that were previously installed, use the Logical Volume Manager (LVM) to create\npartitions.\n12 | P a ge",
    "severity": "Scored",
    "is_active": true,
    "references_text": "1. https://www.projectatomic.io/docs/docker-storage-recommendation/",
    "audit": "At the Docker host execute the below command:\ngrep /var/lib/docker /etc/fstab\nThis should return the partition details for /var/lib/docker mount point.",
    "rationale": "Docker depends on /var/lib/docker as the default directory where all Docker related files,\nincluding the images, are stored. This directory might fill up fast and soon Docker and the\nhost could become unusable. So, it is advisable to create a separate partition (logical\nvolume) for storing Docker files.",
    "impact": "None."
  },
  {
    "rule_id": "1.2",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure the container host has been Hardened",
    "cis_level": " Level 1 - Linux Host OS",
    "description": "Containers run on a Linux host. A container host can run one or more containers. It is of\nutmost importance to harden the host to mitigate host security misconfiguration.",
    "expected_values": "By default, host has factory settings. It is not hardened.",
    "validation_logic": "Ensure that the host specific security guidelines are followed. Ask the system\nadministrators which security benchmark does current host system comply with. Ensure\nthat the host systems actually comply with that host specific security benchmark.",
    "remediation_steps": "You may consider various CIS Security Benchmarks for your container host. If you have\nother security guidelines or regulatory requirements to adhere to, please follow them as\nsuitable in your environment.\nAdditionally, you can run a kernel with grsecurity and PaX. This would add many safety\nchecks, both at compile-time and run-time. It is also designed to defeat many exploits and\nhas powerful security features. These features do not require Docker-specific\nconfiguration, since those security features apply system-wide, independent of containers.",
    "severity": "Not Scored",
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/security/security/\n14 | P a ge\n2. https://learn.cisecurity.org/benchmarks\n3. https://docs.docker.com/engine/security/security/#other-kernel-security-features\n4. https://grsecurity.net/\n5. https://en.wikibooks.org/wiki/Grsecurity\n6. https://pax.grsecurity.net/\n7. http://en.wikipedia.org/wiki/PaX",
    "audit": "Ensure that the host specific security guidelines are followed. Ask the system\nadministrators which security benchmark does current host system comply with. Ensure\nthat the host systems actually comply with that host specific security benchmark.",
    "rationale": "You should follow infrastructure security best practices and harden your host OS. Keeping\nthe host system hardened would ensure that the host vulnerabilities are mitigated. Not\nhardening the host system could lead to security exposures and breaches.",
    "impact": "None."
  },
  {
    "rule_id": "1.3",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure Docker is up to date",
    "cis_level": " Level 1 - Linux Host OS",
    "description": "There are frequent releases for Docker software that address security vulnerabilities,\nproduct bugs and bring in new functionality. Keep a tab on these product updates and\nupgrade as frequently as when new security vulnerabilities are fixed or deemed correct for\nyour organization.",
    "expected_values": "Not Applicable\n16 | P a ge",
    "validation_logic": "Execute the below command and verify that the Docker version is up to date as deemed\nnecessary. It is not a mandate to be on the latest one, though.\ndocker version",
    "remediation_steps": "Keep a track of Docker releases and update as necessary.",
    "severity": "Not Scored",
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/installation/\n2. https://github.com/moby/moby/releases/latest\n3. https://github.com/docker/docker-ce/releases/latest",
    "audit": "Execute the below command and verify that the Docker version is up to date as deemed\nnecessary. It is not a mandate to be on the latest one, though.\ndocker version",
    "rationale": "By staying up to date on Docker updates, vulnerabilities in the Docker software can be\nmitigated. An educated attacker may exploit known vulnerabilities when attempting to\nattain access or elevate privileges. Not installing regular Docker updates may leave you\nwith running vulnerable Docker software. It might lead to elevation privileges,\nunauthorized access or other security breaches. Keep a track of new releases and update as\nnecessary.",
    "impact": "Perform a risk assessment for docker version updates in how they may impact your Docker\noperations. Be aware that several third-party products that use Docker may require older\nmajor version of Docker to be supported."
  },
  {
    "rule_id": "1.4",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure only trusted users are allowed to control Docker daemon",
    "cis_level": " Level 1 - Linux Host OS",
    "description": "The Docker daemon currently requires root privileges. A user added to the docker group\ngives him full root access rights.",
    "expected_values": "Not Applicable\n18 | P a ge",
    "validation_logic": "Execute the below command on the docker host and ensure that only trusted users are\nmembers of the docker group.\ngetent group docker",
    "remediation_steps": "Remove any users from the docker group that are not trusted. Additionally, do not create a\nmapping of sensitive directories on host to container volumes.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/security/security/#docker-daemon-attack-\nsurface\n2. https://www.andreas-jung.com/contents/on-docker-security-docker-group-\nconsidered-harmful\n3. http://www.projectatomic.io/blog/2015/08/why-we-dont-let-non-root-users-run-\ndocker-in-centos-fedora-or-rhel/",
    "audit": "Execute the below command on the docker host and ensure that only trusted users are\nmembers of the docker group.\ngetent group docker",
    "rationale": "Docker allows you to share a directory between the Docker host and a guest container\nwithout limiting the access rights of the container. This means that you can start a\ncontainer and map the / directory on your host to the container. The container will then be\nable to alter your host file system without any restrictions. In simple terms, it means that\nyou can attain elevated privileges with just being a member of the docker group and then\nstarting a container with mapped / directory on the host.",
    "impact": "Rights to build and execute containers as normal user would be restricted."
  },
  {
    "rule_id": "1.5",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure auditing is configured for the docker daemon",
    "cis_level": " Level 1 - Linux Host OS",
    "description": "Audit all Docker daemon activities.",
    "expected_values": "By default, Docker daemon is not audited.\n20 | P a ge",
    "validation_logic": "Verify that there is an audit rule for Docker daemon. For example, execute below\ncommand:\nauditctl -l | grep /usr/bin/docker\nThis should list a rule for Docker daemon.",
    "remediation_steps": "Add a rule for Docker daemon.\nFor example,\nAdd the line as below line in /etc/audit/audit.rules file:\n-w /usr/bin/docker -k docker\nThen, restart the audit daemon. For example,\nservice auditd restart",
    "severity": "Scored",
    "is_active": true,
    "references_text": "1. https://access.redhat.com/documentation/en-\nUS/Red_Hat_Enterprise_Linux/6/html/Security_Guide/chap-system_auditing.html",
    "audit": "Verify that there is an audit rule for Docker daemon. For example, execute below\ncommand:\nauditctl -l | grep /usr/bin/docker\nThis should list a rule for Docker daemon.",
    "rationale": "Apart from auditing your regular Linux file system and system calls, audit Docker daemon\nas well. Docker daemon runs with root privileges. It is thus necessary to audit its activities\nand usage.",
    "impact": "Auditing generates quite big log files. Ensure to rotate and archive them periodically. Also,\ncreate a separate partition of audit to avoid filling root file system."
  },
  {
    "rule_id": "1.6",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure auditing is configured for Docker files and directories -",
    "cis_level": " Level 1 - Linux Host OS",
    "description": "Audit /var/lib/docker.",
    "expected_values": "By default, Docker related files and directories are not audited.",
    "validation_logic": "Verify that there is an audit rule corresponding to /var/lib/docker directory.\nFor example, execute below command:\nauditctl -l | grep /var/lib/docker\nThis should list a rule for /var/lib/docker directory.",
    "remediation_steps": "Add a rule for /var/lib/docker directory.\nFor example,\nAdd the line as below in /etc/audit/audit.rules file:\n-w /var/lib/docker -k docker\nThen, restart the audit daemon. For example,\nservice auditd restart",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://access.redhat.com/documentation/en-\nUS/Red_Hat_Enterprise_Linux/6/html/Security_Guide/chap-system_auditing.html",
    "audit": "Verify that there is an audit rule corresponding to /var/lib/docker directory.\nFor example, execute below command:\nauditctl -l | grep /var/lib/docker\nThis should list a rule for /var/lib/docker directory.",
    "rationale": "Apart from auditing your regular Linux file system and system calls, audit all Docker\nrelated files and directories. Docker daemon runs with root privileges. Its behavior\ndepends on some key files and directories. /var/lib/docker is one such directory. It holds\nall the information about containers. It must be audited.",
    "impact": "Auditing generates quite big log files. Ensure to rotate and archive them periodically. Also,\ncreate a separate partition of audit to avoid filling root file system.\n22 | P a ge"
  },
  {
    "rule_id": "1.7",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure auditing is configured for Docker files and directories -",
    "cis_level": " Level 1 - Linux Host OS",
    "description": "Audit /etc/docker.",
    "expected_values": "By default, Docker related files and directories are not audited.",
    "validation_logic": "Verify that there is an audit rule corresponding to /etc/docker directory.\nFor example, execute below command:\nauditctl -l | grep /etc/docker\nThis should list a rule for /etc/docker directory.",
    "remediation_steps": "Add a rule for /etc/docker directory.\nFor example,\nAdd the line as below in /etc/audit/audit.rules file:\n-w /etc/docker -k docker\nThen, restart the audit daemon. For example,\nservice auditd restart\n24 | P a ge",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://access.redhat.com/documentation/en-\nUS/Red_Hat_Enterprise_Linux/6/html/Security_Guide/chap-system_auditing.html",
    "audit": "Verify that there is an audit rule corresponding to /etc/docker directory.\nFor example, execute below command:\nauditctl -l | grep /etc/docker\nThis should list a rule for /etc/docker directory.",
    "rationale": "Apart from auditing your regular Linux file system and system calls, audit all Docker\nrelated files and directories. Docker daemon runs with root privileges. Its behavior\ndepends on some key files and directories. /etc/docker is one such directory. It holds\nvarious certificates and keys used for TLS communication between Docker daemon and\nDocker client. It must be audited.",
    "impact": "Auditing generates quite big log files. Ensure to rotate and archive them periodically. Also,\ncreate a separate partition of audit to avoid filling root file system."
  },
  {
    "rule_id": "1.8",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure auditing is configured for Docker files and directories -",
    "cis_level": " Level 1 - Linux Host OS",
    "description": "Audit docker.service, if applicable.",
    "expected_values": "By default, Docker related files and directories are not audited. The file docker.service\nmay not be available on the system.",
    "validation_logic": "Step 1: Find out the file location:\nsystemctl show -p FragmentPath docker.service\nStep 2: If the file does not exist, this recommendation is not applicable. If the file exists,\nverify that there is an audit rule corresponding to the file:\nFor example, execute the below command:\nauditctl -l | grep docker.service\nThis should list a rule for docker.service as per its location.",
    "remediation_steps": "If the file exists, add a rule for it.\nFor example,\nAdd the line as below in /etc/audit/audit.rules file:\n-w /usr/lib/systemd/system/docker.service -k docker\nThen, restart the audit daemon. For example,\n26 | P a ge\nservice auditd restart",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://access.redhat.com/documentation/en-\nUS/Red_Hat_Enterprise_Linux/6/html/Security_Guide/chap-system_auditing.html",
    "audit": "Step 1: Find out the file location:\nsystemctl show -p FragmentPath docker.service\nStep 2: If the file does not exist, this recommendation is not applicable. If the file exists,\nverify that there is an audit rule corresponding to the file:\nFor example, execute the below command:\nauditctl -l | grep docker.service\nThis should list a rule for docker.service as per its location.",
    "rationale": "Apart from auditing your regular Linux file system and system calls, audit all Docker\nrelated files and directories. Docker daemon runs with root privileges. Its behavior\ndepends on some key files and directories. docker.service is one such file. The\ndocker.service file might be present if the daemon parameters have been changed by an\nadministrator. It holds various parameters for Docker daemon. It must be audited, if\napplicable.",
    "impact": "Auditing generates quite big log files. Ensure to rotate and archive them periodically. Also,\ncreate a separate partition of audit to avoid filling root file system."
  },
  {
    "rule_id": "1.9",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure auditing is configured for Docker files and directories -",
    "cis_level": " Level 1 - Linux Host OS",
    "description": "Audit docker.socket, if applicable.",
    "expected_values": "By default, Docker related files and directories are not audited. The file docker.socket may\nnot be available on the system.",
    "validation_logic": "Step 1: Find out the file location:\nsystemctl show -p FragmentPath docker.socket\nStep 2: If the file does not exist, this recommendation is not applicable. If the file exists,\nverify that there is an audit rule corresponding to the file:\nFor example, execute the below command:\nauditctl -l | grep docker.socket\nThis should list a rule for docker.socket as per its location.",
    "remediation_steps": "If the file exists, add a rule for it.\nFor example,\nAdd the line as below in /etc/audit/audit.rules file:\n-w /usr/lib/systemd/system/docker.socket -k docker\nThen, restart the audit daemon. For example,\nservice auditd restart\n28 | P a ge",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://access.redhat.com/documentation/en-\nUS/Red_Hat_Enterprise_Linux/6/html/Security_Guide/chap-system_auditing.html",
    "audit": "Step 1: Find out the file location:\nsystemctl show -p FragmentPath docker.socket\nStep 2: If the file does not exist, this recommendation is not applicable. If the file exists,\nverify that there is an audit rule corresponding to the file:\nFor example, execute the below command:\nauditctl -l | grep docker.socket\nThis should list a rule for docker.socket as per its location.",
    "rationale": "Apart from auditing your regular Linux file system and system calls, audit all Docker\nrelated files and directories. Docker daemon runs with root privileges. Its behavior\ndepends on some key files and directories. docker.socket is one such file. It holds various\nparameters for Docker daemon socket. It must be audited, if applicable.",
    "impact": "Auditing generates quite big log files. Ensure to rotate and archive them periodically. Also,\ncreate a separate partition of audit to avoid filling root file system."
  },
  {
    "rule_id": "1.10",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure auditing is configured for Docker files and directories -",
    "cis_level": " Level 1 - Linux Host OS",
    "description": "Audit /etc/default/docker, if applicable.",
    "expected_values": "By default, Docker related files and directories are not audited. The file\n/etc/default/docker may not be available on the system. In that case, this\nrecommendation is not applicable.",
    "validation_logic": "Verify that there is an audit rule corresponding to /etc/default/docker file.\nFor example, execute below command:\nauditctl -l | grep /etc/default/docker\nThis should list a rule for /etc/default/docker file.",
    "remediation_steps": "Add a rule for /etc/default/docker file.\nFor example,\nAdd the line as below in /etc/audit/audit.rules file:\n-w /etc/default/docker -k docker\nThen, restart the audit daemon. For example,\nservice auditd restart",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://access.redhat.com/documentation/en-\nUS/Red_Hat_Enterprise_Linux/6/html/Security_Guide/chap-system_auditing.html",
    "audit": "Verify that there is an audit rule corresponding to /etc/default/docker file.\nFor example, execute below command:\nauditctl -l | grep /etc/default/docker\nThis should list a rule for /etc/default/docker file.",
    "rationale": "Apart from auditing your regular Linux file system and system calls, audit all Docker\nrelated files and directories. Docker daemon runs with root privileges. Its behavior\ndepends on some key files and directories. /etc/default/docker is one such file. It holds\nvarious parameters for Docker daemon. It must be audited, if applicable.",
    "impact": "Auditing generates quite big log files. Ensure to rotate and archive them periodically. Also,\ncreate a separate partition of audit to avoid filling root file system.\n30 | P a ge"
  },
  {
    "rule_id": "1.11",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure auditing is configured for Docker files and directories -",
    "cis_level": " Level 1 - Linux Host OS",
    "description": "Audit /etc/docker/daemon.json, if applicable.",
    "expected_values": "By default, Docker related files and directories are not audited. The file\n/etc/docker/daemon.json may not be available on the system. In that case, this\nrecommendation is not applicable.",
    "validation_logic": "Verify that there is an audit rule corresponding to /etc/docker/daemon.json file.\nFor example, execute below command:\nauditctl -l | grep /etc/docker/daemon.json\nThis should list a rule for /etc/docker/daemon.json file.",
    "remediation_steps": "Add a rule for /etc/docker/daemon.json file.\nFor example,\nAdd the line as below in /etc/audit/audit.rules file:\n-w /etc/docker/daemon.json -k docker\nThen, restart the audit daemon. For example,\nservice auditd restart",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://access.redhat.com/documentation/en-\nUS/Red_Hat_Enterprise_Linux/6/html/Security_Guide/chap-system_auditing.html\n2. https://docs.docker.com/engine/reference/commandline/dockerd/#daemon-\nconfiguration-file",
    "audit": "Verify that there is an audit rule corresponding to /etc/docker/daemon.json file.\nFor example, execute below command:\nauditctl -l | grep /etc/docker/daemon.json\nThis should list a rule for /etc/docker/daemon.json file.",
    "rationale": "Apart from auditing your regular Linux file system and system calls, audit all Docker\nrelated files and directories. Docker daemon runs with root privileges. Its behavior\ndepends on some key files and directories. /etc/docker/daemon.json is one such file. It\nholds various parameters for Docker daemon. It must be audited, if applicable.",
    "impact": "Auditing generates quite big log files. Ensure to rotate and archive them periodically. Also,\ncreate a separate partition of audit to avoid filling root file system.\n32 | P a ge"
  },
  {
    "rule_id": "1.12",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure auditing is configured for Docker files and directories -",
    "cis_level": " Level 1 - Linux Host OS",
    "description": "Audit /usr/bin/docker-containerd, if applicable.",
    "expected_values": "By default, Docker related files and directories are not audited. The file /usr/bin/docker-\ncontainerd may not be available on the system. In that case, this recommendation is not\napplicable.",
    "validation_logic": "Verify that there is an audit rule corresponding to /usr/bin/docker-containerd file.\nFor example, execute below command:\nauditctl -l | grep /usr/bin/docker-containerd\nThis should list a rule for /usr/bin/docker-containerd file.",
    "remediation_steps": "Add a rule for /usr/bin/docker-containerd file.\nFor example,\nAdd the line as below in /etc/audit/audit.rules file:\n-w /usr/bin/docker-containerd -k docker\nThen, restart the audit daemon. For example,\nservice auditd restart\n34 | P a ge",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://access.redhat.com/documentation/en-\nUS/Red_Hat_Enterprise_Linux/6/html/Security_Guide/chap-system_auditing.html\n2. https://github.com/docker/docker/pull/20662\n3. https://containerd.tools/",
    "audit": "Verify that there is an audit rule corresponding to /usr/bin/docker-containerd file.\nFor example, execute below command:\nauditctl -l | grep /usr/bin/docker-containerd\nThis should list a rule for /usr/bin/docker-containerd file.",
    "rationale": "Apart from auditing your regular Linux file system and system calls, audit all Docker\nrelated files and directories. Docker daemon runs with root privileges. Its behavior\ndepends on some key files and directories. /usr/bin/docker-containerd is one such file.\nDocker now relies on containerdand runC to spawn containers. It must be audited, if\napplicable.",
    "impact": "Auditing generates quite big log files. Ensure to rotate and archive them periodically. Also,\ncreate a separate partition of audit to avoid filling root file system."
  },
  {
    "rule_id": "1.13",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure auditing is configured for Docker files and directories -",
    "cis_level": " Level 1 - Linux Host OS",
    "description": "Audit /usr/bin/docker-runc, if applicable.",
    "expected_values": "By default, Docker related files and directories are not audited. The file/usr/bin/docker-\nrunc may not be available on the system. In that case, this recommendation is not\napplicable.",
    "validation_logic": "Verify that there is an audit rule corresponding to /usr/bin/docker-runc file.\nFor example, execute below command:\nauditctl -l | grep /usr/bin/docker-runc\nThis should list a rule for /usr/bin/docker-runc file.",
    "remediation_steps": "Add a rule for /usr/bin/docker-runc file.\nFor example,\nAdd the line as below in /etc/audit/audit.rules file:\n-w /usr/bin/docker-runc -k docker\nThen, restart the audit daemon. For example,\nservice auditd restart",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://access.redhat.com/documentation/en-\nUS/Red_Hat_Enterprise_Linux/6/html/Security_Guide/chap-system_auditing.html\n2. https://github.com/docker/docker/pull/20662\n3. https://containerd.tools/\n4. https://github.com/opencontainers/runc",
    "audit": "Verify that there is an audit rule corresponding to /usr/bin/docker-runc file.\nFor example, execute below command:\nauditctl -l | grep /usr/bin/docker-runc\nThis should list a rule for /usr/bin/docker-runc file.",
    "rationale": "Apart from auditing your regular Linux file system and system calls, audit all Docker\nrelated files and directories. Docker daemon runs with root privileges. Its behavior\ndepends on some key files and directories. /usr/bin/docker-runc is one such file. Docker\nnow relies on containerd and runC to spawn containers. It must be audited, if applicable.",
    "impact": "Auditing generates quite big log files. Ensure to rotate and archive them periodically. Also,\ncreate a separate partition of audit to avoid filling root file system.\n36 | P a ge"
  },
  {
    "rule_id": "2.1",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure network traffic is restricted between containers on the",
    "cis_level": " Level 1 - Docker",
    "description": "By default, all network traffic is allowed between containers on the same host on the\ndefault network bridge. If not desired, restrict all the inter-container communication. Link\nspecific containers together that require communication. Alternatively, you can create\ncustom network and only join containers that need to communicate to that custom\nnetwork.",
    "expected_values": "By default, all inter-container communication is allowed on the default network bridge.",
    "validation_logic": "Run the below command and verify that the default network bridge has been configured to\nrestrict inter-container communication.\ndocker network ls --quiet | xargs docker network inspect --format '{{ .Name\n}}: {{ .Options }}'\nIt should return com.docker.network.bridge.enable_icc:false for the default network\nbridge.\n38 | P a ge",
    "remediation_steps": "Run the docker in daemon mode and pass --icc=false as an argument.\nFor Example,\ndockerd --icc=false\nAlternatively, you can follow the Docker documentation and create a custom network and\nonly join containers that need to communicate to that custom network. The --icc\nparameter only applies to the default docker bridge, if custom networks are used then the\napproach of segmenting networks should be adopted instead.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/userguide/networking/\n2. https://docs.docker.com/engine/userguide/networking/default_network/containe\nr-communication/#communication-between-containers\n39 | P a ge",
    "audit": "Run the below command and verify that the default network bridge has been configured to\nrestrict inter-container communication.\ndocker network ls --quiet | xargs docker network inspect --format '{{ .Name\n}}: {{ .Options }}'\nIt should return com.docker.network.bridge.enable_icc:false for the default network\nbridge.\n38 | P a ge",
    "rationale": "By default, unrestricted network traffic is enabled between all containers on the same host\non the default network bridge. Thus, each container has the potential of reading all packets\nacross the container network on the same host. This might lead to an unintended and\nunwanted disclosure of information to other containers. Hence, restrict the inter-container\ncommunication on the default network bridge.",
    "impact": "The inter-container communication would be disabled on the default network bridge. If\nany communication between containers on the same host is desired, then it needs to be\nexplicitly defined using container linking or alternatively custom networks have to be\ndefined."
  },
  {
    "rule_id": "2.2",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure the logging level is set to 'info'",
    "cis_level": " Level 1 - Docker",
    "description": "Set Docker daemon log level to info.",
    "expected_values": "By default, Docker daemon is set to log level of info.",
    "validation_logic": "ps -ef | grep docker\nEnsure that either the --log-level parameter is not present or if present, then it is set to\ninfo.",
    "remediation_steps": "Run the Docker daemon as below:\ndockerd --log-level=\"info\"",
    "severity": "Scored",
    "is_active": true,
    "references_text": "1. https://docs.docker.com/edge/engine/reference/commandline/dockerd/",
    "audit": "ps -ef | grep docker\nEnsure that either the --log-level parameter is not present or if present, then it is set to\ninfo.",
    "rationale": "Setting up an appropriate log level, configures the Docker daemon to log events that you\nwould want to review later. A base log level of info and above would capture all logs\nexcept debug logs. Until and unless required, you should not run Docker daemon at debug\nlog level.",
    "impact": "None."
  },
  {
    "rule_id": "2.3",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure Docker is allowed to make changes to iptables",
    "cis_level": " Level 1 - Docker",
    "description": "Iptables are used to set up, maintain, and inspect the tables of IP packet filter rules in the\nLinux kernel. Allow the Docker daemon to make changes to the iptables.",
    "expected_values": "By default, iptables is set to true.\n42 | P a ge",
    "validation_logic": "ps -ef | grep dockerd\nEnsure that the --iptables parameter is either not present or not set to false.",
    "remediation_steps": "Do not run the Docker daemon with --iptables=false parameter. For example, do not\nstart the Docker daemon as below:\ndockerd --iptables=false",
    "severity": "Scored",
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/userguide/networking/default_network/containe\nr-communication/\n2. https://fralef.me/docker-and-iptables.html",
    "audit": "ps -ef | grep dockerd\nEnsure that the --iptables parameter is either not present or not set to false.",
    "rationale": "Docker will never make changes to your system iptables rules if you choose to do so.\nDocker server would automatically make the needed changes to iptables based on how you\nchoose your networking options for the containers if it is allowed to do so. It is\nrecommended to let Docker server make changes to iptablesautomatically to avoid\nnetworking misconfiguration that might hamper the communication between containers\nand to the outside world. Additionally, it would save you hassles of updating\niptablesevery time you choose to run the containers or modify networking options.",
    "impact": "Docker daemon service start requires iptables rules to be enabled before it starts. Any\nrestarts of iptables during docker daemon operation may result in losing docker-created\nrules. Adding iptables-persistent to your iptables install can assist with mitigating this\nimpact."
  },
  {
    "rule_id": "2.4",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure insecure registries are not used",
    "cis_level": " Level 1 - Docker",
    "description": "Docker considers a private registry either secure or insecure. By default, registries are\nconsidered secure.",
    "expected_values": "By default, Docker assumes all, but local, registries are secure.",
    "validation_logic": "Run docker info or execute the below command to find out if any insecure registries are\nused:\nps -ef | grep dockerd\nEnsure that the --insecure-registry parameter is not present.",
    "remediation_steps": "Do not use any insecure registries.\nFor example, do not start the Docker daemon as below:\ndockerd --insecure-registry 10.1.0.0/16",
    "severity": "Scored",
    "is_active": true,
    "references_text": "1. https://docs.docker.com/registry/insecure/",
    "audit": "Run docker info or execute the below command to find out if any insecure registries are\nused:\nps -ef | grep dockerd\nEnsure that the --insecure-registry parameter is not present.",
    "rationale": "A secure registry uses TLS. A copy of registry's CA certificate is placed on the Docker host at\n/etc/docker/certs.d/<registry-name>/ directory. An insecure registry is the one not\nhaving either valid registry certificate or is not using TLS. You should not be using any\ninsecure registries in the production environment. Insecure registries can be tampered\nwith leading to possible compromise to your production system.\nAdditionally, If a registry is marked as insecure then docker pull, docker push, and\ndocker search commands will not result in an error message and the user might be\nindefinitely working with insecure registries without ever being notified of potential\ndanger.",
    "impact": "None.\n44 | P a ge"
  },
  {
    "rule_id": "2.5",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure aufs storage driver is not used",
    "cis_level": " Level 1 - Docker",
    "description": "Do not use aufs as storage driver for your Docker instance.",
    "expected_values": "By default, Docker uses devicemapper as the storage driver on most of the platforms.\nDefault storage driver can vary based on your OS vendor. You should use the storage driver\nthat is best supported by your preferred vendor.\n46 | P a ge",
    "validation_logic": "Execute the below command and verify that aufs is not used as storage driver:\ndocker info | grep -e \"^Storage Driver:\\s*aufs\\s*$\"\nThe above command should not return anything.",
    "remediation_steps": "Do not explicitly use aufs as storage driver.\nFor example, do not start Docker daemon as below:\ndockerd --storage-driver aufs",
    "severity": "Scored",
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/userguide/storagedriver/selectadriver/#support\ned-backing-filesystems\n2. http://muehe.org/posts/switching-docker-from-aufs-to-devicemapper/\n3. http://jpetazzo.github.io/assets/2015-03-05-deep-dive-into-docker-storage-\ndrivers.html#1\n4. https://docs.docker.com/engine/userguide/storagedriver/",
    "audit": "Execute the below command and verify that aufs is not used as storage driver:\ndocker info | grep -e \"^Storage Driver:\\s*aufs\\s*$\"\nThe above command should not return anything.",
    "rationale": "The aufs storage driver is the oldest storage driver. It is based on a Linux kernel patch-set\nthat is unlikely to be merged into the main Linux kernel. aufs driver is also known to cause\nsome serious kernel crashes. aufs just has legacy support from Docker. Most importantly,\naufs is not a supported driver in many Linux distributions using latest Linux kernels.",
    "impact": "aufs is the only storage driver that allows containers to share executable and shared\nlibrary memory. It might be useful if you are running thousands of containers with the\nsame program or libraries."
  },
  {
    "rule_id": "2.6",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure TLS authentication for Docker daemon is configured",
    "cis_level": " Level 1 - Docker",
    "description": "It is possible to make the Docker daemon to listen on a specific IP and port and any other\nUnix socket other than default Unix socket. Configure TLS authentication to restrict access\nto Docker daemon via IP and port.",
    "expected_values": "By default, TLS authentication is not configured.",
    "validation_logic": "ps -ef | grep dockerd\nEnsure that the below parameters are present:\n--tlsverify\n--tlscacert\n--tlscert\n--tlskey",
    "remediation_steps": "Follow the steps mentioned in the Docker documentation or other references.",
    "severity": "Scored",
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/security/https/",
    "audit": "ps -ef | grep dockerd\nEnsure that the below parameters are present:\n--tlsverify\n--tlscacert\n--tlscert\n--tlskey",
    "rationale": "By default, Docker daemon binds to a non-networked Unix socket and runs with root\nprivileges. If you change the default docker daemon binding to a TCP port or any other Unix\nsocket, anyone with access to that port or socket can have full access to Docker daemon\nand in turn to the host system. Hence, you should not bind the Docker daemon to another\nIP/port or a Unix socket.\nIf you must expose the Docker daemon via a network socket, configure TLS authentication\nfor the daemon and Docker Swarm APIs (if using). This would restrict the connections to\nyour Docker daemon over the network to a limited number of clients who could\nsuccessfully authenticate over TLS.",
    "impact": "You would need to manage and guard certificates and keys for Docker daemon and Docker\nclients.\n48 | P a ge"
  },
  {
    "rule_id": "2.7",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure the default ulimit is configured appropriately",
    "cis_level": " Level 1 - Docker",
    "description": "Set the default ulimit options as appropriate in your environment.",
    "expected_values": "By default, no ulimit is set.\n50 | P a ge",
    "validation_logic": "ps -ef | grep dockerd\nEnsure that the --default-ulimit parameter is set as appropriate.",
    "remediation_steps": "Run the docker in daemon mode and pass --default-ulimit as argument with respective\nulimits as appropriate in your environment.\nFor Example,\ndockerd --default-ulimit nproc=1024:2048 --default-ulimit nofile=100:200",
    "severity": "Not Scored",
    "is_active": true,
    "references_text": "1. https://docs.docker.com/edge/engine/reference/commandline/dockerd/#default-\nulimits",
    "audit": "ps -ef | grep dockerd\nEnsure that the --default-ulimit parameter is set as appropriate.",
    "rationale": "ulimit provides control over the resources available to the shell and to processes started\nby it. Setting system resource limits judiciously saves you from many disasters such as a\nfork bomb. Sometimes, even friendly users and legitimate processes can overuse system\nresources and in-turn can make the system unusable.\nSetting default ulimit for the Docker daemon would enforce the ulimit for all container\ninstances. You would not need to setup ulimit for each container instance. However, the\ndefault ulimit can be overridden during container runtime, if needed. Hence, to control the\nsystem resources, define a default ulimit as needed in your environment.",
    "impact": "If the ulimits are not set properly, the desired resource control might not be achieved and\nmight even make the system unusable."
  },
  {
    "rule_id": "2.8",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Enable user namespace support",
    "cis_level": " Level 2 - Docker",
    "description": "Enable user namespace support in Docker daemon to utilize container user to host user re-\nmapping. This recommendation is beneficial where containers you are using do not have an\nexplicit container user defined in the container image. If container images that you are\nusing have a pre-defined non-root user, this recommendation may be skipped since this\nfeature is still in its infancy and might give you unpredictable issues and complexities.",
    "expected_values": "By default, user namespace is not remapped.",
    "validation_logic": "ps -p $(docker inspect --format='{{ .State.Pid }}' <CONTAINER ID>) -o\npid,user\nThe above command would find the PID of the container and then would list the host user\nassociated with the container process. If the container process is running as root, then this\nrecommendation is non-compliant.\nAlternatively, you can run docker info to ensure that the userns is listed under Security\nOptions:\ndocker info --format '{{ .SecurityOptions }}'",
    "remediation_steps": "Please consult Docker documentation for various ways in which this can be configured\ndepending upon your requirements. Your steps might also vary based on platform - For\nexample, on Red Hat, sub-UIDs and sub-GIDs mapping creation does not work\nautomatically. You might have to create your own mapping.\nHowever, the high-level steps are as below:\n52 | P a ge\nStep 1: Ensure that the files /etc/subuid and /etc/subgid exist.\ntouch /etc/subuid /etc/subgid\nStep 2: Start the docker daemon with --userns-remap flag\ndockerd --userns-remap=default",
    "severity": "Scored",
    "is_active": true,
    "references_text": "1. http://man7.org/linux/man-pages/man7/user_namespaces.7.html\n2. https://docs.docker.com/engine/reference/commandline/dockerd/#daemon-user-\nnamespace-options\n3. http://events.linuxfoundation.org/sites/events/files/slides/User%20Namespaces\n%20-%20ContainerCon%202015%20-%2016-9-final_0.pdf",
    "audit": "ps -p $(docker inspect --format='{{ .State.Pid }}' <CONTAINER ID>) -o\npid,user\nThe above command would find the PID of the container and then would list the host user\nassociated with the container process. If the container process is running as root, then this\nrecommendation is non-compliant.\nAlternatively, you can run docker info to ensure that the userns is listed under Security\nOptions:\ndocker info --format '{{ .SecurityOptions }}'",
    "rationale": "The Linux kernel user namespace support in Docker daemon provides additional security\nfor the Docker host system. It allows a container to have a unique range of user and group\nIDs which are outside the traditional user and group range utilized by the host system.\nFor example, the root user will have expected administrative privilege inside the container\nbut can effectively be mapped to an unprivileged UID on the host system.",
    "impact": "User namespace remapping makes quite a few Docker features incompatible and also\ncurrently breaks a few functionalities. Check out the Docker documentation and referenced\nlinks for details."
  },
  {
    "rule_id": "2.9",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure the default cgroup usage has been confirmed",
    "cis_level": " Level 2 - Docker",
    "description": "The --cgroup-parent option allows you to set the default cgroup parent to use for all the\ncontainers. If there is no specific use case, this setting should be left at its default.",
    "expected_values": "By default, docker daemon uses /docker for fs cgroup driver and system.slice for\nsystemd cgroup driver.",
    "validation_logic": "ps -ef | grep dockerd\nEnsure that the --cgroup-parent parameter is either not set or is set as appropriate non-\ndefault cgroup.",
    "remediation_steps": "The default setting is good enough and can be left as-is. If you want to specifically set a non-\ndefault cgroup, pass --cgroup-parent parameter to the docker daemon when starting it.\nFor Example,\ndockerd --cgroup-parent=/foobar",
    "severity": "Scored",
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/reference/commandline/dockerd/#default-\ncgroup-parent",
    "audit": "ps -ef | grep dockerd\nEnsure that the --cgroup-parent parameter is either not set or is set as appropriate non-\ndefault cgroup.",
    "rationale": "System administrators typically define cgroups under which containers are supposed to\nrun. Even if cgroups are not explicitly defined by the system administrators, containers run\nunder docker cgroup by default.\nIt is possible to attach to a different cgroup other than that is the default. This usage should\nbe monitored and confirmed. By attaching to a different cgroup than the one that is a\ndefault, it is possible to share resources unevenly and thus might starve the host for\nresources.",
    "impact": "None.\n54 | P a ge"
  },
  {
    "rule_id": "2.10",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure base device size is not changed until needed",
    "cis_level": " Level 2 - Docker",
    "description": "In certain circumstances, you might need containers bigger than 10G in size. In these cases,\ncarefully choose the base device size.",
    "expected_values": "The default base device size is 10G.\n56 | P a ge",
    "validation_logic": "ps -ef | grep dockerd\nExecute the above command and it should not show any --storage-opt dm.basesize\nparameters.",
    "remediation_steps": "Do not set --storage-opt dm.basesize until needed.",
    "severity": "Scored",
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/reference/commandline/dockerd/#storage-\ndriver-options",
    "audit": "ps -ef | grep dockerd\nExecute the above command and it should not show any --storage-opt dm.basesize\nparameters.",
    "rationale": "The base device size can be increased at daemon restart. Increasing the base device size\nallows all future images and containers to be of the new base device size. A user can use\nthis option to expand the base device size however shrinking is not permitted. This value\naffects the system-wide “base” empty filesystem that may already be initialized and\ninherited by pulled images.\nThough the file system does not allot the increased size if it is empty, it will use more space\nfor the empty case depending upon the device size. This may cause a denial of service by\nending up in file system being over-allocated or full.",
    "impact": "None."
  },
  {
    "rule_id": "2.11",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure that authorization for Docker client commands is enabled",
    "cis_level": " Level 2 - Docker",
    "description": "Use native Docker authorization plugins or a third party authorization mechanism with\nDocker daemon to manage access to Docker client commands.",
    "expected_values": "By default, authorization plugins are not set up.",
    "validation_logic": "ps -ef | grep dockerd\nEnsure that the --authorization-plugin parameter is set as appropriate if using docker\nnative authorization.\ndocker search hello-world\nEnsure that docker daemon requires authorization to perform the above command.",
    "remediation_steps": "Step 1: Install/Create an authorization plugin.\nStep 2: Configure the authorization policy as desired.\nStep 3: Start the docker daemon as below:\ndockerd --authorization-plugin=<PLUGIN_ID>\n58 | P a ge",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/reference/commandline/dockerd/#access-\nauthorization\n2. https://docs.docker.com/engine/extend/plugins_authorization/\n3. https://github.com/twistlock/authz\nNotes:\nAs a scored control, focus should be on a PASS/FAIL if the authentication occurs when a\ndocker client command is executed against docker daemon to enforce authentication. The\nnative docker authentication plugin is just one method to enforce this control.",
    "audit": "ps -ef | grep dockerd\nEnsure that the --authorization-plugin parameter is set as appropriate if using docker\nnative authorization.\ndocker search hello-world\nEnsure that docker daemon requires authorization to perform the above command.",
    "rationale": "Docker’s out-of-the-box authorization model is all or nothing. Any user with permission to\naccess the Docker daemon can run any Docker client command. The same is true for callers\nusing Docker’s remote API to contact the daemon. If you require greater access control, you\ncan create authorization plugins and add them to your Docker daemon configuration. Using\nan authorization plugin, a Docker administrator can configure granular access policies for\nmanaging access to Docker daemon.\nThird party integrations of Docker may implement their own authorization models to\nrequire authorization with the Docker daemon outside of docker's native authorization\nplugin (i.e. Kubernetes, Cloud Foundry, Openshift).",
    "impact": "Each docker command specifically passes through authorization plugin mechanism. This\nmight introduce a slight performance drop.\nThird party use of alternative container engines that utilize the docker daemon may\nprovide alternative mechanisms to provide this security control."
  },
  {
    "rule_id": "2.12",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure centralized and remote logging is configured",
    "cis_level": " Level 2 - Docker",
    "description": "Docker now supports various log drivers. A preferable way to store logs is the one that\nsupports centralized and remote logging.",
    "expected_values": "By default, container logs are maintained as json files\n60 | P a ge",
    "validation_logic": "Run docker info and ensure that the Logging Driverproperty set as appropriate.\ndocker info --format '{{ .LoggingDriver }}'\nAlternatively, the below command would give you the --log-driver setting, if configured.\nEnsure that it is set as appropriate.\nps -ef | grep dockerd",
    "remediation_steps": "Step 1: Setup the desired log driver by following its documentation.\nStep 2: Start the docker daemon with that logging driver.\nFor example,\ndockerd --log-driver=syslog --log-opt syslog-address=tcp://192.xxx.xxx.xxx",
    "severity": "Scored",
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/admin/logging/overview/",
    "audit": "Run docker info and ensure that the Logging Driverproperty set as appropriate.\ndocker info --format '{{ .LoggingDriver }}'\nAlternatively, the below command would give you the --log-driver setting, if configured.\nEnsure that it is set as appropriate.\nps -ef | grep dockerd",
    "rationale": "Centralized and remote logging ensures that all important log records are safe despite\ncatastrophic events. Docker now supports various such logging drivers. Use the one that\nsuits your environment the best.",
    "impact": "None."
  },
  {
    "rule_id": "2.13",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure operations on legacy registry (v1) are Disabled",
    "cis_level": " Level 1 - Docker",
    "description": "The latest Docker registry is v2. All operations on the legacy registry version (v1) should be\nrestricted.",
    "expected_values": "By default, legacy registry operations are allowed.",
    "validation_logic": "ps -ef | grep dockerd\nThe above command should list --disable-legacy-registry as an option passed to the\ndocker daemon.",
    "remediation_steps": "Start the docker daemon as below:\ndockerd --disable-legacy-registry",
    "severity": "Scored",
    "is_active": true,
    "references_text": "1. https://docs.docker.com/edge/engine/reference/commandline/dockerd/#legacy-\nregistries\n2. https://docs.docker.com/registry/spec/api/\n3. https://the.binbashtheory.com/creating-private-docker-registry-2-0-with-token-\nauthentication-service/\n62 | P a ge\n4. https://blog.docker.com/2015/07/new-tool-v1-registry-docker-trusted-registry-\nv2-open-source/\n5. http://www.slideshare.net/Docker/docker-registry-v2",
    "audit": "ps -ef | grep dockerd\nThe above command should list --disable-legacy-registry as an option passed to the\ndocker daemon.",
    "rationale": "Docker registry v2 brings in many performance and security improvements over v1. It\nsupports container image provenance and other security features such as image signing\nand verification. Hence, operations on Docker legacy registry should be restricted.",
    "impact": "Legacy registry operations would be restricted."
  },
  {
    "rule_id": "2.14",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure live restore is Enabled",
    "cis_level": " Level 1 - Docker",
    "description": "The --live-restore enables full support of daemon-less containers in docker. It ensures\nthat docker does not stop containers on shutdown or restore and properly reconnects to\nthe container when restarted.",
    "expected_values": "By default, --live-restore is not enabled.\n64 | P a ge",
    "validation_logic": "Run docker info and ensure that the Live Restore Enabled property is set to true.\ndocker info --format '{{ .LiveRestoreEnabled }}'\nAlternatively run the below command and ensure that --live-restore is used.\nps -ef | grep dockerd",
    "remediation_steps": "Run the docker in daemon mode and pass --live-restore as an argument.\nFor Example,\ndockerd --live-restore",
    "severity": "Scored",
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/admin/live-restore/",
    "audit": "Run docker info and ensure that the Live Restore Enabled property is set to true.\ndocker info --format '{{ .LiveRestoreEnabled }}'\nAlternatively run the below command and ensure that --live-restore is used.\nps -ef | grep dockerd",
    "rationale": "One of the important security triads is availability. Setting --live-restore flag in the\ndocker daemon ensures that container execution is not interrupted when the docker\ndaemon is not available. This also means that it is now easier to update and patch the\ndocker daemon without execution downtime.",
    "impact": "None."
  },
  {
    "rule_id": "2.15",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure Userland Proxy is Disabled",
    "cis_level": " Level 1 - Docker",
    "description": "The docker daemon starts a userland proxy service for port forwarding whenever a port is\nexposed. Where hairpin NAT is available, this service is generally superfluous to\nrequirements and can be disabled.",
    "expected_values": "By default, the userland proxy is enabled.\n66 | P a ge",
    "validation_logic": "ps -ef | grep dockerd\nEnsure that the --userland-proxy parameter is set to false.",
    "remediation_steps": "Run the Docker daemon as below:\ndockerd --userland-proxy=false",
    "severity": "Scored",
    "is_active": true,
    "references_text": "1. http://windsock.io/the-docker-proxy/\n2. https://github.com/docker/docker/issues/14856\n3. https://github.com/docker/docker/issues/22741\n4. https://docs.docker.com/engine/userguide/networking/default_network/binding/",
    "audit": "ps -ef | grep dockerd\nEnsure that the --userland-proxy parameter is set to false.",
    "rationale": "Docker engine provides two mechanisms for forwarding ports from the host to containers,\nhairpin NAT, and a userland proxy. In most circumstances, the hairpin NAT mode is\npreferred as it improves performance and makes use of native Linux iptables functionality\ninstead of an additional component.\nWhere hairpin NAT is available, the userland proxy should be disabled on startup to reduce\nthe attack surface of the installation.",
    "impact": "Some systems with older Linux kernels may not be able to support hairpin NAT and\ntherefore require the userland proxy service. Also, some networking setups can be\nimpacted by the removal of the userland proxy."
  },
  {
    "rule_id": "2.16",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure daemon-wide custom seccomp profile is applied, if needed",
    "cis_level": " Level 2 - Docker",
    "description": "You can choose to apply your custom seccomp profile at the daemon-wide level if needed\nand override Docker's default seccomp profile.",
    "expected_values": "By default, Docker applies a seccomp profile.",
    "validation_logic": "Run the below command and review the seccomp profile listed in the Security Options\nsection. If it is default, that means, Docker's default seccomp profile is applied.\ndocker info --format '{{ .SecurityOptions }}'",
    "remediation_steps": "By default, Docker's default seccomp profile is applied. If this is good for your environment,\nno action is necessary. Alternatively, if you choose to apply your own seccomp profile, use\nthe --seccomp-profile flag at daemon start or put it in the daemon runtime parameters\nfile.\ndockerd --seccomp-profile </path/to/seccomp/profile>",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/security/seccomp/\n2. https://github.com/docker/docker/pull/26276",
    "audit": "Run the below command and review the seccomp profile listed in the Security Options\nsection. If it is default, that means, Docker's default seccomp profile is applied.\ndocker info --format '{{ .SecurityOptions }}'",
    "rationale": "A large number of system calls are exposed to every userland process with many of them\ngoing unused for the entire lifetime of the process. Most of the applications do not need all\nthe system calls and thus benefit by having a reduced set of available system calls. The\nreduced set of system calls reduces the total kernel surface exposed to the application and\nthus improvises application security.\nYou could apply your own custom seccomp profile instead of Docker's default seccomp\nprofile. Alternatively, if Docker's default profile is good for your environment, you can\nchoose to ignore this recommendation.",
    "impact": "A misconfigured seccomp profile could possibly interrupt your container environment.\nDocker-default blocked calls have been carefully scrutinized. These address some critical\n68 | P a ge\nvulnerabilities/issues within container environments (for example, kernel key ring calls).\nSo, you should be very careful while overriding the defaults."
  },
  {
    "rule_id": "2.17",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure experimental features are avoided in production",
    "cis_level": " Level 1 - Docker",
    "description": "Avoid experimental features in production.",
    "expected_values": "By default, experimental features are not activated on the docker daemon.",
    "validation_logic": "Run the below command and ensure that the Experimental property is set to false in the\nServer section.\ndocker version --format '{{ .Server.Experimental }}'",
    "remediation_steps": "Do not pass --experimental as a runtime parameter to the docker daemon.",
    "severity": "Scored",
    "is_active": true,
    "references_text": "1. https://docs.docker.com/edge/engine/reference/commandline/dockerd/#options",
    "audit": "Run the below command and ensure that the Experimental property is set to false in the\nServer section.\ndocker version --format '{{ .Server.Experimental }}'",
    "rationale": "Experimental is now a runtime docker daemon flag instead of a separate build. Passing --\nexperimental as a runtime flag to the docker daemon, activates experimental features.\nExperimental is now considered a stable release, but with a couple of features which might\nnot have tested and guaranteed API stability.",
    "impact": "None"
  },
  {
    "rule_id": "2.18",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure containers are restricted from acquiring new privileges",
    "cis_level": " Level 1 - Docker",
    "description": "Restrict containers from acquiring additional privileges via suid or sgid bits, by default.",
    "expected_values": "By default, containers are not restricted from acquiring new privileges.\n71 | P a ge",
    "validation_logic": "ps -ef | grep dockerd\nEnsure that the --no-new-privileges parameter is present and is not set to false.",
    "remediation_steps": "Run the Docker daemon as below:\ndockerd --no-new-privileges",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://github.com/moby/moby/pull/29984\n2. https://github.com/moby/moby/pull/20727",
    "audit": "ps -ef | grep dockerd\nEnsure that the --no-new-privileges parameter is present and is not set to false.",
    "rationale": "A process can set the no_new_priv bit in the kernel. It persists across fork, clone and\nexecve. The no_new_priv bit ensures that the process or its children processes do not gain\nany additional privileges via suid or sgid bits. This way a lot of dangerous operations\nbecome a lot less dangerous because there is no possibility of subverting privileged\nbinaries.\nSetting this at the daemon level ensures that by default all new containers are restricted\nfrom acquiring new privileges.",
    "impact": "no_new_priv prevents LSMs like SELinux from transitioning to process labels that have\naccess not allowed to the current process."
  },
  {
    "rule_id": "3.1",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure that docker.service file ownership is set to root:root",
    "cis_level": " Level 1 - Docker",
    "description": "Verify that the docker.service file ownership and group-ownership are correctly set to\nroot.",
    "expected_values": "This file may not be present on the system. In that case, this recommendation is not\napplicable. By default, if the file is present, the ownership and group-ownership for this file\nis correctly set to root.",
    "validation_logic": "Step 1: Find out the file location:\nsystemctl show -p FragmentPath docker.service\nStep 2: If the file does not exist, this recommendation is not applicable. If the file exists,\nexecute the below command with the correct file path to verify that the file is owned and\ngroup-owned by root.\nFor example,\nstat -c %U:%G /usr/lib/systemd/system/docker.service | grep -v root:root\nThe above command should not return anything.",
    "remediation_steps": "Step 1: Find out the file location:\nsystemctl show -p FragmentPath docker.service\n73 | P a ge\nStep 2: If the file does not exist, this recommendation is not applicable. If the file exists,\nexecute the below command with the correct file path to set the ownership and group\nownership for the file to root.\nFor example,\nchown root:root /usr/lib/systemd/system/docker.service",
    "severity": "Scored",
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/admin/systemd/",
    "audit": "Step 1: Find out the file location:\nsystemctl show -p FragmentPath docker.service\nStep 2: If the file does not exist, this recommendation is not applicable. If the file exists,\nexecute the below command with the correct file path to verify that the file is owned and\ngroup-owned by root.\nFor example,\nstat -c %U:%G /usr/lib/systemd/system/docker.service | grep -v root:root\nThe above command should not return anything.",
    "rationale": "docker.service file contains sensitive parameters that may alter the behavior of Docker\ndaemon. Hence, it should be owned and group-owned by root to maintain the integrity of\nthe file.",
    "impact": "None."
  },
  {
    "rule_id": "3.2",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure that docker.service file permissions are set to 644 or more",
    "cis_level": " Level 1 - Docker",
    "description": "Verify that the docker.service file permissions are correctly set to 644 or more restrictive.",
    "expected_values": "This file may not be present on the system. In that case, this recommendation is not\napplicable. By default, if the file is present, the file permissions are correctly set to 644.",
    "validation_logic": "Step 1: Find out the file location:\nsystemctl show -p FragmentPath docker.service\nStep 2: If the file does not exist, this recommendation is not applicable. If the file exists,\nexecute the below command with the correct file path to verify that the file permissions are\nset to 644 or more restrictive.\nFor example,\nstat -c %a /usr/lib/systemd/system/docker.service",
    "remediation_steps": "Step 1: Find out the file location:\nsystemctl show -p FragmentPath docker.service\nStep 2: If the file does not exist, this recommendation is not applicable. If the file exists,\nexecute the below command with the correct file path to set the file permissions to 644.\nFor example,\nchmod 644 /usr/lib/systemd/system/docker.service\n75 | P a ge",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.docker.com/articles/systemd/",
    "audit": "Step 1: Find out the file location:\nsystemctl show -p FragmentPath docker.service\nStep 2: If the file does not exist, this recommendation is not applicable. If the file exists,\nexecute the below command with the correct file path to verify that the file permissions are\nset to 644 or more restrictive.\nFor example,\nstat -c %a /usr/lib/systemd/system/docker.service",
    "rationale": "docker.service file contains sensitive parameters that may alter the behavior of Docker\ndaemon. Hence, it should not be writable by any other user other than root to maintain the\nintegrity of the file.",
    "impact": "None."
  },
  {
    "rule_id": "3.3",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure that docker.socket file ownership is set to root:root",
    "cis_level": " Level 1 - Docker",
    "description": "Verify that the docker.socket file ownership and group ownership is correctly set to root.",
    "expected_values": "This file may not be present on the system. In that case, this recommendation is not\napplicable. By default, if the file is present, the ownership and group-ownership for this file\nis correctly set to root.",
    "validation_logic": "Step 1: Find out the file location:\nsystemctl show -p FragmentPath docker.socket\nStep 2: If the file does not exist, this recommendation is not applicable. If the file exists,\nexecute the below command with the correct file path to verify that the file is owned and\ngroup-owned by root.\nFor example,\nstat -c %U:%G /usr/lib/systemd/system/docker.socket | grep -v root:root\nThe above command should not return anything.",
    "remediation_steps": "Step 1: Find out the file location:\nsystemctl show -p FragmentPath docker.socket\nStep 2: If the file does not exist, this recommendation is not applicable. If the file exists,\nexecute the below command with the correct file path to set the ownership and group\nownership for the file to root.\nFor example,\nchown root:root /usr/lib/systemd/system/docker.socket\n77 | P a ge",
    "severity": "Scored",
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/reference/commandline/dockerd/#daemon-\nsocket-option\n2. https://github.com/docker/docker-\nce/blob/master/components/packaging/deb/systemd/docker.socket",
    "audit": "Step 1: Find out the file location:\nsystemctl show -p FragmentPath docker.socket\nStep 2: If the file does not exist, this recommendation is not applicable. If the file exists,\nexecute the below command with the correct file path to verify that the file is owned and\ngroup-owned by root.\nFor example,\nstat -c %U:%G /usr/lib/systemd/system/docker.socket | grep -v root:root\nThe above command should not return anything.",
    "rationale": "docker.socket file contains sensitive parameters that may alter the behavior of Docker\nremote API. Hence, it should be owned and group-owned by root to maintain the integrity\nof the file.",
    "impact": "None."
  },
  {
    "rule_id": "3.4",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure that docker.socket file permissions are set to 644 or more",
    "cis_level": " Level 1 - Docker",
    "description": "Verify that the docker.socket file permissions are correctly set to 644 or more restrictive.",
    "expected_values": "This file may not be present on the system. In that case, this recommendation is not\napplicable. By default, if the file is present, the file permissions for this file are correctly set\nto 644.",
    "validation_logic": "Step 1: Find out the file location:\nsystemctl show -p FragmentPath docker.socket\nStep 2: If the file does not exist, this recommendation is not applicable. If the file exists,\nexecute the below command with the correct file path to verify that the file permissions are\nset to 644 or more restrictive.\nFor example,\nstat -c %a /usr/lib/systemd/system/docker.socket",
    "remediation_steps": "Step 1: Find out the file location:\nsystemctl show -p FragmentPath docker.socket\nStep 2: If the file does not exist, this recommendation is not applicable. If the file exists,\nexecute the below command with the correct file path to set the file permissions to 644.\nFor example,\nchmod 644 /usr/lib/systemd/system/docker.socket",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/reference/commandline/dockerd/#bind-docker-\nto-another-hostport-or-a-unix-socket\n2. https://github.com/YungSang/fedora-atomic-\npacker/blob/master/oem/docker.socket\n3. http://daviddaeschler.com/2014/12/14/centos-7rhel-7-and-docker-containers-\non-boot/",
    "audit": "Step 1: Find out the file location:\nsystemctl show -p FragmentPath docker.socket\nStep 2: If the file does not exist, this recommendation is not applicable. If the file exists,\nexecute the below command with the correct file path to verify that the file permissions are\nset to 644 or more restrictive.\nFor example,\nstat -c %a /usr/lib/systemd/system/docker.socket",
    "rationale": "docker.socket file contains sensitive parameters that may alter the behavior of Docker\nremote API. Hence, it should be writable only by root to maintain the integrity of the file.",
    "impact": "None.\n79 | P a ge"
  },
  {
    "rule_id": "3.5",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure that /etc/docker directory ownership is set to root:root",
    "cis_level": " Level 1 - Docker",
    "description": "Verify that the /etc/docker directory ownership and group-ownership is correctly set to\nroot.",
    "expected_values": "By default, the ownership and group-ownership for this directory is correctly set to root.",
    "validation_logic": "Execute the below command to verify that the directory is owned and group-owned by\nroot:\nstat -c %U:%G /etc/docker | grep -v root:root\nThe above command should not return anything.",
    "remediation_steps": "chown root:root /etc/docker\nThis would set the ownership and group-ownership for the directory to root.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/security/https/\n81 | P a ge",
    "audit": "Execute the below command to verify that the directory is owned and group-owned by\nroot:\nstat -c %U:%G /etc/docker | grep -v root:root\nThe above command should not return anything.",
    "rationale": "/etc/docker directory contains certificates and keys in addition to various sensitive files.\nHence, it should be owned and group-owned by root to maintain the integrity of the\ndirectory.",
    "impact": "None."
  },
  {
    "rule_id": "3.6",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure that /etc/docker directory permissions are set to 755 or more",
    "cis_level": " Level 1 - Docker",
    "description": "Verify that the /etc/docker directory permissions are correctly set to 755 or more\nrestrictive.",
    "expected_values": "By default, the permissions for this directory are correctly set to 755.",
    "validation_logic": "Execute the below command to verify that the directory has permissions of 755 or more\nrestrictive:\nstat -c %a /etc/docker",
    "remediation_steps": "chmod 755 /etc/docker\nThis would set the permissions for the directory to 755.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/security/https/\n83 | P a ge",
    "audit": "Execute the below command to verify that the directory has permissions of 755 or more\nrestrictive:\nstat -c %a /etc/docker",
    "rationale": "/etc/docker directory contains certificates and keys in addition to various sensitive files.\nHence, it should only be writable by root to maintain the integrity of the directory.",
    "impact": "None."
  },
  {
    "rule_id": "3.7",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure that registry certificate file ownership is set to root:root",
    "cis_level": " Level 1 - Docker",
    "description": "Verify that all the registry certificate files (usually found under\n/etc/docker/certs.d/<registry-name> directory) are owned and group-owned by root.",
    "expected_values": "By default, the ownership and group-ownership for registry certificate files is correctly set\nto root.",
    "validation_logic": "Execute the below command to verify that the registry certificate files are owned and\ngroup-owned by root:\nstat -c %U:%G /etc/docker/certs.d/* | grep -v root:root\nThe above command should not return anything.",
    "remediation_steps": "chown root:root /etc/docker/certs.d/<registry-name>/*\nThis would set the ownership and group-ownership for the registry certificate files to root.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.docker.com/registry/insecure/\n85 | P a ge",
    "audit": "Execute the below command to verify that the registry certificate files are owned and\ngroup-owned by root:\nstat -c %U:%G /etc/docker/certs.d/* | grep -v root:root\nThe above command should not return anything.",
    "rationale": "/etc/docker/certs.d/<registry-name> directory contains Docker registry certificates.\nThese certificate files must be owned and group-owned by root to maintain the integrity of\nthe certificates.",
    "impact": "None."
  },
  {
    "rule_id": "3.8",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure that registry certificate file permissions are set to 444 or",
    "cis_level": " Level 1 - Docker",
    "description": "Verify that all the registry certificate files (usually found under\n/etc/docker/certs.d/<registry-name> directory) have permissions of 444 or more\nrestrictive.",
    "expected_values": "By default, the permissions for registry certificate files might not be 444. The default file\npermissions are governed by the system or user specific umaskvalues.",
    "validation_logic": "Execute the below command to verify that the registry certificate files have permissions of\n444 or more restrictive:\nstat -c %a /etc/docker/certs.d/<registry-name>/*",
    "remediation_steps": "chmod 444 /etc/docker/certs.d/<registry-name>/*\nThis would set the permissions for registry certificate files to 444.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.docker.com/registry/insecure/\n87 | P a ge",
    "audit": "Execute the below command to verify that the registry certificate files have permissions of\n444 or more restrictive:\nstat -c %a /etc/docker/certs.d/<registry-name>/*",
    "rationale": "/etc/docker/certs.d/<registry-name> directory contains Docker registry certificates.\nThese certificate files must have permissions of 444 to maintain the integrity of the\ncertificates.",
    "impact": "None."
  },
  {
    "rule_id": "3.9",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure that TLS CA certificate file ownership is set to root:root",
    "cis_level": " Level 1 - Docker",
    "description": "Verify that the TLS CA certificate file (the file that is passed alongwith --tlscacert\nparameter) is owned and group-owned by root.",
    "expected_values": "By default, the ownership and group-ownership for TLS CA certificate file is correctly set to\nroot.",
    "validation_logic": "Execute the below command to verify that the TLS CA certificate file is owned and group-\nowned by root:\nstat -c %U:%G <path to TLS CA certificate file> | grep -v root:root\nThe above command should not return anything.",
    "remediation_steps": "chown root:root <path to TLS CA certificate file>\nThis would set the ownership and group-ownership for the TLS CA certificate file to root.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.docker.com/registry/insecure/\n89 | P a ge\n2. https://docs.docker.com/engine/security/https/",
    "audit": "Execute the below command to verify that the TLS CA certificate file is owned and group-\nowned by root:\nstat -c %U:%G <path to TLS CA certificate file> | grep -v root:root\nThe above command should not return anything.",
    "rationale": "The TLS CA certificate file should be protected from any tampering. It is used to\nauthenticate Docker server based on given CA certificate. Hence, it must be owned and\ngroup-owned by root to maintain the integrity of the CA certificate.",
    "impact": "None."
  },
  {
    "rule_id": "3.10",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure that TLS CA certificate file permissions are set to 444 or",
    "cis_level": " Level 1 - Docker",
    "description": "Verify that the TLS CA certificate file (the file that is passed alongwith --tlscacert\nparameter) has permissions of 444 or more restrictive.",
    "expected_values": "By default, the permissions for TLS CA certificate file might not be 444. The default file\npermissions are governed by the system or user specific umask values.",
    "validation_logic": "Execute the below command to verify that the TLS CA certificate file has permissions of 444\nor more restrictive:\nstat -c %a <path to TLS CA certificate file>",
    "remediation_steps": "chmod 444 <path to TLS CA certificate file>\nThis would set the file permissions of the TLS CA file to 444.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.docker.com/registry/insecure/\n2. https://docs.docker.com/engine/security/https/\n91 | P a ge",
    "audit": "Execute the below command to verify that the TLS CA certificate file has permissions of 444\nor more restrictive:\nstat -c %a <path to TLS CA certificate file>",
    "rationale": "The TLS CA certificate file should be protected from any tampering. It is used to\nauthenticate Docker server based on given CA certificate. Hence, it must have permissions\nof 444 to maintain the integrity of the CA certificate.",
    "impact": "None."
  },
  {
    "rule_id": "3.11",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure that Docker server certificate file ownership is set to",
    "cis_level": " Level 1 - Docker",
    "description": "Verify that the Docker server certificate file (the file that is passed alongwith --tlscert\nparameter) is owned and group-owned by root.",
    "expected_values": "By default, the ownership and group-ownership for Docker server certificate file is\ncorrectly set to root.\n93 | P a ge",
    "validation_logic": "Execute the below command to verify that the Docker server certificate file is owned and\ngroup-owned by root:\nstat -c %U:%G <path to Docker server certificate file> | grep -v root:root\nThe above command should not return anything.",
    "remediation_steps": "chown root:root <path to Docker server certificate file>\nThis would set the ownership and group-ownership for the Docker server certificate file to\nroot.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.docker.com/registry/insecure/\n2. https://docs.docker.com/engine/security/https/",
    "audit": "Execute the below command to verify that the Docker server certificate file is owned and\ngroup-owned by root:\nstat -c %U:%G <path to Docker server certificate file> | grep -v root:root\nThe above command should not return anything.",
    "rationale": "The Docker server certificate file should be protected from any tampering. It is used to\nauthenticate Docker server based on the given server certificate. Hence, it must be owned\nand group-owned by root to maintain the integrity of the certificate.",
    "impact": "None."
  },
  {
    "rule_id": "3.12",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure that Docker server certificate file permissions are set to 444",
    "cis_level": " Level 1 - Docker",
    "description": "Verify that the Docker server certificate file (the file that is passed alongwith --tlscert\nparameter) has permissions of 444 or more restrictive.",
    "expected_values": "By default, the permissions for Docker server certificate file might not be 444. The default\nfile permissions are governed by the system or user specific umask values.",
    "validation_logic": "Execute the below command to verify that the Docker server certificate file has\npermissions of 444 or more restrictive:\nstat -c %a <path to Docker server certificate file>",
    "remediation_steps": "chmod 444 <path to Docker server certificate file>\nThis would set the file permissions of the Docker server file to 444.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.docker.com/registry/insecure/\n2. https://docs.docker.com/engine/security/https/\n95 | P a ge",
    "audit": "Execute the below command to verify that the Docker server certificate file has\npermissions of 444 or more restrictive:\nstat -c %a <path to Docker server certificate file>",
    "rationale": "The Docker server certificate file should be protected from any tampering. It is used to\nauthenticate Docker server based on the given server certificate. Hence, it must have\npermissions of 444 to maintain the integrity of the certificate.",
    "impact": "None."
  },
  {
    "rule_id": "3.13",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure that Docker server certificate key file ownership is set to",
    "cis_level": " Level 1 - Docker",
    "description": "Verify that the Docker server certificate key file (the file that is passed alongwith --tlskey\nparameter) is owned and group-owned by root.",
    "expected_values": "By default, the ownership and group-ownership for Docker server certificate key file is\ncorrectly set to root.\n97 | P a ge",
    "validation_logic": "Execute the below command to verify that the Docker server certificate key file is owned\nand group-owned by root:\nstat -c %U:%G <path to Docker server certificate key file> | grep -v\nroot:root\nThe above command should not return anything.",
    "remediation_steps": "chown root:root <path to Docker server certificate key file>\nThis would set the ownership and group-ownership for the Docker server certificate key\nfile to root.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.docker.com/registry/insecure/\n2. https://docs.docker.com/engine/security/https/",
    "audit": "Execute the below command to verify that the Docker server certificate key file is owned\nand group-owned by root:\nstat -c %U:%G <path to Docker server certificate key file> | grep -v\nroot:root\nThe above command should not return anything.",
    "rationale": "The Docker server certificate key file should be protected from any tampering or unneeded\nreads. It holds the private key for the Docker server certificate. Hence, it must be owned\nand group-owned by root to maintain the integrity of the Docker server certificate.",
    "impact": "None."
  },
  {
    "rule_id": "3.14",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure that Docker server certificate key file permissions are set to",
    "cis_level": " Level 1 - Docker",
    "description": "Verify that the Docker server certificate key file (the file that is passed alongwith --tlskey\nparameter) has permissions of 400.",
    "expected_values": "By default, the permissions for Docker server certificate key file might not be 400. The\ndefault file permissions are governed by the system or user specific umask values.",
    "validation_logic": "Execute the below command to verify that the Docker server certificate key file has\npermissions of 400:\nstat -c %a <path to Docker server certificate key file>",
    "remediation_steps": "chmod 400 <path to Docker server certificate key file>\nThis would set the Docker server certificate key file permissions to 400.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.docker.com/registry/insecure/\n2. https://docs.docker.com/engine/security/https/\n99 | P a ge",
    "audit": "Execute the below command to verify that the Docker server certificate key file has\npermissions of 400:\nstat -c %a <path to Docker server certificate key file>",
    "rationale": "The Docker server certificate key file should be protected from any tampering or unneeded\nreads. It holds the private key for the Docker server certificate. Hence, it must have\npermissions of 400 to maintain the integrity of the Docker server certificate.",
    "impact": "None."
  },
  {
    "rule_id": "3.15",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure that Docker socket file ownership is set to root:docker",
    "cis_level": " Level 1 - Docker",
    "description": "Verify that the Docker socket file is owned by root and group-owned by docker.",
    "expected_values": "By default, the ownership and group-ownership for Docker socket file is correctly set to\nroot:docker.",
    "validation_logic": "Execute the below command to verify that the Docker socket file is owned by root and\ngroup-owned by docker:\nstat -c %U:%G /var/run/docker.sock | grep -v root:docker\nThe above command should not return anything.",
    "remediation_steps": "chown root:docker /var/run/docker.sock\nThis would set the ownership to root and group-ownership to docker for default Docker\nsocket file.\n101 | P a ge",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/reference/commandline/dockerd/#daemon-\nsocket-option\n2. https://docs.docker.com/engine/reference/commandline/dockerd/#bind-docker-\nto-another-hostport-or-a-unix-socket",
    "audit": "Execute the below command to verify that the Docker socket file is owned by root and\ngroup-owned by docker:\nstat -c %U:%G /var/run/docker.sock | grep -v root:docker\nThe above command should not return anything.",
    "rationale": "Docker daemon runs as root. The default Unix socket hence must be owned by root. If any\nother user or process owns this socket, then it might be possible for that non-privileged\nuser or process to interact with Docker daemon. Also, such a non-privileged user or\nprocess might interact with containers. This is neither secure nor desired behavior.\nAdditionally, the Docker installer creates a Unix group called docker. You can add users to\nthis group, and then those users would be able to read and write to default Docker Unix\nsocket. The membership to the docker group is tightly controlled by the system\nadministrator. If any other group owns this socket, then it might be possible for members\nof that group to interact with Docker daemon. Also, such a group might not be as tightly\ncontrolled as the docker group. This is neither secure nor desired behavior.\nHence, the default Docker Unix socket file must be owned by root and group-owned by\ndocker to maintain the integrity of the socket file.",
    "impact": "None."
  },
  {
    "rule_id": "3.16",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure that Docker socket file permissions are set to 660 or more",
    "cis_level": " Level 1 - Docker",
    "description": "Verify that the Docker socket file has permissions of 660 or more restrictive.",
    "expected_values": "By default, the permissions for Docker socket file is correctly set to 660.",
    "validation_logic": "Execute the below command to verify that the Docker socket file has permissions of 660 or\nmore restrictive:\nstat -c %a /var/run/docker.sock",
    "remediation_steps": "chmod 660 /var/run/docker.sock\nThis would set the file permissions of the Docker socket file to 660.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/reference/commandline/dockerd/#daemon-\nsocket-option\n2. https://docs.docker.com/engine/reference/commandline/dockerd/#bind-docker-\nto-another-hostport-or-a-unix-socket\n103 | P a ge",
    "audit": "Execute the below command to verify that the Docker socket file has permissions of 660 or\nmore restrictive:\nstat -c %a /var/run/docker.sock",
    "rationale": "Only root and members of docker group should be allowed to read and write to default\nDocker Unix socket. Hence, the Docket socket file must have permissions of 660 or more\nrestrictive.",
    "impact": "None."
  },
  {
    "rule_id": "3.17",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure that daemon.json file ownership is set to root:root",
    "cis_level": " Level 1 - Docker",
    "description": "Verify that the daemon.json file ownership and group-ownership is correctly set to root.",
    "expected_values": "This file may not be present on the system. In that case, this recommendation is not\napplicable.",
    "validation_logic": "Execute the below command to verify that the file is owned and group-owned by root:\nstat -c %U:%G /etc/docker/daemon.json | grep -v root:root\nThe above command should not return anything.",
    "remediation_steps": "chown root:root /etc/docker/daemon.json\nThis would set the ownership and group-ownership for the file to root.",
    "severity": "Scored",
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/reference/commandline/dockerd/#daemon-\nconfiguration-file\n105 | P a ge",
    "audit": "Execute the below command to verify that the file is owned and group-owned by root:\nstat -c %U:%G /etc/docker/daemon.json | grep -v root:root\nThe above command should not return anything.",
    "rationale": "daemon.json file contains sensitive parameters that may alter the behavior of docker\ndaemon. Hence, it should be owned and group-owned by root to maintain the integrity of\nthe file.",
    "impact": "None."
  },
  {
    "rule_id": "3.18",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure that daemon.json file permissions are set to 644 or more",
    "cis_level": " Level 1 - Docker",
    "description": "Verify that the daemon.json file permissions are correctly set to 644 or more restrictive.",
    "expected_values": "This file may not be present on the system. In that case, this recommendation is not\napplicable.",
    "validation_logic": "Execute the below command to verify that the file permissions are correctly set to 644 or\nmore restrictive:\nstat -c %a /etc/docker/daemon.json",
    "remediation_steps": "chmod 644 /etc/docker/daemon.json\nThis would set the file permissions for this file to 644.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/reference/commandline/dockerd/#daemon-\nconfiguration-file\n107 | P a ge",
    "audit": "Execute the below command to verify that the file permissions are correctly set to 644 or\nmore restrictive:\nstat -c %a /etc/docker/daemon.json",
    "rationale": "daemon.json file contains sensitive parameters that may alter the behavior of docker\ndaemon. Hence, it should be writable only by root to maintain the integrity of the file.",
    "impact": "None."
  },
  {
    "rule_id": "3.19",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure that /etc/default/docker file ownership is set to root:root",
    "cis_level": " Level 1 - Docker",
    "description": "Verify that the /etc/default/docker file ownership and group-ownership is correctly set\nto root.",
    "expected_values": "This file may not be present on the system. In that case, this recommendation is not\napplicable.",
    "validation_logic": "Execute the below command to verify that the file is owned and group-owned by root:\nstat -c %U:%G /etc/default/docker | grep -v root:root\nThe above command should not return anything.",
    "remediation_steps": "chown root:root /etc/default/docker\nThis would set the ownership and group-ownership for the file to root.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/admin/configuring/\n109 | P a ge",
    "audit": "Execute the below command to verify that the file is owned and group-owned by root:\nstat -c %U:%G /etc/default/docker | grep -v root:root\nThe above command should not return anything.",
    "rationale": "/etc/default/docker file contains sensitive parameters that may alter the behavior of\ndocker daemon. Hence, it should be owned and group-owned by root to maintain the\nintegrity of the file.",
    "impact": "None."
  },
  {
    "rule_id": "3.20",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure that /etc/default/docker file permissions are set to 644 or",
    "cis_level": " Level 1 - Docker",
    "description": "Verify that the /etc/default/docker file permissions are correctly set to 644 or more\nrestrictive.",
    "expected_values": "This file may not be present on the system. In that case, this recommendation is not\napplicable.",
    "validation_logic": "Execute the below command to verify that the file permissions are correctly set to 644 or\nmore restrictive:\nstat -c %a /etc/default/docker",
    "remediation_steps": "chmod 644 /etc/default/docker\nThis would set the file permissions for this file to 644.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/admin/configuring/\n111 | P a ge",
    "audit": "Execute the below command to verify that the file permissions are correctly set to 644 or\nmore restrictive:\nstat -c %a /etc/default/docker",
    "rationale": "/etc/default/docker file contains sensitive parameters that may alter the behavior of\ndocker daemon. Hence, it should be writable only by root to maintain the integrity of the\nfile.",
    "impact": "None."
  },
  {
    "rule_id": "4.1",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure a user for the container has been created",
    "cis_level": " Level 1 - Docker",
    "description": "Create a non-root user for the container in the Dockerfile for the container image.",
    "expected_values": "By default, the containers are run with rootprivileges and as user rootinside the container.",
    "validation_logic": "docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}: User={{\n.Config.User }}'\nThe above command should return container username or user ID. If it is blank it means,\nthe container is running as root.",
    "remediation_steps": "Ensure that the Dockerfile for the container image contains below instruction:\nUSER <username or ID>\nwhere username or ID refers to the user that could be found in the container base image. If\nthere is no specific user created in the container base image, then add a useradd command\nto add the specific user before USER instruction.\n113 | P a ge\nFor example, add the below lines in the Dockerfile to create a user in the container:\nRUN useradd -d /home/username -m -s /bin/bash username\nUSER username\nNote: If there are users in the image that the containers do not need, consider deleting\nthem. After deleting those users, commit the image and then generate new instances of\ncontainers for use.",
    "severity": "Scored",
    "is_active": true,
    "references_text": "1. https://github.com/docker/docker/issues/2918\n2. https://github.com/docker/docker/pull/4572\n3. https://github.com/docker/docker/issues/7906",
    "audit": "docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}: User={{\n.Config.User }}'\nThe above command should return container username or user ID. If it is blank it means,\nthe container is running as root.",
    "rationale": "It is a good practice to run the container as a non-root user, if possible. Though user\nnamespace mapping is now available, if a user is already defined in the container image, the\ncontainer is run as that user by default and specific user namespace remapping is not\nrequired.",
    "impact": "None."
  },
  {
    "rule_id": "4.2",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure that containers use trusted base images",
    "cis_level": " Level 1 - Docker",
    "description": "Ensure that the container image is written either from scratch or is based on another\nestablished and trusted base image downloaded over a secure channel.",
    "expected_values": "Not Applicable.",
    "validation_logic": "Step 1 - Inspect the Docker host for Docker images used by executing the below command:\ndocker images\nThis would list all the container images that are currently available for use on the Docker\nhost. Interview the system administrator and obtain a proof of evidence that the list of\nimages was obtained from trusted source over a secure channel or from a trusted, secure\nprivate Docker registry.\nStep 2 - For each Docker image found on the Docker host, inspect the image for how it was\nbuilt to verify if from trusted sources and hardened configuration:\ndocker history <imageName>",
    "remediation_steps": " Configure and use Docker Content trust.\n Inspect Docker image history to evaluate their risk to operate on your network.\n Scan Docker images for vulnerabilities in their dependencies and configurations\nthey will impose upon your network.",
    "severity": "Not Scored",
    "is_active": true,
    "references_text": "1. https://titanous.com/posts/docker-insecurity\n2. https://registry.hub.docker.com/\n3. http://blog.docker.com/2014/10/docker-1-3-signed-images-process-injection-\nsecurity-options-mac-shared-directories/\n4. https://github.com/docker/docker/issues/8093\n5. https://docs.docker.com/engine/reference/commandline/pull/\n6. https://github.com/docker/docker/pull/11109\n7. https://blog.docker.com/2015/11/docker-trusted-registry-1-4/",
    "audit": "Step 1 - Inspect the Docker host for Docker images used by executing the below command:\ndocker images\nThis would list all the container images that are currently available for use on the Docker\nhost. Interview the system administrator and obtain a proof of evidence that the list of\nimages was obtained from trusted source over a secure channel or from a trusted, secure\nprivate Docker registry.\nStep 2 - For each Docker image found on the Docker host, inspect the image for how it was\nbuilt to verify if from trusted sources and hardened configuration:\ndocker history <imageName>",
    "rationale": "Official repositories are Docker images curated and optimized by the Docker community or\nthe vendor. There could be other potentially unsafe public repositories. Caution should be\nexercised when obtaining container images from Docker and third parties to how they will\nbe used for your organization's data.",
    "impact": "None.\n115 | P a ge"
  },
  {
    "rule_id": "4.3",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure unnecessary packages are not installed in the container (Not",
    "cis_level": " Level 1 - Docker",
    "description": "Containers tend to be minimal and slim down versions of the Operating System. Do not\ninstall anything that does not justify the purpose of container.",
    "expected_values": "Not Applicable.",
    "validation_logic": "Step 1: List all the running instances of containers by executing below command:\ndocker ps --quiet\nStep 2: For each container instance, execute the below or equivalent command:\ndocker exec $INSTANCE_ID rpm -qa\nThe above command would list the packages installed on the container. Review the list and\nensure that it is legitimate.",
    "remediation_steps": "At the outset, do not install anything on the container that does not justify the purpose. If\nthe image had some packages that your container does not use, uninstall them.\nConsider using a minimal base image rather than the standard Redhat/Centos/Debian\nimages if you can. Some of the options include BusyBox and Alpine.\nNot only does this trim your image size from >150Mb to ~20 Mb, there are also fewer tools\nand paths to escalate privileges. You can even remove the package installer as a final\nhardening measure for leaf/production containers.\n117 | P a ge",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.docker.com/userguide/dockerimages/\n2. http://www.livewyer.com/blog/2015/02/24/slimming-down-your-docker-\ncontainers-alpine-linux\n3. https://github.com/progrium/busybox",
    "audit": "Step 1: List all the running instances of containers by executing below command:\ndocker ps --quiet\nStep 2: For each container instance, execute the below or equivalent command:\ndocker exec $INSTANCE_ID rpm -qa\nThe above command would list the packages installed on the container. Review the list and\nensure that it is legitimate.",
    "rationale": "Bloating containers with unnecessary software could possibly increase the attack surface\nof the container. This also voids the concept of minimal and slim down versions of\ncontainer images. Hence, do not install anything else apart from what is truly needed for\nthe purpose of the container.",
    "impact": "None."
  },
  {
    "rule_id": "4.4",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure images are scanned and rebuilt to include security patches",
    "cis_level": " Level 1 - Docker",
    "description": "Images should be scanned \"frequently\" for any vulnerabilities. Rebuild the images to\ninclude patches and then instantiate new containers from it.",
    "expected_values": "By default, containers and images are not updated of their own.",
    "validation_logic": "Step 1: List all the running instances of containers by executing below command:\ndocker ps --quiet\nStep 2: For each container instance, execute the below or equivalent command to find the\nlist of packages installed within the container. Ensure that the security updates for various\naffected packages are installed.\ndocker exec $INSTANCE_ID rpm -qa\nAlternatively, you could run image vulnerability scanning tools which can scan all the\nimages in your ecosystem and then apply patches for the detected vulnerabilities based on\nyour patch management procedures.",
    "remediation_steps": "Follow the below steps to rebuild the images with security patches:\n119 | P a ge\nStep 1: Pull all the base images (i.e., given your set of Dockerfiles, extract all images\ndeclared in FROM instructions, and re-pull them to check for an updated/patched versions).\nPatch the packages within the images too.\ndocker pull\nStep 2: Force a rebuild of each image:\ndocker build --no-cache\nStep 3: Restart all containers with the updated images.\nYou could also use ONBUILD directive in the Dockerfile to trigger particular update\ninstructions for images that you know are used as base images frequently.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.docker.com/userguide/dockerimages/\n2. https://docs.docker.com/docker-cloud/builds/image-scan/\n3. https://blog.docker.com/2016/05/docker-security-scanning/\n4. https://docs.docker.com/engine/reference/builder/#/onbuild",
    "audit": "Step 1: List all the running instances of containers by executing below command:\ndocker ps --quiet\nStep 2: For each container instance, execute the below or equivalent command to find the\nlist of packages installed within the container. Ensure that the security updates for various\naffected packages are installed.\ndocker exec $INSTANCE_ID rpm -qa\nAlternatively, you could run image vulnerability scanning tools which can scan all the\nimages in your ecosystem and then apply patches for the detected vulnerabilities based on\nyour patch management procedures.",
    "rationale": "Vulnerabilities are loopholes/bugs that can be exploited and security patches are updates\nto resolve these vulnerabilities. We can use image vulnerability scanning tools to find any\nkind of vulnerabilities within the images and then check for available patches to mitigate\nthese vulnerabilities. Patches update the system to the most recent code base. Being on the\ncurrent code base is important because that's where vendors focus on fixing problems.\nEvaluate the security patches before applying and follow the patching best practices.\nAlso, it would be better if, image vulnerability scanning tools could perform binary level\nanalysis or hash based verification instead of just version string matching.",
    "impact": "None"
  },
  {
    "rule_id": "4.5",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure Content trust for Docker is Enabled",
    "cis_level": " Level 2 - Docker",
    "description": "Content trust is disabled by default. You should enable it.",
    "expected_values": "By default, content trust is disabled.\n121 | P a ge",
    "validation_logic": "echo $DOCKER_CONTENT_TRUST\nThis should return 1.",
    "remediation_steps": "To enable content trust in a bash shell, enter the following command:\nexport DOCKER_CONTENT_TRUST=1\nAlternatively, set this environment variable in your profile file so that content trust in\nenabled on every login.",
    "severity": "Scored",
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/security/trust/content_trust/\n2. https://docs.docker.com/engine/reference/commandline/cli/#notary\n3. https://docs.docker.com/engine/reference/commandline/cli/#environment-\nvariables",
    "audit": "echo $DOCKER_CONTENT_TRUST\nThis should return 1.",
    "rationale": "Content trust provides the ability to use digital signatures for data sent to and received\nfrom remote Docker registries. These signatures allow client-side verification of the\nintegrity and publisher of specific image tags. This ensures provenance of container images.",
    "impact": "In an environment where DOCKER_CONTENT_TRUST is set, you are required to follow trust\nprocedures while working with images - build, create, pull, pushand run. You can use the\n--disable-content-trust flag to run individual operations on tagged images without\ncontent trust on an as-needed basis but that defeats the purpose of enabling content trust\nand hence, should be avoided wherever possible.\nNote: Content trust is currently only available for users of the public Docker Hub. It is\ncurrently not available for the Docker Trusted Registry or for private registries."
  },
  {
    "rule_id": "4.6",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure HEALTHCHECK instructions have been added to the container",
    "cis_level": " Level 1 - Docker",
    "description": "Add HEALTHCHECK instruction in your docker container images to perform the health check\non running containers.",
    "expected_values": "By default, HEALTHCHECK is not set.",
    "validation_logic": "Run the below command and ensure that the docker image has appropriate HEALTHCHECK\ninstruction set up.\ndocker inspect --format='{{ .Config.Healthcheck }}' <IMAGE>",
    "remediation_steps": "Follow Docker documentation and rebuild your container image with HEALTHCHECK\ninstruction.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/reference/builder/#healthcheck\n123 | P a ge",
    "audit": "Run the below command and ensure that the docker image has appropriate HEALTHCHECK\ninstruction set up.\ndocker inspect --format='{{ .Config.Healthcheck }}' <IMAGE>",
    "rationale": "One of the important security triads is availability. Adding HEALTHCHECK instruction to your\ncontainer image ensures that the docker engine periodically checks the running container\ninstances against that instruction to ensure that the instances are still working.\nBased on the reported health status, the docker engine could then exit non-working\ncontainers and instantiate new ones.",
    "impact": "None."
  },
  {
    "rule_id": "4.7",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure update instructions are not use alone in the Dockerfile (Not",
    "cis_level": " Level 1 - Docker",
    "description": "Do not use update instructions such as apt-get update alone or in a single line in the\nDockerfile.",
    "expected_values": "By default, docker does not enforce any restrictions on using update instructions.",
    "validation_logic": "Step 1: Run the below command to get the list of images:\ndocker images\nStep 2: Run the below command for each image in the list above, and look for any update\ninstructions being in a single line:\ndocker history <Image_ID>\nAlternatively, if you have access to Dockerfile for the image, verify that there are no update\ninstructions as described above.",
    "remediation_steps": "Use update instructions along with install instructions (or any other) and version pinning\nfor packages while installing them. This would bust the cache and force to extract the\nrequired versions.\nAlternatively, you could use --no-cache flag during docker build process to avoid using\ncached layers.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/userguide/eng-image/dockerfile_best-\npractices/#run\n2. https://github.com/docker/docker/issues/3313",
    "audit": "Step 1: Run the below command to get the list of images:\ndocker images\nStep 2: Run the below command for each image in the list above, and look for any update\ninstructions being in a single line:\ndocker history <Image_ID>\nAlternatively, if you have access to Dockerfile for the image, verify that there are no update\ninstructions as described above.",
    "rationale": "Adding the update instructions in a single line on the Dockerfile will cache the update layer.\nThus, when you build any image later using the same instruction, previously cached update\nlayer will be used. This could potentially deny any fresh updates to go in the later builds.",
    "impact": "None\n125 | P a ge"
  },
  {
    "rule_id": "4.8",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure setuid and setgid permissions are removed in the images",
    "cis_level": " Level 2 - Docker",
    "description": "Removing setuid and setgid permissions in the images would prevent privilege escalation\nattacks in the containers.",
    "expected_values": "Not Applicable",
    "validation_logic": "Run the below command on the image to list the executables having setuid and setgid\npermissions:\ndocker run <Image_ID> find / -perm +6000 -type f -exec ls -ld {} \\; 2>\n/dev/null\nCarefully, review the list and ensure that it is legitimate.",
    "remediation_steps": "Allow setuid and setgid permissions only on executables which need them. You could\nremove these permissions during build time by adding the following command in your\nDockerfile, preferably towards the end of the Dockerfile:\nRUN find / -perm +6000 -type f -exec chmod a-s {} \\; || true",
    "severity": null,
    "is_active": true,
    "references_text": "1. http://www.oreilly.com/webops-perf/free/files/docker-security.pdf\n2. http://container-\nsolutions.com/content/uploads/2015/06/15.06.15_DockerCheatSheet_A2.pdf\n3. http://man7.org/linux/man-pages/man2/setuid.2.html\n4. http://man7.org/linux/man-pages/man2/setgid.2.html",
    "audit": "Run the below command on the image to list the executables having setuid and setgid\npermissions:\ndocker run <Image_ID> find / -perm +6000 -type f -exec ls -ld {} \\; 2>\n/dev/null\nCarefully, review the list and ensure that it is legitimate.",
    "rationale": "setuid and setgid permissions could be used for elevating privileges. While these\npermissions are at times legitimately needed, these could potentially be used in privilege\nescalation attacks. Thus, you should consider dropping these permissions for the packages\nwhich do not need them within the images.",
    "impact": "Above command breaks all the executables that depend on setuid or setgid permissions\nincluding the legitimate ones. Hence, be careful to modify the command to suit your\nrequirements so that it does not drop the permissions of legitimate programs. This\nrequires a careful examination of each executable and fine tuning the permissions.\n127 | P a ge"
  },
  {
    "rule_id": "4.9",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure COPY is used instead of ADD in Dockerfile",
    "cis_level": " Level 1 - Docker",
    "description": "Use COPY instruction instead of ADD instruction in the Dockerfile.",
    "expected_values": "Not Applicable\n129 | P a ge",
    "validation_logic": "Step 1: Run the below command to get the list of images:\ndocker images\nStep 2: Run the below command for each image in the list above and look for any ADD\ninstructions:\ndocker history <Image_ID>\nAlternatively, if you have access to Dockerfile for the image, verify that there are no ADD\ninstructions.",
    "remediation_steps": "Use COPY instructions in Dockerfiles.",
    "severity": "Not Scored",
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/userguide/eng-image/dockerfile_best-\npractices/#add-or-copy",
    "audit": "Step 1: Run the below command to get the list of images:\ndocker images\nStep 2: Run the below command for each image in the list above and look for any ADD\ninstructions:\ndocker history <Image_ID>\nAlternatively, if you have access to Dockerfile for the image, verify that there are no ADD\ninstructions.",
    "rationale": "COPY instruction just copies the files from the local host machine to the container file\nsystem. ADD instruction potentially could retrieve files from remote URLs and perform\noperations such as unpacking. Thus, ADD instruction introduces risks such as adding\nmalicious files from URLs without scanning and unpacking procedure vulnerabilities.",
    "impact": "You would need to take care of the functionalities provided by ADD instructions such as\nfetching files from remote URLs."
  },
  {
    "rule_id": "4.10",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure secrets are not stored in Dockerfiles",
    "cis_level": " Level 1 - Docker",
    "description": "Do not store any secrets in Dockerfiles.",
    "expected_values": "By default, there are no restrictions on storing config secrets in the Dockerfiles.",
    "validation_logic": "Step 1: Run the below command to get the list of images:\ndocker images\nStep 2: Run the below command for each image in the list above, and look for any secrets:\ndocker history <Image_ID>\nAlternatively, if you have access to Dockerfile for the image, verify that there are no secrets\nas described above.",
    "remediation_steps": "Do not store any kind of secrets within Dockerfiles.",
    "severity": "Not Scored",
    "is_active": true,
    "references_text": "1. https://github.com/docker/docker/issues/13490\n2. http://12factor.net/config\n131 | P a ge\n3. https://avicoder.me/2016/07/22/Twitter-Vine-Source-code-dump/",
    "audit": "Step 1: Run the below command to get the list of images:\ndocker images\nStep 2: Run the below command for each image in the list above, and look for any secrets:\ndocker history <Image_ID>\nAlternatively, if you have access to Dockerfile for the image, verify that there are no secrets\nas described above.",
    "rationale": "Dockerfiles could be backtracked easily by using native Docker commands such as docker\nhistory and various tools and utilities. Also, as a general practice, image publishers\nprovide Dockerfiles to build the credibility for their images. Hence, the secrets within these\nDockerfiles could be easily exposed and potentially be exploited.",
    "impact": "You would need to identify a way to handle secrets for your Docker images."
  },
  {
    "rule_id": "4.11",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure verified packages are only Installed",
    "cis_level": " Level 2 - Docker",
    "description": "Verify authenticity of the packages before installing them in the image.",
    "expected_values": "Not Applicable\n133 | P a ge",
    "validation_logic": "Step 1: Run the below command to get the list of images:\ndocker images\nStep 2: Run the below command for each image in the list above, and look for how the\nauthenticity of the packages is determined. This could be via the use of GPG keys or other\nsecure package distribution mechanisms\ndocker history <Image_ID>\nAlternatively, if you have access to Dockerfile for the image, verify that the authenticity of\nthe packages is checked.",
    "remediation_steps": "Use GPG keys for downloading and verifying packages or any other secure package\ndistribution mechanism of your choice.",
    "severity": "Not Scored",
    "is_active": true,
    "references_text": "1. http://www.oreilly.com/webops-perf/free/files/docker-security.pdf\n2. https://github.com/docker-\nlibrary/httpd/blob/12bf8c8883340c98b3988a7bade8ef2d0d6dcf8a/2.4/Dockerfil\ne\n3. https://github.com/docker-\nlibrary/php/blob/d8a4ccf4d620ec866d5b42335b699742df08c5f0/7.0/alpine/Doc\nkerfile\n4. https://access.redhat.com/security/team/key",
    "audit": "Step 1: Run the below command to get the list of images:\ndocker images\nStep 2: Run the below command for each image in the list above, and look for how the\nauthenticity of the packages is determined. This could be via the use of GPG keys or other\nsecure package distribution mechanisms\ndocker history <Image_ID>\nAlternatively, if you have access to Dockerfile for the image, verify that the authenticity of\nthe packages is checked.",
    "rationale": "Verifying authenticity of the packages is essential for building a secure container image.\nTampered packages could potentially be malicious or have some known vulnerabilities that\ncould be exploited.",
    "impact": "None"
  },
  {
    "rule_id": "5.1",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure AppArmor Profile is Enabled",
    "cis_level": " Level 1 - Docker",
    "description": "AppArmor is an effective and easy-to-use Linux application security system. It is available\non quite a few Linux distributions by default such as Debian and Ubuntu.",
    "expected_values": "By default, docker-default AppArmor profile is applied for running containers and this\nprofile can be found at /etc/apparmor.d/docker.",
    "validation_logic": "docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:\nAppArmorProfile={{ .AppArmorProfile }}'\nThe above command should return a valid AppArmor Profile for each container instance.",
    "remediation_steps": "If AppArmor is applicable for your Linux OS, use it. You may have to follow below set of\nsteps:\n1. Verify if AppArmor is installed. If not, install it.\n2. Create or import a AppArmor profile for Docker containers.\n3. Put this profile in enforcing mode.\n4. Start your Docker container using the customized AppArmor profile. For example,\ndocker run --interactive --tty --security-opt=\"apparmor:PROFILENAME\" centos\n/bin/bash\n135 | P a ge\nAlternatively, you can keep the docker's default apparmor profile.",
    "severity": "Scored",
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/security/apparmor/\n2. https://docs.docker.com/engine/reference/run/#security-configuration\n3. https://docs.docker.com/engine/security/security/#other-kernel-security-features",
    "audit": "docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:\nAppArmorProfile={{ .AppArmorProfile }}'\nThe above command should return a valid AppArmor Profile for each container instance.",
    "rationale": "AppArmor protects the Linux OS and applications from various threats by enforcing\nsecurity policy which is also known as AppArmor profile. You can create your own\nAppArmor profile for containers or use the Docker's default AppArmor profile. This would\nenforce security policies on the containers as defined in the profile.",
    "impact": "The container (process) would have set of restrictions as defined in AppArmor profile. If\nyour AppArmor profile is mis-configured, then the container may not entirely work as\nexpected."
  },
  {
    "rule_id": "5.2",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure SELinux security options are set, if applicable",
    "cis_level": " Level 2 - Docker",
    "description": "SELinux is an effective and easy-to-use Linux application security system. It is available on\nquite a few Linux distributions by default such as Red Hat and Fedora.",
    "expected_values": "By default, no SELinux security options are applied on containers.",
    "validation_logic": "docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:\nSecurityOpt={{ .HostConfig.SecurityOpt }}'\nThe above command should return all the security options currently configured for the\ncontainers.",
    "remediation_steps": "If SELinux is applicable for your Linux OS, use it. You may have to follow below set of steps:\n1. Set the SELinux State.\n2. Set the SELinux Policy.\n3. Create or import a SELinux policy template for Docker containers.\n4. Start Docker in daemon mode with SELinux enabled. For example,\ndocker daemon --selinux-enabled\n5. Start your Docker container using the security options. For example,\ndocker run --interactive --tty --security-opt label=level:TopSecret centos\n/bin/bash",
    "severity": "Scored",
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/security/security/#other-kernel-security-features\n2. https://docs.docker.com/engine/reference/run/#security-configuration\n3. http://docs.fedoraproject.org/en-US/Fedora/13/html/Security-Enhanced_Linux/\n4. https://access.redhat.com/documentation/en-\nus/red_hat_enterprise_linux_atomic_host/7/html/container_security_guide/docker_\nselinux_security_policy",
    "audit": "docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:\nSecurityOpt={{ .HostConfig.SecurityOpt }}'\nThe above command should return all the security options currently configured for the\ncontainers.",
    "rationale": "SELinux provides a Mandatory Access Control (MAC) system that greatly augments the\ndefault Discretionary Access Control (DAC) model. You can thus add an extra layer of safety\nby enabling SELinux on your Linux host, if applicable.",
    "impact": "The container (process) would have set of restrictions as defined in SELinux policy. If your\nSELinux policy is mis-configured, then the container may not entirely work as expected.\n137 | P a ge"
  },
  {
    "rule_id": "5.3",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure Linux Kernel Capabilities are restricted within containers",
    "cis_level": " Level 1 - Docker",
    "description": "By default, Docker starts containers with a restricted set of Linux Kernel Capabilities. It\nmeans that any process may be granted the required capabilities instead of root access.\nUsing Linux Kernel Capabilities, the processes do not have to run as root for almost all the\nspecific areas where root privileges are usually needed.",
    "expected_values": "By default, below capabilities are available for containers:\nAUDIT_WRITE\nCHOWN\nDAC_OVERRIDE\nFOWNER\nFSETID\nKILL\nMKNOD\nNET_BIND_SERVICE\nNET_RAW\nSETFCAP\nSETGID\nSETPCAP\nSETUID\nSYS_CHROOT",
    "validation_logic": "docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}: CapAdd={{\n.HostConfig.CapAdd }} CapDrop={{ .HostConfig.CapDrop }}'\nVerify that the added and dropped Linux Kernel Capabilities are in line with the ones\nneeded for container process for each container instance.",
    "remediation_steps": "Execute the below command to add needed capabilities:\n$> docker run --cap-add={\"Capability 1\",\"Capability 2\"}\nFor example,\ndocker run --interactive --tty --cap-add={\"NET_ADMIN\",\"SYS_ADMIN\"}\ncentos:latest /bin/bash\n139 | P a ge\nExecute the below command to drop unneeded capabilities:\n$> docker run --cap-drop={\"Capability 1\",\"Capability 2\"}\nFor example,\ndocker run --interactive --tty --cap-drop={\"SETUID\",\"SETGID\"} centos:latest\n/bin/bash\nAlternatively,\nYou may choose to drop all capabilities and add only add the needed ones:\n$> docker run --cap-drop=all --cap-add={\"Capability 1\",\"Capability 2\"}\nFor example,\ndocker run --interactive --tty --cap-drop=all --cap-\nadd={\"NET_ADMIN\",\"SYS_ADMIN\"} centos:latest /bin/bash",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/security/security/#linux-kernel-capabilities\n2. http://man7.org/linux/man-pages/man7/capabilities.7.html\n3. http://www.oreilly.com/webops-perf/free/files/docker-security.pdf\n140 | P a ge",
    "audit": "docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}: CapAdd={{\n.HostConfig.CapAdd }} CapDrop={{ .HostConfig.CapDrop }}'\nVerify that the added and dropped Linux Kernel Capabilities are in line with the ones\nneeded for container process for each container instance.",
    "rationale": "Docker supports the addition and removal of capabilities, allowing the use of a non-default\nprofile. This may make Docker more secure through capability removal, or less secure\nthrough the addition of capabilities. It is thus recommended to remove all capabilities\nexcept those explicitly required for your container process.\nFor example, capabilities such as below are usually not needed for container process:\nNET_ADMIN\nSYS_ADMIN\nSYS_MODULE",
    "impact": "Based on what Linux Kernel Capabilities were added or dropped, restrictions within the\ncontainer would apply."
  },
  {
    "rule_id": "5.4",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure privileged containers are not used",
    "cis_level": " Level 1 - Docker",
    "description": "Using the --privileged flag gives all Linux Kernel Capabilities to the container thus\noverwriting the --cap-add and --cap-drop flags. Ensure that it is not used.",
    "expected_values": "False.",
    "validation_logic": "docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:\nPrivileged={{ .HostConfig.Privileged }}'\nThe above command should return Privileged=false for each container instance.",
    "remediation_steps": "Do not run container with the --privileged flag.\nFor example, do not start a container as below:\ndocker run --interactive --tty --privileged centos /bin/bash",
    "severity": "Scored",
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/reference/run/#runtime-privilege-and-linux-\ncapabilities\n142 | P a ge",
    "audit": "docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:\nPrivileged={{ .HostConfig.Privileged }}'\nThe above command should return Privileged=false for each container instance.",
    "rationale": "The --privileged flag gives all capabilities to the container, and it also lifts all the\nlimitations enforced by the device cgroup controller. In other words, the container can then\ndo almost everything that the host can do. This flag exists to allow special use-cases, like\nrunning Docker within Docker.",
    "impact": "Linux Kernel Capabilities other than defaults would not be available for use within\ncontainer."
  },
  {
    "rule_id": "5.5",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure sensitive host system directories are not mounted on",
    "cis_level": " Level 1 - Docker",
    "description": "Sensitive host system directories such as below should not be allowed to be mounted as\ncontainer volumes especially in read-write mode.\n/\n/boot\n/dev\n/etc\n/lib\n/proc\n/sys\n/usr",
    "expected_values": "Docker defaults to a read-write volume but you can also mount a directory read-only. By\ndefault, no sensitive host directories are mounted on containers.\n144 | P a ge",
    "validation_logic": "docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:\nVolumes={{ .Mounts }}'\nThe above commands would return the list of current mapped directories and whether\nthey are mounted in read-write mode for each container instance.",
    "remediation_steps": "Do not mount host sensitive directories on containers especially in read-write mode.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/tutorials/dockervolumes/",
    "audit": "docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:\nVolumes={{ .Mounts }}'\nThe above commands would return the list of current mapped directories and whether\nthey are mounted in read-write mode for each container instance.",
    "rationale": "If sensitive directories are mounted in read-write mode, it would be possible to make\nchanges to files within those sensitive directories. The changes might bring down security\nimplications or unwarranted changes that could put the Docker host in compromised state.",
    "impact": "None."
  },
  {
    "rule_id": "5.6",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure ssh is not run within containers",
    "cis_level": " Level 1 - Docker",
    "description": "SSH server should not be running within the container. You should SSH into the Docker\nhost, and use nsenter tool to enter a container from a remote host.",
    "expected_values": "By default, SSH server is not running inside the container. Only one process per container is\nallowed.",
    "validation_logic": "Step 1: List all the running instances of containers by executing below command:\ndocker ps --quiet\nStep 2: For each container instance, execute the below command:\ndocker exec $INSTANCE_ID ps -el\nEnsure that there is no process for SSH server.",
    "remediation_steps": "Uninstall SSH server from the container and use nsenteror any other commands such as\ndocker exec or docker attach to interact with the container instance.\ndocker exec --interactive --tty $INSTANCE_ID sh\nOR\ndocker attach $INSTANCE_ID\n146 | P a ge",
    "severity": "Scored",
    "is_active": true,
    "references_text": "1. http://blog.docker.com/2014/06/why-you-dont-need-to-run-sshd-in-docker/",
    "audit": "Step 1: List all the running instances of containers by executing below command:\ndocker ps --quiet\nStep 2: For each container instance, execute the below command:\ndocker exec $INSTANCE_ID ps -el\nEnsure that there is no process for SSH server.",
    "rationale": "Running SSH within the container increases the complexity of security management by\nmaking it\n Difficult to manage access policies and security compliance for SSH server\n Difficult to manage keys and passwords across various containers\n Difficult to manage security upgrades for SSH server\nIt is possible to have shell access to a container without using SSH, the needlessly\nincreasing the complexity of security management should be avoided.",
    "impact": "None."
  },
  {
    "rule_id": "5.7",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure privileged ports are not mapped within containers",
    "cis_level": " Level 1 - Docker",
    "description": "The TCP/IP port numbers below 1024are considered privileged ports. Normal users and\nprocesses are not allowed to use them for various security reasons. Docker allows a\ncontainer port to be mapped to a privileged port.",
    "expected_values": "By default, mapping a container port to a privileged port on the host is allowed.\nNote: There might be certain cases where you want to map privileged ports, because if you\nforbid it, then the corresponding application has to run outside of a container.\nFor example: HTTP and HTTPS load balancers have to bind 80/tcp and 443/tcp\nrespectively. Forbidding to map privileged ports effectively forbids from running those in a\ncontainer, and mandates using an external load balancer. In such cases, those containers\ninstances should be marked as exceptions for this recommendation.",
    "validation_logic": "List all running containers instances and their port mapping by executing the below\ncommand:\ndocker ps --quiet | xargs docker inspect --format '{{ .Id }}: Ports={{\n.NetworkSettings.Ports }}'\nReview the list and ensure that container ports are not mapped to host port numbers\nbelow 1024.",
    "remediation_steps": "Do not map the container ports to privileged host ports when starting a container. Also,\nensure that there is no such container to host privileged port mapping declarations in the\nDockerfile.",
    "severity": "Scored",
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/userguide/networking/",
    "audit": "List all running containers instances and their port mapping by executing the below\ncommand:\ndocker ps --quiet | xargs docker inspect --format '{{ .Id }}: Ports={{\n.NetworkSettings.Ports }}'\nReview the list and ensure that container ports are not mapped to host port numbers\nbelow 1024.",
    "rationale": "By default, if the user does not specifically declare the container port to host port mapping,\nDocker automatically and correctly maps the container port to one available in 49153-\n65535 block on the host. But, Docker allows a container port to be mapped to a privileged\nport on the host if the user explicitly declared it. This is so because containers are executed\nwith NET_BIND_SERVICE Linux kernel capability that does not restrict the privileged port\nmapping. The privileged ports receive and transmit various sensitive and privileged data.\nAllowing containers to use them can bring serious implications.",
    "impact": "None.\n148 | P a ge"
  },
  {
    "rule_id": "5.8",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure only needed ports are open on the container",
    "cis_level": " Level 1 - Docker",
    "description": "Dockerfile for a container image defines the ports to be opened by default on a container\ninstance. The list of ports may or may not be relevant to the application you are running\nwithin the container.",
    "expected_values": "By default, all the ports that are listed in the Dockerfile under EXPOSE instruction for an\nimage are opened when a container is run with -P or --publish-all flag.",
    "validation_logic": "List all the running instances of containers and their port mapping by executing the below\ncommand:\ndocker ps --quiet | xargs docker inspect --format '{{ .Id }}: Ports={{\n.NetworkSettings.Ports }}'\nReview the list and ensure that the ports mapped are the ones that are really needed for\nthe container.",
    "remediation_steps": "Fix the Dockerfile of the container image to expose only needed ports by your\ncontainerized application. You can also completely ignore the list of ports defined in the\nDockerfile by NOT using -P (UPPERCASE) or --publish-all flag when starting the\ncontainer. Use the -p (lowercase) or --publish flag to explicitly define the ports that you\nneed for a particular container instance.\nFor example,\ndocker run --interactive --tty --publish 5000 --publish 5001 --publish 5002\ncentos /bin/bash\n150 | P a ge",
    "severity": "Scored",
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/userguide/networking/",
    "audit": "List all the running instances of containers and their port mapping by executing the below\ncommand:\ndocker ps --quiet | xargs docker inspect --format '{{ .Id }}: Ports={{\n.NetworkSettings.Ports }}'\nReview the list and ensure that the ports mapped are the ones that are really needed for\nthe container.",
    "rationale": "A container can be run just with the ports defined in the Dockerfile for its image or can be\narbitrarily passed run time parameters to open a list of ports. Additionally, Overtime,\nDockerfile may undergo various changes and the list of exposed ports may or may not be\nrelevant to the application you are running within the container. Opening unneeded ports\nincrease the attack surface of the container and the containerized application. As a\nrecommended practice, do not open unneeded ports.",
    "impact": "None."
  },
  {
    "rule_id": "5.9",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure the host's network namespace is not shared",
    "cis_level": " Level 1 - Docker",
    "description": "The networking mode on a container when set to --net=host, skips placing the container\ninside separate network stack. In essence, this choice tells Docker to not containerize the\ncontainer's networking. This would network-wise mean that the container lives \"outside\"\nin the main Docker host and has full access to its network interfaces.",
    "expected_values": "By default, container connects to Docker bridge.",
    "validation_logic": "docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:\nNetworkMode={{ .HostConfig.NetworkMode }}'\nIf the above command returns NetworkMode=host, it means that --net=host option was\npassed when container was started. This would be non-compliant.",
    "remediation_steps": "Do not pass --net=host option when starting the container.",
    "severity": "Scored",
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/userguide/networking/\n2. https://docs.docker.com/engine/reference/run/#network-settings\n152 | P a ge",
    "audit": "docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:\nNetworkMode={{ .HostConfig.NetworkMode }}'\nIf the above command returns NetworkMode=host, it means that --net=host option was\npassed when container was started. This would be non-compliant.",
    "rationale": "This is potentially dangerous. It allows the container process to open low-numbered ports\nlike any other root process. It also allows the container to access network services like D-\nbus on the Docker host. Thus, a container process can potentially do unexpected things\nsuch as shutting down the Docker host. You should not use this option.",
    "impact": "None."
  },
  {
    "rule_id": "5.10",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure memory usage for container is limited",
    "cis_level": " Level 1 - Docker",
    "description": "By default, all containers on a Docker host share the resources equally. By using the\nresource management capabilities of Docker host, such as memory limit, you can control\nthe amount of memory that a container may consume.",
    "expected_values": "By default, all containers on a Docker host share the resources equally. No memory limits\nare enforced.",
    "validation_logic": "docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}: Memory={{\n.HostConfig.Memory }}'\nIf the above command returns 0, it means the memory limits are not in place. If the above\ncommand returns a non-zero value, it means memory limits are in place.",
    "remediation_steps": "Run the container with only as much memory as required. Always run the container using\nthe --memory argument.\nFor example, you could run a container as below:\ndocker run --interactive --tty --memory 256m centos /bin/bash\nIn the above example, the container is started with a memory limit of 256 MB.\nNote: Please note that the output of the below command would return values in scientific\nnotation if memory limits are in place.\ndocker inspect --format='{{.Config.Memory}}' 7c5a2d4c7fe0\n154 | P a ge\nFor example, if the memory limit is set to 256 MB for the above container instance, the\noutput of the above command would be 2.68435456e+08 and NOT 256m. You should\nconvert this value using a scientific calculator or programmatic methods.",
    "severity": "Scored",
    "is_active": true,
    "references_text": "1. https://goldmann.pl/blog/2014/09/11/resource-management-in-docker/\n2. https://docs.docker.com/engine/reference/commandline/run/#options\n3. https://docs.docker.com/engine/admin/runmetrics/",
    "audit": "docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}: Memory={{\n.HostConfig.Memory }}'\nIf the above command returns 0, it means the memory limits are not in place. If the above\ncommand returns a non-zero value, it means memory limits are in place.",
    "rationale": "By default, container can use all of the memory on the host. You can use memory limit\nmechanism to prevent a denial of service arising from one container consuming all of the\nhost’s resources such that other containers on the same host cannot perform their intended\nfunctions. Having no limit on memory can lead to issues where one container can easily\nmake the whole system unstable and as a result unusable.",
    "impact": "If you do not set proper limits, the container process may have to starve."
  },
  {
    "rule_id": "5.11",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure CPU priority is set appropriately on the container",
    "cis_level": " Level 1 - Docker",
    "description": "By default, all containers on a Docker host share the resources equally. By using the\nresource management capabilities of Docker host, such as CPU shares, you can control the\nhost CPU resources that a container may consume.",
    "expected_values": "By default, all containers on a Docker host share the resources equally. No CPU shares are\nenforced.",
    "validation_logic": "docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:\nCpuShares={{ .HostConfig.CpuShares }}'\nIf the above command returns 0 or 1024, it means the CPU shares are not in place. If the\nabove command returns a non-zero value other than 1024, it means CPU shares are in\nplace.",
    "remediation_steps": "Manage the CPU shares between your containers. To do so start the container using the --\ncpu-shares argument.\nFor example, you could run a container as below:\ndocker run --interactive --tty --cpu-shares 512 centos /bin/bash\nIn the above example, the container is started with CPU shares of 50% of what the other\ncontainers use. So, if the other container has CPU shares of 80%, this container will have\nCPU shares of 40%.\nNote: Every new container will have 1024 shares of CPU by default. However, this value is\nshown as 0 if you run the command mentioned in the audit section.\n156 | P a ge\nAlternatively,\n1. Navigate to /sys/fs/cgroup/cpu/system.slice/ directory.\n2. Check your container instance ID using docker ps.\n3. Now, inside the above directory (in step 1), you would have a directory by name\ndocker-<Instance ID>.scope. For example, docker-\n4acae729e8659c6be696ee35b2237cc1fe4edd2672e9186434c5116e1a6fbed6.scope.\nNavigate to this directory.\n4. You will find a file named cpu.shares. Execute cat cpu.shares. This will always\ngive you the CPU share value based on the system. So, even if there is no CPU shares\nconfigured using -c or --cpu-shares argument in the docker run command, this\nfile will have a value of 1024.\nIf we set one container’s CPU shares to 512 it will receive half of the CPU time compared to\nthe other container. So, take 1024 as 100% and then do quick math to derive the number\nthat you should set for respective CPU shares. For example, use 512 if you want to set 50%\nand 256 if you want to set 25%.",
    "severity": "Scored",
    "is_active": true,
    "references_text": "1. https://goldmann.pl/blog/2014/09/11/resource-management-in-docker/\n2. https://docs.docker.com/engine/reference/commandline/run/#options\n3. https://docs.docker.com/engine/admin/runmetrics/",
    "audit": "docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:\nCpuShares={{ .HostConfig.CpuShares }}'\nIf the above command returns 0 or 1024, it means the CPU shares are not in place. If the\nabove command returns a non-zero value other than 1024, it means CPU shares are in\nplace.",
    "rationale": "By default, CPU time is divided between containers equally. If it is desired, to control the\nCPU time amongst the container instances, you can use CPU sharing feature. CPU sharing\nallows to prioritize one container over the other and forbids the lower priority container to\nclaim CPU resources more often. This ensures that the high priority containers are served\nbetter.",
    "impact": "If you do not set proper CPU shares, the container process may have to starve if the\nresources on the host are not available. If the CPU resources on the host are free, CPU\nshares do not place any restrictions on the CPU that the container may use."
  },
  {
    "rule_id": "5.12",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure the container's root filesystem is mounted as read only",
    "cis_level": " Level 1 - Docker",
    "description": "The container's root filesystem should be treated as a 'golden image' by using Docker run's\n--read-only option. This prevents any writes to the container's root filesystem at\ncontainer runtime and enforces the principle of immutable infrastructure.",
    "expected_values": "By default, a container will have its root filesystem writable allowing all container\nprocesses to write files owned by the container's runtime user.\n159 | P a ge",
    "validation_logic": "Run the following command on the docker host:\ndocker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:\nReadonlyRootfs={{ .HostConfig.ReadonlyRootfs }}'\nIf the above command returns true, it means the container's root filesystem is mounted\nread-only.\nIf the above command returns false, it means the container's root filesystem is writable.",
    "remediation_steps": "Add a --read-only flag at a container's runtime to enforce the container's root filesystem\nto be mounted as read only.\ndocker run <Run arguments> --read-only <Container Image Name or ID> <Command>\nEnabling the --read-only option at a container's runtime should be used by administrators\nto force a container's executable processes to only write container data to explicit storage\nlocations during the container's runtime.\n158 | P a ge\nExamples of explicit storage locations during a container's runtime include, but not limited\nto:\n1. Use the --tmpfs option to mount a temporary file system for non-persistent data\nwrites.\ndocker run --interactive --tty --read-only --tmpfs \"/run\" --tmpfs \"/tmp\"\ncentos /bin/bash\n2. Enabling Docker rw mounts at a container's runtime to persist container data\ndirectly on the Docker host filesystem.\ndocker run --interactive --tty --read-only -v /opt/app/data:/run/app/data:rw\ncentos /bin/bash\n3. Utilizing Docker shared-storage volume plugins for Docker data volume to persist\ncontainer data.\ndocker volume create -d convoy --opt o=size=20GB my-named-volume\ndocker run --interactive --tty --read-only -v my-named-volume:/run/app/data\ncentos /bin/bash\n3. Transmitting container data outside of the docker during the container's runtime\nfor container data to persist container data. Examples include hosted databases,\nnetwork file shares, and APIs.",
    "severity": null,
    "is_active": true,
    "references_text": "1. http://docs.docker.com/reference/commandline/cli/#run\n2. https://docs.docker.com/engine/tutorials/dockervolumes/\n3. http://www.projectatomic.io/blog/2015/12/making-docker-images-write-only-in-\nproduction/\n4. https://docs.docker.com/engine/reference/commandline/run/#mount-tmpfs-\ntmpfs\n5. https://docs.docker.com/engine/tutorials/dockervolumes/#creating-and-\nmounting-a-data-volume-container",
    "audit": "Run the following command on the docker host:\ndocker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:\nReadonlyRootfs={{ .HostConfig.ReadonlyRootfs }}'\nIf the above command returns true, it means the container's root filesystem is mounted\nread-only.\nIf the above command returns false, it means the container's root filesystem is writable.",
    "rationale": "Enabling this option forces containers at runtime to explicitly define their data writing\nstrategy to persist or not persist their data.\nThis also reduces security attack vectors since the container instance's filesystem cannot\nbe tampered with or written to unless it has explicit read-write permissions on its\nfilesystem folder and directories.",
    "impact": "Enabling --read-only at container runtime may break some container OS packages if a\ndata writing strategy is not defined.\nDefine what the container's data should and should not persist at runtime to determine\nwhich recommendation procedure to utilize.\nExample:\n Enable use --tmpfs for temporary file writes to /tmp\n Use Docker shared data volumes for persistent data writes"
  },
  {
    "rule_id": "5.13",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure incoming container traffic is binded to a specific host",
    "cis_level": " Level 1 - Docker",
    "description": "By default, Docker containers can make connections to the outside world, but the outside\nworld cannot connect to containers. Each outgoing connection will appear to originate\nfrom one of the host machine's own IP addresses. Only allow container services to be\ncontacted through a specific external interface on the host machine.",
    "expected_values": "By default, Docker exposes the container ports on 0.0.0.0, the wildcard IP address that\nwill match any possible incoming network interface on the host machine.",
    "validation_logic": "List all the running instances of containers and their port mapping by executing the below\ncommand:\ndocker ps --quiet | xargs docker inspect --format '{{ .Id }}: Ports={{\n.NetworkSettings.Ports }}'\nReview the list and ensure that the exposed container ports are tied to a particular\ninterface and not to the wildcard IP address - 0.0.0.0.\nFor example, if the above command returns as below, then this is non-compliant and the\ncontainer can accept connections on any host interface on the specified port 49153.\nPorts=map[443/tcp:<nil> 80/tcp:[map[HostPort:49153 HostIp:0.0.0.0]]]\nHowever, if the exposed port is tied to a particular interface on the host as below, then this\nrecommendation is configured as desired and is compliant.\nPorts=map[443/tcp:<nil> 80/tcp:[map[HostIp:10.2.3.4 HostPort:49153]]]\n161 | P a ge",
    "remediation_steps": "Bind the container port to a specific host interface on the desired host port.\nFor example,\ndocker run --detach --publish 10.2.3.4:49153:80 nginx\nIn the example above, the container port 80 is bound to the host port on 49153 and would\naccept incoming connection only from 10.2.3.4 external interface.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/userguide/networking/",
    "audit": "List all the running instances of containers and their port mapping by executing the below\ncommand:\ndocker ps --quiet | xargs docker inspect --format '{{ .Id }}: Ports={{\n.NetworkSettings.Ports }}'\nReview the list and ensure that the exposed container ports are tied to a particular\ninterface and not to the wildcard IP address - 0.0.0.0.\nFor example, if the above command returns as below, then this is non-compliant and the\ncontainer can accept connections on any host interface on the specified port 49153.\nPorts=map[443/tcp:<nil> 80/tcp:[map[HostPort:49153 HostIp:0.0.0.0]]]\nHowever, if the exposed port is tied to a particular interface on the host as below, then this\nrecommendation is configured as desired and is compliant.\nPorts=map[443/tcp:<nil> 80/tcp:[map[HostIp:10.2.3.4 HostPort:49153]]]\n161 | P a ge",
    "rationale": "If you have multiple network interfaces on your host machine, the container can accept\nconnections on the exposed ports on any network interface. This might not be desired and\nmay not be secured. Many a times a particular interface is exposed externally and services\nsuch as intrusion detection, intrusion prevention, firewall, load balancing, etc. are run on\nthose interfaces to screen incoming public traffic. Hence, you should not accept incoming\nconnections on any interface. You should only allow incoming connections from a\nparticular external interface.",
    "impact": "None."
  },
  {
    "rule_id": "5.14",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure 'on-failure' container restart policy is set to '5'",
    "cis_level": " Level 1 - Docker",
    "description": "Using the --restart flag in docker run command you can specify a restart policy for how a\ncontainer should or should not be restarted on exit. You should choose the on-failure\nrestart policy and limit the restart attempts to 5.",
    "expected_values": "By default, containers are not configured with restart policies. Hence, containers do not\nattempt to restart of their own.",
    "validation_logic": "docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:\nRestartPolicyName={{ .HostConfig.RestartPolicy.Name }} MaximumRetryCount={{\n.HostConfig.RestartPolicy.MaximumRetryCount }}'\n If the above command returns RestartPolicyName=always, then the system is not\nconfigured as desired and hence this recommendation is non-compliant.\n If the above command returns RestartPolicyName=no or just RestartPolicyName=,\nthen the restart policies are not being used and the container would never be\nrestarted of its own. This recommendation is then Not Applicable and can be\nassumed to be compliant.\n If the above command returns RestartPolicyName=on-failure, then verify that the\nnumber of restart attempts is set to 5 or less by looking at MaximumRetryCount.",
    "remediation_steps": "If a container is desired to be restarted of its own, then, for example, you could start the\ncontainer as below:\ndocker run --detach --restart=on-failure:5 nginx\n163 | P a ge",
    "severity": "Scored",
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/reference/commandline/run/#restart-policies-\nrestart",
    "audit": "docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:\nRestartPolicyName={{ .HostConfig.RestartPolicy.Name }} MaximumRetryCount={{\n.HostConfig.RestartPolicy.MaximumRetryCount }}'\n If the above command returns RestartPolicyName=always, then the system is not\nconfigured as desired and hence this recommendation is non-compliant.\n If the above command returns RestartPolicyName=no or just RestartPolicyName=,\nthen the restart policies are not being used and the container would never be\nrestarted of its own. This recommendation is then Not Applicable and can be\nassumed to be compliant.\n If the above command returns RestartPolicyName=on-failure, then verify that the\nnumber of restart attempts is set to 5 or less by looking at MaximumRetryCount.",
    "rationale": "If you indefinitely keep trying to start the container, it could possibly lead to a denial of\nservice on the host. It could be an easy way to do a distributed denial of service attack\nespecially if you have many containers on the same host. Additionally, ignoring the exit\nstatus of the container and always attempting to restart the container leads to non-\ninvestigation of the root cause behind containers getting terminated. If a container gets\nterminated, you should investigate on the reason behind it instead of just attempting to\nrestart it indefinitely. Thus, it is recommended to use on-failure restart policy and limit it\nto maximum of 5 restart attempts.",
    "impact": "The container would attempt to restart only for 5 times."
  },
  {
    "rule_id": "5.15",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure the host's process namespace is not shared",
    "cis_level": " Level 1 - Docker",
    "description": "Process ID (PID) namespaces isolate the process ID number space, meaning that processes\nin different PID namespaces can have the same PID. This is process level isolation between\ncontainers and the host.",
    "expected_values": "By default, all containers have the PID namespace enabled and the host's process\nnamespace is not shared with the containers.",
    "validation_logic": "docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:\nPidMode={{ .HostConfig.PidMode }}'\nIf the above command returns host, it means the host PID namespace is shared with the\ncontainer else this recommendation is compliant.",
    "remediation_steps": "Do not start a container with --pid=host argument.\nFor example, do not start a container as below:\ndocker run --interactive --tty --pid=host centos /bin/bash",
    "severity": "Scored",
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/reference/run/#pid-settings-pid\n2. http://man7.org/linux/man-pages/man7/pid_namespaces.7.html",
    "audit": "docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:\nPidMode={{ .HostConfig.PidMode }}'\nIf the above command returns host, it means the host PID namespace is shared with the\ncontainer else this recommendation is compliant.",
    "rationale": "PID namespace provides separation of processes. The PID Namespace removes the view of\nthe system processes, and allows process ids to be reused including PID 1. If the host's PID\nnamespace is shared with the container, it would basically allow processes within the\ncontainer to see all of the processes on the host system. This breaks the benefit of process\nlevel isolation between the host and the containers. Someone having access to the\ncontainer can eventually know all the processes running on the host system and can even\nkill the host system processes from within the container. This can be catastrophic. Hence,\ndo not share the host's process namespace with the containers.",
    "impact": "Container processes cannot see the processes on the host system. In certain cases, you\nwant your container to share the host's process namespace. For example, you could build a\ncontainer with debugging tools like strace or gdb, but want to use these tools when\n165 | P a ge\ndebugging processes within the container. If this is desired, then share only one (or\nneeded) host process by using the -p switch.\nFor example,\ndocker run --pid=host rhel7 strace -p 1234"
  },
  {
    "rule_id": "5.16",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure the host's IPC namespace is not shared",
    "cis_level": " Level 1 - Docker",
    "description": "IPC (POSIX/SysV IPC) namespace provides separation of named shared memory segments,\nsemaphores and message queues. IPC namespace on the host thus should not be shared\nwith the containers and should remain isolated.",
    "expected_values": "By default, all containers have the IPC namespace enabled and host IPC namespace is not\nshared with any container.",
    "validation_logic": "docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:\nIpcMode={{ .HostConfig.IpcMode }}'\nIf the above command returns host, it means the host IPC namespace is shared with the\ncontainer. If the above command returns nothing, then the host's IPC namespace is not\nshared. This recommendation is then compliant.",
    "remediation_steps": "Do not start a container with --ipc=host argument. For example, do not start a container\nas below:\ndocker run --interactive --tty --ipc=host centos /bin/bash",
    "severity": "Scored",
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/reference/run/#ipc-settings-ipc\n2. http://man7.org/linux/man-pages/man7/namespaces.7.html",
    "audit": "docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:\nIpcMode={{ .HostConfig.IpcMode }}'\nIf the above command returns host, it means the host IPC namespace is shared with the\ncontainer. If the above command returns nothing, then the host's IPC namespace is not\nshared. This recommendation is then compliant.",
    "rationale": "IPC namespace provides separation of IPC between the host and containers. If the host's\nIPC namespace is shared with the container, it would basically allow processes within the\ncontainer to see all of the IPC on the host system. This breaks the benefit of IPC level\nisolation between the host and the containers. Someone having access to the container can\neventually manipulate the host IPC. This can be catastrophic. Hence, do not share the host's\nIPC namespace with the containers.",
    "impact": "Shared memory segments are used to accelerate inter-process communication. It is\ncommonly used by high-performance applications. If such applications are containerized\ninto multiple containers, you might need to share the IPC namespace of the containers to\nachieve high performance. In such cases, you should still be sharing container specific IPC\n167 | P a ge\nnamespaces only and not the host IPC namespace. You may share the container's IPC\nnamespace with another container as below:\nFor example,\ndocker run --interactive --tty --ipc=container:e3a7a1a97c58 centos /bin/bash"
  },
  {
    "rule_id": "5.17",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure host devices are not directly exposed to containers (Not",
    "cis_level": " Level 1 - Docker",
    "description": "Host devices can be directly exposed to containers at runtime. Do not directly expose host\ndevices to containers especially for containers that are not trusted.",
    "expected_values": "By default, no host devices are exposed to containers. If you do not provide sharing\npermissions and choose to expose a host device to a container, the host device would be\nexposed with read, write and mknod permissions.",
    "validation_logic": "docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:\nDevices={{ .HostConfig.Devices }}'\nThe above command would list out each device with below information:\n CgroupPermissions - For example, rwm\n PathInContainer - Device path within the container\n PathOnHost - Device path on the host\nVerify that the host device is needed to be accessed from within the container and the\npermissions required are correctly set. If the above command returns [], then the container\ndoes not have access to host devices. This recommendation can be assumed to be\ncompliant.\n169 | P a ge",
    "remediation_steps": "Do not directly expose the host devices to containers. If at all, you need to expose the host\ndevices to containers, use the correct set of permissions:\nFor example, do not start a container as below:\ndocker run --interactive --tty --device=/dev/tty0:/dev/tty0:rwm --\ndevice=/dev/temp_sda:/dev/temp_sda:rwm centos bash\nFor example, share the host device with correct permissions:\ndocker run --interactive --tty --device=/dev/tty0:/dev/tty0:rw --\ndevice=/dev/temp_sda:/dev/temp_sda:r centos bash",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/reference/commandline/run/#options",
    "audit": "docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:\nDevices={{ .HostConfig.Devices }}'\nThe above command would list out each device with below information:\n CgroupPermissions - For example, rwm\n PathInContainer - Device path within the container\n PathOnHost - Device path on the host\nVerify that the host device is needed to be accessed from within the container and the\npermissions required are correctly set. If the above command returns [], then the container\ndoes not have access to host devices. This recommendation can be assumed to be\ncompliant.\n169 | P a ge",
    "rationale": "The --device option exposes the host devices to the containers and consequently, the\ncontainers can directly access such host devices. You would not require the container to\nrun in privileged mode to access and manipulate the host devices. By default, the\ncontainer will be able to read, write and mknod these devices. Additionally, it is possible for\ncontainers to remove block devices from the host. Hence, do not expose host devices to\ncontainers directly.\nIf at all, you would want to expose the host device to a container, use the sharing\npermissions appropriately:\n r - read only\n w - writable\n m - mknod allowed",
    "impact": "You would not be able to use the host devices directly within the containers."
  },
  {
    "rule_id": "5.18",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure the default ulimit is overwritten at runtime, only if needed",
    "cis_level": " Level 1 - Docker",
    "description": "The default ulimit is set at the Docker daemon level. However, you may override the default\nulimit setting, if needed, during container runtime.",
    "expected_values": "Container instances inherit the default ulimit settings set at the Docker daemon level.",
    "validation_logic": "docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:\nUlimits={{ .HostConfig.Ulimits }}'\nThe above command should return Ulimits=<no value> for each container instance until\nand unless there is an exception and a need to override the default ulimit settings.",
    "remediation_steps": "Only override the default ulimit settings if needed.\nFor example, to override default ulimit settings start a container as below:\ndocker run --ulimit nofile=1024:1024 --interactive --tty centos /bin/bash",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/reference/commandline/run/#set-ulimits-in-\ncontainer-ulimit\n2. http://www.oreilly.com/webops-perf/free/files/docker-security.pdf",
    "audit": "docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:\nUlimits={{ .HostConfig.Ulimits }}'\nThe above command should return Ulimits=<no value> for each container instance until\nand unless there is an exception and a need to override the default ulimit settings.",
    "rationale": "ulimit provides control over the resources available to the shell and to processes started\nby it. Setting system resource limits judiciously saves you from many disasters such as a\nfork bomb. Sometimes, even friendly users and legitimate processes can overuse system\nresources and in-turn can make the system unusable.\nThe default ulimit set at the Docker daemon level should be honored. If the default ulimit\nsettings are not appropriate for a particular container instance, you may override them as\nan exception. But, do not make this a practice. If most of the container instances are\noverriding default ulimit settings, consider changing the default ulimit settings to\nsomething that is appropriate for your needs.",
    "impact": "If the ulimits are not set properly, the desired resource control might not be achieved and\nmight even make the system unusable.\n171 | P a ge"
  },
  {
    "rule_id": "5.19",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure mount propagation mode is not set to shared",
    "cis_level": " Level 1 - Docker",
    "description": "Mount propagation mode allows mounting volumes in shared, slave or private mode on a\ncontainer. Do not use shared mount propagation mode until needed.",
    "expected_values": "By default, the container mounts are private.\n173 | P a ge",
    "validation_logic": "docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:\nPropagation={{range $mnt := .Mounts}} {{json $mnt.Propagation}} {{end}}'\nThe above command would return the propagation mode for mounted volumes.\nPropagation mode should not be set to shared unless needed. The above command might\nthrow errors if there are no mounts. In that case, this recommendation is not applicable.",
    "remediation_steps": "Do not mount volumes in shared mode propagation.\nFor example, do not start container as below:\ndocker run <Run arguments> --volume=/hostPath:/containerPath:shared\n<Container Image Name or ID> <Command>",
    "severity": "Scored",
    "is_active": true,
    "references_text": "1. https://github.com/docker/docker/pull/17034\n2. https://docs.docker.com/engine/reference/run/#volume-shared-filesystems\n3. https://www.kernel.org/doc/Documentation/filesystems/sharedsubtree.txt",
    "audit": "docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:\nPropagation={{range $mnt := .Mounts}} {{json $mnt.Propagation}} {{end}}'\nThe above command would return the propagation mode for mounted volumes.\nPropagation mode should not be set to shared unless needed. The above command might\nthrow errors if there are no mounts. In that case, this recommendation is not applicable.",
    "rationale": "A shared mount is replicated at all mounts and the changes made at any mount point are\npropagated to all mounts. Mounting a volume in shared mode does not restrict any other\ncontainer to mount and make changes to that volume. This might be catastrophic if the\nmounted volume is sensitive to changes. Do not set mount propagation mode to shared\nuntil needed.",
    "impact": "None."
  },
  {
    "rule_id": "5.20",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure the host's UTS namespace is not shared",
    "cis_level": " Level 1 - Docker",
    "description": "UTS namespaces provide isolation of two system identifiers: the hostname and the NIS\ndomain name. It is used for setting the hostname and the domain that is visible to running\nprocesses in that namespace. Processes running within containers do not typically require\nto know hostname and domain name. Hence, the namespace should not be shared with the\nhost.",
    "expected_values": "By default, all containers have the UTS namespace enabled and host UTS namespace is not\nshared with any container.\n175 | P a ge",
    "validation_logic": "docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:\nUTSMode={{ .HostConfig.UTSMode }}'\nIf the above command returns host, it means the host UTS namespace is shared with the\ncontainer and this recommendation is non-compliant. If the above command returns\nnothing, then the host's UTS namespace is not shared. This recommendation is then\ncompliant.",
    "remediation_steps": "Do not start a container with --uts=host argument.\nFor example, do not start a container as below:\ndocker run --rm --interactive --tty --uts=host rhel7.2",
    "severity": "Scored",
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/reference/run/#uts-settings-uts\n2. http://man7.org/linux/man-pages/man7/namespaces.7.html",
    "audit": "docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:\nUTSMode={{ .HostConfig.UTSMode }}'\nIf the above command returns host, it means the host UTS namespace is shared with the\ncontainer and this recommendation is non-compliant. If the above command returns\nnothing, then the host's UTS namespace is not shared. This recommendation is then\ncompliant.",
    "rationale": "Sharing the UTS namespace with the host provides full permission to the container to\nchange the hostname of the host. This is insecure and should not be allowed.",
    "impact": "None."
  },
  {
    "rule_id": "5.21",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure the default seccomp profile is not Disabled",
    "cis_level": " Level 1 - Docker",
    "description": "Seccomp filtering provides a means for a process to specify a filter for incoming system\ncalls. The default Docker seccomp profile works on whitelist basis and allows 311 system\ncalls blocking all others. It should not be disabled unless it hinders your container\napplication usage.",
    "expected_values": "When you run a container, it uses the default profile unless you override it with the --\nsecurity-opt option.",
    "validation_logic": "docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:\nSecurityOpt={{ .HostConfig.SecurityOpt }}'\nThe above command should return <no value> or your modified seccomp profile. If it\nreturns [seccomp:unconfined], that means this recommendation is non-compliant and the\ncontainer is running without any seccomp profiles.",
    "remediation_steps": "By default, seccomp profiles are enabled. You do not need to do anything unless you want\nto modify and use the modified seccomp profile.",
    "severity": "Scored",
    "is_active": true,
    "references_text": "1. http://blog.scalock.com/new-docker-security-features-and-what-they-mean-\nseccomp-profiles\n2. https://docs.docker.com/engine/reference/run/#security-configuration\n3. https://github.com/docker/docker/blob/master/profiles/seccomp/default.json\n4. https://docs.docker.com/engine/security/seccomp/\n5. https://www.kernel.org/doc/Documentation/prctl/seccomp_filter.txt\n6. https://github.com/docker/docker/issues/22870",
    "audit": "docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:\nSecurityOpt={{ .HostConfig.SecurityOpt }}'\nThe above command should return <no value> or your modified seccomp profile. If it\nreturns [seccomp:unconfined], that means this recommendation is non-compliant and the\ncontainer is running without any seccomp profiles.",
    "rationale": "A large number of system calls are exposed to every userland process with many of them\ngoing unused for the entire lifetime of the process. Most of the applications do not need all\nthe system calls and thus benefit by having a reduced set of available system calls. The\nreduced set of system calls reduces the total kernel surface exposed to the application and\nthus improvises application security.",
    "impact": "With Docker 1.10 and greater, the default seccomp profile blocks syscalls, regardless of --\ncap-add passed to the container. You should create your own custom seccomp profile in\nsuch cases. You may also disable the default seccomp profile by passing --security-\nopt=seccomp:unconfined on docker run.\n177 | P a ge"
  },
  {
    "rule_id": "5.22",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure docker exec commands are not used with privileged option",
    "cis_level": " Level 2 - Docker",
    "description": "Do not docker exec with --privileged option.",
    "expected_values": "By default, docker exec command runs without --privileged option.",
    "validation_logic": "If you have auditing enabled as prescribed in Section 1, you can use the below command to\nfilter out docker exec commands that used --privileged option.\nausearch -k docker | grep exec | grep privileged",
    "remediation_steps": "Do not use --privileged option in docker exec command.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/reference/commandline/exec/",
    "audit": "If you have auditing enabled as prescribed in Section 1, you can use the below command to\nfilter out docker exec commands that used --privileged option.\nausearch -k docker | grep exec | grep privileged",
    "rationale": "Using --privileged option in docker exec gives extended Linux capabilities to the\ncommand. This could potentially be insecure and unsafe to do especially when you are\nrunning containers with dropped capabilities or with enhanced restrictions.",
    "impact": "None. If you need enhanced capabilities within the container, then run the container with\nthe needed capabilities."
  },
  {
    "rule_id": "5.23",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure docker exec commands are not used with user option",
    "cis_level": " Level 2 - Docker",
    "description": "Do not docker exec with --user option.",
    "expected_values": "By default, docker exec command runs without --user option.",
    "validation_logic": "If you have auditing enabled as prescribed in Section 1, you can use the below command to\nfilter out docker exec commands that used --user option.\nausearch -k docker | grep exec | grep user",
    "remediation_steps": "Do not use --user option in docker exec command.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/reference/commandline/exec/\n181 | P a ge",
    "audit": "If you have auditing enabled as prescribed in Section 1, you can use the below command to\nfilter out docker exec commands that used --user option.\nausearch -k docker | grep exec | grep user",
    "rationale": "Using --user option in docker exec executes the command within the container as that\nuser. This could potentially be insecure and unsafe to do especially when you are running\ncontainers with dropped capabilities or with enhanced restrictions.\nFor example, suppose your container is running as tomcat user (or any other non-root\nuser), it would be possible to run a command through docker exec as rootwith --\nuser=root option. This could potentially be dangerous.",
    "impact": "None."
  },
  {
    "rule_id": "5.24",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure cgroup usage is confirmed",
    "cis_level": " Level 1 - Docker",
    "description": "It is possible to attach to a particular cgroup on container run. Confirming cgroup usage\nwould ensure that containers are running under defined cgroups.",
    "expected_values": "By default, containers run under docker cgroup.\n183 | P a ge",
    "validation_logic": "docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:\nCgroupParent={{ .HostConfig.CgroupParent }}'\nThe above command would return the cgroup under which the containers are running. If it\nis blank, it means containers are running under default docker cgroup. In that case, this\nrecommendation is compliant. If the containers are found to be running under cgroup\nother than the one that was expected, this recommendation is non-compliant.",
    "remediation_steps": "Do not use --cgroup-parent option in docker run command unless needed.",
    "severity": "Scored",
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/reference/run/#specify-custom-cgroups\n2. https://access.redhat.com/documentation/en-\nUS/Red_Hat_Enterprise_Linux/6/html/Resource_Management_Guide/ch01.html",
    "audit": "docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:\nCgroupParent={{ .HostConfig.CgroupParent }}'\nThe above command would return the cgroup under which the containers are running. If it\nis blank, it means containers are running under default docker cgroup. In that case, this\nrecommendation is compliant. If the containers are found to be running under cgroup\nother than the one that was expected, this recommendation is non-compliant.",
    "rationale": "System administrators typically define cgroups under which containers are supposed to\nrun. Even if cgroups are not explicitly defined by the system administrators, containers run\nunder docker cgroup by default.\nAt run-time, it is possible to attach to a different cgroup other than the one that was\nexpected to be used. This usage should be monitored and confirmed. By attaching to a\ndifferent cgroup than the one that is expected, excess permissions and resources might be\ngranted to the container and thus, can prove to be unsafe.",
    "impact": "None."
  },
  {
    "rule_id": "5.25",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure the container is restricted from acquiring additional",
    "cis_level": " Level 1 - Docker",
    "description": "Restrict the container from acquiring additional privileges via suid or sgid bits.",
    "expected_values": "By default, new privileges are not restricted.",
    "validation_logic": "docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:\nSecurityOpt={{ .HostConfig.SecurityOpt }}'\nThe above command should return all the security options currently configured for the\ncontainers. no-new-privileges should also be one of them.",
    "remediation_steps": "For example, you should start your container as below:\ndocker run --rm -it --security-opt=no-new-privileges ubuntu bash",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://github.com/projectatomic/atomic-site/issues/269\n185 | P a ge\n2. https://github.com/docker/docker/pull/20727\n3. https://www.kernel.org/doc/Documentation/prctl/no_new_privs.txt\n4. https://lwn.net/Articles/475678/\n5. https://lwn.net/Articles/475362/",
    "audit": "docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:\nSecurityOpt={{ .HostConfig.SecurityOpt }}'\nThe above command should return all the security options currently configured for the\ncontainers. no-new-privileges should also be one of them.",
    "rationale": "A process can set the no_new_priv bit in the kernel. It persists across fork, clone and\nexecve. The no_new_priv bit ensures that the process or its children processes do not gain\nany additional privileges via suid or sgid bits. This way a lot of dangerous operations\nbecome a lot less dangerous because there is no possibility of subverting privileged\nbinaries.",
    "impact": "no_new_priv prevents LSMs like SELinux from transitioning to process labels that have\naccess not allowed to the current process."
  },
  {
    "rule_id": "5.26",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure container health is checked at runtime",
    "cis_level": " Level 1 - Docker",
    "description": "If the container image does not have an HEALTHCHECK instruction defined, use --health-cmd\nparameter at container runtime for checking container health.",
    "expected_values": "By default, health checks are not done at container runtime.",
    "validation_logic": "Run the below command and ensure that all the containers are reporting health status:\ndocker ps --quiet | xargs docker inspect --format '{{ .Id }}: Health={{\n.State.Health.Status }}'",
    "remediation_steps": "Run the container using --health-cmd and the other parameters.\nFor example,\ndocker run -d --health-cmd='stat /etc/passwd || exit 1' nginx",
    "severity": "Scored",
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/reference/run/#healthcheck\n187 | P a ge",
    "audit": "Run the below command and ensure that all the containers are reporting health status:\ndocker ps --quiet | xargs docker inspect --format '{{ .Id }}: Health={{\n.State.Health.Status }}'",
    "rationale": "One of the important security triads is availability. If the container image you are using\ndoes not have a pre-defined HEALTHCHECK instruction, use the --health-cmd parameter to\ncheck container health at runtime.\nBased on the reported health status, you could take necessary actions.",
    "impact": "None."
  },
  {
    "rule_id": "5.27",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure docker commands always get the latest version of the",
    "cis_level": " Level 1 - Docker",
    "description": "Always ensure that you are using the latest version of the image within your repository and\nnot the cached older versions.",
    "expected_values": "By default, docker commands extract the local copy unless version pinning mechanisms are\nused or the local cache is cleared.",
    "validation_logic": "Step 1: Open your image repository and list the image version history for the image you\nare inspecting.\nStep 2: Observe the status when the docker pull command is triggered.\nIf the status is shown as Image is up to date, it means that you are getting the cached\nversion of the image.\nStep 3: Match the version of the image you are running with the latest version reported in\nyour repository which tells if you are running the cached version or the latest copy.",
    "remediation_steps": "Use proper version pinning mechanisms (the latest tag which is assigned by default is still\nvulnerable to caching attacks) to avoid extracting the cached older versions. Version\npinning mechanisms should be used for base images, packages, and entire images too. You\ncan customize version pinning rules as per your requirements.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://github.com/docker/docker/pull/16609",
    "audit": "Step 1: Open your image repository and list the image version history for the image you\nare inspecting.\nStep 2: Observe the status when the docker pull command is triggered.\nIf the status is shown as Image is up to date, it means that you are getting the cached\nversion of the image.\nStep 3: Match the version of the image you are running with the latest version reported in\nyour repository which tells if you are running the cached version or the latest copy.",
    "rationale": "Multiple docker commands such as docker pull, docker run, etc. are known to have an\nissue that by default, they extract the local copy of the image, if present, even though there\nis an updated version of the image with the \"same tag\" in the upstream repository. This\ncould lead to using older and vulnerable images.",
    "impact": "None\n189 | P a ge"
  },
  {
    "rule_id": "5.28",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure PIDs cgroup limit is used",
    "cis_level": " Level 1 - Docker",
    "description": "Use --pids-limit flag at container runtime.",
    "expected_values": "The Default value for --pids-limit is 0 which means there is no restriction on the number\nof forks. Also, note that PIDs cgroup limit works only for the kernel versions 4.3+.\n191 | P a ge",
    "validation_logic": "Run the below command and ensure that PidsLimit is not set to 0 or -1. A PidsLimit of 0\nor -1 means that any number of processes can be forked inside the container concurrently.\ndocker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:\nPidsLimit={{ .HostConfig.PidsLimit }}'",
    "remediation_steps": "Use --pids-limit flag while launching the container with an appropriate value.\nFor example,\ndocker run -it --pids-limit 100 <Image_ID>\nIn the above example, the number of processes allowed to run at any given time is set to\n100. After a limit of 100 concurrently running processes is reached, docker would restrict\nany new process creation.",
    "severity": "Scored",
    "is_active": true,
    "references_text": "1. https://github.com/docker/docker/pull/18697\n2. https://docs.docker.com/engine/reference/commandline/run/#options",
    "audit": "Run the below command and ensure that PidsLimit is not set to 0 or -1. A PidsLimit of 0\nor -1 means that any number of processes can be forked inside the container concurrently.\ndocker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:\nPidsLimit={{ .HostConfig.PidsLimit }}'",
    "rationale": "Attackers could launch a fork bomb with a single command inside the container. This fork\nbomb can crash the entire system and requires a restart of the host to make the system\nfunctional again. PIDs cgroup --pids-limit will prevent this kind of attacks by restricting\nthe number of forks that can happen inside a container at a given time.",
    "impact": "Set the PIDs limit value as appropriate. Incorrect values might leave the containers\nunusable."
  },
  {
    "rule_id": "5.29",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure Docker's default bridge docker0 is not used",
    "cis_level": " Level 2 - Docker",
    "description": "Do not use Docker's default bridge docker0. Use docker's user-defined networks for\ncontainer networking.",
    "expected_values": "By default, docker runs containers on its docker0 bridge.",
    "validation_logic": "Run the below command, and verify that containers are on a user-defined network and not\nthe default docker0 bridge.\ndocker network ls --quiet | xargs xargs docker network inspect --format '{{\n.Name }}: {{ .Options }}'",
    "remediation_steps": "Follow Docker documentation and setup a user-defined network. Run all the containers in\nthe defined network.",
    "severity": "Not Scored",
    "is_active": true,
    "references_text": "1. https://github.com/nyantec/narwhal\n2. https://arxiv.org/pdf/1501.02967\n3. https://docs.docker.com/engine/userguide/networking/\n193 | P a ge",
    "audit": "Run the below command, and verify that containers are on a user-defined network and not\nthe default docker0 bridge.\ndocker network ls --quiet | xargs xargs docker network inspect --format '{{\n.Name }}: {{ .Options }}'",
    "rationale": "Docker connects virtual interfaces created in the bridge mode to a common bridge called\ndocker0. This default networking model is vulnerable to ARP spoofing and MAC flooding\nattacks since there is no filtering applied.",
    "impact": "You have to manage the user-defined networks."
  },
  {
    "rule_id": "5.30",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure the host's user namespaces is not shared",
    "cis_level": " Level 1 - Docker",
    "description": "Do not share the host's user namespaces with the containers.",
    "expected_values": "By default, the host user namespace is shared with the containers until user namespace\nsupport is enabled.",
    "validation_logic": "Run the below command and ensure that it does not return any value for UsernsMode. If it\nreturns a value of host, it means the host user namespace is shared with the containers.\ndocker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:\nUsernsMode={{ .HostConfig.UsernsMode }}'",
    "remediation_steps": "Do not share user namespaces between host and containers.\nFor example, do not run a container as below:\ndocker run --rm -it --userns=host ubuntu bash",
    "severity": "Scored",
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/security/userns-remap/\n2. https://docs.docker.com/engine/reference/commandline/run/#options\n3. https://github.com/docker/docker/pull/12648\n195 | P a ge\n4. https://events.linuxfoundation.org/sites/events/files/slides/User%20Namespaces\n%20-%20ContainerCon%202015%20-%2016-9-final_0.pdf",
    "audit": "Run the below command and ensure that it does not return any value for UsernsMode. If it\nreturns a value of host, it means the host user namespace is shared with the containers.\ndocker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:\nUsernsMode={{ .HostConfig.UsernsMode }}'",
    "rationale": "User namespaces ensure that a root process inside the container will be mapped to a non-\nroot process outside the container. Sharing the user namespaces of the host with the\ncontainer thus does not isolate users on the host with users on the containers.",
    "impact": "None"
  },
  {
    "rule_id": "5.31",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure the Docker socket is not mounted inside any containers",
    "cis_level": " Level 1 - Docker",
    "description": "The docker socket docker.sock should not be mounted inside a container.",
    "expected_values": "By default, docker.sock is not mounted inside containers.",
    "validation_logic": "docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:\nVolumes={{ .Mounts }}' | grep docker.sock\nThe above command would return any instances where docker.sock had been mapped to\na container as a volume.",
    "remediation_steps": "Ensure that no containers mount docker.sock as a volume.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://raesene.github.io/blog/2016/03/06/The-Dangers-Of-Docker.sock/\n2. https://forums.docker.com/t/docker-in-docker-vs-mounting-var-run-docker-\nsock/9450/2\n3. https://github.com/docker/docker/issues/21109\n197 | P a ge",
    "audit": "docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}:\nVolumes={{ .Mounts }}' | grep docker.sock\nThe above command would return any instances where docker.sock had been mapped to\na container as a volume.",
    "rationale": "If the docker socket is mounted inside a container it would allow processes running within\nthe container to execute docker commands which effectively allows for full control of the\nhost.",
    "impact": "None"
  },
  {
    "rule_id": "6.1",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure image sprawl is avoided",
    "cis_level": " Level 1 - Linux Host OS",
    "description": "Do not keep a large number of container images on the same host. Use only tagged images\nas appropriate.",
    "expected_values": "Images and layered filesystems remain accessible on the host until the administrator\nremoves all tags that refer to those images or layers.",
    "validation_logic": "Step 1 Make a list of all image IDs that are currently instantiated by executing below\ncommand:\ndocker images --quiet | xargs docker inspect --format '{{ .Id }}: Image={{\n.Config.Image }}'\nStep 2: List all the images present on the system by executing below command:\ndocker images\nStep 3: Compare the list of image IDs populated from Step 1 and Step 2 and find out images\nthat are currently not being instantiated. If any such unused or old images are found,\ndiscuss with the system administrator the need to keep such images on the system. If such\na need is not justified enough, then this recommendation is non-compliant.\n199 | P a ge",
    "remediation_steps": "Keep the set of the images that you actually need and establish a workflow to remove old or\nstale images from the host. Additionally, use features such as pull-by-digest to get specific\nimages from the registry.\nAdditionally, you can follow below set of steps to find out unused images on the system and\ndelete them.\nStep 1 Make a list of all image IDs that are currently instantiated by executing below\ncommand:\ndocker images --quiet | xargs docker inspect --format '{{ .Id }}: Image={{\n.Config.Image }}'\nStep 2: List all the images present on the system by executing below command:\ndocker images\nStep 3: Compare the list of image IDs populated from Step 1 and Step 2 and find out images\nthat are currently not being instantiated.\nStep 4: Decide if you want to keep the images that are not currently in use. If not delete\nthem by executing below command:\ndocker rmi $IMAGE_ID",
    "severity": "Not Scored",
    "is_active": true,
    "references_text": "1. http://craiccomputing.blogspot.in/2014/09/clean-up-unused-docker-containers-\nand.html\n2. https://forums.docker.com/t/command-to-remove-all-unused-images/20/8\n3. https://github.com/docker/docker/issues/9054\n4. https://docs.docker.com/engine/reference/commandline/rmi/\n5. https://docs.docker.com/engine/reference/commandline/pull/\n6. https://github.com/docker/docker/pull/11109\n200 | P a ge",
    "audit": "Step 1 Make a list of all image IDs that are currently instantiated by executing below\ncommand:\ndocker images --quiet | xargs docker inspect --format '{{ .Id }}: Image={{\n.Config.Image }}'\nStep 2: List all the images present on the system by executing below command:\ndocker images\nStep 3: Compare the list of image IDs populated from Step 1 and Step 2 and find out images\nthat are currently not being instantiated. If any such unused or old images are found,\ndiscuss with the system administrator the need to keep such images on the system. If such\na need is not justified enough, then this recommendation is non-compliant.\n199 | P a ge",
    "rationale": "Tagged images are useful to fall back from \"latest\" to a specific version of an image in\nproduction. Images with unused or old tags may contain vulnerabilities that might be\nexploited, if instantiated. Additionally, if you fail to remove unused images from the system\nand there are various such redundant and unused images, the host filesystem may become\nfull and could lead to denial of service.",
    "impact": "None"
  },
  {
    "rule_id": "6.2",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure container sprawl is avoided",
    "cis_level": " Level 1 - Linux Host OS",
    "description": "Do not keep a large number of containers on the same host.",
    "expected_values": "By default, Docker does not restrict the number of containers you may have on a host.",
    "validation_logic": "Step 1 - Find the total number of containers you have on the host:\ndocker info --format '{{ .Containers }}'\nStep 2 - Execute the below commands to find the total number of containers that are\nactually running or in the stopped state on the host.\ndocker info --format '{{ .ContainersStopped }}'\ndocker info --format '{{ .ContainersRunning }}'\nIf the difference between the number of containers that are stopped on the host and the\nnumber of containers that are actually running on the host is large (say 25 or more), then\nperhaps, the containers are sprawled on the host.",
    "remediation_steps": "Periodically check your container inventory per host and clean up the stopped containers\nusing the below command:\ndocker container prune\n202 | P a ge",
    "severity": "Not Scored",
    "is_active": true,
    "references_text": "1. https://zeltser.com/security-risks-and-benefits-of-docker-application/\n2. http://searchsdn.techtarget.com/feature/Docker-networking-How-Linux-\ncontainers-will-change-your-network",
    "audit": "Step 1 - Find the total number of containers you have on the host:\ndocker info --format '{{ .Containers }}'\nStep 2 - Execute the below commands to find the total number of containers that are\nactually running or in the stopped state on the host.\ndocker info --format '{{ .ContainersStopped }}'\ndocker info --format '{{ .ContainersRunning }}'\nIf the difference between the number of containers that are stopped on the host and the\nnumber of containers that are actually running on the host is large (say 25 or more), then\nperhaps, the containers are sprawled on the host.",
    "rationale": "The flexibility of containers makes it easy to run multiple instances of applications and\nindirectly leads to Docker images that exist at varying security patch levels. It also means\nthat you are consuming host resources that otherwise could have been used for running\n'useful' containers. Having more than just the manageable number of containers on a\nparticular host makes the situation vulnerable to mishandling, misconfiguration and\nfragmentation. Thus, avoid container sprawl and keep the number of containers on a host\nto a manageable total.",
    "impact": "If you keep way too few number of containers per host, then perhaps you are not utilizing\nyour host resources very adequately."
  },
  {
    "rule_id": "7.1",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure swarm mode is not Enabled, if not needed",
    "cis_level": " Level 1 - Docker",
    "description": "Do not enable swarm mode on a docker engine instance unless needed.",
    "expected_values": "By default, docker swarm mode is not enabled.",
    "validation_logic": "Review the output of the docker info command. If the output includes Swarm: active it\nindicates that swarm mode has been activated on the Docker engine. Confirm if swarm\nmode on the docker engine instance is actually needed.",
    "remediation_steps": "If swarm mode has been enabled on a system in error, run\ndocker swarm leave",
    "severity": "Scored",
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/reference/commandline/swarm_init/",
    "audit": "Review the output of the docker info command. If the output includes Swarm: active it\nindicates that swarm mode has been activated on the Docker engine. Confirm if swarm\nmode on the docker engine instance is actually needed.",
    "rationale": "By default, a Docker engine instance will not listen on any network ports, with all\ncommunications with the client coming over the Unix socket. When Docker swarm mode is\nenabled on a docker engine instance, multiple network ports are opened on the system and\nmade available to other systems on the network for the purposes of cluster management\nand node communications.\nOpening network ports on a system increase its attack surface and this should be avoided\nunless required.",
    "impact": "None.\n204 | P a ge"
  },
  {
    "rule_id": "7.2",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure the minimum number of manager nodes have been created",
    "cis_level": " Level 1 - Docker",
    "description": "Ensure that the minimum number of required manager nodes is created in a swarm.",
    "expected_values": "A single manager is all that is required to start a given cluster.",
    "validation_logic": "Run docker info and verify the number of managers.\ndocker info --format '{{ .Swarm.Managers }}'\nAlternatively run the below command.\ndocker node ls | grep 'Leader'",
    "remediation_steps": "If an excessive number of managers is configured, the excess can be demoted as worker\nusing the following command:\ndocker node demote <ID>\nWhere is the node ID value of the manager to be demoted.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/swarm/manage-nodes/\n2. https://docs.docker.com/engine/swarm/admin_guide/#/add-manager-nodes-for-\nfault-tolerance",
    "audit": "Run docker info and verify the number of managers.\ndocker info --format '{{ .Swarm.Managers }}'\nAlternatively run the below command.\ndocker node ls | grep 'Leader'",
    "rationale": "Manager nodes within a swarm have control over the swarm and change its configuration\nmodifying security parameters. Having excessive manager nodes could render the swarm\nmore susceptible to compromise.\nIf fault tolerance is not required in the manager nodes, a single node should be elected as a\nmanger. If fault tolerance is required then the smallest practical odd number to achieve the\nappropriate level of tolerance should be configured.",
    "impact": "None\n206 | P a ge"
  },
  {
    "rule_id": "7.3",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure swarm services are binded to a specific host interface",
    "cis_level": " Level 1 - Docker",
    "description": "By default, the docker swarm services will listen to all interfaces on the host, which may\nnot be necessary for the operation of the swarm where the host has multiple network\ninterfaces.",
    "expected_values": "By default, docker swarm services listen on all available host interfaces.\n208 | P a ge",
    "validation_logic": "List the network listener on port 2377/TCP (the default for docker swarm) and confirm\nthat it is only listening on specific interfaces. For example, using ubuntu this could be done\nwith the following command:\nnetstat -lt | grep -i 2377",
    "remediation_steps": "Remediation of this requires re-initialization of the swarm specifying a specific interface\nfor the --listen-addr parameter.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/reference/commandline/swarm_init/#--listen-\naddr\n2. https://docs.docker.com/engine/swarm/admin_guide/#recover-from-disaster\nNotes:\nA couple of points I noted looking at this one. there doesn't seem to be a parameter for\ndocker swarm update to change the listen-addr. For the remediation I did wonder if --\nforce-new-swarm could be used to change this, but I'm not sure what other effects that\nwould have on the swarm so just left with a general requirement to re-initialize the swarm.\nAlso interestingly the node communication service running on 7946/TCP doesn't respect\nthe --listen-addr parameter. this seems like a bug to me, I'll likely file an issue on github for\nit after a bit more exploration.",
    "audit": "List the network listener on port 2377/TCP (the default for docker swarm) and confirm\nthat it is only listening on specific interfaces. For example, using ubuntu this could be done\nwith the following command:\nnetstat -lt | grep -i 2377",
    "rationale": "When a swarm is initialized the default value for the --listen-addr flag is 0.0.0.0:2377\nwhich means that the swarm services will listen on all interfaces on the host. If a host has\nmultiple network interfaces this may be undesirable as it may expose the docker swarm\nservices to networks which are not involved in the operation of the swarm.\nBy passing a specific IP address to the --listen-addr, a specific network interface can be\nspecified limiting this exposure.",
    "impact": "None"
  },
  {
    "rule_id": "7.4",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure data exchanged between containers are encrypted on",
    "cis_level": " Level 1 - Docker",
    "description": "Encrypt data exchanged between containers on different nodes on the overlay network.",
    "expected_values": "By default, data exchanged between containers on different nodes on the overlay network\nare not encrypted in the Docker swarm mode.",
    "validation_logic": "Run the below command and ensure that each overlay network has been encrypted.\ndocker network ls --filter driver=overlay --quiet | xargs docker network\ninspect --format '{{.Name}} {{ .Options }}'",
    "remediation_steps": "Create overlay network with --opt encrypted flag.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/userguide/networking/overlay-security-model/\n2. https://github.com/docker/docker/issues/24253",
    "audit": "Run the below command and ensure that each overlay network has been encrypted.\ndocker network ls --filter driver=overlay --quiet | xargs docker network\ninspect --format '{{.Name}} {{ .Options }}'",
    "rationale": "By default, data exchanged between containers on different nodes on the overlay network\nis not encrypted. This could potentially expose traffic between the container nodes.",
    "impact": "None"
  },
  {
    "rule_id": "7.5",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure Docker's secret management commands are used for",
    "cis_level": " Level 2 - Docker",
    "description": "Use Docker's in-built secret management command.",
    "expected_values": "Not Applicable",
    "validation_logic": "On a swarm manager node, run the below command and ensure docker secret\nmanagement is used in your environment, if applicable.\ndocker secret ls",
    "remediation_steps": "Follow docker secret documentation and use it to manage secrets effectively.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/reference/commandline/secret/",
    "audit": "On a swarm manager node, run the below command and ensure docker secret\nmanagement is used in your environment, if applicable.\ndocker secret ls",
    "rationale": "Docker has various commands for managing secrets in a Swarm cluster. This is the\nfoundation for future secret support in Docker with potential improvements such as\nWindows support, different backing stores, etc.",
    "impact": "None"
  },
  {
    "rule_id": "7.6",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure swarm manager is run in auto-lock mode",
    "cis_level": " Level 1 - Docker",
    "description": "Run Docker swarm manager in auto-lock mode.",
    "expected_values": "By default, swarm manager does not run in auto-lock mode.",
    "validation_logic": "Run the below command. If it outputs the key, it means swarm was initialized with the --\nautolock flag. If the output is no unlock key is set, it means that swarm was NOT\ninitialized with the --autolock flag and is non-compliant with respect to this\nrecommendation.\ndocker swarm unlock-key",
    "remediation_steps": "If you are initializing swarm, use the below command.\ndocker swarm init --autolock\nIf you want to set --autolock on an existing swarm manager node, use the below\ncommand.\ndocker swarm update --autolock\n213 | P a ge",
    "severity": "Scored",
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/swarm/swarm_manager_locking/",
    "audit": "Run the below command. If it outputs the key, it means swarm was initialized with the --\nautolock flag. If the output is no unlock key is set, it means that swarm was NOT\ninitialized with the --autolock flag and is non-compliant with respect to this\nrecommendation.\ndocker swarm unlock-key",
    "rationale": "When Docker restarts, both the TLS key used to encrypt communication among swarm\nnodes, and the key used to encrypt and decrypt Raft logs on disk, are loaded into each\nmanager node's memory. You should protect the mutual TLS encryption key and the key\nused to encrypt and decrypt Raft logs at rest. This protection could be enabled by\ninitializing swarm with --autolock flag.\nWith --autolockenabled, when Docker restarts, you must unlock the swarm first, using a\nkey encryption key generated by Docker when the swarm was initialized.",
    "impact": "A swarm in auto-lock mode won't recover from a re-start without manual intervention\nfrom a user to enter the unlock key. In some deployments, this might not be good for\navailability."
  },
  {
    "rule_id": "7.7",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure swarm manager auto-lock key is rotated periodically (Not",
    "cis_level": " Level 1 - Docker",
    "description": "Rotate swarm manager auto-lock key periodically.",
    "expected_values": "By default, keys are not rotated automatically.",
    "validation_logic": "Currently, there is no mechanism to find out when the key was last rotated on a swarm\nmanager node. You should check with the system administrator if there is a key rotation\nrecord and the keys were rotated at a pre-defined frequency.",
    "remediation_steps": "Run the below command to rotate the keys.\ndocker swarm unlock-key --rotate\nAdditionally, to facilitate audit for this recommendation, maintain key rotation records and\nensure that you establish a pre-defined frequency for key rotation.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/reference/commandline/swarm_unlock-key/\n215 | P a ge",
    "audit": "Currently, there is no mechanism to find out when the key was last rotated on a swarm\nmanager node. You should check with the system administrator if there is a key rotation\nrecord and the keys were rotated at a pre-defined frequency.",
    "rationale": "Swarm manager auto-lock key is not automatically rotated. You should rotate them\nperiodically as a best practice.",
    "impact": "None"
  },
  {
    "rule_id": "7.8",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure node certificates are rotated as appropriate",
    "cis_level": " Level 2 - Docker",
    "description": "Rotate swarm node certificates as appropriate.",
    "expected_values": "By default, node certificates are rotated automatically every 90 days.",
    "validation_logic": "Run the below command and ensure that the node certificate Expiry Duration is set as\nappropriate.\ndocker info | grep \"Expiry Duration\"",
    "remediation_steps": "Run the below command to set the desired expiry time.\nFor example,\ndocker swarm update --cert-expiry 48h",
    "severity": "Not Scored",
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/reference/commandline/swarm_update/#exampl\nes\n217 | P a ge",
    "audit": "Run the below command and ensure that the node certificate Expiry Duration is set as\nappropriate.\ndocker info | grep \"Expiry Duration\"",
    "rationale": "Docker Swarm uses mutual TLS for clustering operations amongst its nodes. Certificate\nrotation ensures that in an event such as compromised node or key, it is difficult to\nimpersonate a node. By default, node certificates are rotated every 90 days. You should\nrotate it more often or as appropriate in your environment.",
    "impact": "None"
  },
  {
    "rule_id": "7.9",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure CA certificates are rotated as appropriate",
    "cis_level": " Level 2 - Docker",
    "description": "Rotate root CA certificates as appropriate.",
    "expected_values": "By default, root CA certificates are not rotated.\n219 | P a ge",
    "validation_logic": "Based on your installation path, check the time stamp on the root CA certificate file.\nFor example,\nls -l /var/lib/docker/swarm/certificates/swarm-root-ca.crt\nThe certificate should have been rotated at the established frequency.",
    "remediation_steps": "Run the below command to rotate the certificate.\ndocker swarm ca --rotate",
    "severity": "Not Scored",
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/swarm/how-swarm-mode-works/pki/#rotating-\nthe-ca-certificate",
    "audit": "Based on your installation path, check the time stamp on the root CA certificate file.\nFor example,\nls -l /var/lib/docker/swarm/certificates/swarm-root-ca.crt\nThe certificate should have been rotated at the established frequency.",
    "rationale": "Docker Swarm uses mutual TLS for clustering operations amongst its nodes. Certificate\nrotation ensures that in an event such as compromised node or key, it is difficult to\nimpersonate a node. Node certificates depend upon root CA certificates. For operational\nsecurity, it is important to rotate these frequently. Currently, root CA certificates are not\nrotated automatically. You should thus establish a process to rotate it at the desired\nfrequency.",
    "impact": "None"
  },
  {
    "rule_id": "7.10",
    "benchmark": "CIS Docker Community Edition Benchmark v1.1.0",
    "device_type": "Docker",
    "control_name": "Ensure management plane traffic has been separated from data",
    "cis_level": " Level 2 - Docker",
    "description": "Separate management plane traffic from data plane traffic.",
    "expected_values": "By default, the data plane traffic is not separated from management plane traffic.\n221 | P a ge",
    "validation_logic": "Run the below command on each swarm node and ensure that the management plane\naddress is different from data plane address.\ndocker node inspect --format '{{ .Status.Addr }}' self\nNote: At the time of writing of this benchmark, there is no way to inspect data plane\naddress. An issue has been raised and is in the reference link.",
    "remediation_steps": "Initialize Swarm with dedicated interfaces for management and data planes respectively.\nFor example,\ndocker swarm init --advertise-addr=192.168.0.1 --data-path-addr=17.1.0.3",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.docker.com/engine/reference/commandline/swarm_init/#--data-\npath-addr\n2. https://github.com/moby/moby/issues/33938\n3. https://github.com/moby/moby/pull/32717",
    "audit": "Run the below command on each swarm node and ensure that the management plane\naddress is different from data plane address.\ndocker node inspect --format '{{ .Status.Addr }}' self\nNote: At the time of writing of this benchmark, there is no way to inspect data plane\naddress. An issue has been raised and is in the reference link.",
    "rationale": "Separating the management plane traffic from data plane traffic ensures that these traffics\nare on their respective paths. These paths could then be individually monitored and could\nbe tied to different traffic control policies and monitoring. It also ensures that management\nplane is always reachable despite the huge volume of data flow.",
    "impact": "You would require 2 network interface cards per node."
  },
  {
    "rule_id": "1.1.1.1",
    "benchmark": "CIS Palo Alto Firewall 10 Benchmark v1.3.0",
    "device_type": "Palo Alto",
    "control_name": "Syslog logging should be configured",
    "cis_level": "• Level 1",
    "description": "Syslog logging is a standard logging protocol that is widely supported. It is\nrecommended for a level 1 deployment only, as syslog does not support encryption.",
    "expected_values": "By default no external logging is defined",
    "validation_logic": "Navigate to Device > Server Profiles > Syslog Ensure that a valid Syslog profile\nis configured, and that it points to a valid Syslog host. Navigate to Device > Log\nSettings Under System, verify that at least one Syslog entry exists and that at least\none entry has \"All Logs\" selected. Each Syslog entry must have a valid Syslog Profile\nattached.\nUnder Configuration, verify that at least one Syslog entry exists and that at least one\nentry has \"All Logs\" selected. Each Syslog entry must have a valid Syslog Profile\nattached.\nUnder User-ID, verify that at least one Syslog entry exists and that at least one entry\nhas \"All Logs\" selected. Each Syslog entry must have a valid Syslog Profile attached.\nPage 18\nUnder HIP Match (Host Information Profile), verify that at least one Syslog entry exists\nand that at least one entry has \"All Logs\" selected. Each Syslog entry must have a valid\nSyslog Profile attached.\nUnder IP-Tag, verify that at least one Syslog entry exists and that at least one entry has\n\"All Logs\" selected. Each Syslog entry must have a valid Syslog Profile attached.",
    "remediation_steps": "Navigate to Device > Server Profiles > Syslog Choose Add Assign a Name to the\nProfile. Choose Add, and assign a server name in the Name field, add an IP address or\nFQDN in the Syslog Server field. Edit other fields as appropriate for your server.\nRepeat if multiple Syslog destinations are required.\nNavigate to Device > Log Settings Under System, add an entry. Define a Name and\na Filter setting. Under Forward Methods, add a Syslog Profile in the Syslog\nsection. Ensure that at least one of the Log Settings Configuration entries has it's\nFilter setting at All Logs\nUnder Configuration, add an entry. Define a Name and a Filter setting. Under\nForward Methods, add a Syslog Profile in the Syslog section. Ensure that at least\none of the Log Settings Configuration entries has it's Filter setting at All Logs\nUnder User-ID, add an entry. Define a Name and a Filter setting. Under Forward\nMethods, add a Syslog Profile in the Syslog section. Ensure that at least one of the\nLog Settings Configuration entries has it's Filter setting at All Logs\nUnder HIP Match (Host Information Profile), add an entry. Define a Name and a Filter\nsetting. Under Forward Methods, add a Syslog Profile in the Syslog section.\nEnsure that at least one of the Log Settings Configuration entries has it's Filter setting\nat All Logs\nUnder IP-Tag, add an entry. Define a Name and a Filter setting. Under Forward\nMethods, add a Syslog Profile in the Syslog section. Ensure that at least one of the\nLog Settings Configuration entries has it's Filter setting at All Logs",
    "severity": "Automated",
    "is_active": true,
    "references_text": "1. “PAN-OS Administrator's Guide 11.1 (English) - Configure Syslog Monitoring” -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/monitoring/use-\nsyslog-for-monitoring/configure-syslog-monitoring\nPage 19",
    "audit": "Navigate to Device > Server Profiles > Syslog Ensure that a valid Syslog profile\nis configured, and that it points to a valid Syslog host. Navigate to Device > Log\nSettings Under System, verify that at least one Syslog entry exists and that at least\none entry has \"All Logs\" selected. Each Syslog entry must have a valid Syslog Profile\nattached.\nUnder Configuration, verify that at least one Syslog entry exists and that at least one\nentry has \"All Logs\" selected. Each Syslog entry must have a valid Syslog Profile\nattached.\nUnder User-ID, verify that at least one Syslog entry exists and that at least one entry\nhas \"All Logs\" selected. Each Syslog entry must have a valid Syslog Profile attached.\nPage 18\nUnder HIP Match (Host Information Profile), verify that at least one Syslog entry exists\nand that at least one entry has \"All Logs\" selected. Each Syslog entry must have a valid\nSyslog Profile attached.\nUnder IP-Tag, verify that at least one Syslog entry exists and that at least one entry has\n\"All Logs\" selected. Each Syslog entry must have a valid Syslog Profile attached.",
    "rationale": "Sending all system logs to a remote host is recommended to provide protected, long\nterm storage and archiving. This also places a copy of the logs in a second location, in\ncase the primary (on the firewall) logs are compromised. Storing logs on a remote host\nalso allows for more flexible log searches and log processing, as well as many methods\nof triggering events or scripts based on specific log events or combinations of events.\nFinally, remote logging provides many organizations with the opportunity to combine\nlogs from disparate infrastructure in a SIEM (Security Information and Event\nManagement) system.\nLogging to an external system is also usually required by most regulatory frameworks.",
    "impact": "Failure to properly store and archive logs for critical infrastructure leaves an\norganization without the tools required to establish trends in events or activity, or to\nretrospectively analyze security or operational events beyond the log timespan stored\non the firewall. Not having remote logs also puts many organizations outside of\ncompliance with many regulatory frameworks. Finally, not logging to a remote host\nleaves organizations without recourse in the event of a compromise of logs on the\nprimary device. It is imperative that organizations log critical infrastructure appropriately,\nstore and archive these logs in a central location, and have a robust set of tools to\nanalyze logs both in real time and after the fact."
  },
  {
    "rule_id": "1.1.1.2",
    "benchmark": "CIS Palo Alto Firewall 10 Benchmark v1.3.0",
    "device_type": "Palo Alto",
    "control_name": "SNMPv3 traps should be configured",
    "cis_level": "• Level 2",
    "description": "SNMP v3 can be used for remote logging, and is the recommended protocol in higher\nsecurity situations as it fully supports encryption of logs.",
    "expected_values": "By default no external logging is defined\nPage 22",
    "validation_logic": "Navigate to Device > Server Profiles > SNMP Traps\nEnsure that a valid SNMP profile is configured, that version V3 is selected, and that it\npoints to a valid SNMPv3 host. User, EngineID and Password fields should be\ncompleted appropriately\nNavigate to Device > Log Settings Under System, verify that at least one SNMP\nentry exists, corresponding to an SNMPv3 Server Profile and that at least one entry has\n\"All Logs\" selected.\nPage 21\nUnder Configuration, verify that at least one SNMP entry exists, corresponding to an\nSNMPv3 Server Profile and that at least one entry has \"All Logs\" selected.\nUnder User-ID, verify that at least one SNMP entry exists, corresponding to an\nSNMPv3 Server Profile and that at least one entry has \"All Logs\" selected.\nUnder HIP Match (Host Information Profile), verify that at least one SNMP entry exists,\ncorresponding to an SNMPv3 Server Profile and that at least one entry has \"All Logs\"\nselected.\nUnder IP-Tag, verify that at least one SNMP entry exists, corresponding to an SNMPv3\nServer Profile and that at least one entry has \"All Logs\" selected.",
    "remediation_steps": "Navigate to Device > Server Profiles > SNMP Trap Choose Add Assign a Name to\nthe Profile, and specify version V3. Choose Add, and assign a server name in the Name\nfield, add an IP address or FQDN in the SNMP Manager field. Edit the Password fields\nas appropriate for your server. Repeat if multiple Syslog destinations are required.\nNavigate to Device > Log Settings Under System, add an entry. Define a Name and\na Filter setting. Under Forward Methods, add a SNMP Profile in the SNMP\nsection. Ensure that at least one of the Log Settings Configuration entries has its\nFilter setting at All Logs\nUnder Configuration, add an entry. Define a Name and a Filter setting. Under\nForward Methods, add a SNMP Profile in the SNMP section. Ensure that at least one\nof the Log Settings Configuration entries has its Filter setting at All Logs\nUnder User-ID, add an entry. Define a Name and a Filter setting. Under Forward\nMethods, add a SNMP Profile in the SNMP section. Ensure that at least one of the Log\nSettings Configuration entries has its Filter setting at All Logs\nUnder HIP Match (Host Information Profile), add an entry. Define a Name and a Filter\nsetting. Under Forward Methods, add a SNMP Profile in the SNMP section. Ensure\nthat at least one of the Log Settings Configuration entries has its Filter setting at All\nLogs\nUnder IP-Tag, add an entry. Define a Name and a Filter setting. Under Forward\nMethods, add a SNMP Profile in the SNMP section. Ensure that at least one of the Log\nSettings Configuration entries has its Filter setting at All Logs",
    "severity": "Automated",
    "is_active": true,
    "references_text": "1. “PAN-OS Administrator's Guide 11.1 (English) - Forward Traps to an SNMP\nManager” - https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-\nadmin/monitoring/snmp-monitoring-and-traps/forward-traps-to-an-snmp-manager",
    "audit": "Navigate to Device > Server Profiles > SNMP Traps\nEnsure that a valid SNMP profile is configured, that version V3 is selected, and that it\npoints to a valid SNMPv3 host. User, EngineID and Password fields should be\ncompleted appropriately\nNavigate to Device > Log Settings Under System, verify that at least one SNMP\nentry exists, corresponding to an SNMPv3 Server Profile and that at least one entry has\n\"All Logs\" selected.\nPage 21\nUnder Configuration, verify that at least one SNMP entry exists, corresponding to an\nSNMPv3 Server Profile and that at least one entry has \"All Logs\" selected.\nUnder User-ID, verify that at least one SNMP entry exists, corresponding to an\nSNMPv3 Server Profile and that at least one entry has \"All Logs\" selected.\nUnder HIP Match (Host Information Profile), verify that at least one SNMP entry exists,\ncorresponding to an SNMPv3 Server Profile and that at least one entry has \"All Logs\"\nselected.\nUnder IP-Tag, verify that at least one SNMP entry exists, corresponding to an SNMPv3\nServer Profile and that at least one entry has \"All Logs\" selected.",
    "rationale": "Sending all system logs to a remote host is recommended to provide protected, long\nterm storage and archiving. This also places a copy of the logs in a second location, in\ncase the primary (on the firewall) logs are compromised. Storing logs on a remote host\nalso allows for more flexible log searches and log processing, as well as many methods\nof triggering events or scripts based on specific log events or combinations of events.\nFinally, remote logging provides many organizations with the opportunity to combine\nlogs from disparate infrastructure in a SIEM (Security Information and Event\nManagement) system.\nLogging to an external system is also usually required by most regulatory frameworks.",
    "impact": "Failure to properly store and archive logs for critical infrastructure leaves an\norganization without the tools required to establish trends in events or activity, or to\nretrospectively analyze security or operational events beyond the log timespan stored\non the firewall. Not having remote logs also puts many organizations outside of\ncompliance with many regulatory frameworks. Finally, not logging to a remote host\nleaves organizations without recourse in the event of a compromise of logs on the\nprimary device. It is imperative that organizations log critical infrastructure appropriately,\nstore and archive these logs in a central location, and have a robust set of tools to\nanalyze logs both in real time and after the fact. Not encrypting log data as it transits the\nnetwork allows an attacker to mount a \"MiTM\" (Monkey in the Middle) attack, which\nallows them to intercept and/or modify logs as they transit from the source to the\ndestination."
  },
  {
    "rule_id": "1.1.2",
    "benchmark": "CIS Palo Alto Firewall 10 Benchmark v1.3.0",
    "device_type": "Palo Alto",
    "control_name": "Ensure 'Login Banner' is set",
    "cis_level": "• Level 1",
    "description": "Configure a login banner, ideally approved by the organization’s legal team. This banner\nshould, at minimum, prohibit unauthorized access, provide notice of logging or\nmonitoring, and avoid using the word “welcome” or similar words of invitation.",
    "expected_values": "Not configured",
    "validation_logic": "Navigate to Device > Setup > Management > General Settings.\nVerify that Login Banner is set appropriately for your organization.",
    "remediation_steps": "Navigate to Device > Setup > Management > General Settings.\nSet Login Banner as appropriate for your organization.",
    "severity": "Automated",
    "is_active": true,
    "references_text": "1. “PAN-OS Administrator's Guide 11.1 (English) - Configuring Logon Banners” -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/firewall-\nadministration/use-the-web-interface/configure-banners-message-of-the-day-\nand-logos\nPage 24",
    "audit": "Navigate to Device > Setup > Management > General Settings.\nVerify that Login Banner is set appropriately for your organization.",
    "rationale": "Through a properly stated login banner, the risk of unintentional access to the device by\nunauthorized users is reduced. Should legal action take place against a person\naccessing the device without authorization, the login banner greatly diminishes a\ndefendant’s claim of ignorance.",
    "impact": null
  },
  {
    "rule_id": "1.1.3",
    "benchmark": "CIS Palo Alto Firewall 10 Benchmark v1.3.0",
    "device_type": "Palo Alto",
    "control_name": "Ensure 'Enable Log on High DP Load' is enabled",
    "cis_level": "• Level 1",
    "description": "Enable the option 'Enable Log on High DP Load' feature. When this option is selected, a\nsystem log entry is created when the device’s packet processing load reaches 100%\nutilization.",
    "expected_values": "Not enabled",
    "validation_logic": "Navigate to Device > Setup > Management > Logging and Reporting Settings\n> Log Export and Reporting.\nVerify Enable Log on High DP Load is checked.",
    "remediation_steps": "Navigate to Device > Setup > Management > Logging and Reporting Settings\n> Log Export and Reporting.\nSet the Enable Log on High DP Load box to checked.",
    "severity": null,
    "is_active": true,
    "references_text": "1. \"Logging Best Practices\" - https://live.paloaltonetworks.com/t5/best-practice-\nassessment-device/logging-and-reporting-settings-log-on-high-dp-mode/ta-\np/336964\nPage 26",
    "audit": "Navigate to Device > Setup > Management > Logging and Reporting Settings\n> Log Export and Reporting.\nVerify Enable Log on High DP Load is checked.",
    "rationale": "When the device’s packet processing load reaches 100%, a degradation in the\navailability of services accessed through the device can occur. Logging this event can\nhelp with troubleshooting system performance.",
    "impact": "Sustained attacks, especially volumetric DOS and DDOS attacks will often affect CPU\nutilization. This setting will generate an event that is easily monitored for and alerted on.\nWhile setting CPU utilization watermarks in a Network Management System is a\nstandard practice, this setting does not depend on even having an NMS, it doesn't\nrequire anything other than standard logging to implement."
  },
  {
    "rule_id": "1.2.1",
    "benchmark": "CIS Palo Alto Firewall 10 Benchmark v1.3.0",
    "device_type": "Palo Alto",
    "control_name": "Ensure 'Permitted IP Addresses' is set to those necessary",
    "cis_level": "• Level 1",
    "description": "Permit only the necessary IP addresses to be used to manage the device.",
    "expected_values": "Not enabled (all addresses that can reach the interface are permitted)",
    "validation_logic": "Navigate to Device > Setup > Interfaces > Management.\nVerify that Permitted IP Addresses is limited only to those necessary for device\nmanagement.",
    "remediation_steps": "Navigate to Device > Setup > Interfaces > Management.\nSet Permitted IP Addresses to only those necessary for device management for the\nSSH and HTTPS protocols. If no profile exists, create one that has these addresses set.",
    "severity": null,
    "is_active": true,
    "references_text": "1. \"How to Allow Certain IP Addresses on the Management Interface\" -\nhttps://live.paloaltonetworks.com/docs/DOC-8432\n2. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing\nAdministrative Access\": https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-\nadmin/getting-started/best-practices-for-securing-administrative-access.html#\nPage 29",
    "audit": "Navigate to Device > Setup > Interfaces > Management.\nVerify that Permitted IP Addresses is limited only to those necessary for device\nmanagement.",
    "rationale": "Management access to the device should be restricted to the IP addresses or subnets\nused by firewall administrators. Permitting management access from other IP addresses\nincreases the risk of unauthorized access through password guessing, stolen\ncredentials, or other means.",
    "impact": null
  },
  {
    "rule_id": "1.2.2",
    "benchmark": "CIS Palo Alto Firewall 10 Benchmark v1.3.0",
    "device_type": "Palo Alto",
    "control_name": "Ensure 'Permitted IP Addresses' is set for all management",
    "cis_level": "• Level 1",
    "description": "For all management profiles, only the IP addresses required for device management\nshould be specified.",
    "expected_values": "Not enabled",
    "validation_logic": "Navigate to Network > Network Profiles > Interface Management.\nIn each profile, for each of the target protocols (SNMP, HTTPS, SSH), verify that\nPermitted IP Addresses is limited to those necessary for device management.",
    "remediation_steps": "Navigate to Network > Network Profiles > Interface Management.\nIn each profile, for each of the target protocols (SNMP, HTTPS, SSH), set Permitted\nIP Addresses to only include those necessary for device management. If no profile\nexists, create one that has these options set.",
    "severity": null,
    "is_active": true,
    "references_text": "1. \"How to Allow Certain IP Addresses on the Management Interface\" -\nhttps://live.paloaltonetworks.com/docs/DOC-8432\n2. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing\nAdministrative Access\": https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-\nadmin/getting-started/best-practices-for-securing-administrative-access.html#\nPage 31",
    "audit": "Navigate to Network > Network Profiles > Interface Management.\nIn each profile, for each of the target protocols (SNMP, HTTPS, SSH), verify that\nPermitted IP Addresses is limited to those necessary for device management.",
    "rationale": "If a Permitted IP Addresses list is either not specified or is too broad, an attacker may\ngain the ability to attempt management access from unintended locations, such as the\nInternet. The “Ensure 'Security Policy' denying any/all traffic exists at the bottom of the\nsecurity policies ruleset” recommendation in this benchmark can provide additional\nprotection by requiring a security policy specifically allowing device management\naccess.",
    "impact": null
  },
  {
    "rule_id": "1.2.3",
    "benchmark": "CIS Palo Alto Firewall 10 Benchmark v1.3.0",
    "device_type": "Palo Alto",
    "control_name": "Ensure HTTP and Telnet options are disabled for the",
    "cis_level": "• Level 1",
    "description": "HTTP and Telnet options should not be enabled for device management.",
    "expected_values": "Not set. (HTTP and Telnet are disabled by default)",
    "validation_logic": "Navigate to Device > Setup > Interfaces > Management.\nVerify that the HTTP and Telnet options are both unchecked.",
    "remediation_steps": "Navigate to Device > Setup > Interfaces > Management.\nSet the HTTP and Telnet boxes to unchecked.",
    "severity": null,
    "is_active": true,
    "references_text": "1. \"How to Configure a Layer 3 Interface to act as a Management Port\" -\nhttps://live.paloaltonetworks.com/t5/Configuration-Articles/How-to-Configure-a-\nLayer-3-Interface-to-act-as-a-Management-Port/ta-p/59024\n2. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing\nAdministrative Access\": https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-\nadmin/getting-started/best-practices-for-securing-administrative-access.html#\nPage 33",
    "audit": "Navigate to Device > Setup > Interfaces > Management.\nVerify that the HTTP and Telnet options are both unchecked.",
    "rationale": "Management access over cleartext services such as HTTP or Telnet could result in a\ncompromise of administrator credentials and other sensitive information related to\ndevice management. Theft of either administrative credentials or session data is easily\naccomplished with a \"Man in the Middle\" attack.",
    "impact": null
  },
  {
    "rule_id": "1.2.4",
    "benchmark": "CIS Palo Alto Firewall 10 Benchmark v1.3.0",
    "device_type": "Palo Alto",
    "control_name": "Ensure HTTP and Telnet options are disabled for all",
    "cis_level": "• Level 1",
    "description": "HTTP and Telnet options should not be enabled for device management.",
    "expected_values": null,
    "validation_logic": "Navigate to Network > Network Profiles > Interface Management. For each\nInterface Management profile verify that the HTTP and Telnet options are both\nunchecked.",
    "remediation_steps": "Navigate to Network > Network Profiles > Interface Management. For each\nProfile, set the HTTP and Telnet boxes to unchecked.",
    "severity": null,
    "is_active": true,
    "references_text": "1. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing\nAdministrative Access\": https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-\nadmin/getting-started/best-practices-for-securing-administrative-access.html#\n2. “PAN-OS Administrator's Guide 9.0 (English) - Use Interface Management\nProfiles to Restrict Access\": https://docs.paloaltonetworks.com/pan-os/9-0/pan-\nos-admin/networking/configure-interfaces/use-interface-management-profiles-to-\nrestrict-access.html#",
    "audit": "Navigate to Network > Network Profiles > Interface Management. For each\nInterface Management profile verify that the HTTP and Telnet options are both\nunchecked.",
    "rationale": "Management access over cleartext services such as HTTP or Telnet could result in a\ncompromise of administrator credentials and other sensitive information related to\ndevice management.",
    "impact": null
  },
  {
    "rule_id": "1.2.5",
    "benchmark": "CIS Palo Alto Firewall 10 Benchmark v1.3.0",
    "device_type": "Palo Alto",
    "control_name": "Ensure valid certificate is set for browser-based",
    "cis_level": "• Level 2",
    "description": "In most cases, a browser HTTPS interface is used to administer the Palo Alto\nappliance. The certificate used to secure this session should satisfy the following\ncriteria:\n1. A valid certificate from a trusted source should be used. While a certificate from a\ntrusted Public Certificate Authority is certainly valid, one from a trusted Private\nCertificate Authority is absolutely acceptable for this purpose.\n2. The certificate should have a valid date. It should not have a \"to\" date in the past\n(it should not be expired), and should not have a \"from\" date in the future.\n3. The certificate should use an acceptable cipher and encryption level.",
    "expected_values": "A self-signed certificate is installed by default for the administrative interface.",
    "validation_logic": "Verify that the certificate used to secure HTTPS sessions meets the criteria by\nreviewing the appropriate certificate:\nNavigate to Device > Certificate Management > Certificates\nVerify that this Certificate is properly applied to the Management Interface:\nNavigate to Device > Setup > Management > General Settings > SSL/TLS\nService Profile",
    "remediation_steps": "Create or acquire a certificate that meets the stated criteria and set it:\nNavigate to Device > Certificate Management > Certificates\nPage 37\nImport an appropriate Certificate for your administrative session, from a trusted\nCertificate Authority.\nNavigate to Device > Certificate Management > SSL/TLS Service Profile\nChoose or import the certificate you want to use for the web based administrative\nsession.\nNavigate to Device > Setup > Management > General Settings > SSL/TLS\nService Profile\nChoose the Service Profile that you have configured",
    "severity": null,
    "is_active": true,
    "references_text": "1. \"How to Configure a Certificate for Secure Web GUI Access\" -\nhttps://live.paloaltonetworks.com/t5/Configuration-Articles/How-to-configure-a-\ncertificate-for-secure-web-gui-access/ta-p/68653\n2. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing\nAdministrative Access\": https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-\nadmin/getting-started/best-practices-for-securing-administrative-access.html#",
    "audit": "Verify that the certificate used to secure HTTPS sessions meets the criteria by\nreviewing the appropriate certificate:\nNavigate to Device > Certificate Management > Certificates\nVerify that this Certificate is properly applied to the Management Interface:\nNavigate to Device > Setup > Management > General Settings > SSL/TLS\nService Profile",
    "rationale": "If a certificate that is self-signed, expired, or otherwise invalid is used for the browser\nHTTPS interface, administrators in most cases will not be able to tell if their session is\nbeing eavesdropped on or injected into by a \"Man in the Middle\" attack.",
    "impact": "If the default self-signed certificate is used, an administrator will not be able to clearly\ntell if their HTTPS session is being hijacked or not. Using a trusted certificate ensures\nthat the session is both encrypted and trusted."
  },
  {
    "rule_id": "1.3.1",
    "benchmark": "CIS Palo Alto Firewall 10 Benchmark v1.3.0",
    "device_type": "Palo Alto",
    "control_name": "Ensure 'Minimum Password Complexity' is enabled",
    "cis_level": "• Level 1",
    "description": "This checks all new passwords to ensure that they meet basic requirements for strong\npasswords.",
    "expected_values": "Not enabled.",
    "validation_logic": "Navigate to Device > Setup > Management > Minimum Password Complexity.\nVerify Enabled is checked\nEnsure that the various password settings to values that are appropriate to your\norganization. Non-zero values should be set for Minimum Uppercase, Lowercase and\nSpecial Characters. \"Block Username Inclusion\" should be enabled.",
    "remediation_steps": "Navigate to Device > Setup > Management > Minimum Password Complexity.\nSet Enabled to be checked\nPage 40\nSet that the various password settings to values that are appropriate to your\norganization. It is suggested that there at least be some special characters enforced,\nand that a minimum length be set. Ensure that non-zero values are set for Minimum\nUppercase, Lowercase and Special Characters. \"Block Username Inclusion\" should be\nenabled.\nOperationally, dictionary words should be avoided for all passwords - passphrases are a\nmuch better alternative.",
    "severity": null,
    "is_active": true,
    "references_text": "1. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing\nAdministrative Access” - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-\nadmin/getting-started/best-practices-for-securing-administrative-access.html",
    "audit": "Navigate to Device > Setup > Management > Minimum Password Complexity.\nVerify Enabled is checked\nEnsure that the various password settings to values that are appropriate to your\norganization. Non-zero values should be set for Minimum Uppercase, Lowercase and\nSpecial Characters. \"Block Username Inclusion\" should be enabled.",
    "rationale": "Password complexity recommendations are derived from the USGCB (United States\nGovernment Configuration Baseline), Common Weakness Enumeration, and\nbenchmarks published by the CIS (Center for Internet Security). Password complexity\nadds entropy to a password, in comparison to a simple password of the same length. A\ncomplex password is more difficult to attack, either directly against administrative\ninterfaces or cryptographically, against captured password hashes. However, making a\npassword of greater length will generally have a greater impact in this regard, in\ncomparison to making a shorter password more complex.",
    "impact": "Simple passwords make an attacker's job very easy. There is a reasonably short list of\ncommonly used admin passwords for network infrastructure, not enforcing password\nlengths and complexity can lend itself to making an attacker's brute force attack\nsuccessful."
  },
  {
    "rule_id": "1.3.2",
    "benchmark": "CIS Palo Alto Firewall 10 Benchmark v1.3.0",
    "device_type": "Palo Alto",
    "control_name": "Ensure 'Minimum Length' is greater than or equal to 12",
    "cis_level": "• Level 1",
    "description": "This determines the least number of characters that make up a password for a user\naccount.",
    "expected_values": "Not enabled.\nPage 42",
    "validation_logic": "Navigate to Device > Setup > Management > Minimum Password Complexity.\nVerify Minimum Length is greater than or equal to 12",
    "remediation_steps": "Navigate to Device > Setup > Management > Minimum Password Complexity.\nSet Minimum Length to greater than or equal to 12",
    "severity": null,
    "is_active": true,
    "references_text": "1. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing\nAdministrative Access” - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-\nadmin/getting-started/best-practices-for-securing-administrative-access.html",
    "audit": "Navigate to Device > Setup > Management > Minimum Password Complexity.\nVerify Minimum Length is greater than or equal to 12",
    "rationale": "A longer password is much more difficult to attack, either directly against administrative\ninterfaces or cryptographically, against captured password hashes. Making a password\nof greater length will generally have a greater impact in this regard, in comparison to\nmaking a shorter password more complex. Passphrases are a commonly used\nrecommendation, to make longer passwords more palatable to end users.\nAdministrative staff however generally use \"password safe\" applications, so a long and\ncomplex password is more easily implemented for most infrastructure administrative\ninterfaces.",
    "impact": "Longer passwords are much more difficult to attack. This is true of attacks against the\nadministrative interfaces themselves, or of decryption attacks against captured hashes.\nA longer password will almost always have a more positive impact than a shorter but\nmore complex password."
  },
  {
    "rule_id": "1.3.3",
    "benchmark": "CIS Palo Alto Firewall 10 Benchmark v1.3.0",
    "device_type": "Palo Alto",
    "control_name": "Ensure 'Minimum Uppercase Letters' is greater than or",
    "cis_level": "• Level 1",
    "description": "This checks all new passwords to ensure that they contain at least one English\nuppercase character (A through Z).",
    "expected_values": "Not enabled.",
    "validation_logic": "Navigate to Device > Setup > Management > Minimum Password Complexity\nVerify Minimum Uppercase Letters is greater than or equal to 1",
    "remediation_steps": "Navigate to Device > Setup > Management > Minimum Password Complexity\nSet Minimum Uppercase Letters to greater than or equal to 1",
    "severity": null,
    "is_active": true,
    "references_text": "1. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing\nAdministrative Access” - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-\nadmin/getting-started/best-practices-for-securing-administrative-access.html",
    "audit": "Navigate to Device > Setup > Management > Minimum Password Complexity\nVerify Minimum Uppercase Letters is greater than or equal to 1",
    "rationale": "This is one of several settings that, when taken together, ensure that passwords are\nsufficiently complex as to thwart brute force and dictionary attacks.",
    "impact": null
  },
  {
    "rule_id": "1.3.4",
    "benchmark": "CIS Palo Alto Firewall 10 Benchmark v1.3.0",
    "device_type": "Palo Alto",
    "control_name": "Ensure 'Minimum Lowercase Letters' is greater than or",
    "cis_level": "• Level 1",
    "description": "This checks all new passwords to ensure that they contain at least one English\nlowercase character (a through z).",
    "expected_values": "Not enabled.",
    "validation_logic": "Navigate to Device > Setup > Management > Minimum Password Complexity\nVerify Minimum Lowercase Letters is greater than or equal to 1",
    "remediation_steps": "Navigate to Device > Setup > Management > Minimum Password Complexity\nSet Minimum Lowercase Letters to greater than or equal to 1",
    "severity": null,
    "is_active": true,
    "references_text": "1. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing\nAdministrative Access” - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-\nadmin/getting-started/best-practices-for-securing-administrative-access.html",
    "audit": "Navigate to Device > Setup > Management > Minimum Password Complexity\nVerify Minimum Lowercase Letters is greater than or equal to 1",
    "rationale": "This is one of several settings that, when taken together, ensure that passwords are\nsufficiently complex as to thwart brute force and dictionary attacks.",
    "impact": null
  },
  {
    "rule_id": "1.3.5",
    "benchmark": "CIS Palo Alto Firewall 10 Benchmark v1.3.0",
    "device_type": "Palo Alto",
    "control_name": "Ensure 'Minimum Numeric Letters' is greater than or equal",
    "cis_level": "• Level 1",
    "description": "This checks all new passwords to ensure that they contain at least one base 10 digit (0\nthrough 9).",
    "expected_values": "Not enabled.",
    "validation_logic": "Navigate to Device > Setup > Management > Minimum Password Complexity`\nVerify Minimum Numeric Letters is greater than or equal to 1",
    "remediation_steps": "Navigate to Device > Setup > Management > Minimum Password Complexity\nSet Minimum Numeric Letters to greater than or equal to 1",
    "severity": null,
    "is_active": true,
    "references_text": "1. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing\nAdministrative Access” - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-\nadmin/getting-started/best-practices-for-securing-administrative-access.html",
    "audit": "Navigate to Device > Setup > Management > Minimum Password Complexity`\nVerify Minimum Numeric Letters is greater than or equal to 1",
    "rationale": "This is one of several settings that, when taken together, ensure that passwords are\nsufficiently complex as to thwart brute force and dictionary attacks.",
    "impact": null
  },
  {
    "rule_id": "1.3.6",
    "benchmark": "CIS Palo Alto Firewall 10 Benchmark v1.3.0",
    "device_type": "Palo Alto",
    "control_name": "Ensure 'Minimum Special Characters' is greater than or",
    "cis_level": "• Level 1",
    "description": "This checks all new passwords to ensure that they contain at least one non-alphabetic\ncharacter (for example, !, $, #, %).",
    "expected_values": "Not enabled.",
    "validation_logic": "Navigate to Device > Setup > Management > Minimum Password Complexity\nVerify Minimum Special Characters is greater than or equal to 1",
    "remediation_steps": "Navigate to Device > Setup > Management > Minimum Password Complexity\nSet Minimum Special Characters to greater than or equal to 1",
    "severity": null,
    "is_active": true,
    "references_text": "1. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing\nAdministrative Access” - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-\nadmin/getting-started/best-practices-for-securing-administrative-access.html",
    "audit": "Navigate to Device > Setup > Management > Minimum Password Complexity\nVerify Minimum Special Characters is greater than or equal to 1",
    "rationale": "This is one of several settings that, when taken together, ensure that passwords are\nsufficiently complex as to thwart brute force and dictionary attacks.",
    "impact": null
  },
  {
    "rule_id": "1.3.7",
    "benchmark": "CIS Palo Alto Firewall 10 Benchmark v1.3.0",
    "device_type": "Palo Alto",
    "control_name": "Ensure 'Required Password Change Period' is less than or",
    "cis_level": "• Level 1",
    "description": "This defines how long a user can use a password before it expires.",
    "expected_values": "Not enabled.",
    "validation_logic": "Navigate to Device > Setup > Management > Minimum Password Complexity.\nVerify Required Password Change Period (days) is less than or equal to 90",
    "remediation_steps": "Navigate to Device > Setup > Management > Minimum Password Complexity.\nSet Required Password Change Period (days) to less than or equal to 90",
    "severity": null,
    "is_active": true,
    "references_text": "1. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing\nAdministrative Access” - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-\nadmin/getting-started/best-practices-for-securing-administrative-access.html\nPage 52",
    "audit": "Navigate to Device > Setup > Management > Minimum Password Complexity.\nVerify Required Password Change Period (days) is less than or equal to 90",
    "rationale": "The longer a password exists, the higher the likelihood that it will be compromised by a\nbrute force attack, by an attacker gaining general knowledge about the user and\nguessing the password, or by the user sharing the password.",
    "impact": "Failure to change administrative passwords can result in a slow \"creep\" of people who\nhave access. Especially in a situation with high staff turnover (for instance, in a NOC or\nSOC situation), administrative passwords need to be changed frequently.\nAdministrative credentials should not be shared across multiple devices. In a NOC/SOC\nsituation, it's important to not share administrative credentials between operators\n(names accounts should be used), and in particular administrative credentials should\nnever be shared across different customer infrastructures."
  },
  {
    "rule_id": "1.3.8",
    "benchmark": "CIS Palo Alto Firewall 10 Benchmark v1.3.0",
    "device_type": "Palo Alto",
    "control_name": "Ensure 'New Password Differs By Characters' is greater",
    "cis_level": "• Level 1",
    "description": "This checks all new passwords to ensure that they differ by at least three characters\nfrom the previous password.",
    "expected_values": "Not enabled.",
    "validation_logic": "Navigate to Device > Setup > Management > Minimum Password Complexity\nVerify New Password Differs By Characters is set to greater than or equal to 3",
    "remediation_steps": "Navigate to Device > Setup > Management > Minimum Password Complexity\nSet New Password Differs By Characters to 3 or more",
    "severity": null,
    "is_active": true,
    "references_text": "1. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing\nAdministrative Access” - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-\nadmin/getting-started/best-practices-for-securing-administrative-access.html\nPage 54",
    "audit": "Navigate to Device > Setup > Management > Minimum Password Complexity\nVerify New Password Differs By Characters is set to greater than or equal to 3",
    "rationale": "This is one of several settings that, when taken together, ensure that passwords are\nsufficiently complex as to thwart brute force and dictionary attacks.",
    "impact": "This prevents the use of passwords that fall into a predictable pattern. Especially in\nsituations that involve staff turnover, having a pattern to password changes should be\navoided."
  },
  {
    "rule_id": "1.3.9",
    "benchmark": "CIS Palo Alto Firewall 10 Benchmark v1.3.0",
    "device_type": "Palo Alto",
    "control_name": "Ensure 'Prevent Password Reuse Limit' is set to 24 or more",
    "cis_level": "• Level 1",
    "description": "This determines the number of unique passwords that have to be most recently used for\na user account before a previous password can be reused.",
    "expected_values": "Not enabled.",
    "validation_logic": "Navigate to Device > Setup > Management > Minimum Password Complexity.\nVerify Prevent Password Reuse Limit is greater than or equal to 24",
    "remediation_steps": "Navigate to Device > Setup > Management > Minimum Password Complexity.\nSet Prevent Password Reuse Limit to greater than or equal to 24",
    "severity": null,
    "is_active": true,
    "references_text": "1. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing\nAdministrative Access” - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-\nadmin/getting-started/best-practices-for-securing-administrative-access.html\nPage 56",
    "audit": "Navigate to Device > Setup > Management > Minimum Password Complexity.\nVerify Prevent Password Reuse Limit is greater than or equal to 24",
    "rationale": "The longer a user uses the same password, the greater the chance that an attacker can\ndetermine the password through brute force attacks. Also, any accounts that may have\nbeen compromised will remain exploitable for as long as the password is left\nunchanged. If password changes are required but password reuse is not prevented, or if\nusers continually reuse a small number of passwords, the effectiveness of a good\npassword policy is greatly reduced. While current guidance emphasizes password\nlength above frequent password changes, not enforcing password re-use guidance\nadds the temptation of using a small pool of passwords, which can make an attacker's\njob easier across an entire infrastructure.",
    "impact": null
  },
  {
    "rule_id": "1.3.10",
    "benchmark": "CIS Palo Alto Firewall 10 Benchmark v1.3.0",
    "device_type": "Palo Alto",
    "control_name": "Ensure 'Password Profiles' do not exist",
    "cis_level": "• Level 1",
    "description": "Password profiles that are weaker than the recommended minimum password\ncomplexity settings must not exist.",
    "expected_values": "Not configured",
    "validation_logic": "Navigate to Device > Password Profiles.\nVerify Password Profiles weaker than the recommended minimum password complexity\nsettings do not exist.",
    "remediation_steps": "Navigate to Device > Password Profiles.\nEnsure Password Profiles weaker than the recommended minimum password\ncomplexity settings do not exist.",
    "severity": "Automated",
    "is_active": true,
    "references_text": "1. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing\nAdministrative Access” - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-\nadmin/getting-started/best-practices-for-securing-administrative-access.html\nPage 58",
    "audit": "Navigate to Device > Password Profiles.\nVerify Password Profiles weaker than the recommended minimum password complexity\nsettings do not exist.",
    "rationale": "As password profiles override any 'Minimum Password Complexity' settings defined in\nthe device, they generally should not exist. If these password profiles do exist, they\nshould enforce stronger password policies than what is set in the 'Minimum Password\nComplexity' settings.",
    "impact": null
  },
  {
    "rule_id": "1.4.1",
    "benchmark": "CIS Palo Alto Firewall 10 Benchmark v1.3.0",
    "device_type": "Palo Alto",
    "control_name": "Ensure 'Idle timeout' is less than or equal to 10 minutes for",
    "cis_level": "• Level 1",
    "description": "Set the Idle Timeout value for device management to 10 minutes or less to\nautomatically close inactive sessions.",
    "expected_values": "Not configured",
    "validation_logic": "Navigate to Device > Setup > Management > Authentication Settings.\nVerify Idle Timeout is less than or equal to 10.",
    "remediation_steps": "Navigate to Device > Setup > Management > Authentication Settings.\nSet Idle Timeout to less than or equal to 10.",
    "severity": null,
    "is_active": true,
    "references_text": "1. “How to Change the Admin Session Timeout Value” -\nhttps://live.paloaltonetworks.com/docs/DOC-5557\n2. “PAN-OS Administrator's Guide 11.1 (English) - Device - Setup - Management” -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-\nhelp/device/device-setup-management#\nPage 61",
    "audit": "Navigate to Device > Setup > Management > Authentication Settings.\nVerify Idle Timeout is less than or equal to 10.",
    "rationale": "An unattended computer with an open administrative session to the device could allow\nan unauthorized user access to the firewall’s management interface.",
    "impact": null
  },
  {
    "rule_id": "1.4.2",
    "benchmark": "CIS Palo Alto Firewall 10 Benchmark v1.3.0",
    "device_type": "Palo Alto",
    "control_name": "Ensure 'Failed Attempts' and 'Lockout Time' for",
    "cis_level": "• Level 1",
    "description": "Configure values for Failed Login Attempts and Account Lockout Time set to\norganization-defined values (for example, 3 failed attempts and a 15 minute lockout\ntime). Do not set Failed Attempts and Lockout Time in the Authentication Settings\nsection; any Failed Attempts or Lockout Time settings within the selected Authentication\nProfile do not apply in the Authentication Settings section.",
    "expected_values": "Not configured",
    "validation_logic": "Navigate to Device > Authentication Profile.\nVerify Failed Attempts is set a non-zero organization-defined value.\nVerify Lockout Time is set to a non-zero organization-defined value.",
    "remediation_steps": "Navigate to Device > Authentication Profile.\nSet Failed Attempts to the non-zero organization-defined value.\nSet Lockout Time to the non-zero organization-defined value.",
    "severity": null,
    "is_active": true,
    "references_text": "1. “PAN-OS Administrator's Guide 11.1 (English) - Device - Setup - Management” -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-\nhelp/device/device-setup-management#\nPage 63\n2. “PAN-OS Administrator's Guide 11.1 (English) - Authentication Profile\" -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-\nhelp/device/device-authentication-profile",
    "audit": "Navigate to Device > Authentication Profile.\nVerify Failed Attempts is set a non-zero organization-defined value.\nVerify Lockout Time is set to a non-zero organization-defined value.",
    "rationale": "Without a lockout limit, an attacker can continuously guess administrators’ passwords.\nFrom the other point of view, if lockout settings are configured in the Authentication\nSettings section it may be possible for an attacker to continuously lock out all\nadministrative accounts from accessing the device. This potential situation indicates the\nimportance of using named administrative accounts, instead of the default, single\nshared \"admin\" account.",
    "impact": null
  },
  {
    "rule_id": "1.5.1",
    "benchmark": "CIS Palo Alto Firewall 10 Benchmark v1.3.0",
    "device_type": "Palo Alto",
    "control_name": "Ensure 'V3' is selected for SNMP polling",
    "cis_level": "• Level 1",
    "description": "For SNMP polling, only SNMPv3 should be used.",
    "expected_values": "Not configured",
    "validation_logic": "Navigate to Device > Setup > Operations > Miscellaneous > SNMP Setup\nVerify V3 is selected.",
    "remediation_steps": "Navigate to Device > Setup > Operations > Miscellaneous > SNMP Setup\nSelect V3.\nIn order to be usable, the User and View sections of this dialog should also be\ncompleted. These settings need to match the settings in the organization's NMS\n(Network Management System)",
    "severity": "Automated",
    "is_active": true,
    "references_text": "1. https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-\nhelp/device/device-setup-operations/enable-snmp-monitoring\nPage 66",
    "audit": "Navigate to Device > Setup > Operations > Miscellaneous > SNMP Setup\nVerify V3 is selected.",
    "rationale": "SNMPv3 utilizes AES-128 encryption, message integrity, user authorization, and device\nauthentication security features. SNMPv2c does not provide these security features. If\nan SNMPv2c community string is intercepted or otherwise obtained, an attacker could\ngain read access to the firewall. Note that SNMP write access is not possible.",
    "impact": "Any clear-text administrative protocol (such as SNMPv2) can expose valuable\ninformation to any attacker that is in a position to eavesdrop on that protocol."
  },
  {
    "rule_id": "1.6.1",
    "benchmark": "CIS Palo Alto Firewall 10 Benchmark v1.3.0",
    "device_type": "Palo Alto",
    "control_name": "Ensure 'Verify Update Server Identity' is enabled",
    "cis_level": "• Level 1",
    "description": "This setting determines whether or not the identity of the update server must be verified\nbefore performing an update session. Note that if an SSL Forward Proxy is configured\nto intercept the update session, this option may need to be disabled (because the SSL\nCertificate will not match).",
    "expected_values": "Not configured",
    "validation_logic": "Navigate to Device > Setup > Services > Services.\nVerify that the Verify Update Server Identity box is checked.",
    "remediation_steps": "Navigate to Device > Setup > Services > Services.\nSet the Verify Update Server Identity box to checked.",
    "severity": null,
    "is_active": true,
    "references_text": "1. “PAN-OS Administrator's Guide 9.0 (English) - Install Content Updates\" -\nhttps://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/software-and-\ncontent-updates/install-content-and-software-updates.html\nPage 69",
    "audit": "Navigate to Device > Setup > Services > Services.\nVerify that the Verify Update Server Identity box is checked.",
    "rationale": "Verifying the update server identity before package download ensures the packages\noriginate from a trusted source. Without this, it is possible to receive and install an\nupdate from a malicious source.",
    "impact": "This setting protects the device from an \"evilgrade\" attack, where a successful DNS\nattack can redirect the firewall to an attacker-controlled update server, which can then\nserve a modified update."
  },
  {
    "rule_id": "1.6.2",
    "benchmark": "CIS Palo Alto Firewall 10 Benchmark v1.3.0",
    "device_type": "Palo Alto",
    "control_name": "Ensure redundant NTP servers are configured appropriately",
    "cis_level": "• Level 1",
    "description": "These settings enable use of primary and secondary NTP servers to provide\nredundancy in case of a failure involving the primary NTP server.",
    "expected_values": "Not configured\nPage 71",
    "validation_logic": "Navigate to Device > Setup > Services > Services.\nVerify Primary NTP Server Address is set appropriately.\nVerify Secondary NTP Server Address is set appropriately.",
    "remediation_steps": "Navigate to Device > Setup > Services > Services.\nSet Primary NTP Server Address appropriately.\nSet Secondary NTP Server Address appropriately.",
    "severity": null,
    "is_active": true,
    "references_text": "1. “The NIST Authenticated NTP Service” -\nhttp://www.nist.gov/pml/div688/grp40/authntp.cfm\n2. https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-\nhelp/device/device-setup-services/global-services-settings\n3. \"How to Configure Authenticated NTP\" -\nhttps://live.paloaltonetworks.com/t5/Configuration-Articles/How-to-Configure-\nAuthenticated-NTP/ta-p/54495",
    "audit": "Navigate to Device > Setup > Services > Services.\nVerify Primary NTP Server Address is set appropriately.\nVerify Secondary NTP Server Address is set appropriately.",
    "rationale": "NTP enables the device to maintain an accurate time and date when receiving updates\nfrom a reliable NTP server. Accurate timestamps are critical when correlating events\nwith other systems, troubleshooting, or performing investigative work. Logs and certain\ncryptographic functions, such as those utilizing certificates, rely on accurate time and\ndate parameters. In addition, rules referencing a Schedule object will not function as\nintended if the device’s time and date are incorrect.\nFor additional security, authenticated NTP can be utilized. If Symmetric Key\nauthentication is selected, only SHA1 should be used, as MD5 is considered severely\ncompromised.\nMost organizations will maintain a pair of internal NTP servers for all internal time\nservices. These servers will either be self-contained atomic clocks, or will collect time\nfrom a known reliable source (often GPS or a well-known internet server pool will be\nused).",
    "impact": null
  },
  {
    "rule_id": "1.6.3",
    "benchmark": "CIS Palo Alto Firewall 10 Benchmark v1.3.0",
    "device_type": "Palo Alto",
    "control_name": "Ensure that the Certificate Securing Remote Access VPNs",
    "cis_level": "• Level 1\n• Level 2",
    "description": "The Certificate used to secure Remote Access VPNs should satisfy the following\ncriteria:\n• It should be a valid certificate from a trusted source. In almost cases this means\na trusted Public Certificate Authority, as in most cases remote access VPN users\nwill not have access to any Private Certificate Authorities for Certificate\nvalidation.\n• The certificate should have a valid date. It should not have a \"to\" date in the past\n(it should not be expired), and should not have a \"from\" date in the future.\n• The key length used to encrypt the certificate should be 2048 bits or more.\n• The hash used to sign the certificate should be SHA-2 or better.\n• When the Certificate is applied, the TLS version should be 1.1 or higher (1.2 is\nrecommended)",
    "expected_values": "Not configured",
    "validation_logic": "Verify that the certificate being used to secure the VPN meets the criteria listed above:\nNavigate to Device > Certificate Management > Certificates\nEnsure that a valid certificate is applied to the HTTPS portal:\nPage 73\nNavigate to Network > GlobalProtect > Portals > Portal Configuration >\n(Select the Portal being assessed) > Authentication > SSL/TLS Profile\nEnsure that a valid certificate is applied to the GlobalProtect Gateway:\nNavigate to Network > GlobalProtect > Gateways > (Select the Gateway\nbeing Assessed) > Authentication > SSL/TLS Service Profile\nEnsure that the correct Certificate is selected. Ensure that the Minimum TLS version is\nconfigured to be 1.1 or higher (TLSv1.2 is recommended).",
    "remediation_steps": "Create a CSR and install a certificate from a public CA (Certificate Authority) here:\nNavigate to Device > Certificate Management > Certificates\nApply a valid certificate to the HTTPS portal:\nNavigate to Network > GlobalProtect > Portals > Portal Configuration >\nAuthentication > SSL/TLS Profile\nApply a valid certificate to the GlobalProtect Gateway:\nNavigate to Network > GlobalProtect > Gateways > Authentication > SSL/TLS\nService Profile Configure the Service Profile to use the correct certificate\nEnsure that the Minimum TLS version is set to 1.1 or 1.2 (1.2 is recommended).",
    "severity": null,
    "is_active": true,
    "references_text": "1. “PAN-OS Administrator's Guide 9.0 (English) - GlobalProtect Certificate Best\nPractices\" - https://docs.paloaltonetworks.com/globalprotect/9-0/globalprotect-\nadmin/get-started/enable-ssl-between-globalprotect-components/globalprotect-\ncertificate-best-practices.html\n2. “PAN-OS Administrator's Guide 9.0 (English) - Deploy Server Certificates to the\nGlobalProtect Components\" - https://docs.paloaltonetworks.com/globalprotect/9-\n0/globalprotect-admin/get-started/enable-ssl-between-globalprotect-\ncomponents/deploy-server-certificates-to-the-globalprotect-components.html#\nPage 74",
    "audit": "Verify that the certificate being used to secure the VPN meets the criteria listed above:\nNavigate to Device > Certificate Management > Certificates\nEnsure that a valid certificate is applied to the HTTPS portal:\nPage 73\nNavigate to Network > GlobalProtect > Portals > Portal Configuration >\n(Select the Portal being assessed) > Authentication > SSL/TLS Profile\nEnsure that a valid certificate is applied to the GlobalProtect Gateway:\nNavigate to Network > GlobalProtect > Gateways > (Select the Gateway\nbeing Assessed) > Authentication > SSL/TLS Service Profile\nEnsure that the correct Certificate is selected. Ensure that the Minimum TLS version is\nconfigured to be 1.1 or higher (TLSv1.2 is recommended).",
    "rationale": "If presented with a certificate error, the end user in most cases will not be able to tell if\ntheir session is using a self-signed or expired certificate, or if their session is being\neavesdropped on or injected into by a \"Man in the Middle\" attack. This means that self-\nsigned or invalid certificates should never be used for VPN connections.",
    "impact": "Not using a trusted Certificate, issued by a trusted Public Certificate Authority means\nthat clients establishing VPN sessions will always see an error indicating an untrusted\nCertificate. This means that they will have no method of validating if their VPN session\nis being hijacked by a \"Monkey in the Middle\" (MitM) attack. It also \"trains\" them to\nbypass certificate warnings for other services, making MitM attacks easier for those\nother services as well."
  },
  {
    "rule_id": "1.7.1",
    "benchmark": "CIS Palo Alto Firewall 10 Benchmark v1.3.0",
    "device_type": "Palo Alto",
    "control_name": "Enabling Post-Quantum (PQ) on IKEv2 VPNs",
    "cis_level": "• Level 2\n• Level 2\n• Level 2\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 2\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 2\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 2\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 2",
    "description": "For VPN that has IKEv2 enabled, enable PQ for more secure way to exchange pre-\nshared secret to defend against \"Harvest Now, Decrypt Later\" attack technique.\nConfigure appropriate settings to map IP addresses to usernames. Mapping userids to\nIP addresses is what permits the firewall to create rules based on userids and groups\nrather than IP addresses and subnets, as well as log events by userids rather than IP\naddresses or DNS names. The specifics of how to achieve IP-to-username mapping is\nhighly dependent on the environment. It can be enabled by integrating the firewall with a\ndomain controller, Exchange server, captive portal, Terminal Server, User-ID Agent,\nXML API, or syslog data from a variety of devices.\nDisable WMI probing if it is not required for User-ID functionality in the environment.\nOnly enable the User-ID option for interfaces that are both internal and trusted. There is\nrarely a legitimate need to allow WMI probing (or any user-id identification) on an\nuntrusted interface. The exception to this is identification of remote-access VPN users,\nwho are identified as they connect.\nIf User-ID is configured, use the Include/Exclude Networks section to limit the User-ID\nscope to operate only on trusted networks. There is rarely a legitimate need to allow\nWMI probing or other User identification on an untrusted network.\nIf the integrated (on-device) User-ID Agent is utilized, the Active Directory account for\nthe agent should only be a member of the Event Log Readers group, Distributed COM\nUsers group, and Domain Users group. If the Windows User-ID agent is utilized, the\nActive Directory account for the agent should only be a member of the Event Log\nReaders group, Server Operators group, and Domain Users group.\nRestrict the User-ID service account from interactively logging on to systems in the\nActive Directory domain.\nRestrict the User-ID service account’s ability to gain remote access into the\norganization. This capability could be made available through a variety of technologies,\nsuch as VPN, Citrix GoToMyPC, or TeamViewer. Remote services that integrate\nauthentication with the organization’s Active Directory may unintentionally allow the\nUser-ID service account to gain remote access.\nCreate security policies to deny Palo Alto User-ID traffic originating from the interface\nconfigured for the UID Agent service that are destined to any untrusted zone.\nEnsure a High Availability peer is fully synchronized and in a passive or active state.\nConfigure Link Monitoring and/or Path Monitoring under High Availability options. If Link\nMonitoring is utilized, all links critical to traffic flow should be monitored.\nSet the Passive Link State to auto, and uncheck the Preemptive option to disable it.\nSet Antivirus Update Schedule to download and install updates hourly.\nSet the Applications and Threats Update Schedule to download and install updates at\ndaily or shorter intervals.\nThe default file size limits on the firewall are designed to include the majority of malware\nin the wild (which is smaller than the default size limits) and to exclude large files that\nare very unlikely to be malicious and that can impact WildFire file-forwarding capacity.\nEnsure that all files traversing the firewall are inspected by WildFire by setting a Wildfire\nfile blocking profile on all security policies.\nAllow the firewall to forward decrypted content to WildFire. Note that SSL Forward-\nProxy must also be enabled and configured for this setting to take effect on inside-to-\noutside traffic flows.\nEnable all options under Session Information Settings for WildFire.\nConfigure WildFire to send an alert when a malicious or greyware file is detected. This\nalert could be sent by whichever means is preferable, including email, SNMP trap, or\nsyslog message.\nAlternatively, configure the WildFire cloud to generate alerts for malicious files. The\ncloud can generate alerts in addition to or instead of the local WildFire implementation.\nNote that the destination email address of alerts configured in the WildFire cloud portal\nis tied to the logged in account, and cannot be modified. Also, new systems added to\nthe WildFire cloud portal will not be automatically set to email alerts.\nSet the WildFire update schedule to download and install updates in real-time.\nBy default, all relevant files are uploaded to Wildfire datacenter located in US. Palo Alto\nNetworks has been adding more WildFire regional clouds around the world. From\nhaving just 3 regional clouds back in PanOS 8.x, now to more than 10 regional clouds\nall over the world.\nConfigure antivirus profiles to a value of 'reset-both' for all decoders except imap and\npop3 under both Action and WildFire Action. If required by the organization's email\nimplementation, configure imap and pop3 decoders to 'alert' under both Action and\nWildFire Action.\nCreate a secure antivirus profile and apply it to all security policies that could pass\nHTTP, SMTP, IMAP, POP3, FTP, or SMB traffic. The antivirus profile may be applied to\nthe security policies directly or through a profile group.\nIf a single rule exists within the anti-spyware profile, configure it to block on Critical,\nHigh, and Medium spyware severity level, any category, and any threat. If multiple rules\nexist within the anti-spyware profile, ensure all spyware categories, threats, and severity\nlevels (Critical, High, and Medium) are set to be blocked. Additional rules may exist for\npacket capture or exclusion purposes.\nConfigure DNS sinkholing for all anti-spyware profiles in use. All internal requests to the\nselected sinkhole IP address must traverse the firewall. Any device attempting to\ncommunicate with the DNS sinkhole IP address should be considered infected.\nCreate one or more anti-spyware profiles and collectively apply them to all security\npolicies permitting traffic to the Internet. The anti-spyware profiles may be applied to the\nsecurity policies directly or through a profile group.\nConfigure a Vulnerability Protection Profile set to block attacks against any critical or\nhigh vulnerabilities, at minimum, and set to default on any medium, low, or informational\nvulnerabilities. Configuring an alert action for low and informational, instead of default,\nwill produce additional information at the expense of greater log utilization.\nFor any security rule allowing traffic, apply a securely configured Vulnerability Protection\nProfile. Careful analysis of the target environment should be performed before\nimplementing this configuration, as outlined by PAN’s “Threat Prevention Deployment\nTech Note” in the references section.\nConfigure the device to use PAN-DB URL Filtering instead of BrightCloud.\nIdeally, deciding which URL categories to block, and which to allow, is a joint effort\nbetween IT and another entity of authority within an organization—such as the legal\ndepartment or administration. For most organizations, blocking or requiring an override\non the following categories represents a minimum baseline: adult, hacking, command-\nand-control, copyright-infringement, extremism, malware, phishing, proxy-avoidance-\nand-anonymizers, and parked. Some organizations may add \"unknown\" and \"dynamic-\ndns\" to this list, at the expense of some support calls on those topics.\nURL filters should not specify any categories as Allow Categories.\nEnable all options (User-Agent, Referer, and X-Forwarded-For) for HTTP header\nlogging.\nApply a secure URL filtering profile to all security policies permitting traffic to the\nInternet. The URL Filtering profile may be applied to the security policies directly or\nthrough a profile group.\nThis guideline is highly specific to an organization. While blocking of credit card or\nSocial Security numbers will not occur with the recommended settings below, careful\ntuning is also recommended.\nCreate a secure Data Filtering profile and apply it to all security policies permitting traffic\nto or from the Internet. The Data Filtering profile may be applied to security policies\ndirectly or through a profile group.\nEnable the SYN Flood Action of SYN Cookies for all untrusted zones. The Alert,\nActivate, and Maximum settings for SYN Flood Protection depend highly on the\nenvironment and device used. Perform traffic analysis on the specific environment and\nfirewall to determine accurate thresholds. Do not rely on default values to be\nappropriate for an environment.\nSetting these values for all interfaces is an approach that should be considered by many\norganizations, as traffic floods can result from internal testing or malware as well.\nAs a rough ballpark for most environments, an Activate value of 50% of the firewall’s\nmaximum “New sessions per second”/CPS is a conservative setting. The following is a\nlist of maximum new sessions per second for each platform:\nPA-4xx series = 73,000 CPS\nPA-8xx series = 13,100 CPS\nPA-14xx series = 140,000 CPS\nPA-32xx series = 84,000 CPS\nPA-34xx series = 268,000 CPS\nPA-52xx series = 500,000 CPS\nPA-54xx series = 3,600,000 CPS\nPA-70xx series = 6,000,000 CPS\nEnable all Flood Protection options in the Zone Protection Profile attached to all\nuntrusted zones. The Alert, Activate, and Maximum settings for Flood Protection\ndepend highly on the environment and device used. Perform traffic analysis on the\nspecific environment and firewall to determine accurate thresholds. Do not rely on\ndefault values to be appropriate for an environment.\nSetting these values for all interfaces is an approach that should be considered by many\norganizations, as traffic floods can result from internal testing or malware as well.\nEnable all three scan options in a Zone Protection profile. Do not configure an action of\nAllow for any scan type. The exact interval and threshold values must be tuned to the\nspecific environment. Less aggressive settings are typically appropriate for trusted\nzones, such as setting an action of alert for all scan types.\nAttach appropriate Zone Protection profiles meeting these criteria to all zones. Separate\nZone Protection profiles for trusted and untrusted zones is a best practice.\nFor all zones, attach a Zone Protection Profile that is configured to drop packets with a\nspoofed IP address or a mismatched overlapping TCP segment, and packets with\nmalformed, strict source routing, or loose source routing IP options set.\nIdeally user names and passwords user within an organization are not used with third\nparty sites. Some sanctioned SAS applications may have connections to the corporate\ndomain, in which case they will need to be exempt from the user credential submission\npolicy through a custom URL category.\nConfigure 'Wildfire Inline ML Action' on antivirus profiles to a value of 'reset-both' for all\ndecoders except imap and pop3 under 'Wildfire Inline ML Action'. If required by the\norganization's email implementation, configure imap and pop3 decoders to 'alert' under\n'Wildfire Inline ML Action'.\nConfigure 'Wildfire Inline ML' on antivirus profiles to a value of 'enable' for all file types.\nEnable 'Inline Cloud Analysis' on Vulnerability Protection profiles to combat zero-day\nthreats.\nEnable both 'Local Inline Categorization' and 'Cloud Inline Categorization' on URL\nFiltering profiles to evaluate suspicious web page contents in real-time to protect users\nagainst zero-day threats.\nEnable 'Inline Cloud Analysis' on Anti-Spyware profiles to detect and protection against\nadvanced, highly-evasive zero-day command-and-control (C2) threats.\nDNS security is an extensible cloud-based service capable of generating DNS\nsignatures using advanced predictive analytics and machine learning. DNS Security\nprotects from sophisticated DNS-based attacks.\nWhen permitting traffic from an untrusted zone, such as the Internet or guest network, to\na more trusted zone, such as a DMZ segment, create security policies specifying which\nspecific applications are allowed.\n**Enhanced Security Recommendation: ** Require specific application policies when\nallowing any traffic, regardless of the trust level of a zone. Do not rely solely on port\npermissions. This may require SSL interception, and may also not be possible in all\nenvironments.\nCreate security policies specifying application-default for the Service setting, in addition\nto the specific ports desired. The Service setting of any should not be used for any\npolicies that allow traffic.\nCreate a pair of security rules at the top of the security policies ruleset to block traffic to\nand from IP addresses known to be malicious.\nNote: This recommendation (as written) requires a Palo Alto Networks \"Threat\nPrevention License\". Third Party and Open Source Threat Intelligence Feeds can also\nbe used for this purpose.\nEnable logging on built-in default security policies \"intrazone-default\" and \"interzone-\ndefault\"\nConfigure SSL Forward Proxy for all traffic destined to the Internet. In most\norganizations, including all categories except financial-services, government and\nhealth-and-medicine is recommended.\nConfigure SSL Inbound Inspection for all untrusted traffic destined for servers using\nSSL or TLS.\nThe CA Certificate used for in-line HTTP Man in the Middle should be trusted by target\nusers. For SSL Forward Proxy configurations, there are classes of users that need to\nbe considered.\n1: Users that are members of the organization, users of machines under control of the\norganization. For these people and machines, ensure that the CA Certificate is in one of\nthe Trusted CA certificate stores. This is easily done in Active Directory, using Group\nPolicies for instance. A MDM (Mobile Device Manager) can be used to accomplish the\nsame task for mobile devices such as telephones or tablets. Other central management\nor orchestration tools can be used for Linux or \"IoT\" (Internet of Things) devices.\n2: Users that are not member of the organization - often these are classed as \"Visitors\"\nin the policies of the organization. If a public CA Certificate is a possibility for your\norganization, then that is one approach. A second approach is to not decrypt affected\ntraffic - this is easily done, but leaves the majority of \"visitor\" traffic uninspected and\npotentially carrying malicious content. The final approach, and the one most commonly\nseen, is to use the same certificate as is used for the hosting organization. In this last\ncase, visitors will see a certificate warning, but the issuing CA will be the organization\nthat they are visiting.",
    "expected_values": "Not Configured\nNot configured\nPage 82\nBy default WMI probing and all User-ID functions are disabled.\nNot configured\nPage 86\nNot configured\nNot configured\nPage 90\nNot configured\nNot Configured\nPage 98\nNot Configured\nNot Configured\nNot Configured\nThis setting is by default set to Weekly.\nIn PAN-OS 9.x, the default file sizes for WildFire are:\n• pe (Portable Executable) - 16MB\n• apk (Android Application)- 10MB\n• pdf (Portable Document Format) - 3072KB\n• ms-office (Microsoft Office) — 16384KB\n• jar (Packaged Java class file) — 5MB\n• flash (Adobe Flash) — 5MB\n• MacOSX (DMG/MAC-APP/MACH-O PKG files) — 10MB\n• archive (RAR and 7z files) — 50MB\n• linux (ELF files) — 50MB\n• script (JScript, VBScript, PowerShell, and Shell Script)- 20KB\nNot Configured\nNot Configured\nAll Session Information Settings are enabled by default. These include:\n• Source IP\n• Source port\n• Destination IP\n• Destination port\n• Virtual System\n• Application\n• User\n• URL\n• File name\n• Email sender\n• Email recipient\n• Email subject\nPage 117\nNot Configured\nNot Configured\nwildfire.paloaltonetworks.com\nPage 123\nNot Configured\nNo Antivirus Profiles are enabled on any default or new Security Policy\nTwo Anti-Spyware Security Profiles are configured by default \"strict\" and \"default\".\nNot Configured\nNot Configured\nTwo Vulnerability Protection Profiles are configured by default - \"strict\" and \"default\".\nNot Configured\nPage 139\nNot Configured\nNot Configured\nPage 143\nA default URL Filtering Security Profile is configured, with the following categories set to\n\"block\": abused-drugs adult gambling hacking malware phishing questionable weapons\n3 Categories are set to alert in the default policy, and 58 Categories are set to allow\n(which means they are not logged)\nNot Configured\nNot Configured\nPage 149\nNot Configured\nNot Configured\nNot Configured\nNot Configured\nNot Configured\nNot Configured\nPage 162\nNot Configured\nNot Configured\nPage 166\nNot Configured\nNot Configured\nPage 170\nNot Configured\nPage 172\nNot Configured\nPage 174\nNot Configured\nNot Configured\nNot Configured\nNot Configured\nPage 185\nDisabled\nNot Configured\nNot Configured\nDecryption is not enabled by default.",
    "validation_logic": "Navigate to Network > Network Profiles > IKE Gateways.\nOn gateways that has IKEv2 enabled, click into it and navigate to Advanced Options.\nOn IKEv2 section, navigate to PQ PPK section.\nVerify that Enable Post-Quantum Pre-Shared Key (PPK) is checked.\nNegotiation mode should be set to Mandatory if both sides of VPN supports PQ.\nNegotiation mode should be set to Preferred if you don't know or don't have control\nover whether the peer supports RFC 8784. Preferred mode preserves backward\ncompatibility to ensure connections fall back instead of dropping.\nIf both sides of VPN supports more than 1 PPK key ID, then multiple PPK key ID should\nbe configured. Configuring multiple PQ PPKs is most secure because it adds a random\nelement to PQ PPK selection.\nPage 77\nTo validate if this recommendation has been met, look at the Source User column in\nthe URL Filtering or Traffic logs (Monitor > Logs > URL Filtering and Logs >\nTraffic Logs, respectively.)\nUser traffic originating from a trusted zone should identify a username.\nNavigate to Device > User Identification > User Mapping > Palo Alto\nNetworks User ID Agent Setup.\nVerify that Enable Probing is not checked.\nNavigate to Network > Network Profiles > Interface Management.\nVerify that User-ID is only enabled for interfaces that are both internal and trusted.\nNavigate to Device > User Identification > User Mapping > Include/Exclude\nNetworks.\nVerify that all trusted internal networks have a Discovery value of Include.\nVerify that all untrusted external networks have a Discovery value of Exclude. Note that\nany value in the trusted networks list implies that all other networks are untrusted.\nNavigate to Active Directory Users and Computers for the Active Directory under\nconsideration.\nVerify that the service account for the User-ID agent is not a member of any groups\nother than Event Log Readers, Distributed COM Users, and Domain Users (for the\nintegrated, on-device User-ID agent) or Event Log Readers, Server Operators, and\nDomain Users (for the Windows User-ID agent.)\nNavigate to Active Directory Group Policies.\nVerify that Group Policies restricts the interactive logon privilege for the User-ID service\naccount.\nor\nNavigate to Active Directory Managed Service Accounts.\nVerify that Managed Service Accounts restricts the interactive logon privilege for the\nUser-ID service account.\nAuditing is operating-system dependent. For instance, in Windows Active Directory, this\naccount should not be included in any group that grants the account access to VPN or\nWireless access. In addition, domain administrative accounts should not have remote\ndesktop (RDP) access to all domain member workstations.\nNavigate to Device > Setup > Services > Services Features > Service Route\nConfiguration > Customize.\nClick on the protocol in use (IPv4 and/or IPv6).\nClick UID Agent.\nClick on the address object for the UID Agent's IP address.\nVerify SOURCE/NAME is set to 'Deny msrpc to untrusted'.\nVerify SOURCE/ZONE is set to 'INSIDE'.\nVerify SOURCE/Address is set to the Address object for the UID Agent.\nVerify DESTINATION/ZONE is set to 'GUEST' and 'OUTSIDE'.\nVerify DESTINATION/Address is set to 'any'.\nVerify DESTINATION/Application is set to 'msrpc'.\nVerify DESTINATION/Service is set to 'application-default'.\nVerify DESTINATION/Action is set to 'Block' (red circle with diagonal line).\nPage 94\nNavigate to Device > High Availability > HA Communications.\nIn the HA Communications. >Data Link (HA2) section, verify that the correct\ninterface is selected. Verify the desired protocol (IPv4 or IPv6) is selected. Verify\nthe correct Transport is selected. Verify the Enable Session Synchronization box is\nchecked.\nTo verify Link Monitoring from GUI:\nNavigate to Device > High Availability > Link and Path Monitoring. In the\nLink Monitoring section, verify the correct interfaces are in the Link Group and\nGroup Failure Conditions Under the Link Monitoring section, verify Failure\nCondition is set to Any. Verify Enabled button is checked.\nTo verify Path Monitoring from GUI:\nNavigate to Device > High Availability > Link and Path Monitoring. In the\nPath Monitoring section, verify Option is set correctly. Verify Failure Condition is\nset to Any. Verify Name, IP Address, Failure Condition is set correctly. Verify\nDefault setting is set to Any. Verify Enabled button is checked.\nTo ensure Active/Passive Settings are configured correctly:\nNavigate to Device > High Availability > General > Active/Passive\nSettings.\nVerify Passive Link State is set to auto.\nTo ensure Election Settings are configured correctly:\nNavigate to Device > High Availability > Election Settings.\nVerify Preemptive is disabled.\nNavigate to Device > Dynamic Updates > Antivirus Update Schedule.\nVerify that Action is set to Download and Install.\nVerify that Recurrence is set to Hourly.\nNavigate to Device > Dynamic Updates > Application and Threats Update\nSchedule.\nVerify that Action is set to Download and Install.\nVerify that Recurrence is set to Daily, Hourly or Every 30 Minutes\nNavigate to Device > Setup > WildFire.\nNavigate to the General Settings sections.\nVerify the maximum size for each file type at the defaults or larger, to a size that is as\nlarge enough to account for \"large\" files, but not large enough to affect performance of\nthe hardware.\nTo verify WildFire Analysis Profile:\n• Navigate to Objects > Security Profiles > WildFire Analysis Profile\nverify that a profile exists.\nTo verify File Blocking Rules:\n• For each Security Policy were the action is set to Allow, edit the Rule and\nnavigate to Actions > Profile Setting. Ensure that the WildFire\nAnalysis is set to Allow and verify that a profile is set.\nIf Group Profiles are used:\n• Navigate to Policies > Security\n• For each Security Policy were the action is set to Allow, edit the Rule and\nnavigate to Actions > Profile Setting. Ensure that the Profile Type is set\nto Group.\n• Navigate to Objects > Security Profile Groups. Open the Security Profile Group\nused above, and ensure that the Wildfire Analysis Profile is set.\nNavigate to Device > Setup > Content-ID > Content-ID Settings.\nVerify that Allow forwarding of decrypted content is checked.\nNavigate to Device > Setup > WildFire > Session Information Settings.\nVerify that every option is enabled.\nNavigate to Objects > Log Forwarding.\nVerify that the WildFire log type is configured to generate alerts using the desired\nalerting mechanism(s).\nNavigate to Device > Dynamic Updates > WildFire Update Schedule.\nVerify that Recurrence is set to Real-time.\nNavigate to Device > Setup > WildFire.\nNavigate to the General Settings sections.\nVerify that WildFire Public Cloud is set to your appropriate region.\nNavigate to Objects > Security Profiles > Antivirus\nVerify that antivirus profiles have all decoders set to reset-both for both Action and\nWildfire Action. If imap and pop3 are required in the organization, verify that the\nimap and pop3 decoders are set to alert for both Action and Wildfire Action.\nNavigate to Policies > Security . For each policy, navigate to [Policy Name] >\nActions Verify there is a secure Antivirus profile applied to all security policies\npassing traffic - regardless of protocol. This can be set by Profiles or by Profile Group.\nNavigate to Objects > Security Profiles > Anti-Spyware. Click on existing\nprofile in used or create a new profile.\nNavigate to Signature Policies tab. Add new policy by giving it a name Policy\nName.\nVerify a Policy Name exists within the anti-spyware profile that is configured to perform\nthe reset-both on Critical, High, and Medium Severity level, any\nCategory, and any Threat Name.\nNavigate to Objects > Security Profiles > Anti-Spyware.\nWithin the each anti-spyware profile, under its DNS Policies tab, verify the Signature\nSource List: default-paloalto-dns should have as its Policy Action set to\nsinkhole If licensed, the DNS Security should have as its Policy Action set to\nsinkhole\nVerify the 'Sinkhole IPv4' IP address is correct. This should be set to\nsinkhole.paloaltnetworks.com, or if an internal host is set then that host IP or\nFQDN should be in that field\nVerify the 'Sinkhole IPv6' IP address is correct. This should be set to IPv6 Loopback\nIP (::1), or if an internal DNS Sinkhole host is set then that host IP or FQDN should\nbe in that field\nNavigate to Policies > Security Policies For each outbound security Policy, in\nthe Actions tab, verify that the Anti-Spyware setting includes the Spyware Profile\ncreated, either explicitly or as a Group Profile\nTo verify correct operation of DNS Security, from an internal station make a DNS\nrequest to each of the following hosts:\n• test-malware.testpanw.com to test Malware DNS Signature checks\n• test-c2.testpanw.com to test C2 DNS Signature checks\nPage 132\n• test-dga.testpanw.com to test DGA (Domain Generation Algorithm) DNS attack\nchecks\n• test-dnstun.testpanw.com to test DNS Tunneling attack checks Each of\nthese DNS requests should be redirected to the configured DNS Sinkhole server\nIP address Each of these DNS requests should appear in the firewall logs, under\nMonitor > Logs > Threat. If configured, each of these requests should\ngenerate an alert in the organization's SIEM.\nNavigate to Objects > Security Profiles > Anti-Spyware.\nAlso navigate to Policies > Security.\nVerify there are one or more anti-spyware profiles that collectively apply to all inside to\noutside traffic from any address to any address and any application and service.\nNavigate to Objects > Security Profiles > Vulnerability Protection.\nVerify a Vulnerability Protection Profile is set to block attacks against any critical or high\nvulnerabilities (minimum), and set to default on attacks against any medium, low, or\ninformational vulnerabilities.\nNavigate to Policies > Security.\nFor each Policy, under the Actions tab, select Vulnerability Protection.\nVerify either the 'Strict' or the 'Default' profile is selected, or a custom profile that\ncomplies with the organization's policies, legal and regulatory requirements.\nNavigate to Device > Licenses.\nClick on PAN-DB URL Filtering.\nVerify Active is set to Yes.\nNavigate to Objects > Security Profiles > URL Filtering.\nVerify that all URL categories designated by the organization are listed, and the action\nis set to Block.\nNavigate to Objects > Security Profiles > URL Filtering.\nVerify that the for all allowed categories, that the Site Access action is set to alert\nNavigate to Objects > Security Profiles > URL Filtering > URL Filtering\nProfile > URL Filtering Settings.\nVerify these four settings:\na. Log container page only box is un-checked\nb. User-Agent box is checked\nc. Referer box is checked\nd. X-Forwarded-For box is checked\nTo Verify URL Filtering:\nFor each Security Policy that transits traffic to the public internet, navigate to Policies\n> Security > Security Profiles > [Policy Name] > Actions.\nVerify there is a URL Filtering profile that complies with the policies of the organization\nis applied to all Security Policies that transit traffic to the public internet.\nNavigate to Objects > Custom Objects > Data Patterns.\nVerify an appropriate Data Pattern has been created that accounts for sensitive\ninformation within your organization. In most cases this will include Credit Card\nNumbers, and your jurisdiction's equivalent of Social Insurance Numbers. In many\ncases these can simply be picked from the list of Predefined Patterns.\nNavigate to Objects > Security Profiles > Data Filtering.\nVerify an appropriate Data Filtering Profile has been created, using the created\nData Patterns. Ensure that an Alert Threshold is set that generates alerts\nappropriately. A typical starting value for Alert Threshold is 20, but this should be\nadjusted after appropriate testing.\nNavigate to Objects > Custom Objects > Data Patterns. Verify that the patterns\ndefined match the various data that you wish to monitor or make blocking decisions on.\nNavigate to Objects > Security Profiles > Data Filtering For each Filtering\nProfile, verify that the Data Patterns defined matches the data you wish to monitor,\nwith appropriate values for Alert Threshold (typically 20), Block Threshold\n(typically 0) and Log Severity.\nFinally, navigate to Policies > Security. Open all appropriate policies, for each\nPolicy choose the Actions tab, and verify that the appropriate Data Filtering\nPolicy is applied (either as an individual Profile or as part of a Group Profile)\nFrom GUI:\nNavigate to Network > Network Profiles > Zone Protection > Zone\nProtection Profile > Flood Protection tab.\nVerify the SYN box is checked. Verify the Action dropdown is SYN Cookies. Verify Alert\nis 20000 (or appropriate for org). Verify Activate is 25000 (50% of maximum for firewall\nmodel). Verify Maximum is 1000000 (or appropriate for org).\nNavigate to Network > Zones. Open the zone facing any untrusted network. Verify that\nZone Protection has the Zone Protection Profile set to the Profile created.\nIn the GUI:\nNavigate to Network > Network Profiles > Zone Protection > Flood\nProtection.\nEnsure that all settings are enabled with at least the default values.\nNavigate to Network > Zones, select each untrusted zone in turn, and ensure that the\nZone Protection Profile is set.\nPage 158\nNavigate to Network > Network Profiles > Zone Protection > Zone\nProtection Profile > Reconnaissance Protection.\nVerify that TCP Port Scan is enabled, its Action is set to block-ip, its Interval is set to\n5, and its Threshold is set to 20. For block-ip, ensure the \"Track By\" is set to source\nand \"Duration\" is set to 600 seconds.\nVerify that Host Sweep is enabled, its Action is set to block, its Interval is set to 10,\nand its Threshold is set to 30.\nVerify that UDP Port Scan is enabled, its Action is set to alert, its Interval is set to 10,\nand its Threshold is set to 20.\nNavigate to Network > Network Profiles > Zone Protection > Zone\nProtection Profile > Packet Based Attack Protection > TCP/IP Drop.\nVerify Spoofed IP address is checked.\nVerify Mismatched overlapping TCP segment is checked.\nUnder IP Option Drop, verify that Strict Source Routing, Loose Source\nRouting, and Malformed are all checked. Additional options may also be checked.\nNavigate to Objects > Security Profiles > URL Filtering.\nChoose the Categories tab. Verify that the User Credential Submitting action on\nall enabled URL categories is set to either block or continue.\nUnder the User Credential Detection tab ensure the User Credential\nDetection is set to a value appropriate to your organization, and is not set to\nDisabled. Verify that the Log Severity value is set to a value appropriate to your\norganization and your logging or SIEM solution.\nNavigate to Objects > Security Profiles > Antivirus\nVerify that antivirus profiles have all decoders set to reset-both for Wildfire Inline\nML Action. If imap and pop3 are required in the organization, verify that the imap and\npop3 decoders are set to alert for Wildfire Inline ML Action.\nNavigate to Objects > Security Profiles > Antivirus\nGo to Wildfire Inline ML tab. Verify that all Action Setting are set to enable\n(inherit per-protocol actions).\nNavigate to Objects > Security Profiles > Vulnerability Protection\nGo to Inline Cloud Analysis tab. Verify that it is enabled and all Model action is set\nas alert.\nNavigate to Objects > Security Profiles > URL Filtering\nGo to Inline Categorization tab. Verify that it is enabled for both Enable local\ninline categorization and Enable cloud inline categorization.\nNavigate to Objects > Security Profiles > Anti-Spyware\nGo to Inline Cloud Analysis tab. Verify that it is enabled and all Model action is set\nas reset-both.\nNavigate to Objects > Security Profiles > Anti-Spyware\nGo to DNS Policies tab. Verify that policy action is set to sinkhole for all DNS\nSecurity categories.\nOn Command and control Domains category, verify that the packet capture option to\nextended-capture.Navigate to Objects > Security Profiles > Anti-Spyware\nGo to DNS Policies tab. Configure policy action to sinkhole for all DNS Security\ncategories.\nOn Command and control Domains category, set the packet capture option to\nextended-capture\nNavigate to Policies > Security.\nPage 179\nFor all Security Policies that transit from a less trusted to a more trusted interface, that\nthe appropriate Application and Service values are set. For instance, for a web\nserver exposed to the internet from a DMZ: Source tab: Zone set to OUTSIDE / Address\nset to Any Destination tab: Zone set to DMZ / Address set to [DMZ Host Object]\nApplication tab: set to web-browsing Service/URL Category tab: set Service to\nether:\n• application-default or:\n• service-http and/or service-https\n**Enhanced Security Recommendation: **\nAssess this setting for Policies on all Interfaces, for traffic in all directions. Ensure that\nfor each Security Policy that the appropriate settings are set for both Application and\nService\nNavigate to Policies > Security.\nFor each exposed host, verify that a Security Policy exists with:\n• Source tab: Zone set to OUTSIDE Address set to any\n• Destination tab: Zone set to DMZ / Address set to <DMZ Host Object>\n• Application tab: Application set to web-browsing (or appropriate\napplication)\n• Service tab: Service set to application-default. The value of any should\nnever be used\nNavigate to Policies > Security\nVerify a Security Policy exists similar to:\n• General tab: Name set to Deny to Malicious IP\n• Source tab: Source Zone set to Any,\n• Destination tab: Destination Zone set to Any, Destination Address set to\nPalo Alto Networks - Known malicious IP addresses,Palo Alto\nNetworks - High risk IP addresses, Palo Alto Networks - Tor exit\nIP addresses, Palo Alto Networks - Bulletproof IP addresses\n• Application tab: Application set to Any\n• Service/URL Category tab: Service set to Any\n• Actions tab: Action set to Block, Profile Type set to None\nVerify a Security Policy exists similar to:\nPage 184\n• General tab: Name set to Deny from Malicious IP\n• Source tab: Source Zone set to Any, Source Address set to Palo Alto\nNetworks - Known malicious IP addresses,Palo Alto Networks - High\nrisk IP addresses, Palo Alto Networks - Tor exit IP addresses, Palo\nAlto Networks - Bulletproof IP addresses\n• Destination tab: Destination Zone set to Any\n• Application tab: Application set to Any\n• Service/URL Category tab: Service set to Any\n• Actions tab: Action set to Block, Profile Type set to None\nNote: This recommendation requires a Palo Alto Networks \"Threat Prevention License\"\nNavigate to Policies > Security\nGo to default policies intrazone-default and interzone-default. On Actions tab,\nverify that log setting has Log at Session End is enabled.\nNavigate to Policies > Decryption. Verify SSL Forward Proxy is set for all traffic\ndestined to the Internet.\nVerify each Decryption Policy Rule:\n• Source tab: The Source Zone and/or Source Address should include all target\ninternal networks. Source User should include all target internal users\n• Destination tab: The Destination Zone should include the untrusted target\nzone (usually the internet). Destination Address is typically Any for an\ninternet destination.\nPage 190\n• Service/URL Category tab: Verify that all URL Category entries are included\nexcept financial-services, government and health-and-medicine (this list\nmay vary depending on your organization and its policies).\n• Options tab: Verify that the Type is set to SSL Forward Proxy\nNavigate to Policies > Decryption.\nVerify SSL Inbound Inspection is set appropriately for all untrusted traffic destined for\nservers using SSL or TLS.\nNavigate to Policies > Decryption. For each service published to the internet (or\nother untrusted zones), verify the following settings:\n• General tab: Name set to a descriptive name\n• Source: Source Zone set to the target zone (Internet in many cases). Source\nAddress set to the target address space (Any for internet traffic)\n• Destination tab: Destination Zone should be set to the appropriate zone, or\nAny. Destination Address set to the target host address\n• Options tab: Type set to SSL Inbound Inspection\nVerify the CA Certificate(s):\nNavigate to Device > Certificate Management > Certificates\n• Verify that appropriate internal certificates are imported, and that all certificates in\nthe list are valid. In particular, verify the Subject, Issuer, CA, Expires,\nAlgorithm and Usage fields\nPage 195\n• Alternatively, if an internal CA is implemented on the firewall, verify that target\nclients have the root certificate for this CA imported into their list of trusted\ncertificate authorities.\nVerify the Certificate Profile needed for the SSL Forward Proxy:\n• Navigate to Device > Certificate Management > Certificate Profile.\nVerify that an appropriate profile is created.",
    "remediation_steps": "Navigate to Network > Network Profiles > IKE Gateways.\nOn gateways that has IKEv2 enabled, click into it and navigate to Advanced Options.\nOn IKEv2 section, navigate to PQ PPK section.\nCheck Enable Post-Quantum Pre-Shared Key (PPK) option.\nNegotiation mode should be set to Mandatory if both sides of VPN supports PQ.\nNegotiation mode should be set to Preferred if you don't know or don't have control\nover whether the peer supports RFC 8784. Preferred mode preserves backward\ncompatibility to ensure connections fall back instead of dropping.\nIf both sides of VPN supports more than 1 PPK key ID, then multiple PPK key ID should\nbe configured. Configuring multiple PQ PPKs is most secure because it adds a random\nelement to PQ PPK selection.\nTo Set User-ID Agents:\nNavigate to Device > User Identification > User-ID Agents\nSet the Name, IP Address and Port of the User-ID Agent`\nEnable User Identification for each monitored zone that will have user accounts:\nNavigate to Network > Zone, for each relevant zone enable User\nIdentification\nTo Set Terminal Services Agents:\nPage 80\nNavigate to Device > Terminal Services Agents Set the Name, IP Address and\nPort of the Terminal Services Agent\nEnable User Identification for each monitored zone that will have Terminal Servers:\nNavigate to Network > Zone, enable User Identification\nNavigate to Device > User Identification > User Mapping > Palo Alto\nNetworks User ID Agent Setup.\nSet Enable Probing so it is unchecked.\nNavigate to Network > Network Profiles > Interface Management.\nSet User-ID to be checked only for interfaces that are both internal and trusted;\nuncheck it for all other interfaces.\nNavigate to Device > User Identification > User Mapping > Include/Exclude\nNetworks.\nSet all trusted internal networks to have a Discovery value of Include.\nSet all untrusted external networks to have a Discovery value of Exclude. Note that any\nvalue in the trusted networks list implies that all other networks are untrusted.\nNavigate to Active Directory Users and Computers.\nPage 88\nSet the service account for the User-ID agent so that it is only a member of the Event\nLog Readers, Distributed COM Users, and Domain Users (for the integrated, on-device\nUser-ID agent) or the Event Log Readers, Server Operators, and Domain Users groups\n(for the Windows User-ID agent.)\nNavigate to Active Directory Group Policies.\nSet Group Policies to restrict the interactive logon privilege for the User-ID service\naccount.\nor\nNavigate to Active Directory Managed Service Accounts.\nSet Managed Service Accounts to restrict the interactive logon privilege for the User-ID\nservice account.\nRemove this account from all groups that might grant remote access to the network, or\nto any network services or hosts. Remediation is operating-system dependent. For\ninstance, in Windows Active Directory, this account should be removed from any group\nthat grants the account access to VPN or Wireless access. In addition, domain\nadministrative accounts by default have remote desktop (RDP) access to all domain\nmember workstations - this should be explicitly denied for this account.\nNavigate to Device > Setup > Services > Services Features > Service Route\nConfiguration > Customize.\nClick on the protocol in use (IPv4 and/or IPv6).\nClick UID Agent.\nClick on the address object for the UID Agent's IP address.\nSet SOURCE/NAME to 'Deny msrpc to untrusted'.\nSet SOURCE/ZONE to 'INSIDE'.\nSet SOURCE/Address to the Address object for the UID Agent.\nSet DESTINATION/ZONE to 'GUEST' and 'OUTSIDE'.\nSet DESTINATION/Address to 'any'.\nSet DESTINATION/Application to 'msrpc'.\nSet DESTINATION/Service to 'application-default'.\nSet DESTINATION/Action to 'Block' (red circle with diagonal line).\nNavigate to Device > High Availability > HA Communications.\nClick HA Communications. Click Data Link (HA2). Select the correct interface.\nSelect the desired protocol (IPv4 or IPv6). Select the correct Transport. Set the\nEnable Session Synchronization box to be checked.\nChoose Save Configuration.\nTo set Link Monitoring from GUI:\nPage 100\nNavigate to Device > High Availability > Link and Path Monitoring. Click\nLink Monitoring. Set the correct interfaces to the Link Group and Group Failure\nConditions. Click Link Monitoring. Set Failure Condition to Any. Check Enabled\nbutton.\nTo set Path Monitoring from GUI:\nNavigate to Device > High Availability > Link and Path Monitoring. Click\nPath Monitoring. Set Option correctly. Set Failure Condition to Any. Set Name,\nIP Address, Failure Condition correctly. Set Default setting to Any. Check\nEnabled button.\nTo set Active/Passive Settings correctly:\nNavigate to Device > High Availability > General > Active/Passive\nSettings.\nSet Passive Link State to auto.\nTo set Election Settings correctly:\nNavigate to Device > High Availability > Election Settings.\nSet Preemptive to be disabled.\nPage 102\nNavigate to Device > Dynamic Updates > Antivirus Update Schedule.\nSet Action to Download and Install.\nSet Recurrence to Hourly.\nNavigate to Device > Dynamic Updates > Application and Threats Update\nSchedule.\nSet Action to Download and Install.\nSet Recurrence to Daily, Hourly or Every 30 Minutes\nNavigate to Device > Setup > WildFire.\nClick the General Settings edit icon.\nSet the maximum size for each file type are larger than the defaults, to a size that is as\nlarge enough to account for \"large\" files, but not large enough to affect performance of\nthe hardware.\nIn PAN-OS 9.x and higher, the default file sizes for WildFire are:\n• pe (Portable Executable) - 16MB\nPage 110\n• apk (Android Application)- 10MB\n• pdf (Portable Document Format) - 3072KB\n• ms-office (Microsoft Office) — 16384KB\n• jar (Packaged Java class file) — 5MB\n• flash (Adobe Flash) — 5MB\n• MacOSX (DMG/MAC-APP/MACH-O PKG files) — 10MB\n• archive (RAR and 7z files) — 50MB\n• linux (ELF files) — 50MB\n• script (JScript, VBScript, PowerShell, and Shell Script)- 20KB\nIn PAN-OS 9.x and higher, the maximum file sizes for Wildfire are:\n• pe (Portable Executable) - 50MB\n• apk (Android Application)- 50MB\n• pdf (Portable Document Format) - 51200KB\n• ms-office (Microsoft Office) — 51200KB\n• jar (Packaged Java class file) — 20MB\n• flash (Adobe Flash) — 10MB\n• MacOSX (DMG/MAC-APP/MACH-O PKG files) — 50MB\n• archive (RAR and 7z files) — 50MB\n• linux (ELF files) — 50MB\n• script (JScript, VBScript, PowerShell, and Shell Script)- 4096KB\nTo Set File Blocking Profile:\n• Navigate to Objects > Security Profiles > WildFire Analysis Profile.\nPage 113\n• Create a WildFire profile that has 'Application Any', 'File Types Any', and\n'Direction Both'\nTo Set WildFire Analysis Rules:\n• Navigate to Policies > Security.\n• For each Security Policy Rule where the action is \"Allow\", Navigate to Actions >\nProfile Setting > WildFire Analysis and set a WildFire Analysis profile.\nGroup Profiles can also be used. To take this approach:\n• Navigate to Objects > Security Profile Groups. Create a Security Profile\nGroup, and ensure that (among other settings) the Wildfire Analysis\nProfile is set to the created profile.\n• Navigate to Policies > Security. For each Security Policy Rule where the\naction is \"Allow\", Navigate to Actions > Profile Setting. Modify the Profile\nType to Group, and set the Group Profile to the created Security Profile Group.\nNavigate to Device > Setup > Content-ID > Content-ID Settings.\nSet Allow forwarding of decrypted content to be checked. Note that SSL\nForward Proxy must be configured for this setting to be effective.\nNavigate to Device > Setup > WildFire > Session Information Settings.\nSet every option to be enabled.\nFrom GUI, configure some combination of the following Server Profiles:\nConfigure the Email Server: Select Device > Server Profiles > Email Click Add\nEnter a name for the Profile. Select the virtual system from the Location drop down\nmenu (if applicable) Click Add\nConfigure the Syslog Server: Select Device > Server Profiles > Syslog > Add\nEnter Name, Display Name, Syslog Server, Transport, Port, Format,\nFacility Click OK Click Commit to save the configuration\nConfigure the SMTP Server: Select Device > Server Profiles > Email Select\nAdd, Name, Display Name, From, To, Additional Recipients, Gateway IP\nor Hostname Click OK Click Commit to save the configuration\nPage 119\nNavigate to Objects, Log Forwarding Choose Add, set the log type to \"wildfire\", add\nthe filter \"(verdict neq benign)\", then add log destinations for SNMP, Syslog, Email or\nHTTP as required.\nNavigate to Device > Dynamic Updates > WildFire Update Schedule.\nSet Recurrence is set to Real-time.\nNavigate to Device > Setup > WildFire.\nNavigate to the General Settings sections.\nClick the General Settings edit icon.\nChange the WildFire Public Cloud to your appropriate region.\nNavigate to Objects > Security Profiles > Antivirus.\nSet antivirus profiles to have all decoders set to reset-both for both Action and\nWildfire Action. If imap and pop3 are required in the organization, set the imap and\npop3 decoders to alert for both Action and Wildfire Action.\nNavigate to Policies > Security . For each policy, navigate to [Policy Name] >\nActions\nSet an Antivirus profile or a Profile Group containing an AV profile for each\nsecurity policy passing traffic - regardless of protocol.\nNavigate to Objects > Security Profiles > Anti-Spyware. Click on existing\nprofile in used or create a new profile.\nNavigate to Signature Policies tab. Add new policy by giving it a name Policy\nName.\nSet a Policy Name exists within the anti-spyware profile that is configured to perform\nthe reset-both on Critical, High, and Medium Severity level, any\nCategory, and any Threat Name.\nPage 130\nNavigate to Objects > Security Profiles > Anti-Spyware.\nWithin the each anti-spyware profile, under its DNS Policies tab, set the Signature\nSource List: default-paloalto-dns should have as its Policy Action set to\nsinkhole If licensed, the DNS Security should have as its Policy Action set to\nsinkhole\nVerify the 'Sinkhole IPv4' IP address is correct. This should be set to\nsinkhole.paloaltnetworks.com, or if an internal host is set then that host IP or\nFQDN should be in that field\nVerify the 'Sinkhole IPv6' IP address is correct. This should be set to IPv6 Loopback\nIP (::1), or if an internal DNS Sinkhole host is set then that host IP or FQDN should\nbe in that field\nNavigate to Policies > Security Policies For each outbound security Policy, in\nthe Actions tab, set the Anti-Spyware setting to include the Spyware Profile created,\neither explicitly or as a Group Profile\nNavigate to Objects > Security Profiles > Anti-Spyware.\nAlso navigate to Policies > Security.\nSet one or more anti-spyware profiles to collectively apply to all inside to outside traffic\nfrom any address to any address and any application and service.\nNavigate to Objects > Security Profiles > Vulnerability Protection.\nSet a Vulnerability Protection Profile to block attacks against any critical or high\nvulnerabilities (minimum), and to default on attacks against any medium, low, or\ninformational vulnerabilities.\nNavigate to Policies > Security.\nFor each Policy, under the Actions tab, select Vulnerability Protection.\nSet it to use either the 'Strict' or the 'Default' profile, or a custom profile that complies\nwith the organization's policies, legal and regulatory requirements.\nNavigate to Device > Licenses.\nClick on PAN-DB URL Filtering.\nSet Active to Yes.\nNavigate to Objects > Security Profiles > URL Filtering.\nSet a URL filter so that all URL categories designated by the organization are listed.\nNavigate to the Actions tab.\nSet the action to Block.\nNavigate to Objects > Security Profiles > URL Filtering.\nFor each permitted category, set the Site Access actioun to alert\nNavigate to Objects > Security Profiles > URL Filtering > URL Filtering\nProfile > URL Filtering Settings.\nPage 147\nSet the following four settings:\na. Log container page only box is un-checked\nb. Check the User-Agent box\nc. Check the Referer box\nd. Check the X-Forwarded-For box\nTo Set URL Filtering: For each Security Profile that transits traffic to the internet,\nnavigate to Policies > Security > Security Profiles > [Policy Name] >\nActions.\nSet a URL Filtering profile that complies with the policies of the organization is applied\nto all Security Policies that transit traffic to the public internet.\nNavigate to Objects > Custom Objects > Data Patterns.\nCreate an appropriate Data Pattern that accounts for sensitive information within your\norganization. In most cases this will include Credit Card Numbers, and your jurisdiction's\nequivalent of Social Insurance Numbers. In many cases these can simply be picked\nfrom the list of Predefined Patterns.\nNavigate to Objects > Security Profiles > Data Filtering.\nPage 151\nCreate appropriate Data Filtering Profile, using the created Data Patterns.\nEnsure that an Alert Threshold is set that generates alerts appropriately. A typical\nstarting value for Alert Threshold is 20, but this should be adjusted after appropriate\ntesting.\nNavigate to Objects > Custom Objects > Data Patterns. Add patterns to match\nthe various data that you wish to monitor or make blocking decisions on.\nPage 153\nNavigate to Objects > Security Profiles > Data Filtering Add a Filtering\nProfile that matches the data you wish to monitor, with appropriate values for Alert\nThreshold (typically 20), Block Threshold (typically 0) and Log Serverity\nFinally, apply the Filtering Profile to a Security Profile. Navigate to Policies >\nSecurity. Edit all appropriate policies, and for each Policy choose the Actions tab,\nand add the appropriate Data Filtering Policy (either as an individual Profile or\nas part of a Group Profile)\nFrom GUI:\nNavigate to Network > Network Profiles > Zone Protection > Zone\nProtection Profile > Flood Protection tab.\nCheck the SYN box. Set the Action dropdown to SYN Cookies Set Alert to 20000 (or\nappropriate for org). Set Activate to 25000 (50% of maximum for firewall model). Set\nMaximum to 1000000 (or appropriate for org)\nNavigate to Network > Zones. Open the zone facing any untrusted network, if one\ndoes not exist create it. Set Zone Protection to the Zone Protection Profile\ncreated.\nIn the GUI:\nNavigate to Network > Network Profiles > Zone Protection > Flood\nProtection.\nSet all settings to \"enabled\" with at least the default values.\nNavigate to Network > Zones, select each untrusted zone in turn, and set the Zone\nProtection Profile.\nNavigate to Network > Network Profiles > Zone Protection > Zone\nProtection Profile > Reconnaissance Protection.\nPage 160\nSet TCP Port Scan to enabled, its Action to block-ip, its Interval to 5, and its\nThreshold to 20. For block-ip, set the \"Track By\" is set to source and \"Duration\" is set\nto 600 seconds.\nSet Host Sweep to enabled, its Action to block, its Interval to 10, and its Threshold to\n30.\nSet UDP Port Scan to enabled, its Action to alert, its Interval to 10, and its Threshold\nto 20.\nNavigate to Network > Network Profiles > Zone Protection > Zone\nProtection Profile > Packet Based Attack Protection > TCP/IP Drop.\nSet Spoofed IP address to be checked.\nSet Mismatched overlapping TCP segment to be checked.\nUnder IP Option Drop, set Strict Source Routing, Loose Source Routing, and\nMalformed to all be checked. Additional options may also be set if desired.\nNavigate to Objects > Security Profiles > URL Filtering.\nChoose the Categories tab. Set the User Credential Submitting action on all\nenabled URL categories is either block or continue, as appropriate to your\norganization and the category.\nPage 164\nUnder the User Credential Detection tab set the User Credential Detection\nvalue to a setting appropriate to your organization, any value except Disabled. Set the\nLog Severity to a value appropriate to your organization and your logging or SIEM\nsolution.\nNavigate to Objects > Security Profiles > Antivirus\nSet antivirus profiles to have all decoders set to reset-both for Wildfire Inline ML\nAction. If imap and pop3 are required in the organization, set the imap and pop3\ndecoders are set to alert for Wildfire Inline ML Action.\nNavigate to Objects > Security Profiles > Antivirus\nGo to Wildfire Inline ML tab. Set enable (inherit per-protocol actions) for\nall Model on Action Setting.\nNavigate to Objects > Security Profiles > Vulnerability Protection\nGo to Inline Cloud Analysis tab. Tick the checkbox for Enable cloud inline\nanalysis. Verify that all Model action is set as alert.\nNote that, firewall device certificate is used to authenticate to the Advanced Threat\nPrevention inline cloud analysis service. This step is required before 'Inline Cloud\nAnalysis' can be used. Refer to reference for detailed guide.\nNavigate to Objects > Security Profiles > URL Filtering\nGo to Inline Categorization tab. Tick the checkbox for both Enable local inline\ncategorization and Enable cloud inline categorization.\nNote that:\n1. Firewall device certificate is used to authenticate to the Advanced Threat\nPrevention inline cloud analysis service. This step is required before 'Inline Cloud\nAnalysis' can be used. Refer to reference for detailed guide.\n2. 'Local Inline Categorization' can be enabled with just the URL Filtering license\n(no Advanced Threat Prevention is needed).\nNavigate to Objects > Security Profiles > Anti-Spyware\nGo to Inline Cloud Analysis tab. Tick the checkbox for Enable cloud inline\nanalysis. Verify that all Model action is set as reset-both.\nNote that, firewall device certificate is used to authenticate to the Advanced Threat\nPrevention inline cloud analysis service. This step is required before Inline Cloud\nAnalysis can be used. Refer to reference for detailed guide.\nNavigate to Objects > Security Profiles > Anti-Spyware\nGo to DNS Policies tab. Configure policy action to sinkhole for all DNS Security\ncategories.\nOn Command and control Domains category, set the packet capture option to\nextended-capture.\nPage 176\nNavigate to Policies > Security.\nFor all Security Policies that transit from a less trusted to a more trusted interface,\nset the Application and Service values to match the exposed application. For\ninstance, for a web server exposed to the internet from a DMZ: Source tab: Zone set to\nOUTSIDE / Address set to Any Destination tab: Zone set to DMZ / Address set to [DMZ\nHost Object] Application tab: set to web-browsing Service/URL Category tab:\nset Service to ether:\n• application-default or:\n• service-http and/or service-https\n**Enhanced Security Recommendation: **\nSet these values for Policies on all Interfaces, for traffic in all directions. For each\nSecurity Policy, set the Application and Service values to match the exposed\napplication.\nNavigate to Policies > Security.\nFor each exposed host, set a Security Policy exists with:\n• Source tab: Zone set to OUTSIDE Address set to any\n• Destination tab: Zone set to DMZ / Address set to <DMZ Host Object>\n• Application tab: Application set to web-browsing (or appropriate\napplication)\nPage 182\n• Service tab: Service set to application-default. The value of any should\nnever be used\nNavigate to Policies > Security\nCreate a Security Policy similar to:\n• General tab: Name set to Deny to Malicious IP\n• Source tab: Source Zone set to Any,\n• Destination tab: Destination Zone set to Any, Destination Address set to\nPalo Alto Networks - Known malicious IP addresses,Palo Alto\nNetworks - High risk IP addresses, Palo Alto Networks - Tor exit\nIP addresses, Palo Alto Networks - Bulletproof IP addresses\n• Application tab: Application set to Any\n• Service/URL Category tab: Service set to Any\n• Actions tab: Action set to Block, Profile Type set to None\nCreate a Security Policy similar to:\n• General tab: Name set to Deny from Malicious IP\n• Source tab: Source Zone set to Any, Source Address set to Palo Alto\nNetworks - Known malicious IP addresses,Palo Alto Networks - High\nrisk IP addresses, Palo Alto Networks - Tor exit IP addresses, Palo\nAlto Networks - Bulletproof IP addresses\n• Destination tab: Destination Zone set to Any\n• Application tab: Application set to Any\n• Service/URL Category tab: Service set to Any\n• Actions tab: Action set to Block, Profile Type set to None\nNote: This recommendation requires a Palo Alto Networks \"Threat Prevention License\"\nNavigate to Policies > Security\nGo to default policies intrazone-default and interzone-default. On Actions tab,\nenable Log at Session End on log setting.\nNavigate to Policies > Decryption. Create a Policy for all traffic destined to the\nInternet. This Policy should include:\n• Source tab: The Source Zone and/or Source Address should include all target\ninternal networks. Source User should include all target internal users\n• Destination tab: The Destination Zone should include the untrusted target\nzone (usually the internet). Destination Address is typically Any for an\ninternet destination.\n• Service/URL Category tab: all URL Category entries should be included\nexcept financial-services, government and health-and-medicine (this list\nmay vary depending on your organization and its policies).\n• Options tab: Type set to SSL Forward Proxy\nNavigate to Policies > Decryption.\nSet SSL Inbound Inspection appropriately for all untrusted traffic destined for servers\nusing SSL or TLS.\nNavigate to Policies > Decryption. For each service published to the internet (or\nother untrusted zones), create a Policy and set the following options:\nPage 193\n• General tab: Name set to a descriptive name\n• Source: Source Zone set to the target zone (Internet in many cases). Source\nAddress set to the target address space (Any for internet traffic)\n• Destination tab: Destination Zone should be set to the appropriate zone, or\nAny. Destination Address set to the target host address\n• Options tab: Type set to SSL Inbound Inspection\nSet the CA Certificate(s):\nNavigate to Device > Certificate Management > Certificates. Import the\nappropriate CA Certificates from any internal Certificate Authorities.\nAlternatively, generate a self-signed certificate for an internal CA on the firewall, and\nthen import the root certificate for that CA into the trusted CA list of target clients. In an\nActive Directory environment this can be facilitated using a Group Policy.\nSet the Certificate Profile needed for the SSL Forward Proxy:\n• Navigate to Device > Certificate Management > Certificate Profile.\nSet the decryption profile to include the settings described in the SSL Forward Proxy\nguidance in this document",
    "severity": "Manual",
    "is_active": true,
    "references_text": "1. “PAN-OS Administrator's Guide 11.1 (English) - Network Security\" -\nhttps://docs.paloaltonetworks.com/network-security/quantum-\nsecurity/administration/configure-quantum-resistant-ikev2-vpns/configure-post-\nquantum-ikev2-vpns\n1. “Best Practices for Securing User-ID Deployments” -\nhttps://live.paloaltonetworks.com/docs/DOC-7912\n2. “How to Configure Group Mapping settings?” -\nhttps://live.paloaltonetworks.com/docs/DOC-4994\n3. https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/user-id\n4. https://paloaltonetworks.com/content/dam/paloaltonetworks-\ncom/en_US/assets/pdf/tech-briefs/techbrief-user-id.pdf\n1. “R7-2014-16: Palo Alto Networks User-ID Credential Exposure” -\nhttps://blog.rapid7.com/2014/10/14/palo-alto-networks-userid-credential-\nexposure/\n2. “Best Practices for Securing User-ID Deployments” -\nhttps://live.paloaltonetworks.com/docs/DOC-7912\n3. “PAN-OS Administrator's Guide 11.1 (English) - Client Probing\" -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/user-id/user-id-\nconcepts/user-mapping/client-probing\n1. “Customer advisory: Security Impact of User-ID Misconfiguration” -\nhttps://live.paloaltonetworks.com/docs/DOC-8125\n2. “R7-2014-16: Palo Alto Networks User-ID Credential Exposure” -\nhttps://blog.rapid7.com/2014/10/14/palo-alto-networks-userid-credential-\nexposure/\nPage 84\n3. “Best Practices for Securing User-ID Deployments” -\nhttps://live.paloaltonetworks.com/docs/DOC-7912\n4. “User-ID Best Practices” - https://live.paloaltonetworks.com/docs/DOC-6591\n5. “PAN-OS Administrator's Guide 11.1 (English) - Client Probing\" -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/user-id/user-id-\nconcepts/user-mapping/client-probing\n1. Best Practices for Securing User-ID Deployments -\nhttps://live.paloaltonetworks.com/docs/DOC-7912\n1. “Best Practices for Securing User-ID Deployments” -\nhttps://live.paloaltonetworks.com/docs/DOC-7912\n2. “User-ID Best Practices” - https://live.paloaltonetworks.com/docs/DOC-6591\n3. “PAN-OS Administrator's Guide 11.1 (English) - Configure User Mapping Using\nthe Windows User-ID Agent” - https://docs.paloaltonetworks.com/pan-os/11-\n1/pan-os-admin/user-id/map-ip-addresses-to-users/configure-user-mapping-\nusing-the-windows-user-id-agent\n4. “PAN-OS Administrator's Guide 11.1 (English) - Configure User Mapping Using\nthe PAN-OS Integrated User-ID Agent” - https://docs.paloaltonetworks.com/pan-\nos/11-1/pan-os-admin/user-id/map-ip-addresses-to-users/configure-user-\nmapping-using-the-pan-os-integrated-user-id-agent\n1. “Best Practices for Securing User-ID Deployments” -\nhttps://live.paloaltonetworks.com/docs/DOC-7912\n2. “PAN-OS Administrator's Guide 11.1 (English) - Configure User Mapping Using\nthe Windows User-ID Agent” - https://docs.paloaltonetworks.com/pan-os/11-\n1/pan-os-admin/user-id/map-ip-addresses-to-users/configure-user-mapping-\nusing-the-windows-user-id-agent\n3. “PAN-OS Administrator's Guide 11.1 (English) - Configure User Mapping Using\nthe PAN-OS Integrated User-ID Agent” - https://docs.paloaltonetworks.com/pan-\nos/11-1/pan-os-admin/user-id/map-ip-addresses-to-users/configure-user-\nmapping-using-the-pan-os-integrated-user-id-agent\n4. “User-ID Best Practices” - https://live.paloaltonetworks.com/docs/DOC-6591\n1. “Best Practices for Securing User-ID Deployments” -\nhttps://live.paloaltonetworks.com/docs/DOC-7912\n2. “User-ID Best Practices” - https://live.paloaltonetworks.com/docs/DOC-6591\n3. “PAN-OS Administrator's Guide 11.1 (English) - Configure User Mapping Using\nthe Windows User-ID Agent” - https://docs.paloaltonetworks.com/pan-os/11-\nPage 92\n1/pan-os-admin/user-id/map-ip-addresses-to-users/configure-user-mapping-\nusing-the-windows-user-id-agent\n4. “PAN-OS Administrator's Guide 11.1 (English) - Configure User Mapping Using\nthe PAN-OS Integrated User-ID Agent” - https://docs.paloaltonetworks.com/pan-\nos/11-1/pan-os-admin/user-id/map-ip-addresses-to-users/configure-user-\nmapping-using-the-pan-os-integrated-user-id-agent\n1. “Best Practices for Securing User-ID Deployments” -\nhttps://live.paloaltonetworks.com/docs/DOC-7912\n2. “User-ID Best Practices” - https://live.paloaltonetworks.com/docs/DOC-6591\n3. “PAN-OS Administrator's Guide 11.1 (English) - Configure User Mapping Using\nthe Windows User-ID Agent” - https://docs.paloaltonetworks.com/pan-os/11-\n1/pan-os-admin/user-id/map-ip-addresses-to-users/configure-user-mapping-\nusing-the-windows-user-id-agent\n4. “PAN-OS Administrator's Guide 11.1 (English) - Configure User Mapping Using\nthe PAN-OS Integrated User-ID Agent” - https://docs.paloaltonetworks.com/pan-\nos/11-1/pan-os-admin/user-id/map-ip-addresses-to-users/configure-user-\nmapping-using-the-pan-os-integrated-user-id-agent\n1. “PAN-OS Administrator's Guide 11.1 (English) - High Availability\" -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-\nhelp/device/device-high-availability\n1. “PAN-OS Administrator's Guide 11.1 (English) - High Availability\" -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-\nhelp/device/device-high-availability\n1. “PAN-OS Administrator's Guide 11.1 (English) - High Availability\" -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-\nhelp/device/device-high-availability\n1. “Tips for Managing Content Updates” -\nhttps://live.paloaltonetworks.com/docs/DOC-1578\n2. “PAN-OS Administrator's Guide 9.0 (English) -Dynamic Content Updates\" -\nhttps://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/software-and-\ncontent-updates/dynamic-content-updates.html\n3. “PAN-OS Administrator's Guide 9.0 (English) - Install Content Updates\" -\nhttps://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/software-and-\ncontent-updates/install-content-and-software-updates.html\nPage 105\n1. “Tips for Managing Content Updates” -\nhttps://live.paloaltonetworks.com/docs/DOC-1578\n2. “PAN-OS Administrator's Guide 9.0 (English) -Dynamic Content Updates\" -\nhttps://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/software-and-\ncontent-updates/dynamic-content-updates.html\nPage 107\n3. “PAN-OS Administrator's Guide 9.0 (English) - Install Content Updates\" -\nhttps://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/software-and-\ncontent-updates/install-content-and-software-updates.html\n1. “How to Configure WildFire” - https://live.paloaltonetworks.com/docs/DOC-3252\n2. https://docs.paloaltonetworks.com/wildfire/10-2/wildfire-admin/wildfire-\ndeployment-best-practices/wildfire-best-practices\nPage 111\n1. “Wildfire Administrator's Guide 9.0 (English)\" -\nhttps://docs.paloaltonetworks.com/wildfire/9-0/wildfire-admin.html\n1. “WildFire Fails Forwarding File to Cloud for Encrypted Traffic” -\nhttps://live.paloaltonetworks.com/docs/DOC-6845\n2. “Wildfire Administrator's Guide 9.0 (English) - Forward Decrypted SSL Traffic for\nWildfire Analysis\" - https://docs.paloaltonetworks.com/wildfire/9-0/wildfire-\nadmin/submit-files-for-wildfire-analysis/forward-decrypted-ssl-traffic-for-wildfire-\nanalysis.html#\n3. “Wildfire Administrator's Guide 9.0 (English) - Wildfire Best Practices\" -\nhttps://docs.paloaltonetworks.com/wildfire/9-0/wildfire-admin/wildfire-deployment-\nbest-practices/wildfire-best-practices.html#\nPage 115\n1. “Wildfire Administrator's Guide 9.0 (English)\" -\nhttps://docs.paloaltonetworks.com/wildfire/9-0/wildfire-admin.html#\n2. “Wildfire Administrator's Guide 9.0 (English) - Wildfire Best Practices\" -\n/https://docs.paloaltonetworks.com/wildfire/9-0/wildfire-admin/wildfire-\ndeployment-best-practices/wildfire-best-practices.html\n1. “WildFire Email Alerts: Subscribe or Add Additional Recipients” -\nhttps://live.paloaltonetworks.com/docs/DOC-7740\n2. “Wildfire Administrator's Guide 9.0 (English)\" -\nhttps://docs.paloaltonetworks.com/wildfire/9-0/wildfire-admin.html\n1. “Wildfire What's New in 10.0 (English)\" -\nhttps://docs.paloaltonetworks.com/wildfire/u-v/wildfire-whats-new/wildfire-\nfeatures-in-panos-100/wildfire-real-time-signature-updates\n2. “How to Configure WildFire” - https://live.paloaltonetworks.com/docs/DOC-3252\n3. “Tips for Managing Content Updates” -\nhttps://live.paloaltonetworks.com/docs/DOC-1578\nPage 121\n1. \"List of Available Wildfire Regions\" -\nhttps://docs.paloaltonetworks.com/advanced-wildfire/administration/advanced-\nwildfire-overview/advanced-wildfire-deployments/advanced-wildfire-global-cloud\n2. \"Announcements as More Regions are Added\" -\nhttps://docs.paloaltonetworks.com/wildfire\n1. “Threat Prevention Deployment Tech Note” -\nhttps://live.paloaltonetworks.com/docs/DOC-3094\nPage 126\n2. “PAN-OS Administrator's Guide 11.1 (English) - Security Profiles” -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/policy/security-\nprofiles\n3. \"KB on reset-server, reset-client or silent drop\" -\nhttps://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA10g000000\nClTaCAK\n1. “PAN-OS Administrator's Guide 11.1 (English) - Security Policies ” -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/policy/security-\npolicy\nPage 128\n2. “PAN-OS Administrator's Guide 11.1 (English) - Security Profiles” -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/policy/security-\nprofiles\n1. \"PAN OS Administrator's Guide 11.1 (English) - Anti-Spyware Profile\" -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-\nhelp/objects/objects-security-profiles-anti-spyware-profile\n1. “How to Deal with Conficker using DNS Sinkhole” -\nhttps://live.paloaltonetworks.com/docs/DOC-6628\n2. “Threat Prevention Deployment Tech Note” -\nhttps://live.paloaltonetworks.com/docs/DOC-3094\n3. \"PAN OS Administrator's Guide 11.1 (English) - Anti-Spyware Profile\" -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-\nhelp/objects/objects-security-profiles-anti-spyware-profile\nPage 133\n1. “Threat Prevention Deployment Tech Note” -\nhttps://live.paloaltonetworks.com/docs/DOC-3094\nPage 135\n2. “PAN-OS Administrator's Guide 9.0 (English) - Security Profiles” -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/policy/security-\nprofiles\n1. “Threat Prevention Deployment Tech Note” -\nhttps://live.paloaltonetworks.com/docs/DOC-3094\nPage 137\n2. “PAN-OS Administrator's Guide 11.1 (English) - Security Profiles” -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/policy/security-\nprofiles\n1. “Threat Prevention Deployment Tech Note” -\nhttps://live.paloaltonetworks.com/docs/DOC-3094\n2. “PAN-OS Administrator's Guide 11.1 (English) - Security Policies” -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/policy/security-\npolicy\n3. “PAN-OS Administrator's Guide 11.1 (English) - Security Profiles” -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/policy/security-\nprofiles\n1. “PAN-OS Administrator's Guide 9.0 (English) - URL Filtering” -\nhttps://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/url-filtering.html\nPage 141\n2. “PAN-OS Administrator's Guide 9.0 (English) - URL Filtering Best Practices\" -\nhttps://docs.paloaltonetworks.com/advanced-url-\nfiltering/administration/configuring-url-filtering/url-filtering-best-practices\n1. “PAN-OS Administrator's Guide 11.1 (English) - Security Profiles” -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/policy/security-\nprofiles\n2. “PAN-OS Administrator's Guide 9.0 (English) - URL Filtering” -\nhttps://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/url-filtering.html\n3. “PAN-OS Admin Guide 9.0 (English) - URL Filtering Best Practices\" -\nhttps://docs.paloaltonetworks.com/advanced-url-\nfiltering/administration/configuring-url-filtering/url-filtering-best-practices\n1. “PAN-OS Administrator's Guide 11.1 (English) - URL Filtering Best Practices\" -\nhttps://docs.paloaltonetworks.com/advanced-url-\nfiltering/administration/configuring-url-filtering/url-filtering-best-practices\n2. “PAN-OS Administrator's Guide 9.0 (English) - URL Filtering” -\nhttps://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/url-filtering.html\nPage 145\n1. “PAN-OS Administrator's Guide 11.1 (English) - URL Filtering Best Practices\" -\nhttps://docs.paloaltonetworks.com/advanced-url-\nfiltering/administration/configuring-url-filtering/url-filtering-best-practices\n1. “PAN-OS Administrator's Guide 11.1 (English) - URL Filtering Best Practices\" -\nhttps://docs.paloaltonetworks.com/advanced-url-\nfiltering/administration/configuring-url-filtering/url-filtering-best-practices\n1. “What are the Data Filtering Best Practices?” -\nhttps://live.paloaltonetworks.com/docs/DOC-2513\n2. “PAN-OS Administrator's Guide 9.0 (English) - Setting up Data Filtering\" -\nhttps://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/threat-\nprevention/set-up-data-filtering.html#\n1. “PAN-OS Administrator's Guide 9.0 (English) - Setting up Data Filtering\" -\nhttps://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/threat-\nprevention/set-up-data-filtering.html#\n1. “Understanding DoS Protection” - https://live.paloaltonetworks.com/docs/DOC-\n5078\n2. \"Syn Cookie Operation” - https://live.paloaltonetworks.com/docs/DOC-1542\n3. “How to Determine if Configured DoS Classify TCP SYN Cookie Alarm, Activate\nand Maximal Rate is Triggered” - https://live.paloaltonetworks.com/docs/DOC-\n6801\n4. “Threat Prevention Deployment Tech Note” -\nhttps://live.paloaltonetworks.com/docs/DOC-3094\nPage 156\n5. “What are the Differences between DoS Protection and Zone Protection?” -\nhttps://live.paloaltonetworks.com/docs/DOC-4501\n6. “Application DDoS Mitigation” - https://live.paloaltonetworks.com/docs/DOC-7158\n7. PANOS 11.1 Admin Guide - Zone Protection . Flood Protection -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-\nhelp/network/network-network-profiles/network-network-profiles-zone-\nprotection/flood-protection\n1. “Understanding DoS Protection” - https://live.paloaltonetworks.com/docs/DOC-\n5078\n2. “Threat Prevention Deployment Tech Note” -\nhttps://live.paloaltonetworks.com/docs/DOC-3094\n3. “What are the Differences between DoS Protection and Zone Protection?” -\nhttps://live.paloaltonetworks.com/docs/DOC-4501\n4. PANOS 11.1 Admin Guide - Network Profiles / Zone Protection / Flood Protection\n- https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-\nhelp/network/network-network-profiles/network-network-profiles-zone-\nprotection/flood-protection\n1. “Host Sweep Triggering Method in Zone Protection Profile” -\nhttps://live.paloaltonetworks.com/docs/DOC-8703\n2. “Understanding DoS Protection” - https://live.paloaltonetworks.com/docs/DOC-\n5078\n3. “Threat Prevention Deployment Tech Note” -\nhttps://live.paloaltonetworks.com/docs/DOC-3094\n4. “What are the Differences between DoS Protection and Zone Protection?” -\nhttps://live.paloaltonetworks.com/docs/DOC-4501\n5. PANOS 11.1 Admin Guide - Network Profiles / Zone Protection /\nReconnaissance Protection - https://docs.paloaltonetworks.com/pan-os/11-\n1/pan-os-web-interface-help/network/network-network-profiles/network-network-\nprofiles-zone-protection/reconnaissance-protection\n1. “Understanding DoS Protection” - https://live.paloaltonetworks.com/docs/DOC-\n5078\n2. “Threat Prevention Deployment Tech Note” -\nhttps://live.paloaltonetworks.com/docs/DOC-3094\n3. “What are the Differences between DoS Protection and Zone Protection?” -\nhttps://live.paloaltonetworks.com/docs/DOC-4501\n4. PANOS 11.1 Admin Guide - Network Profiles / Zone Protection / Packet Based\nAttack Protection - https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-\ninterface-help/network/network-network-profiles/network-network-profiles-zone-\nprotection/packet-based-attack-protection\n1. PAN OS 11.1 Admin Guide - URL Filtering / User Credential Detection -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-\nhelp/objects/objects-security-profiles-url-filtering/user-credential-detection\n1. “PAN-OS Administrator's Guide 11.1 (English) - Security Profiles” -\nhttps://docs.paloaltonetworks.com/advanced-wildfire/administration/configure-\nadvanced-wildfire-analysis/enable-advanced-wildfire-inline-ml\n1. “PAN-OS Administrator's Guide 11.1 (English) - Security Profiles” -\nhttps://docs.paloaltonetworks.com/advanced-wildfire/administration/configure-\nadvanced-wildfire-analysis/enable-advanced-wildfire-inline-ml\nPage 168\n1. “Configuring Vulnerability Protection Inline Cloud Analysis Guide (English)” -\nhttps://docs.paloaltonetworks.com/pan-os/11-0/pan-os-new-features/content-\ninspection-features/vuln-protection-inline-cloud-analysis\n1. “Configuring Cloud Inline Categorization for URL Filtering Guide (English)” -\nhttps://docs.paloaltonetworks.com/pan-os/10-2/pan-os-new-features/url-filtering-\nfeatures/cloud-inline-categorization\n2. “PAN-OS Administrator's Guide 11.1 (English) - Inline Categorization” -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-\nhelp/objects/objects-security-profiles-url-filtering/inline-categorization\n1. “Configuring Inline Cloud Analysis Guide (English)” -\nhttps://docs.paloaltonetworks.com/advanced-threat-\nprevention/administration/configure-threat-prevention/configure-inline-cloud-\nanalysis#idcf1fc426-b522-4e84-9098-ac82f2d784ae\n1. “Configuring DNS Security” - https://docs.paloaltonetworks.com/dns-\nsecurity/administration/configure-dns-security/enable-dns-security#tabs-\nid066476b2-c4dd-4fc0-b7e4-f4ba32e19f60\n2. \"DNS Security Best Practices\" - https://docs.paloaltonetworks.com/advanced-\nthreat-prevention/administration/threat-prevention/best-practices-for-securing-\nyour-network-from-layer-4-and-layer-7-evasions\n1. “PAN-OS Administrator's Guide 11.1 (English) - Security Policies / Applications\nand Usage ” - https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-\ninterface-help/policies/policies-security/applications-and-usage\nPage 180\n1. “Security Policy Guidelines” - https://live.paloaltonetworks.com/docs/DOC-3469\n2. “Security Bulletin: App-ID Cache Pollution” -\nhttp://researchcenter.paloaltonetworks.com/2012/12/app-id-cache-pollution-\nresponse/\n3. “PAN-OS Administrator's Guide 11.1 (English) - Security Policiy Overview ” -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-\nhelp/policies/policies-security/security-policy-overview\n1. \"PAN-OS 11.1 Admin Guide: Built-in External Dynamic Lists\":\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/policy/use-an-\nexternal-dynamic-list-in-policy/built-in-edls\n1. “Gateway Firewall Best Practices on Default Policies Logging Configuration” -\nhttps://docs.paloaltonetworks.com/best-practices/internet-gateway-best-\npractices/best-practice-internet-gateway-security-policy/define-the-initial-internet-\ngateway-security-policy/step-5-enable-logging-for-traffic-that-doesnt-match-any-\nrules\n2. “Datacenter Firewall Best Practices on Default Policies Logging Configuration” -\nhttps://docs.paloaltonetworks.com/best-practices/10-2/data-center-best-\npractices/data-center-best-practice-security-policy/log-and-monitor-data-center-\ntraffic/log-intra-data-center-traffic-that-matches-the-intrazone-allow-rule\nPage 187\n1. “How to Implement SSL Decryption” -\nhttps://live.paloaltonetworks.com/docs/DOC-1412\n2. ““PAN-OS Administrator's Guide 11.1 (English) - Decryption (English)” -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/decryption\n1. “How to Implement SSL Decryption” -\nhttps://live.paloaltonetworks.com/docs/DOC-1412\n2. “PAN-OS Administrator's Guide 11.1 (English) - Decryption (English)” -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/decryption\n1. \"How to Implement and Test SSL Decryption\" -\nhttps://live.paloaltonetworks.com/t5/Configuration-Articles/How-to-Implement-\nand-Test-SSL-Decryption/ta-p/59719\n2. “PAN-OS Administrator's Guide 11.1 (English) - Decryption (English)” -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/decryption\n3. \"SSL Certificates Resource List on Configuring and Troubleshooting\" -\nhttps://live.paloaltonetworks.com/t5/Management-Articles/SSL-certificates-\nresource-list/ta-p/53068\n4. \"Certificates\" - http://palo-alto.wikia.com/wiki/Certificates\nPage 196",
    "audit": "Navigate to Network > Network Profiles > IKE Gateways.\nOn gateways that has IKEv2 enabled, click into it and navigate to Advanced Options.\nOn IKEv2 section, navigate to PQ PPK section.\nVerify that Enable Post-Quantum Pre-Shared Key (PPK) is checked.\nNegotiation mode should be set to Mandatory if both sides of VPN supports PQ.\nNegotiation mode should be set to Preferred if you don't know or don't have control\nover whether the peer supports RFC 8784. Preferred mode preserves backward\ncompatibility to ensure connections fall back instead of dropping.\nIf both sides of VPN supports more than 1 PPK key ID, then multiple PPK key ID should\nbe configured. Configuring multiple PQ PPKs is most secure because it adds a random\nelement to PQ PPK selection.\nPage 77\nTo validate if this recommendation has been met, look at the Source User column in\nthe URL Filtering or Traffic logs (Monitor > Logs > URL Filtering and Logs >\nTraffic Logs, respectively.)\nUser traffic originating from a trusted zone should identify a username.\nNavigate to Device > User Identification > User Mapping > Palo Alto\nNetworks User ID Agent Setup.\nVerify that Enable Probing is not checked.\nNavigate to Network > Network Profiles > Interface Management.\nVerify that User-ID is only enabled for interfaces that are both internal and trusted.\nNavigate to Device > User Identification > User Mapping > Include/Exclude\nNetworks.\nVerify that all trusted internal networks have a Discovery value of Include.\nVerify that all untrusted external networks have a Discovery value of Exclude. Note that\nany value in the trusted networks list implies that all other networks are untrusted.\nNavigate to Active Directory Users and Computers for the Active Directory under\nconsideration.\nVerify that the service account for the User-ID agent is not a member of any groups\nother than Event Log Readers, Distributed COM Users, and Domain Users (for the\nintegrated, on-device User-ID agent) or Event Log Readers, Server Operators, and\nDomain Users (for the Windows User-ID agent.)\nNavigate to Active Directory Group Policies.\nVerify that Group Policies restricts the interactive logon privilege for the User-ID service\naccount.\nor\nNavigate to Active Directory Managed Service Accounts.\nVerify that Managed Service Accounts restricts the interactive logon privilege for the\nUser-ID service account.\nAuditing is operating-system dependent. For instance, in Windows Active Directory, this\naccount should not be included in any group that grants the account access to VPN or\nWireless access. In addition, domain administrative accounts should not have remote\ndesktop (RDP) access to all domain member workstations.\nNavigate to Device > Setup > Services > Services Features > Service Route\nConfiguration > Customize.\nClick on the protocol in use (IPv4 and/or IPv6).\nClick UID Agent.\nClick on the address object for the UID Agent's IP address.\nVerify SOURCE/NAME is set to 'Deny msrpc to untrusted'.\nVerify SOURCE/ZONE is set to 'INSIDE'.\nVerify SOURCE/Address is set to the Address object for the UID Agent.\nVerify DESTINATION/ZONE is set to 'GUEST' and 'OUTSIDE'.\nVerify DESTINATION/Address is set to 'any'.\nVerify DESTINATION/Application is set to 'msrpc'.\nVerify DESTINATION/Service is set to 'application-default'.\nVerify DESTINATION/Action is set to 'Block' (red circle with diagonal line).\nPage 94\nNavigate to Device > High Availability > HA Communications.\nIn the HA Communications. >Data Link (HA2) section, verify that the correct\ninterface is selected. Verify the desired protocol (IPv4 or IPv6) is selected. Verify\nthe correct Transport is selected. Verify the Enable Session Synchronization box is\nchecked.\nTo verify Link Monitoring from GUI:\nNavigate to Device > High Availability > Link and Path Monitoring. In the\nLink Monitoring section, verify the correct interfaces are in the Link Group and\nGroup Failure Conditions Under the Link Monitoring section, verify Failure\nCondition is set to Any. Verify Enabled button is checked.\nTo verify Path Monitoring from GUI:\nNavigate to Device > High Availability > Link and Path Monitoring. In the\nPath Monitoring section, verify Option is set correctly. Verify Failure Condition is\nset to Any. Verify Name, IP Address, Failure Condition is set correctly. Verify\nDefault setting is set to Any. Verify Enabled button is checked.\nTo ensure Active/Passive Settings are configured correctly:\nNavigate to Device > High Availability > General > Active/Passive\nSettings.\nVerify Passive Link State is set to auto.\nTo ensure Election Settings are configured correctly:\nNavigate to Device > High Availability > Election Settings.\nVerify Preemptive is disabled.\nNavigate to Device > Dynamic Updates > Antivirus Update Schedule.\nVerify that Action is set to Download and Install.\nVerify that Recurrence is set to Hourly.\nNavigate to Device > Dynamic Updates > Application and Threats Update\nSchedule.\nVerify that Action is set to Download and Install.\nVerify that Recurrence is set to Daily, Hourly or Every 30 Minutes\nNavigate to Device > Setup > WildFire.\nNavigate to the General Settings sections.\nVerify the maximum size for each file type at the defaults or larger, to a size that is as\nlarge enough to account for \"large\" files, but not large enough to affect performance of\nthe hardware.\nTo verify WildFire Analysis Profile:\n• Navigate to Objects > Security Profiles > WildFire Analysis Profile\nverify that a profile exists.\nTo verify File Blocking Rules:\n• For each Security Policy were the action is set to Allow, edit the Rule and\nnavigate to Actions > Profile Setting. Ensure that the WildFire\nAnalysis is set to Allow and verify that a profile is set.\nIf Group Profiles are used:\n• Navigate to Policies > Security\n• For each Security Policy were the action is set to Allow, edit the Rule and\nnavigate to Actions > Profile Setting. Ensure that the Profile Type is set\nto Group.\n• Navigate to Objects > Security Profile Groups. Open the Security Profile Group\nused above, and ensure that the Wildfire Analysis Profile is set.\nNavigate to Device > Setup > Content-ID > Content-ID Settings.\nVerify that Allow forwarding of decrypted content is checked.\nNavigate to Device > Setup > WildFire > Session Information Settings.\nVerify that every option is enabled.\nNavigate to Objects > Log Forwarding.\nVerify that the WildFire log type is configured to generate alerts using the desired\nalerting mechanism(s).\nNavigate to Device > Dynamic Updates > WildFire Update Schedule.\nVerify that Recurrence is set to Real-time.\nNavigate to Device > Setup > WildFire.\nNavigate to the General Settings sections.\nVerify that WildFire Public Cloud is set to your appropriate region.\nNavigate to Objects > Security Profiles > Antivirus\nVerify that antivirus profiles have all decoders set to reset-both for both Action and\nWildfire Action. If imap and pop3 are required in the organization, verify that the\nimap and pop3 decoders are set to alert for both Action and Wildfire Action.\nNavigate to Policies > Security . For each policy, navigate to [Policy Name] >\nActions Verify there is a secure Antivirus profile applied to all security policies\npassing traffic - regardless of protocol. This can be set by Profiles or by Profile Group.\nNavigate to Objects > Security Profiles > Anti-Spyware. Click on existing\nprofile in used or create a new profile.\nNavigate to Signature Policies tab. Add new policy by giving it a name Policy\nName.\nVerify a Policy Name exists within the anti-spyware profile that is configured to perform\nthe reset-both on Critical, High, and Medium Severity level, any\nCategory, and any Threat Name.\nNavigate to Objects > Security Profiles > Anti-Spyware.\nWithin the each anti-spyware profile, under its DNS Policies tab, verify the Signature\nSource List: default-paloalto-dns should have as its Policy Action set to\nsinkhole If licensed, the DNS Security should have as its Policy Action set to\nsinkhole\nVerify the 'Sinkhole IPv4' IP address is correct. This should be set to\nsinkhole.paloaltnetworks.com, or if an internal host is set then that host IP or\nFQDN should be in that field\nVerify the 'Sinkhole IPv6' IP address is correct. This should be set to IPv6 Loopback\nIP (::1), or if an internal DNS Sinkhole host is set then that host IP or FQDN should\nbe in that field\nNavigate to Policies > Security Policies For each outbound security Policy, in\nthe Actions tab, verify that the Anti-Spyware setting includes the Spyware Profile\ncreated, either explicitly or as a Group Profile\nTo verify correct operation of DNS Security, from an internal station make a DNS\nrequest to each of the following hosts:\n• test-malware.testpanw.com to test Malware DNS Signature checks\n• test-c2.testpanw.com to test C2 DNS Signature checks\nPage 132\n• test-dga.testpanw.com to test DGA (Domain Generation Algorithm) DNS attack\nchecks\n• test-dnstun.testpanw.com to test DNS Tunneling attack checks Each of\nthese DNS requests should be redirected to the configured DNS Sinkhole server\nIP address Each of these DNS requests should appear in the firewall logs, under\nMonitor > Logs > Threat. If configured, each of these requests should\ngenerate an alert in the organization's SIEM.\nNavigate to Objects > Security Profiles > Anti-Spyware.\nAlso navigate to Policies > Security.\nVerify there are one or more anti-spyware profiles that collectively apply to all inside to\noutside traffic from any address to any address and any application and service.\nNavigate to Objects > Security Profiles > Vulnerability Protection.\nVerify a Vulnerability Protection Profile is set to block attacks against any critical or high\nvulnerabilities (minimum), and set to default on attacks against any medium, low, or\ninformational vulnerabilities.\nNavigate to Policies > Security.\nFor each Policy, under the Actions tab, select Vulnerability Protection.\nVerify either the 'Strict' or the 'Default' profile is selected, or a custom profile that\ncomplies with the organization's policies, legal and regulatory requirements.\nNavigate to Device > Licenses.\nClick on PAN-DB URL Filtering.\nVerify Active is set to Yes.\nNavigate to Objects > Security Profiles > URL Filtering.\nVerify that all URL categories designated by the organization are listed, and the action\nis set to Block.\nNavigate to Objects > Security Profiles > URL Filtering.\nVerify that the for all allowed categories, that the Site Access action is set to alert\nNavigate to Objects > Security Profiles > URL Filtering > URL Filtering\nProfile > URL Filtering Settings.\nVerify these four settings:\na. Log container page only box is un-checked\nb. User-Agent box is checked\nc. Referer box is checked\nd. X-Forwarded-For box is checked\nTo Verify URL Filtering:\nFor each Security Policy that transits traffic to the public internet, navigate to Policies\n> Security > Security Profiles > [Policy Name] > Actions.\nVerify there is a URL Filtering profile that complies with the policies of the organization\nis applied to all Security Policies that transit traffic to the public internet.\nNavigate to Objects > Custom Objects > Data Patterns.\nVerify an appropriate Data Pattern has been created that accounts for sensitive\ninformation within your organization. In most cases this will include Credit Card\nNumbers, and your jurisdiction's equivalent of Social Insurance Numbers. In many\ncases these can simply be picked from the list of Predefined Patterns.\nNavigate to Objects > Security Profiles > Data Filtering.\nVerify an appropriate Data Filtering Profile has been created, using the created\nData Patterns. Ensure that an Alert Threshold is set that generates alerts\nappropriately. A typical starting value for Alert Threshold is 20, but this should be\nadjusted after appropriate testing.\nNavigate to Objects > Custom Objects > Data Patterns. Verify that the patterns\ndefined match the various data that you wish to monitor or make blocking decisions on.\nNavigate to Objects > Security Profiles > Data Filtering For each Filtering\nProfile, verify that the Data Patterns defined matches the data you wish to monitor,\nwith appropriate values for Alert Threshold (typically 20), Block Threshold\n(typically 0) and Log Severity.\nFinally, navigate to Policies > Security. Open all appropriate policies, for each\nPolicy choose the Actions tab, and verify that the appropriate Data Filtering\nPolicy is applied (either as an individual Profile or as part of a Group Profile)\nFrom GUI:\nNavigate to Network > Network Profiles > Zone Protection > Zone\nProtection Profile > Flood Protection tab.\nVerify the SYN box is checked. Verify the Action dropdown is SYN Cookies. Verify Alert\nis 20000 (or appropriate for org). Verify Activate is 25000 (50% of maximum for firewall\nmodel). Verify Maximum is 1000000 (or appropriate for org).\nNavigate to Network > Zones. Open the zone facing any untrusted network. Verify that\nZone Protection has the Zone Protection Profile set to the Profile created.\nIn the GUI:\nNavigate to Network > Network Profiles > Zone Protection > Flood\nProtection.\nEnsure that all settings are enabled with at least the default values.\nNavigate to Network > Zones, select each untrusted zone in turn, and ensure that the\nZone Protection Profile is set.\nPage 158\nNavigate to Network > Network Profiles > Zone Protection > Zone\nProtection Profile > Reconnaissance Protection.\nVerify that TCP Port Scan is enabled, its Action is set to block-ip, its Interval is set to\n5, and its Threshold is set to 20. For block-ip, ensure the \"Track By\" is set to source\nand \"Duration\" is set to 600 seconds.\nVerify that Host Sweep is enabled, its Action is set to block, its Interval is set to 10,\nand its Threshold is set to 30.\nVerify that UDP Port Scan is enabled, its Action is set to alert, its Interval is set to 10,\nand its Threshold is set to 20.\nNavigate to Network > Network Profiles > Zone Protection > Zone\nProtection Profile > Packet Based Attack Protection > TCP/IP Drop.\nVerify Spoofed IP address is checked.\nVerify Mismatched overlapping TCP segment is checked.\nUnder IP Option Drop, verify that Strict Source Routing, Loose Source\nRouting, and Malformed are all checked. Additional options may also be checked.\nNavigate to Objects > Security Profiles > URL Filtering.\nChoose the Categories tab. Verify that the User Credential Submitting action on\nall enabled URL categories is set to either block or continue.\nUnder the User Credential Detection tab ensure the User Credential\nDetection is set to a value appropriate to your organization, and is not set to\nDisabled. Verify that the Log Severity value is set to a value appropriate to your\norganization and your logging or SIEM solution.\nNavigate to Objects > Security Profiles > Antivirus\nVerify that antivirus profiles have all decoders set to reset-both for Wildfire Inline\nML Action. If imap and pop3 are required in the organization, verify that the imap and\npop3 decoders are set to alert for Wildfire Inline ML Action.\nNavigate to Objects > Security Profiles > Antivirus\nGo to Wildfire Inline ML tab. Verify that all Action Setting are set to enable\n(inherit per-protocol actions).\nNavigate to Objects > Security Profiles > Vulnerability Protection\nGo to Inline Cloud Analysis tab. Verify that it is enabled and all Model action is set\nas alert.\nNavigate to Objects > Security Profiles > URL Filtering\nGo to Inline Categorization tab. Verify that it is enabled for both Enable local\ninline categorization and Enable cloud inline categorization.\nNavigate to Objects > Security Profiles > Anti-Spyware\nGo to Inline Cloud Analysis tab. Verify that it is enabled and all Model action is set\nas reset-both.\nNavigate to Objects > Security Profiles > Anti-Spyware\nGo to DNS Policies tab. Verify that policy action is set to sinkhole for all DNS\nSecurity categories.\nOn Command and control Domains category, verify that the packet capture option to\nextended-capture.Navigate to Objects > Security Profiles > Anti-Spyware\nGo to DNS Policies tab. Configure policy action to sinkhole for all DNS Security\ncategories.\nOn Command and control Domains category, set the packet capture option to\nextended-capture\nNavigate to Policies > Security.\nPage 179\nFor all Security Policies that transit from a less trusted to a more trusted interface, that\nthe appropriate Application and Service values are set. For instance, for a web\nserver exposed to the internet from a DMZ: Source tab: Zone set to OUTSIDE / Address\nset to Any Destination tab: Zone set to DMZ / Address set to [DMZ Host Object]\nApplication tab: set to web-browsing Service/URL Category tab: set Service to\nether:\n• application-default or:\n• service-http and/or service-https\n**Enhanced Security Recommendation: **\nAssess this setting for Policies on all Interfaces, for traffic in all directions. Ensure that\nfor each Security Policy that the appropriate settings are set for both Application and\nService\nNavigate to Policies > Security.\nFor each exposed host, verify that a Security Policy exists with:\n• Source tab: Zone set to OUTSIDE Address set to any\n• Destination tab: Zone set to DMZ / Address set to <DMZ Host Object>\n• Application tab: Application set to web-browsing (or appropriate\napplication)\n• Service tab: Service set to application-default. The value of any should\nnever be used\nNavigate to Policies > Security\nVerify a Security Policy exists similar to:\n• General tab: Name set to Deny to Malicious IP\n• Source tab: Source Zone set to Any,\n• Destination tab: Destination Zone set to Any, Destination Address set to\nPalo Alto Networks - Known malicious IP addresses,Palo Alto\nNetworks - High risk IP addresses, Palo Alto Networks - Tor exit\nIP addresses, Palo Alto Networks - Bulletproof IP addresses\n• Application tab: Application set to Any\n• Service/URL Category tab: Service set to Any\n• Actions tab: Action set to Block, Profile Type set to None\nVerify a Security Policy exists similar to:\nPage 184\n• General tab: Name set to Deny from Malicious IP\n• Source tab: Source Zone set to Any, Source Address set to Palo Alto\nNetworks - Known malicious IP addresses,Palo Alto Networks - High\nrisk IP addresses, Palo Alto Networks - Tor exit IP addresses, Palo\nAlto Networks - Bulletproof IP addresses\n• Destination tab: Destination Zone set to Any\n• Application tab: Application set to Any\n• Service/URL Category tab: Service set to Any\n• Actions tab: Action set to Block, Profile Type set to None\nNote: This recommendation requires a Palo Alto Networks \"Threat Prevention License\"\nNavigate to Policies > Security\nGo to default policies intrazone-default and interzone-default. On Actions tab,\nverify that log setting has Log at Session End is enabled.\nNavigate to Policies > Decryption. Verify SSL Forward Proxy is set for all traffic\ndestined to the Internet.\nVerify each Decryption Policy Rule:\n• Source tab: The Source Zone and/or Source Address should include all target\ninternal networks. Source User should include all target internal users\n• Destination tab: The Destination Zone should include the untrusted target\nzone (usually the internet). Destination Address is typically Any for an\ninternet destination.\nPage 190\n• Service/URL Category tab: Verify that all URL Category entries are included\nexcept financial-services, government and health-and-medicine (this list\nmay vary depending on your organization and its policies).\n• Options tab: Verify that the Type is set to SSL Forward Proxy\nNavigate to Policies > Decryption.\nVerify SSL Inbound Inspection is set appropriately for all untrusted traffic destined for\nservers using SSL or TLS.\nNavigate to Policies > Decryption. For each service published to the internet (or\nother untrusted zones), verify the following settings:\n• General tab: Name set to a descriptive name\n• Source: Source Zone set to the target zone (Internet in many cases). Source\nAddress set to the target address space (Any for internet traffic)\n• Destination tab: Destination Zone should be set to the appropriate zone, or\nAny. Destination Address set to the target host address\n• Options tab: Type set to SSL Inbound Inspection\nVerify the CA Certificate(s):\nNavigate to Device > Certificate Management > Certificates\n• Verify that appropriate internal certificates are imported, and that all certificates in\nthe list are valid. In particular, verify the Subject, Issuer, CA, Expires,\nAlgorithm and Usage fields\nPage 195\n• Alternatively, if an internal CA is implemented on the firewall, verify that target\nclients have the root certificate for this CA imported into their list of trusted\ncertificate authorities.\nVerify the Certificate Profile needed for the SSL Forward Proxy:\n• Navigate to Device > Certificate Management > Certificate Profile.\nVerify that an appropriate profile is created.",
    "rationale": "Post-quantum IKEv2 VPNs based on RFC 8784 work by transmitting a pre-shared\nsecret separately (out-of-band) from the initial peering exchange (the IKE_SA_INIT\nExchange). Instead of transmitting the pre-shared secret in the peering exchange,\nwhich an attacker could compromise or harvest now and decrypt later, the peering\nexchange only transmits a Key ID. A Key ID and a pre-shared secret comprise a unique\npair called a post-quantum pre-shared key (PQ PPK).\nEach IKEv2 peer uses the Key ID to look up the pre-shared secret, which is transmitted\nsecurely between administrators or pushed by Panorama, and stored locally on each\nIKEv2 peer. The pre-shared key is never part of the peering exchange and never\ntraverses the post-quantum VPN, so an attacker using a quantum computer can't steal\nit, crack it, and use it to decrypt data harvested from a VPN.\nBoth IKEv2 peers must have the same active pairs of Key ID plus pre-shared secret so\nthat when peers negotiate the connection, each peer can look up the same Key ID and\nretrieve the same pre-shared secret. If the responding peer doesn't have a matching\nKey ID or if the pre-shared secret associated with the Key ID differs from the initiator,\nthe connection is aborted.\nUnderstanding which user is involved in a security incident allows appropriate personnel\nto move quickly between the detection and reaction phases of incident response. In\nenvironments with either short DHCP lease times, or where users may move frequently\nbetween systems, the ability to analyze or report, or alert on events based on user\naccounts or user groups is a tremendous advantage. For forensics tasks when DHCP\nlease information may not be available, the Source User information may be the only\nway to tie together related data.\nWMI probing normally requires a domain administrator account. A malicious user could\ncapture the encrypted password hash for offline cracking or relayed authentication\nattacks. Relying on other forms of user identification, such as using UserID Agents or\nsecurity log monitoring, mitigates this risk.\nIn addition, it is easy to mis-configure this feature such that it is enabled on untrusted\ninterfaces. This can result in a domain administrator account and the associated\npassword hash being sent to untrusted hosts on the internet, where malicious users can\nthen capture that hash for offline cracking.\nPAN released a customer advisory in October of 2014 warning of WMI probing on\nuntrusted interfaces with User-ID enabled. This can result in theft of the password hash\nfor the account used in WMI probing.\nThe Include/Exclude Networks feature allow users to configure boundaries for the User-\nID service. By using the feature to limit User-ID probing to only trusted internal\nnetworks, the risks of privileged information disclosure through sent probes can be\nreduced. Note that if an entry appears in the Include/Exclude Networks section, an\nimplicit exclude-all-networks policy will take effect for all other networks.\nAs a principle of least privilege, user accounts should have only minimum necessary\npermissions. If an attacker compromises a User-ID service account with domain admin\nrights, the organization is at far greater risk than if the service account were only\ngranted minimum rights.\nIn the event of a compromised User-ID service account, restricting interactive logins\nforbids the attacker from utilizing services such as RDP against computers in the Active\nDirectory domain of the organization. This reduces the impact of a User-ID service\naccount compromise.\nIn the event of a compromised User-ID service account, restricting the account’s ability\nto remotely access resources within the organization’s internal network reduces the\nimpact of a service account compromise.\nIf User-ID and WMI probes are sent to untrusted zones, the risk of privileged information\ndisclosure exists. The information disclosed can include the User-ID Agent service\naccount name, domain name, and encrypted password hashes sent in User-ID and\nWMI probes. To prevent this exposure, msrpc traffic originating from the firewall to\nuntrusted networks should be explicitly denied. This security policy should be in effect\neven for environments not currently using WMI probing to help guard against possible\nprobe misconfigurations in the future.\nThis setting is a \"fail safe\" to prevent exposure of this information if any of the other\nWMI User control settings are misconfigured.\nTo ensure availability of both the firewall and the resources it protects, a High\nAvailability peer is required. In the event a single firewall fails, or when maintenance\nsuch as a software update is required, the HA peer can be used to automatically fail\nover session states and maintain overall availability\nIf Link or Path Monitoring is not enabled, the standby router will not automatically take\nover as active if a critical link fails on the active firewall. Services through the firewall\ncould become unavailable as a result.\nSimultaneously enabling the 'Preemptive' option and setting the 'Passive Link State'\noption to 'Shutdown' could cause a 'preemptive loop' if Link and Path Monitoring are\nboth configured. This will negatively impact the availability of the firewall and network\nservices, should a monitored failure occur.\nNew antivirus definitions may be released at any time. With an hourly update schedule,\nthe firewall can ensure threats with new definitions are quickly mitigated. A daily update\nschedule could leave an organization vulnerable to a known virus for nearly 24 hours, in\na worst-case scenario. Setting an appropriate threshold value reduces the risk of a bad\ndefinition file negatively affecting traffic.\nNew Applications and Threats file versions may be released at any time. With a\nfrequent update schedule, the firewall can ensure threats with new signatures are\nquickly mitigated, and the latest application signatures are applied.\nBecause the firewall has a specific capacity reserved to forward files for WildFire\nanalysis, forwarding high numbers of large files can cause the firewall to skip forwarding\nof some files. This condition occurs when the maximum file size limits are configured for\na file type that is traversing the firewall at a high rate. In this case, a potentially\nmalicious file might not get forwarded for WildFire analysis. Consider this possible\ncondition if you would like to increase the size limit for files other than PEs beyond their\ndefault size limit.\nTraffic matching security policies that do not include a WildFire file blocking profile will\nnot utilize WildFire for file analysis. Wildfire analysis is one of the key security measures\navailable on this platform. Without Wildfire analysis enabled, inbound malware can only\nbe analyzed by signature - which industry wide is roughly 40-60% effective. In a\ntargeted attack, the success of signature-based-only analysis drops even further.\nAs encrypted Internet traffic continues to proliferate, WildFire becomes less effective\nunless it is allowed to act on decrypted content. For example, if a user downloads a\nmalicious pdf over SSL, WildFire can only provide analysis if 1) the session is decrypted\nby the firewall and 2) forwarding of decrypted content is enabled. In today's internet,\nroughly 70-80% of all user traffic is encrypted. If Wildfire is not configured to analyze\nencrypted content, the effectiveness of Wildfire is drastically reduced.\nPermitting the firewall to send all of this information to WildFire creates more detailed\nreports, thereby making the process of tracking down potentially infected devices more\nefficient. This could prevent an infected system from further infecting the environment.\nEnvironments with security policies restricting sending this data to the WildFire cloud\ncan instead utilize an on-premises WildFire appliance. In addition, risk can be analyzed\nin the context of the destination host and user account, either during analysis or during\nincident response.\nWildFire analyzes files that have already been downloaded and possibly executed. A\nWildFire verdict of malicious indicates that a computer could already be infected. In\naddition, because WildFire only analyzes files it has not already seen that were not\nflagged by the firewall’s antivirus filter, files deemed malicious by WildFire are more\nlikely to evade detection by desktop antivirus products.\nWildFire definitions may contain signatures to block immediate, active threats to the\nenvironment. With updates in real-time, the firewall can ensure threats with new\ndefinitions are quickly mitigated.\nDepending on regulations, files is only allowed to be uploaded to local country / region.\nBesides, uploading to local country or even nearest country decreases file uploading\nspeed.\nRefer to the available regions in the references below.\nAntivirus signatures produce low false positives. By blocking any detected malware\nthrough the specified decoders, the threat of malware propagation through the firewall is\ngreatly reduced. It is recommended to mitigate malware found in pop3 and imap\nthrough a dedicated antivirus gateway. Due to the nature of the pop3 and imap\nprotocols, the firewall is not able to block only a single email message containing\nmalware. Instead, the entire session would be terminated, potentially affecting benign\nemail messages.\nBy applying a secure antivirus profile to all applicable traffic, the threat of malware\npropagation through the firewall is greatly reduced. Without an antivirus profile assigned\nto any potential hostile zone, the first protection in the path against malware is removed,\nleaving in most cases only the desktop endpoint protection application to detect and\nremediate any potential malware.\nRequiring a blocking policy for all spyware threats, categories, and severities (Critical,\nHigh, and Medium) reduces the risk of spyware traffic from successfully exiting the\norganization. Without an anti-spyware profile assigned to any potential hostile zone, the\nfirst protection in the path against malware is removed, leaving in most cases only the\ndesktop endpoint protection application to detect and remediate any potential spyware.\nDNS sinkholing helps to identify infected clients by spoofing DNS responses for\nmalware domain queries. Without sinkholing, the DNS server itself may be seen as\ninfected, while the truly infected device remains unidentified. In addition, sinkholing also\nensures that DNS queries that might be indicators of compromise do not transit the\ninternet, where they could be potentially used to negatively impact the \"ip reputation\" of\nthe organization's internet network subnets.\nBy applying secure anti-spyware profiles to all applicable traffic, the threat of sensitive\ndata exfiltration or command-and-control traffic successfully passing through the firewall\nis greatly reduced. Anti-spyware profiles are not restricted to particular protocols like\nantivirus profiles, so anti-spyware profiles should be applied to all security policies\npermitting traffic to the Internet. Assigning an anti-spyware profile to each trusted zone\nwill quickly and easily identify trusted hosts that have been infected with spyware, by\nidentifying the infection from their outbound network traffic. In addition, that outbound\nnetwork traffic will be blocked by the profile.\nA Vulnerability Protection Profile helps to protect assets by alerting on, or blocking,\nnetwork attacks. The default action for attacks against many critical and high\nvulnerabilities is to only alert on the attack - not to block.\nA Vulnerability Protection Profile helps to protect assets by alerting on, or blocking\nnetwork attacks. By applying a secure Vulnerability Protection Profile to all security rules\npermitting traffic, all network traffic traversing the firewall will be inspected for attacks.\nThis protects both organizational assets from attack and organizational reputation from\ndamage.\nNote that encrypted sessions do not allow for complete inspection.\nStandard URL filtering provides protection against inappropriate and malicious URLs\nand IP addresses. PAN-DB URL Filtering is slightly less granular than the BrightCloud\nURL filtering. However the PAN-DB Filter offers additional malware protection and PAN\nthreat intelligence by using the Wildfire service as an additional input, which is currently\nnot available in the BrightCloud URL Filtering license. This makes the PAN-DB filter\nmore responsive to specific malware \"campaigns\".\nCertain URL categories pose a technology-centric threat, such as command-and-\ncontrol, copyright-infringement, extremism, malware, phishing, proxy-avoidance-and-\nanonymizers, and parked. Users visiting websites in these categories, many times\nunintentionally, are at greater risk of compromising the security of their system. Other\ncategories, such as adult, may pose a legal liability and will be blocked for those\nreasons.\nSetting a URL filter to have one or more entries under Allow Categories will cause no\nlog entries to be produced in the URL Filtering logs for access to URLs in those\ncategories. For forensic, legal, and HR purposes, it is advisable to log access to every\nURL. In many cases failure to log all URL access is a violation of corporate policy, legal\nrequirements or regulatory requirements.\nLogging HTTP header information provides additional information in the URL logs,\nwhich may be useful during forensic investigations. The User-Agent option logs which\nbrowser was used during the web session, which could provide insight to the vector\nused for malware retrieval. The Referer option logs the source webpage responsible for\nreferring the user to the logged webpage. The X-Forwarded-For option is useful for\npreserving the user’s source IP address, such as if a user traverses a proxy server prior\nto the firewall. Un-checking the Log container page only box produces substantially\nmore information about web activity, with the expense of producing far more entries in\nthe URL logs. If this option remains checked, a URL filter log entry showing details of a\nmalicious file download may not exist.\nURL Filtering policies dramatically reduce the risk of users visiting malicious or\ninappropriate websites. In addition, a complete URL history log for all devices is\ninvaluable when performing forensic analysis in the event of a security incident.\nApplying complete and approved URL filtering to outbound traffic is a frequent\nrequirement in corporate policies, legal requirements or regulatory requirements.\nCredit card and Social Security numbers are sensitive, and should never traverse an\norganization’s Internet connection in clear text. Passing sensitive data within an\norganization should also be avoided whenever possible. Detecting and blocking known\nsensitive information is a basic protection against a data breach or data loss. Not\nimplementing these defenses can lead to loss of regulatory accreditation (such as PCI,\nHIPAA etc), or can lead to legal action from injured parties or regulatory bodies.\nA Data Filtering profile helps prevent certain types of sensitive information from\ntraversing an organization’s Internet connection, especially in clear text. Detecting and\nblocking known sensitive information is a basic protection against a data breach or data\nloss. Not implementing these defenses can lead to loss of regulatory accreditation (such\nas PCI, HIPAA etc), or can lead to legal action from injured parties or regulatory bodies.\nBefore starting, be very aware that Data Filtering will often block data that you didn't\nanticipate, false positives will definitely occur. Even the prebuilt filters will frequently\nmatch on unintended data in files or websites. Work very closely with your user\ncommunity to ensure that required data is blocked or alerted on, but a minimum of false\npositive blocks occur. As false positives occur, ensure that your user community has a\nclear and timely procedure to get the configuration updated.\nProtecting resources and the firewall itself against DoS/DDoS attacks requires a layered\napproach. Firewalls alone cannot mitigate all DoS attacks, however, many attacks can\nbe successfully mitigated. Utilizing SYN Cookies helps to mitigate SYN flood attacks,\nwhere the CPU and/or memory buffers of the victim device become overwhelmed by\nincomplete TCP sessions. SYN Cookies are preferred over Random Early Drop.\nPage 155\nWithout flood protection, it may be possible for an attacker, through the use of a botnet\nor other means, to overwhelm network resources. Flood protection does not completely\neliminate this risk; rather, it provides a layer of protection. Without a properly configured\nzone protection profile applied to untrusted interfaces, the protected / trusted networks\nare susceptible to large number of attacks. While many of these involve denial of\nservice, some of these attacks are designed to evade IPS systems (fragmentation\nattacks for instance) or to evade basic firewall protections (source routing and record\nroute attacks).\nPort scans and host sweeps are common in the reconnaissance phase of an attack.\nBots scouring the Internet in search of a vulnerable target may also scan for open ports\nand available hosts. Reconnaissance Protection will allow for these attacks to be either\nalerted on or blocked altogether.\nUsing specially crafted packets, an attacker may attempt to evade or diminish the\neffectiveness of network security devices. Enabling the options in this recommendation\nlowers the risk of these attacks.\nPreventing users from having the ability to submit their corporate credentials to the\nInternet could stop credential phishing attacks and the potential that a breach at a site\nwhere a user reused credentials could lead to a credential stuffing attack.\nStarting from PanOS 10, Wildfire supports real-time detection and blocking. As more\nattacks are designed to bypass signature-based protection, real-time signatureless-\nbased protection is needed. Antivirus signatures produce low false positives. By\nblocking any detected malware through the specified decoders, the threat of malware\npropagation through the firewall is greatly reduced. It is recommended to mitigate\nmalware found in pop3 and imap through a dedicated antivirus gateway. Due to the\nnature of the pop3 and imap protocols, the firewall is not able to block only a single\nemail message containing malware. Instead, the entire session would be terminated,\npotentially affecting benign email messages.\nStarting from PanOS 10, Wildfire supports real-time detection and blocking. As more\nattacks are designed to bypass signature-based protection, real-time signatureless-\nbased protection is needed. With this new functionality, common file types used for\nmalware delivery such as Windows Executables, PowerShell Script, MSOffice, Shell,\nand Executable Linked Format (ELF) can be inspected using Wildfire and malicious files\nare blocked in real-time.\nStarting from PanOS 11, Palo Alto Networks now operates new inline deep learning\ndetection engines in the Advanced Threat Prevention cloud to analyze traffic for\ncommand injection and SQL injection vulnerabilities in real-time to protect users against\nzero-day threats. By operating cloud-based detection engines, you can access a wide\narray of detection mechanisms that are updated and deployed automatically without\nrequiring the user to download update packages or operate process intensive, firewall-\nbased analyzers which can sap resources.\nIt is recommended to set the action as 'alert' during initial deployment and monitor it's\nfalse positive, configure the exclusion URL and IP before moving to 'reset-both' action.\nStarting from PanOS 10, Palo Alto Networks Advanced URL Filtering now operates a\nseries of inline cloud-based deep learning detectors that evaluate suspicious web page\ncontents in real-time to protect users against zero-day threats. This includes cloaked\nwebsites, multi-step attacks, CAPTCHA challenges, and previously unseen one-time-\nuse URLs.\nStarting from PanOS 10, Palo Alto Networks now operates a series of ML-based\ndetection engines in the Advanced Threat Prevention cloud to analyze traffic for\nadvanced C2 (command-and-control) and spyware threats in real-time to protect users\nagainst zero-day threats. By operating cloud-based detection engines, you can access\na wide array of detection mechanisms that are updated and deployed automatically\nwithout requiring the user to download update packages or operate process intensive,\nfirewall-based analyzers which can sap resources.\nThe cloud-based detection engine logic is continuously monitored and updated using\nC2 traffic datasets from WildFire, with additional support through manual updates by\nPalo Alto Networks threat researchers, who provide human intervention for highly\naccurized detection enhancements.\nDNS traffic are normally allowed on firewall. With this in mind, attackers leverage on this\nattack surface to evade detections or extract out data. Starting from PanOS 9, Palo Alto\nNetworks has launched DNS Security services to combat against evassive malwares\nand to detect DNS tunneling activities.\nFor DNS Security to be effective, \"Threat Prevention\" or \"Advanced Threat Prevention\"\nlicense must be purchased in addition of \"DNS Security\" license.\nTo avoid unintentionally exposing systems and services, rules allowing traffic from\nuntrusted zones to trusted zones should be as specific as possible. Application-based\nrules, as opposed to service/port rules, further tighten what traffic is allowed to pass.\nSimilarly, traffic from trusted to untrusted networks should have a security policy set,\nwith application-based rules. A \"catch-all\" rule that allows all applications will also allow\nmalware traffic. The goal should be to understand both inbound and outbound traffic,\npermit what is known, and block all other traffic.\nApp-ID requires a number of packets to traverse the firewall before an application can\nbe identified and either allowed or dropped. Due to this behavior, even when an\napplication is defined in a security policy, a service setting of any may allow a device in\none zone to perform ports scans on IP addresses in a different zone. In addition, this\nrecommendation helps to avoid an App-ID cache pollution attack.\nBecause of how App-ID works, configuring the service setting to \"Any\" allows some\ninitial traffic to reach the target host before App-ID can recognize and appropriately\nrestrict the traffic. Setting the Service Setting to application specific at least restricts the\ntraffic to the target applications or protocols for that initial volume of traffic.\nCreating rules that block traffic to/from known malicious sites from Trusted Threat\nIntelligence Sources protects you against IP addresses that Palo Alto Networks has\nproven to be used almost exclusively to distribute malware, initiate command-and-\ncontrol activity, and launch attacks.\nBy default, these default security policies does not have logging enabled. This enables\nSOC or security analyst to do further investigations on security incidents especially on\nthreat hunting or incident response activities.\nWithout SSL inspection, the firewall cannot apply many of its protection features against\nencrypted traffic. The amount of encrypted malware traffic continues to rise, and\nlegitimate websites using SSL encryption are hacked or tricked into delivering malware\non a frequent basis. As encryption on the Internet continues to grow at a rapid rate, SSL\ninspection is no longer optional as a practical security measure. If proper decryption is\nnot configured, it follows that the majority of traffic is not being fully inspected for\nmalicious content or policy violations. This is a major exposure, allowing delivery of\nexploits and payloads direct to user desktops.\nNote that, categories to be decrypted is highly dependant on each organization's policy.\nWithout SSL Inbound Inspection, the firewall is not able to protect SSL or TLS-enabled\nwebservers against many threats.\nUsing a self-signed certificate, or any certificate that generates a warning in the\nbrowser, means that members of the organization have no method of determining if\nthey are being presented with a legitimate certificate, or an attacker's \"man in the\nmiddle' certificate. It also very rapidly teaches members of the organization to bypass all\nsecurity warnings of this type.",
    "impact": "While this removes the exposure of having the WMI user account password being\ncompromised, it also reduces the effectiveness of user identification during operation of\nthe firewall (applying rules and policies). This trade-off should be weighed carefully for\nall installations.\nIf WMI probing is enabled without limiting the scope, internet hosts that are sources or\ndestinations of traffic will be probed, and the password hash of the configured Domain\nAdmin account can be captured by an outside attacker on such a host.\nNot restricting the networks subject to User Identification means that the administrative\ncredentials (userid and password hash) used for this task will transit untrusted networks,\nor be sent to untrusted hosts. Capturing these credentials exposes them to offline\ncracking attacks.\nUsing accounts with full administrative privileges when those rights are not required is\nalways a bad idea. This is particularly true for service accounts of this type, which in\nmany organizations do not see strong passwords or frequent password changes. In\naddition, service passwords are stored in the Windows Registry, and are recoverable\nwith the user of appropriate malicious tools. The principal of least privilege means that\nany compromised accounts of this type have less value to an attacker, and expose\nfewer assets based on their rights.\nNot configuring High Availability (HA) correctly directly impacts the Availability of the\nsystem. With HA in place, standard maintenance such as OS updates, network and\npower cabling can be accomplished with no outage or a minimum impact.\nNot configuring High Availability (HA) correctly directly impacts the Availability of the\nsystem. With HA in place, standard maintenance such as OS updates, network and\npower cabling can be accomplished with no outage or a minimum impact.\nWithout Link and Path monitoring in particular, failover will only occur when the primary\ndevice fails completely. Link and path monitoring permits failover if a critical interface\nloses link (either due to cabling or an upstream switch failover), or if a route or path fails\n(indicating an upstream issue that affects local Layer 3).\nIncorrectly configuring this setting will adversely affect availability, rather than positively\naffect it.\nUsing larger file filtering can cause the system to skip files in the event multiple larger\nfiles are sent.\nWith default values, all relevant files are uploaded to wildfire.paloaltonetworks.com\nwhich is located in US.\nNot having an AV Profile on a Security Policy allows signature-based malware to transit\nthe security boundary without blocks or alerts. In most cases this leaves only the\nEndpoint Security application to block or alert malware.\nNot configuring a Vulnerability Protection Profile means that network attacks will not be\nlogged, alerted on or blocked.\nNot configuring a Vulnerability Protection Profile means that network attacks will not be\nlogged, alerted on or blocked.\nNot having an effective URL Filtering configuration can leave an organization open to\nlegal action, internal HR issues, non-compliance with regulatory policies or productivity\nloss.\nNot having an effective URL Filtering configuration can leave an organization open to\nlegal action, internal HR issues, non-compliance with regulatory policies or productivity\nloss.\nNot having an effective URL Filtering configuration can leave an organization open to\nlegal action, internal HR issues, non-compliance with regulatory policies or productivity\nloss.\nNot having an effective URL Filtering configuration can leave an organization open to\nlegal action, internal HR issues, non-compliance with regulatory policies or productivity\nloss.\nNot having an effective URL Filtering configuration can leave an organization open to\nlegal action, internal HR issues, non-compliance with regulatory policies or productivity\nloss.\nNot configuring a Network Zone Protection Profile on untrusted interfaces leaves an\norganization exposed to common attacks and reconnaissance from those untrusted\nnetworks. Not configuring a Zone Protection Profile for internal networks leaves an\norganization vulnerable to malware, software or hardware causes of traffic flooding from\ninternal sources.\nNot configuring and applying a Network Zone Protection Profile leaves an organization\nexposed to common attacks and reconnaissance from untrusted networks.\nNot configuring a Zone Protection Profile for internal networks leaves an organization\nvulnerable to malware, software or hardware causes of traffic flooding from internal\nsources.\nNot configuring a Network Zone Protection Profile leaves an organization exposed to\ncommon attacks and reconnaissance from untrusted networks.\nNot configuring a Network Zone Protection Profile leaves an organization exposed to\ncommon attacks and reconnaissance from untrusted networks.\nNot preventing users from submitting their corporate credentials to the Internet can\nleave them open to phishing attacks or allow for credential reuse on unauthorized sites.\nUsing internal email accounts provides malicious actors with intelligence information,\nwhich can be used for phishing, credential stuffing and other attacks. Using internal\npasswords will often provide authenticated access directly to sensitive information. Not\nonly that, but a pattern of credential re-use can expose personal information from\nmultiple online sources.\nSetting application based rules on both inbound and outbound traffic ensures that the\ntraffic on the protocol and port being specified is actually the application that you expect.\nFor outbound traffic, the days of \"we trust our users\" is well past us, that statement also\nimplies that we trust the malware on the user workstations, which is obviously not the\ncase.\nFor traffic from trusted to less trusted interfaces, the applications should be\ncharacterized over time, with the end goal being that all applications in in the rules, and\na final \"block all\" rule is in place. Not having this goal gives both attackers and malware\nthe leeway they need to accomplish their goals.\nTrusting only Port permissions to control traffic exposes an organization to \"tunneling\"\nstyle attacks that can exfiltrate data or facilitate Command and Control (C2) sessions.\nWhile not foolproof, simply blocking traffic from known malicious hosts allows more\nresources to be devoted to analyzing traffic from other sources for malicious content.\nThis approach is a recommended part of most \"Defense in Depth\" recommendations,\nallowing defenders to focus more deeply on traffic from uncategorized sources.\nFailure to decrypt outbound traffic allows attackers to mask attacks, data exfiltration\nand/or command and control (C2) traffic by simply using standard TLS encryption.\nPrivacy concerns for your organization's users will dictate that some common categories\nshould be exempted from inspection and decryption. Personal banking or healthcare\ninformation is almost always exempted, as are interactions with government entities.\nExemptions and inclusions to decryption policies should be negotiated internally and\ngoverned by published Corporate Policies.\nNot decrypting inbound traffic to TLS encrypted services means that inspection for\nmany common attacks cannot occur on the firewall. This means that all defenses\nagainst these attacks are up to the host."
  },
  {
    "rule_id": "1.1.1.1",
    "benchmark": "CIS Palo Alto Firewall 11 Benchmark v1.2.0",
    "device_type": "Palo Alto",
    "control_name": "Syslog logging should be configured",
    "cis_level": "• Level 1",
    "description": "Syslog logging is a standard logging protocol that is widely supported. It is\nrecommended for a level 1 deployment only, as syslog does not support encryption.",
    "expected_values": "By default no external logging is defined",
    "validation_logic": "Navigate to Device > Server Profiles > Syslog Ensure that a valid Syslog profile\nis configured, and that it points to a valid Syslog host. Navigate to Device > Log\nSettings Under System, verify that at least one Syslog entry exists and that at least\none entry has \"All Logs\" selected. Each Syslog entry must have a valid Syslog Profile\nattached.\nUnder Configuration, verify that at least one Syslog entry exists and that at least one\nentry has \"All Logs\" selected. Each Syslog entry must have a valid Syslog Profile\nattached.\nUnder User-ID, verify that at least one Syslog entry exists and that at least one entry\nhas \"All Logs\" selected. Each Syslog entry must have a valid Syslog Profile attached.\nPage 18\nUnder HIP Match (Host Information Profile), verify that at least one Syslog entry exists\nand that at least one entry has \"All Logs\" selected. Each Syslog entry must have a valid\nSyslog Profile attached.\nUnder IP-Tag, verify that at least one Syslog entry exists and that at least one entry has\n\"All Logs\" selected. Each Syslog entry must have a valid Syslog Profile attached.",
    "remediation_steps": "Navigate to Device > Server Profiles > Syslog Choose Add Assign a Name to the\nProfile. Choose Add, and assign a server name in the Name field, add an IP address or\nFQDN in the Syslog Server field. Edit other fields as appropriate for your server.\nRepeat if multiple Syslog destinations are required.\nNavigate to Device > Log Settings Under System, add an entry. Define a Name and\na Filter setting. Under Forward Methods, add a Syslog Profile in the Syslog\nsection. Ensure that at least one of the Log Settings Configuration entries has it's\nFilter setting at All Logs\nUnder Configuration, add an entry. Define a Name and a Filter setting. Under\nForward Methods, add a Syslog Profile in the Syslog section. Ensure that at least\none of the Log Settings Configuration entries has it's Filter setting at All Logs\nUnder User-ID, add an entry. Define a Name and a Filter setting. Under Forward\nMethods, add a Syslog Profile in the Syslog section. Ensure that at least one of the\nLog Settings Configuration entries has it's Filter setting at All Logs\nUnder HIP Match (Host Information Profile), add an entry. Define a Name and a Filter\nsetting. Under Forward Methods, add a Syslog Profile in the Syslog section.\nEnsure that at least one of the Log Settings Configuration entries has it's Filter setting\nat All Logs\nUnder IP-Tag, add an entry. Define a Name and a Filter setting. Under Forward\nMethods, add a Syslog Profile in the Syslog section. Ensure that at least one of the\nLog Settings Configuration entries has it's Filter setting at All Logs",
    "severity": "Automated",
    "is_active": true,
    "references_text": "1. “PAN-OS Administrator's Guide 11.1 (English) - Configure Syslog Monitoring” -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/monitoring/use-\nsyslog-for-monitoring/configure-syslog-monitoring\nPage 19",
    "audit": "Navigate to Device > Server Profiles > Syslog Ensure that a valid Syslog profile\nis configured, and that it points to a valid Syslog host. Navigate to Device > Log\nSettings Under System, verify that at least one Syslog entry exists and that at least\none entry has \"All Logs\" selected. Each Syslog entry must have a valid Syslog Profile\nattached.\nUnder Configuration, verify that at least one Syslog entry exists and that at least one\nentry has \"All Logs\" selected. Each Syslog entry must have a valid Syslog Profile\nattached.\nUnder User-ID, verify that at least one Syslog entry exists and that at least one entry\nhas \"All Logs\" selected. Each Syslog entry must have a valid Syslog Profile attached.\nPage 18\nUnder HIP Match (Host Information Profile), verify that at least one Syslog entry exists\nand that at least one entry has \"All Logs\" selected. Each Syslog entry must have a valid\nSyslog Profile attached.\nUnder IP-Tag, verify that at least one Syslog entry exists and that at least one entry has\n\"All Logs\" selected. Each Syslog entry must have a valid Syslog Profile attached.",
    "rationale": "Sending all system logs to a remote host is recommended to provide protected, long\nterm storage and archiving. This also places a copy of the logs in a second location, in\ncase the primary (on the firewall) logs are compromised. Storing logs on a remote host\nalso allows for more flexible log searches and log processing, as well as many methods\nof triggering events or scripts based on specific log events or combinations of events.\nFinally, remote logging provides many organizations with the opportunity to combine\nlogs from disparate infrastructure in a SIEM (Security Information and Event\nManagement) system.\nLogging to an external system is also usually required by most regulatory frameworks.",
    "impact": "Failure to properly store and archive logs for critical infrastructure leaves an\norganization without the tools required to establish trends in events or activity, or to\nretrospectively analyze security or operational events beyond the log timespan stored\non the firewall. Not having remote logs also puts many organizations outside of\ncompliance with many regulatory frameworks. Finally, not logging to a remote host\nleaves organizations without recourse in the event of a compromise of logs on the\nprimary device. It is imperative that organizations log critical infrastructure appropriately,\nstore and archive these logs in a central location, and have a robust set of tools to\nanalyze logs both in real time and after the fact."
  },
  {
    "rule_id": "1.1.1.2",
    "benchmark": "CIS Palo Alto Firewall 11 Benchmark v1.2.0",
    "device_type": "Palo Alto",
    "control_name": "SNMPv3 traps should be configured",
    "cis_level": "• Level 2",
    "description": "SNMP v3 can be used for remote logging, and is the recommended protocol in higher\nsecurity situations as it fully supports encryption of logs.",
    "expected_values": "By default no external logging is defined\nPage 22",
    "validation_logic": "Navigate to Device > Server Profiles > SNMP Traps\nEnsure that a valid SNMP profile is configured, that version V3 is selected, and that it\npoints to a valid SNMPv3 host. User, EngineID and Password fields should be\ncompleted appropriately\nNavigate to Device > Log Settings Under System, verify that at least one SNMP\nentry exists, corresponding to an SNMPv3 Server Profile and that at least one entry has\n\"All Logs\" selected.\nPage 21\nUnder Configuration, verify that at least one SNMP entry exists, corresponding to an\nSNMPv3 Server Profile and that at least one entry has \"All Logs\" selected.\nUnder User-ID, verify that at least one SNMP entry exists, corresponding to an\nSNMPv3 Server Profile and that at least one entry has \"All Logs\" selected.\nUnder HIP Match (Host Information Profile), verify that at least one SNMP entry exists,\ncorresponding to an SNMPv3 Server Profile and that at least one entry has \"All Logs\"\nselected.\nUnder IP-Tag, verify that at least one SNMP entry exists, corresponding to an SNMPv3\nServer Profile and that at least one entry has \"All Logs\" selected.",
    "remediation_steps": "Navigate to Device > Server Profiles > SNMP Trap Choose Add Assign a Name to\nthe Profile, and specify version V3. Choose Add, and assign a server name in the Name\nfield, add an IP address or FQDN in the SNMP Manager field. Edit the Password fields\nas appropriate for your server. Repeat if multiple Syslog destinations are required.\nNavigate to Device > Log Settings Under System, add an entry. Define a Name and\na Filter setting. Under Forward Methods, add a SNMP Profile in the SNMP\nsection. Ensure that at least one of the Log Settings Configuration entries has its\nFilter setting at All Logs\nUnder Configuration, add an entry. Define a Name and a Filter setting. Under\nForward Methods, add a SNMP Profile in the SNMP section. Ensure that at least one\nof the Log Settings Configuration entries has its Filter setting at All Logs\nUnder User-ID, add an entry. Define a Name and a Filter setting. Under Forward\nMethods, add a SNMP Profile in the SNMP section. Ensure that at least one of the Log\nSettings Configuration entries has its Filter setting at All Logs\nUnder HIP Match (Host Information Profile), add an entry. Define a Name and a Filter\nsetting. Under Forward Methods, add a SNMP Profile in the SNMP section. Ensure\nthat at least one of the Log Settings Configuration entries has its Filter setting at All\nLogs\nUnder IP-Tag, add an entry. Define a Name and a Filter setting. Under Forward\nMethods, add a SNMP Profile in the SNMP section. Ensure that at least one of the Log\nSettings Configuration entries has its Filter setting at All Logs",
    "severity": "Automated",
    "is_active": true,
    "references_text": "1. “PAN-OS Administrator's Guide 11.1 (English) - Forward Traps to an SNMP\nManager” - https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-\nadmin/monitoring/snmp-monitoring-and-traps/forward-traps-to-an-snmp-manager",
    "audit": "Navigate to Device > Server Profiles > SNMP Traps\nEnsure that a valid SNMP profile is configured, that version V3 is selected, and that it\npoints to a valid SNMPv3 host. User, EngineID and Password fields should be\ncompleted appropriately\nNavigate to Device > Log Settings Under System, verify that at least one SNMP\nentry exists, corresponding to an SNMPv3 Server Profile and that at least one entry has\n\"All Logs\" selected.\nPage 21\nUnder Configuration, verify that at least one SNMP entry exists, corresponding to an\nSNMPv3 Server Profile and that at least one entry has \"All Logs\" selected.\nUnder User-ID, verify that at least one SNMP entry exists, corresponding to an\nSNMPv3 Server Profile and that at least one entry has \"All Logs\" selected.\nUnder HIP Match (Host Information Profile), verify that at least one SNMP entry exists,\ncorresponding to an SNMPv3 Server Profile and that at least one entry has \"All Logs\"\nselected.\nUnder IP-Tag, verify that at least one SNMP entry exists, corresponding to an SNMPv3\nServer Profile and that at least one entry has \"All Logs\" selected.",
    "rationale": "Sending all system logs to a remote host is recommended to provide protected, long\nterm storage and archiving. This also places a copy of the logs in a second location, in\ncase the primary (on the firewall) logs are compromised. Storing logs on a remote host\nalso allows for more flexible log searches and log processing, as well as many methods\nof triggering events or scripts based on specific log events or combinations of events.\nFinally, remote logging provides many organizations with the opportunity to combine\nlogs from disparate infrastructure in a SIEM (Security Information and Event\nManagement) system.\nLogging to an external system is also usually required by most regulatory frameworks.",
    "impact": "Failure to properly store and archive logs for critical infrastructure leaves an\norganization without the tools required to establish trends in events or activity, or to\nretrospectively analyze security or operational events beyond the log timespan stored\non the firewall. Not having remote logs also puts many organizations outside of\ncompliance with many regulatory frameworks. Finally, not logging to a remote host\nleaves organizations without recourse in the event of a compromise of logs on the\nprimary device. It is imperative that organizations log critical infrastructure appropriately,\nstore and archive these logs in a central location, and have a robust set of tools to\nanalyze logs both in real time and after the fact. Not encrypting log data as it transits the\nnetwork allows an attacker to mount a \"MiTM\" (Monkey in the Middle) attack, which\nallows them to intercept and/or modify logs as they transit from the source to the\ndestination."
  },
  {
    "rule_id": "1.1.2",
    "benchmark": "CIS Palo Alto Firewall 11 Benchmark v1.2.0",
    "device_type": "Palo Alto",
    "control_name": "Ensure 'Login Banner' is set",
    "cis_level": "• Level 1",
    "description": "Configure a login banner, ideally approved by the organization’s legal team. This banner\nshould, at minimum, prohibit unauthorized access, provide notice of logging or\nmonitoring, and avoid using the word “welcome” or similar words of invitation.",
    "expected_values": "Not configured",
    "validation_logic": "Navigate to Device > Setup > Management > General Settings.\nVerify that Login Banner is set appropriately for your organization.",
    "remediation_steps": "Navigate to Device > Setup > Management > General Settings.\nSet Login Banner as appropriate for your organization.",
    "severity": "Automated",
    "is_active": true,
    "references_text": "1. “PAN-OS Administrator's Guide 11.1 (English) - Configuring Logon Banners” -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/firewall-\nadministration/use-the-web-interface/configure-banners-message-of-the-day-\nand-logos\nPage 24",
    "audit": "Navigate to Device > Setup > Management > General Settings.\nVerify that Login Banner is set appropriately for your organization.",
    "rationale": "Through a properly stated login banner, the risk of unintentional access to the device by\nunauthorized users is reduced. Should legal action take place against a person\naccessing the device without authorization, the login banner greatly diminishes a\ndefendant’s claim of ignorance.",
    "impact": null
  },
  {
    "rule_id": "1.1.3",
    "benchmark": "CIS Palo Alto Firewall 11 Benchmark v1.2.0",
    "device_type": "Palo Alto",
    "control_name": "Ensure 'Enable Log on High DP Load' is enabled",
    "cis_level": "• Level 1",
    "description": "Enable the option 'Enable Log on High DP Load' feature. When this option is selected, a\nsystem log entry is created when the device’s packet processing load reaches 100%\nutilization.",
    "expected_values": "Not enabled",
    "validation_logic": "Navigate to Device > Setup > Management > Logging and Reporting Settings\n> Log Export and Reporting.\nVerify Enable Log on High DP Load is checked.",
    "remediation_steps": "Navigate to Device > Setup > Management > Logging and Reporting Settings\n> Log Export and Reporting.\nSet the Enable Log on High DP Load box to checked.",
    "severity": null,
    "is_active": true,
    "references_text": "1. \"Logging Best Practices\" - https://live.paloaltonetworks.com/t5/best-practice-\nassessment-device/logging-and-reporting-settings-log-on-high-dp-mode/ta-\np/336964\nPage 26",
    "audit": "Navigate to Device > Setup > Management > Logging and Reporting Settings\n> Log Export and Reporting.\nVerify Enable Log on High DP Load is checked.",
    "rationale": "When the device’s packet processing load reaches 100%, a degradation in the\navailability of services accessed through the device can occur. Logging this event can\nhelp with troubleshooting system performance.",
    "impact": "Sustained attacks, especially volumetric DOS and DDOS attacks will often affect CPU\nutilization. This setting will generate an event that is easily monitored for and alerted on.\nWhile setting CPU utilization watermarks in a Network Management System is a\nstandard practice, this setting does not depend on even having an NMS, it doesn't\nrequire anything other than standard logging to implement."
  },
  {
    "rule_id": "1.2.1",
    "benchmark": "CIS Palo Alto Firewall 11 Benchmark v1.2.0",
    "device_type": "Palo Alto",
    "control_name": "Ensure 'Permitted IP Addresses' is set to those necessary",
    "cis_level": "• Level 1",
    "description": "Permit only the necessary IP addresses to be used to manage the device.",
    "expected_values": "Not enabled (all addresses that can reach the interface are permitted)",
    "validation_logic": "Navigate to Device > Setup > Interfaces > Management.\nVerify that Permitted IP Addresses is limited only to those necessary for device\nmanagement.",
    "remediation_steps": "Navigate to Device > Setup > Interfaces > Management.\nSet Permitted IP Addresses to only those necessary for device management for the\nSSH and HTTPS protocols. If no profile exists, create one that has these addresses set.",
    "severity": null,
    "is_active": true,
    "references_text": "1. \"How to Allow Certain IP Addresses on the Management Interface\" -\nhttps://live.paloaltonetworks.com/docs/DOC-8432\n2. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing\nAdministrative Access\": https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-\nadmin/getting-started/best-practices-for-securing-administrative-access.html#\nPage 29",
    "audit": "Navigate to Device > Setup > Interfaces > Management.\nVerify that Permitted IP Addresses is limited only to those necessary for device\nmanagement.",
    "rationale": "Management access to the device should be restricted to the IP addresses or subnets\nused by firewall administrators. Permitting management access from other IP addresses\nincreases the risk of unauthorized access through password guessing, stolen\ncredentials, or other means.",
    "impact": null
  },
  {
    "rule_id": "1.2.2",
    "benchmark": "CIS Palo Alto Firewall 11 Benchmark v1.2.0",
    "device_type": "Palo Alto",
    "control_name": "Ensure 'Permitted IP Addresses' is set for all management",
    "cis_level": "• Level 1",
    "description": "For all management profiles, only the IP addresses required for device management\nshould be specified.",
    "expected_values": "Not enabled",
    "validation_logic": "Navigate to Network > Network Profiles > Interface Management.\nIn each profile, for each of the target protocols (SNMP, HTTPS, SSH), verify that\nPermitted IP Addresses is limited to those necessary for device management.",
    "remediation_steps": "Navigate to Network > Network Profiles > Interface Management.\nIn each profile, for each of the target protocols (SNMP, HTTPS, SSH), set Permitted\nIP Addresses to only include those necessary for device management. If no profile\nexists, create one that has these options set.",
    "severity": null,
    "is_active": true,
    "references_text": "1. \"How to Allow Certain IP Addresses on the Management Interface\" -\nhttps://live.paloaltonetworks.com/docs/DOC-8432\n2. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing\nAdministrative Access\": https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-\nadmin/getting-started/best-practices-for-securing-administrative-access.html#\nPage 31",
    "audit": "Navigate to Network > Network Profiles > Interface Management.\nIn each profile, for each of the target protocols (SNMP, HTTPS, SSH), verify that\nPermitted IP Addresses is limited to those necessary for device management.",
    "rationale": "If a Permitted IP Addresses list is either not specified or is too broad, an attacker may\ngain the ability to attempt management access from unintended locations, such as the\nInternet. The “Ensure 'Security Policy' denying any/all traffic exists at the bottom of the\nsecurity policies ruleset” recommendation in this benchmark can provide additional\nprotection by requiring a security policy specifically allowing device management\naccess.",
    "impact": null
  },
  {
    "rule_id": "1.2.3",
    "benchmark": "CIS Palo Alto Firewall 11 Benchmark v1.2.0",
    "device_type": "Palo Alto",
    "control_name": "Ensure HTTP and Telnet options are disabled for the",
    "cis_level": "• Level 1",
    "description": "HTTP and Telnet options should not be enabled for device management.",
    "expected_values": "Not set. (HTTP and Telnet are disabled by default)",
    "validation_logic": "Navigate to Device > Setup > Interfaces > Management.\nVerify that the HTTP and Telnet options are both unchecked.",
    "remediation_steps": "Navigate to Device > Setup > Interfaces > Management.\nSet the HTTP and Telnet boxes to unchecked.",
    "severity": null,
    "is_active": true,
    "references_text": "1. \"How to Configure a Layer 3 Interface to act as a Management Port\" -\nhttps://live.paloaltonetworks.com/t5/Configuration-Articles/How-to-Configure-a-\nLayer-3-Interface-to-act-as-a-Management-Port/ta-p/59024\n2. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing\nAdministrative Access\": https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-\nadmin/getting-started/best-practices-for-securing-administrative-access.html#\nPage 33",
    "audit": "Navigate to Device > Setup > Interfaces > Management.\nVerify that the HTTP and Telnet options are both unchecked.",
    "rationale": "Management access over cleartext services such as HTTP or Telnet could result in a\ncompromise of administrator credentials and other sensitive information related to\ndevice management. Theft of either administrative credentials or session data is easily\naccomplished with a \"Man in the Middle\" attack.",
    "impact": null
  },
  {
    "rule_id": "1.2.4",
    "benchmark": "CIS Palo Alto Firewall 11 Benchmark v1.2.0",
    "device_type": "Palo Alto",
    "control_name": "Ensure HTTP and Telnet options are disabled for all",
    "cis_level": "• Level 1",
    "description": "HTTP and Telnet options should not be enabled for device management.",
    "expected_values": null,
    "validation_logic": "Navigate to Network > Network Profiles > Interface Management. For each\nInterface Management profile verify that the HTTP and Telnet options are both\nunchecked.",
    "remediation_steps": "Navigate to Network > Network Profiles > Interface Management. For each\nProfile, set the HTTP and Telnet boxes to unchecked.",
    "severity": null,
    "is_active": true,
    "references_text": "1. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing\nAdministrative Access\": https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-\nadmin/getting-started/best-practices-for-securing-administrative-access.html#\n2. “PAN-OS Administrator's Guide 9.0 (English) - Use Interface Management\nProfiles to Restrict Access\": https://docs.paloaltonetworks.com/pan-os/9-0/pan-\nos-admin/networking/configure-interfaces/use-interface-management-profiles-to-\nrestrict-access.html#",
    "audit": "Navigate to Network > Network Profiles > Interface Management. For each\nInterface Management profile verify that the HTTP and Telnet options are both\nunchecked.",
    "rationale": "Management access over cleartext services such as HTTP or Telnet could result in a\ncompromise of administrator credentials and other sensitive information related to\ndevice management.",
    "impact": null
  },
  {
    "rule_id": "1.2.5",
    "benchmark": "CIS Palo Alto Firewall 11 Benchmark v1.2.0",
    "device_type": "Palo Alto",
    "control_name": "Ensure valid certificate is set for browser-based",
    "cis_level": "• Level 2",
    "description": "In most cases, a browser HTTPS interface is used to administer the Palo Alto\nappliance. The certificate used to secure this session should satisfy the following\ncriteria:\n1. A valid certificate from a trusted source should be used. While a certificate from a\ntrusted Public Certificate Authority is certainly valid, one from a trusted Private\nCertificate Authority is absolutely acceptable for this purpose.\n2. The certificate should have a valid date. It should not have a \"to\" date in the past\n(it should not be expired), and should not have a \"from\" date in the future.\n3. The certificate should use an acceptable cipher and encryption level.",
    "expected_values": "A self-signed certificate is installed by default for the administrative interface.",
    "validation_logic": "Verify that the certificate used to secure HTTPS sessions meets the criteria by\nreviewing the appropriate certificate:\nNavigate to Device > Certificate Management > Certificates\nVerify that this Certificate is properly applied to the Management Interface:\nNavigate to Device > Setup > Management > General Settings > SSL/TLS\nService Profile",
    "remediation_steps": "Create or acquire a certificate that meets the stated criteria and set it:\nNavigate to Device > Certificate Management > Certificates\nPage 37\nImport an appropriate Certificate for your administrative session, from a trusted\nCertificate Authority.\nNavigate to Device > Certificate Management > SSL/TLS Service Profile\nChoose or import the certificate you want to use for the web based administrative\nsession.\nNavigate to Device > Setup > Management > General Settings > SSL/TLS\nService Profile\nChoose the Service Profile that you have configured",
    "severity": null,
    "is_active": true,
    "references_text": "1. \"How to Configure a Certificate for Secure Web GUI Access\" -\nhttps://live.paloaltonetworks.com/t5/Configuration-Articles/How-to-configure-a-\ncertificate-for-secure-web-gui-access/ta-p/68653\n2. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing\nAdministrative Access\": https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-\nadmin/getting-started/best-practices-for-securing-administrative-access.html#",
    "audit": "Verify that the certificate used to secure HTTPS sessions meets the criteria by\nreviewing the appropriate certificate:\nNavigate to Device > Certificate Management > Certificates\nVerify that this Certificate is properly applied to the Management Interface:\nNavigate to Device > Setup > Management > General Settings > SSL/TLS\nService Profile",
    "rationale": "If a certificate that is self-signed, expired, or otherwise invalid is used for the browser\nHTTPS interface, administrators in most cases will not be able to tell if their session is\nbeing eavesdropped on or injected into by a \"Man in the Middle\" attack.",
    "impact": "If the default self-signed certificate is used, an administrator will not be able to clearly\ntell if their HTTPS session is being hijacked or not. Using a trusted certificate ensures\nthat the session is both encrypted and trusted."
  },
  {
    "rule_id": "1.3.1",
    "benchmark": "CIS Palo Alto Firewall 11 Benchmark v1.2.0",
    "device_type": "Palo Alto",
    "control_name": "Ensure 'Minimum Password Complexity' is enabled",
    "cis_level": "• Level 1",
    "description": "This checks all new passwords to ensure that they meet basic requirements for strong\npasswords.",
    "expected_values": "Not enabled.",
    "validation_logic": "Navigate to Device > Setup > Management > Minimum Password Complexity.\nVerify Enabled is checked\nEnsure that the various password settings to values that are appropriate to your\norganization. Non-zero values should be set for Minimum Uppercase, Lowercase and\nSpecial Characters. \"Block Username Inclusion\" should be enabled.",
    "remediation_steps": "Navigate to Device > Setup > Management > Minimum Password Complexity.\nSet Enabled to be checked\nPage 40\nSet that the various password settings to values that are appropriate to your\norganization. It is suggested that there at least be some special characters enforced,\nand that a minimum length be set. Ensure that non-zero values are set for Minimum\nUppercase, Lowercase and Special Characters. \"Block Username Inclusion\" should be\nenabled.\nOperationally, dictionary words should be avoided for all passwords - passphrases are a\nmuch better alternative.",
    "severity": null,
    "is_active": true,
    "references_text": "1. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing\nAdministrative Access” - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-\nadmin/getting-started/best-practices-for-securing-administrative-access.html",
    "audit": "Navigate to Device > Setup > Management > Minimum Password Complexity.\nVerify Enabled is checked\nEnsure that the various password settings to values that are appropriate to your\norganization. Non-zero values should be set for Minimum Uppercase, Lowercase and\nSpecial Characters. \"Block Username Inclusion\" should be enabled.",
    "rationale": "Password complexity recommendations are derived from the USGCB (United States\nGovernment Configuration Baseline), Common Weakness Enumeration, and\nbenchmarks published by the CIS (Center for Internet Security). Password complexity\nadds entropy to a password, in comparison to a simple password of the same length. A\ncomplex password is more difficult to attack, either directly against administrative\ninterfaces or cryptographically, against captured password hashes. However, making a\npassword of greater length will generally have a greater impact in this regard, in\ncomparison to making a shorter password more complex.",
    "impact": "Simple passwords make an attacker's job very easy. There is a reasonably short list of\ncommonly used admin passwords for network infrastructure, not enforcing password\nlengths and complexity can lend itself to making an attacker's brute force attack\nsuccessful."
  },
  {
    "rule_id": "1.3.2",
    "benchmark": "CIS Palo Alto Firewall 11 Benchmark v1.2.0",
    "device_type": "Palo Alto",
    "control_name": "Ensure 'Minimum Length' is greater than or equal to 12",
    "cis_level": "• Level 1",
    "description": "This determines the least number of characters that make up a password for a user\naccount.",
    "expected_values": "Not enabled.\nPage 42",
    "validation_logic": "Navigate to Device > Setup > Management > Minimum Password Complexity.\nVerify Minimum Length is greater than or equal to 12",
    "remediation_steps": "Navigate to Device > Setup > Management > Minimum Password Complexity.\nSet Minimum Length to greater than or equal to 12",
    "severity": null,
    "is_active": true,
    "references_text": "1. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing\nAdministrative Access” - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-\nadmin/getting-started/best-practices-for-securing-administrative-access.html",
    "audit": "Navigate to Device > Setup > Management > Minimum Password Complexity.\nVerify Minimum Length is greater than or equal to 12",
    "rationale": "A longer password is much more difficult to attack, either directly against administrative\ninterfaces or cryptographically, against captured password hashes. Making a password\nof greater length will generally have a greater impact in this regard, in comparison to\nmaking a shorter password more complex. Passphrases are a commonly used\nrecommendation, to make longer passwords more palatable to end users.\nAdministrative staff however generally use \"password safe\" applications, so a long and\ncomplex password is more easily implemented for most infrastructure administrative\ninterfaces.",
    "impact": "Longer passwords are much more difficult to attack. This is true of attacks against the\nadministrative interfaces themselves, or of decryption attacks against captured hashes.\nA longer password will almost always have a more positive impact than a shorter but\nmore complex password."
  },
  {
    "rule_id": "1.3.3",
    "benchmark": "CIS Palo Alto Firewall 11 Benchmark v1.2.0",
    "device_type": "Palo Alto",
    "control_name": "Ensure 'Minimum Uppercase Letters' is greater than or",
    "cis_level": "• Level 1",
    "description": "This checks all new passwords to ensure that they contain at least one English\nuppercase character (A through Z).",
    "expected_values": "Not enabled.",
    "validation_logic": "Navigate to Device > Setup > Management > Minimum Password Complexity\nVerify Minimum Uppercase Letters is greater than or equal to 1",
    "remediation_steps": "Navigate to Device > Setup > Management > Minimum Password Complexity\nSet Minimum Uppercase Letters to greater than or equal to 1",
    "severity": null,
    "is_active": true,
    "references_text": "1. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing\nAdministrative Access” - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-\nadmin/getting-started/best-practices-for-securing-administrative-access.html",
    "audit": "Navigate to Device > Setup > Management > Minimum Password Complexity\nVerify Minimum Uppercase Letters is greater than or equal to 1",
    "rationale": "This is one of several settings that, when taken together, ensure that passwords are\nsufficiently complex as to thwart brute force and dictionary attacks.",
    "impact": null
  },
  {
    "rule_id": "1.3.4",
    "benchmark": "CIS Palo Alto Firewall 11 Benchmark v1.2.0",
    "device_type": "Palo Alto",
    "control_name": "Ensure 'Minimum Lowercase Letters' is greater than or",
    "cis_level": "• Level 1",
    "description": "This checks all new passwords to ensure that they contain at least one English\nlowercase character (a through z).",
    "expected_values": "Not enabled.",
    "validation_logic": "Navigate to Device > Setup > Management > Minimum Password Complexity\nVerify Minimum Lowercase Letters is greater than or equal to 1",
    "remediation_steps": "Navigate to Device > Setup > Management > Minimum Password Complexity\nSet Minimum Lowercase Letters to greater than or equal to 1",
    "severity": null,
    "is_active": true,
    "references_text": "1. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing\nAdministrative Access” - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-\nadmin/getting-started/best-practices-for-securing-administrative-access.html",
    "audit": "Navigate to Device > Setup > Management > Minimum Password Complexity\nVerify Minimum Lowercase Letters is greater than or equal to 1",
    "rationale": "This is one of several settings that, when taken together, ensure that passwords are\nsufficiently complex as to thwart brute force and dictionary attacks.",
    "impact": null
  },
  {
    "rule_id": "1.3.5",
    "benchmark": "CIS Palo Alto Firewall 11 Benchmark v1.2.0",
    "device_type": "Palo Alto",
    "control_name": "Ensure 'Minimum Numeric Letters' is greater than or equal",
    "cis_level": "• Level 1",
    "description": "This checks all new passwords to ensure that they contain at least one base 10 digit (0\nthrough 9).",
    "expected_values": "Not enabled.",
    "validation_logic": "Navigate to Device > Setup > Management > Minimum Password Complexity`\nVerify Minimum Numeric Letters is greater than or equal to 1",
    "remediation_steps": "Navigate to Device > Setup > Management > Minimum Password Complexity\nSet Minimum Numeric Letters to greater than or equal to 1",
    "severity": null,
    "is_active": true,
    "references_text": "1. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing\nAdministrative Access” - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-\nadmin/getting-started/best-practices-for-securing-administrative-access.html",
    "audit": "Navigate to Device > Setup > Management > Minimum Password Complexity`\nVerify Minimum Numeric Letters is greater than or equal to 1",
    "rationale": "This is one of several settings that, when taken together, ensure that passwords are\nsufficiently complex as to thwart brute force and dictionary attacks.",
    "impact": null
  },
  {
    "rule_id": "1.3.6",
    "benchmark": "CIS Palo Alto Firewall 11 Benchmark v1.2.0",
    "device_type": "Palo Alto",
    "control_name": "Ensure 'Minimum Special Characters' is greater than or",
    "cis_level": "• Level 1",
    "description": "This checks all new passwords to ensure that they contain at least one non-alphabetic\ncharacter (for example, !, $, #, %).",
    "expected_values": "Not enabled.",
    "validation_logic": "Navigate to Device > Setup > Management > Minimum Password Complexity\nVerify Minimum Special Characters is greater than or equal to 1",
    "remediation_steps": "Navigate to Device > Setup > Management > Minimum Password Complexity\nSet Minimum Special Characters to greater than or equal to 1",
    "severity": null,
    "is_active": true,
    "references_text": "1. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing\nAdministrative Access” - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-\nadmin/getting-started/best-practices-for-securing-administrative-access.html",
    "audit": "Navigate to Device > Setup > Management > Minimum Password Complexity\nVerify Minimum Special Characters is greater than or equal to 1",
    "rationale": "This is one of several settings that, when taken together, ensure that passwords are\nsufficiently complex as to thwart brute force and dictionary attacks.",
    "impact": null
  },
  {
    "rule_id": "1.3.7",
    "benchmark": "CIS Palo Alto Firewall 11 Benchmark v1.2.0",
    "device_type": "Palo Alto",
    "control_name": "Ensure 'Required Password Change Period' is less than or",
    "cis_level": "• Level 1",
    "description": "This defines how long a user can use a password before it expires.",
    "expected_values": "Not enabled.",
    "validation_logic": "Navigate to Device > Setup > Management > Minimum Password Complexity.\nVerify Required Password Change Period (days) is less than or equal to 90",
    "remediation_steps": "Navigate to Device > Setup > Management > Minimum Password Complexity.\nSet Required Password Change Period (days) to less than or equal to 90",
    "severity": null,
    "is_active": true,
    "references_text": "1. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing\nAdministrative Access” - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-\nadmin/getting-started/best-practices-for-securing-administrative-access.html\nPage 52",
    "audit": "Navigate to Device > Setup > Management > Minimum Password Complexity.\nVerify Required Password Change Period (days) is less than or equal to 90",
    "rationale": "The longer a password exists, the higher the likelihood that it will be compromised by a\nbrute force attack, by an attacker gaining general knowledge about the user and\nguessing the password, or by the user sharing the password.",
    "impact": "Failure to change administrative passwords can result in a slow \"creep\" of people who\nhave access. Especially in a situation with high staff turnover (for instance, in a NOC or\nSOC situation), administrative passwords need to be changed frequently.\nAdministrative credentials should not be shared across multiple devices. In a NOC/SOC\nsituation, it's important to not share administrative credentials between operators\n(names accounts should be used), and in particular administrative credentials should\nnever be shared across different customer infrastructures."
  },
  {
    "rule_id": "1.3.8",
    "benchmark": "CIS Palo Alto Firewall 11 Benchmark v1.2.0",
    "device_type": "Palo Alto",
    "control_name": "Ensure 'New Password Differs By Characters' is greater",
    "cis_level": "• Level 1",
    "description": "This checks all new passwords to ensure that they differ by at least three characters\nfrom the previous password.",
    "expected_values": "Not enabled.",
    "validation_logic": "Navigate to Device > Setup > Management > Minimum Password Complexity\nVerify New Password Differs By Characters is set to greater than or equal to 3",
    "remediation_steps": "Navigate to Device > Setup > Management > Minimum Password Complexity\nSet New Password Differs By Characters to 3 or more",
    "severity": null,
    "is_active": true,
    "references_text": "1. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing\nAdministrative Access” - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-\nadmin/getting-started/best-practices-for-securing-administrative-access.html\nPage 54",
    "audit": "Navigate to Device > Setup > Management > Minimum Password Complexity\nVerify New Password Differs By Characters is set to greater than or equal to 3",
    "rationale": "This is one of several settings that, when taken together, ensure that passwords are\nsufficiently complex as to thwart brute force and dictionary attacks.",
    "impact": "This prevents the use of passwords that fall into a predictable pattern. Especially in\nsituations that involve staff turnover, having a pattern to password changes should be\navoided."
  },
  {
    "rule_id": "1.3.9",
    "benchmark": "CIS Palo Alto Firewall 11 Benchmark v1.2.0",
    "device_type": "Palo Alto",
    "control_name": "Ensure 'Prevent Password Reuse Limit' is set to 24 or more",
    "cis_level": "• Level 1",
    "description": "This determines the number of unique passwords that have to be most recently used for\na user account before a previous password can be reused.",
    "expected_values": "Not enabled.",
    "validation_logic": "Navigate to Device > Setup > Management > Minimum Password Complexity.\nVerify Prevent Password Reuse Limit is greater than or equal to 24",
    "remediation_steps": "Navigate to Device > Setup > Management > Minimum Password Complexity.\nSet Prevent Password Reuse Limit to greater than or equal to 24",
    "severity": null,
    "is_active": true,
    "references_text": "1. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing\nAdministrative Access” - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-\nadmin/getting-started/best-practices-for-securing-administrative-access.html\nPage 56",
    "audit": "Navigate to Device > Setup > Management > Minimum Password Complexity.\nVerify Prevent Password Reuse Limit is greater than or equal to 24",
    "rationale": "The longer a user uses the same password, the greater the chance that an attacker can\ndetermine the password through brute force attacks. Also, any accounts that may have\nbeen compromised will remain exploitable for as long as the password is left\nunchanged. If password changes are required but password reuse is not prevented, or if\nusers continually reuse a small number of passwords, the effectiveness of a good\npassword policy is greatly reduced. While current guidance emphasizes password\nlength above frequent password changes, not enforcing password re-use guidance\nadds the temptation of using a small pool of passwords, which can make an attacker's\njob easier across an entire infrastructure.",
    "impact": null
  },
  {
    "rule_id": "1.3.10",
    "benchmark": "CIS Palo Alto Firewall 11 Benchmark v1.2.0",
    "device_type": "Palo Alto",
    "control_name": "Ensure 'Password Profiles' do not exist",
    "cis_level": "• Level 1",
    "description": "Password profiles that are weaker than the recommended minimum password\ncomplexity settings must not exist.",
    "expected_values": "Not configured",
    "validation_logic": "Navigate to Device > Password Profiles.\nVerify Password Profiles weaker than the recommended minimum password complexity\nsettings do not exist.",
    "remediation_steps": "Navigate to Device > Password Profiles.\nEnsure Password Profiles weaker than the recommended minimum password\ncomplexity settings do not exist.",
    "severity": "Automated",
    "is_active": true,
    "references_text": "1. “PAN-OS Administrator's Guide 9.0 (English) - Best Practices for Securing\nAdministrative Access” - https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-\nadmin/getting-started/best-practices-for-securing-administrative-access.html",
    "audit": "Navigate to Device > Password Profiles.\nVerify Password Profiles weaker than the recommended minimum password complexity\nsettings do not exist.",
    "rationale": "As password profiles override any 'Minimum Password Complexity' settings defined in\nthe device, they generally should not exist. If these password profiles do exist, they\nshould enforce stronger password policies than what is set in the 'Minimum Password\nComplexity' settings.",
    "impact": null
  },
  {
    "rule_id": "1.4.1",
    "benchmark": "CIS Palo Alto Firewall 11 Benchmark v1.2.0",
    "device_type": "Palo Alto",
    "control_name": "Ensure 'Idle timeout' is less than or equal to 10 minutes for",
    "cis_level": "• Level 1",
    "description": "Set the Idle Timeout value for device management to 10 minutes or less to\nautomatically close inactive sessions.",
    "expected_values": "Not configured",
    "validation_logic": "Navigate to Device > Setup > Management > Authentication Settings.\nVerify Idle Timeout is less than or equal to 10.",
    "remediation_steps": "Navigate to Device > Setup > Management > Authentication Settings.\nSet Idle Timeout to less than or equal to 10.",
    "severity": null,
    "is_active": true,
    "references_text": "1. “How to Change the Admin Session Timeout Value” -\nhttps://live.paloaltonetworks.com/docs/DOC-5557\n2. “PAN-OS Administrator's Guide 11.1 (English) - Device - Setup - Management” -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-\nhelp/device/device-setup-management#\nPage 61",
    "audit": "Navigate to Device > Setup > Management > Authentication Settings.\nVerify Idle Timeout is less than or equal to 10.",
    "rationale": "An unattended computer with an open administrative session to the device could allow\nan unauthorized user access to the firewall’s management interface.",
    "impact": null
  },
  {
    "rule_id": "1.4.2",
    "benchmark": "CIS Palo Alto Firewall 11 Benchmark v1.2.0",
    "device_type": "Palo Alto",
    "control_name": "Ensure 'Failed Attempts' and 'Lockout Time' for",
    "cis_level": "• Level 1",
    "description": "Configure values for Failed Login Attempts and Account Lockout Time set to\norganization-defined values (for example, 3 failed attempts and a 15 minute lockout\ntime). Do not set Failed Attempts and Lockout Time in the Authentication Settings\nsection; any Failed Attempts or Lockout Time settings within the selected Authentication\nProfile do not apply in the Authentication Settings section.",
    "expected_values": "Not configured",
    "validation_logic": "Navigate to Device > Authentication Profile.\nVerify Failed Attempts is set a non-zero organization-defined value.\nVerify Lockout Time is set to a non-zero organization-defined value.",
    "remediation_steps": "Navigate to Device > Authentication Profile.\nSet Failed Attempts to the non-zero organization-defined value.\nSet Lockout Time to the non-zero organization-defined value.",
    "severity": null,
    "is_active": true,
    "references_text": "1. “PAN-OS Administrator's Guide 11.1 (English) - Device - Setup - Management” -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-\nhelp/device/device-setup-management#\nPage 63\n2. “PAN-OS Administrator's Guide 11.1 (English) - Authentication Profile\" -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-\nhelp/device/device-authentication-profile",
    "audit": "Navigate to Device > Authentication Profile.\nVerify Failed Attempts is set a non-zero organization-defined value.\nVerify Lockout Time is set to a non-zero organization-defined value.",
    "rationale": "Without a lockout limit, an attacker can continuously guess administrators’ passwords.\nFrom the other point of view, if lockout settings are configured in the Authentication\nSettings section it may be possible for an attacker to continuously lock out all\nadministrative accounts from accessing the device. This potential situation indicates the\nimportance of using named administrative accounts, instead of the default, single\nshared \"admin\" account.",
    "impact": null
  },
  {
    "rule_id": "1.5.1",
    "benchmark": "CIS Palo Alto Firewall 11 Benchmark v1.2.0",
    "device_type": "Palo Alto",
    "control_name": "Ensure 'V3' is selected for SNMP polling",
    "cis_level": "• Level 1",
    "description": "For SNMP polling, only SNMPv3 should be used.",
    "expected_values": "Not configured",
    "validation_logic": "Navigate to Device > Setup > Operations > Miscellaneous > SNMP Setup\nVerify V3 is selected.",
    "remediation_steps": "Navigate to Device > Setup > Operations > Miscellaneous > SNMP Setup\nSelect V3.\nIn order to be usable, the User and View sections of this dialog should also be\ncompleted. These settings need to match the settings in the organization's NMS\n(Network Management System)",
    "severity": "Automated",
    "is_active": true,
    "references_text": "1. https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-\nhelp/device/device-setup-operations/enable-snmp-monitoring\nPage 66",
    "audit": "Navigate to Device > Setup > Operations > Miscellaneous > SNMP Setup\nVerify V3 is selected.",
    "rationale": "SNMPv3 utilizes AES-128 encryption, message integrity, user authorization, and device\nauthentication security features. SNMPv2c does not provide these security features. If\nan SNMPv2c community string is intercepted or otherwise obtained, an attacker could\ngain read access to the firewall. Note that SNMP write access is not possible.",
    "impact": "Any clear-text administrative protocol (such as SNMPv2) can expose valuable\ninformation to any attacker that is in a position to eavesdrop on that protocol."
  },
  {
    "rule_id": "1.6.1",
    "benchmark": "CIS Palo Alto Firewall 11 Benchmark v1.2.0",
    "device_type": "Palo Alto",
    "control_name": "Ensure 'Verify Update Server Identity' is enabled",
    "cis_level": "• Level 1",
    "description": "This setting determines whether or not the identity of the update server must be verified\nbefore performing an update session. Note that if an SSL Forward Proxy is configured\nto intercept the update session, this option may need to be disabled (because the SSL\nCertificate will not match).",
    "expected_values": "Not configured",
    "validation_logic": "Navigate to Device > Setup > Services > Services.\nVerify that the Verify Update Server Identity box is checked.",
    "remediation_steps": "Navigate to Device > Setup > Services > Services.\nSet the Verify Update Server Identity box to checked.",
    "severity": null,
    "is_active": true,
    "references_text": "1. “PAN-OS Administrator's Guide 9.0 (English) - Install Content Updates\" -\nhttps://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/software-and-\ncontent-updates/install-content-and-software-updates.html\nPage 69",
    "audit": "Navigate to Device > Setup > Services > Services.\nVerify that the Verify Update Server Identity box is checked.",
    "rationale": "Verifying the update server identity before package download ensures the packages\noriginate from a trusted source. Without this, it is possible to receive and install an\nupdate from a malicious source.",
    "impact": "This setting protects the device from an \"evilgrade\" attack, where a successful DNS\nattack can redirect the firewall to an attacker-controlled update server, which can then\nserve a modified update."
  },
  {
    "rule_id": "1.6.2",
    "benchmark": "CIS Palo Alto Firewall 11 Benchmark v1.2.0",
    "device_type": "Palo Alto",
    "control_name": "Ensure redundant NTP servers are configured appropriately",
    "cis_level": "• Level 1",
    "description": "These settings enable use of primary and secondary NTP servers to provide\nredundancy in case of a failure involving the primary NTP server.",
    "expected_values": "Not configured\nPage 71",
    "validation_logic": "Navigate to Device > Setup > Services > Services.\nVerify Primary NTP Server Address is set appropriately.\nVerify Secondary NTP Server Address is set appropriately.",
    "remediation_steps": "Navigate to Device > Setup > Services > Services.\nSet Primary NTP Server Address appropriately.\nSet Secondary NTP Server Address appropriately.",
    "severity": null,
    "is_active": true,
    "references_text": "1. “The NIST Authenticated NTP Service” -\nhttp://www.nist.gov/pml/div688/grp40/authntp.cfm\n2. https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-\nhelp/device/device-setup-services/global-services-settings\n3. \"How to Configure Authenticated NTP\" -\nhttps://live.paloaltonetworks.com/t5/Configuration-Articles/How-to-Configure-\nAuthenticated-NTP/ta-p/54495",
    "audit": "Navigate to Device > Setup > Services > Services.\nVerify Primary NTP Server Address is set appropriately.\nVerify Secondary NTP Server Address is set appropriately.",
    "rationale": "NTP enables the device to maintain an accurate time and date when receiving updates\nfrom a reliable NTP server. Accurate timestamps are critical when correlating events\nwith other systems, troubleshooting, or performing investigative work. Logs and certain\ncryptographic functions, such as those utilizing certificates, rely on accurate time and\ndate parameters. In addition, rules referencing a Schedule object will not function as\nintended if the device’s time and date are incorrect.\nFor additional security, authenticated NTP can be utilized. If Symmetric Key\nauthentication is selected, only SHA1 should be used, as MD5 is considered severely\ncompromised.\nMost organizations will maintain a pair of internal NTP servers for all internal time\nservices. These servers will either be self-contained atomic clocks, or will collect time\nfrom a known reliable source (often GPS or a well-known internet server pool will be\nused).",
    "impact": null
  },
  {
    "rule_id": "1.6.3",
    "benchmark": "CIS Palo Alto Firewall 11 Benchmark v1.2.0",
    "device_type": "Palo Alto",
    "control_name": "Ensure that the Certificate Securing Remote Access VPNs",
    "cis_level": "• Level 2",
    "description": "The Certificate used to secure Remote Access VPNs should satisfy the following\ncriteria:\n• It should be a valid certificate from a trusted source. In almost cases this means\na trusted Public Certificate Authority, as in most cases remote access VPN users\nwill not have access to any Private Certificate Authorities for Certificate\nvalidation.\n• The certificate should have a valid date. It should not have a \"to\" date in the past\n(it should not be expired), and should not have a \"from\" date in the future.\n• The key length used to encrypt the certificate should be 2048 bits or more.\n• The hash used to sign the certificate should be SHA-2 or better.\n• When the Certificate is applied, the TLS version should be 1.1 or higher (1.2 is\nrecommended)",
    "expected_values": "Not configured",
    "validation_logic": "Verify that the certificate being used to secure the VPN meets the criteria listed above:\nNavigate to Device > Certificate Management > Certificates\nEnsure that a valid certificate is applied to the HTTPS portal:\nNavigate to Network > GlobalProtect > Portals > Portal Configuration >\n(Select the Portal being assessed) > Authentication > SSL/TLS Profile\nPage 73\nEnsure that a valid certificate is applied to the GlobalProtect Gateway:\nNavigate to Network > GlobalProtect > Gateways > (Select the Gateway\nbeing Assessed) > Authentication > SSL/TLS Service Profile\nEnsure that the correct Certificate is selected. Ensure that the Minimum TLS version is\nconfigured to be 1.1 or higher (TLSv1.2 is recommended).",
    "remediation_steps": "Create a CSR and install a certificate from a public CA (Certificate Authority) here:\nNavigate to Device > Certificate Management > Certificates\nApply a valid certificate to the HTTPS portal:\nNavigate to Network > GlobalProtect > Portals > Portal Configuration >\nAuthentication > SSL/TLS Profile\nApply a valid certificate to the GlobalProtect Gateway:\nNavigate to Network > GlobalProtect > Gateways > Authentication > SSL/TLS\nService Profile Configure the Service Profile to use the correct certificate\nEnsure that the Minimum TLS version is set to 1.1 or 1.2 (1.2 is recommended).",
    "severity": null,
    "is_active": true,
    "references_text": "1. “PAN-OS Administrator's Guide 9.0 (English) - GlobalProtect Certificate Best\nPractices\" - https://docs.paloaltonetworks.com/globalprotect/9-0/globalprotect-\nadmin/get-started/enable-ssl-between-globalprotect-components/globalprotect-\ncertificate-best-practices.html\n2. “PAN-OS Administrator's Guide 9.0 (English) - Deploy Server Certificates to the\nGlobalProtect Components\" - https://docs.paloaltonetworks.com/globalprotect/9-\n0/globalprotect-admin/get-started/enable-ssl-between-globalprotect-\ncomponents/deploy-server-certificates-to-the-globalprotect-components.html#",
    "audit": "Verify that the certificate being used to secure the VPN meets the criteria listed above:\nNavigate to Device > Certificate Management > Certificates\nEnsure that a valid certificate is applied to the HTTPS portal:\nNavigate to Network > GlobalProtect > Portals > Portal Configuration >\n(Select the Portal being assessed) > Authentication > SSL/TLS Profile\nPage 73\nEnsure that a valid certificate is applied to the GlobalProtect Gateway:\nNavigate to Network > GlobalProtect > Gateways > (Select the Gateway\nbeing Assessed) > Authentication > SSL/TLS Service Profile\nEnsure that the correct Certificate is selected. Ensure that the Minimum TLS version is\nconfigured to be 1.1 or higher (TLSv1.2 is recommended).",
    "rationale": "If presented with a certificate error, the end user in most cases will not be able to tell if\ntheir session is using a self-signed or expired certificate, or if their session is being\neavesdropped on or injected into by a \"Man in the Middle\" attack. This means that self-\nsigned or invalid certificates should never be used for VPN connections.",
    "impact": "Not using a trusted Certificate, issued by a trusted Public Certificate Authority means\nthat clients establishing VPN sessions will always see an error indicating an untrusted\nCertificate. This means that they will have no method of validating if their VPN session\nis being hijacked by a \"Monkey in the Middle\" (MitM) attack. It also \"trains\" them to\nbypass certificate warnings for other services, making MitM attacks easier for those\nother services as well."
  },
  {
    "rule_id": "1.7.1",
    "benchmark": "CIS Palo Alto Firewall 11 Benchmark v1.2.0",
    "device_type": "Palo Alto",
    "control_name": "Enabling Post-Quantum (PQ) on IKEv2 VPNs",
    "cis_level": "• Level 2\n• Level 2\n• Level 2\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 2\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 2\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 2\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 1\n• Level 2",
    "description": "For VPN that has IKEv2 enabled, enable PQ for more secure way to exchange pre-\nshared secret to defend against \"Harvest Now, Decrypt Later\" attack technique.\nConfigure appropriate settings to map IP addresses to usernames. Mapping userids to\nIP addresses is what permits the firewall to create rules based on userids and groups\nrather than IP addresses and subnets, as well as log events by userids rather than IP\naddresses or DNS names. The specifics of how to achieve IP-to-username mapping is\nhighly dependent on the environment. It can be enabled by integrating the firewall with a\ndomain controller, Exchange server, captive portal, Terminal Server, User-ID Agent,\nXML API, or syslog data from a variety of devices.\nDisable WMI probing if it is not required for User-ID functionality in the environment.\nOnly enable the User-ID option for interfaces that are both internal and trusted. There is\nrarely a legitimate need to allow WMI probing (or any user-id identification) on an\nuntrusted interface. The exception to this is identification of remote-access VPN users,\nwho are identified as they connect.\nIf User-ID is configured, use the Include/Exclude Networks section to limit the User-ID\nscope to operate only on trusted networks. There is rarely a legitimate need to allow\nWMI probing or other User identification on an untrusted network.\nIf the integrated (on-device) User-ID Agent is utilized, the Active Directory account for\nthe agent should only be a member of the Event Log Readers group, Distributed COM\nUsers group, and Domain Users group. If the Windows User-ID agent is utilized, the\nActive Directory account for the agent should only be a member of the Event Log\nReaders group, Server Operators group, and Domain Users group.\nRestrict the User-ID service account from interactively logging on to systems in the\nActive Directory domain.\nRestrict the User-ID service account’s ability to gain remote access into the\norganization. This capability could be made available through a variety of technologies,\nsuch as VPN, Citrix GoToMyPC, or TeamViewer. Remote services that integrate\nauthentication with the organization’s Active Directory may unintentionally allow the\nUser-ID service account to gain remote access.\nCreate security policies to deny Palo Alto User-ID traffic originating from the interface\nconfigured for the UID Agent service that are destined to any untrusted zone.\nEnsure a High Availability peer is fully synchronized and in a passive or active state.\nConfigure Link Monitoring and/or Path Monitoring under High Availability options. If Link\nMonitoring is utilized, all links critical to traffic flow should be monitored.\nSet the Passive Link State to auto, and uncheck the Preemptive option to disable it.\nSet Antivirus Update Schedule to download and install updates hourly.\nSet the Applications and Threats Update Schedule to download and install updates at\ndaily or shorter intervals.\nThe default file size limits on the firewall are designed to include the majority of malware\nin the wild (which is smaller than the default size limits) and to exclude large files that\nare very unlikely to be malicious and that can impact WildFire file-forwarding capacity.\nEnsure that all files traversing the firewall are inspected by WildFire by setting a Wildfire\nfile blocking profile on all security policies.\nAllow the firewall to forward decrypted content to WildFire. Note that SSL Forward-\nProxy must also be enabled and configured for this setting to take effect on inside-to-\noutside traffic flows.\nEnable all options under Session Information Settings for WildFire.\nConfigure WildFire to send an alert when a malicious or greyware file is detected. This\nalert could be sent by whichever means is preferable, including email, SNMP trap, or\nsyslog message.\nAlternatively, configure the WildFire cloud to generate alerts for malicious files. The\ncloud can generate alerts in addition to or instead of the local WildFire implementation.\nNote that the destination email address of alerts configured in the WildFire cloud portal\nis tied to the logged in account, and cannot be modified. Also, new systems added to\nthe WildFire cloud portal will not be automatically set to email alerts.\nSet the WildFire update schedule to download and install updates in real-time.\nBy default, all relevant files are uploaded to Wildfire datacenter located in US. Palo Alto\nNetworks has been adding more WildFire regional clouds around the world. From\nhaving just 3 regional clouds back in PanOS 8.x, now to more than 10 regional clouds\nall over the world.\nEnable 'Advanced WildFire Inline Cloud Analysis' on Wildfire profiles and forward PE\nfiles for analysis. Palo Alto Networks Advanced WildFire operates a series of cloud-\nbased ML detection engines that provide inline analysis of PE (portable executable) files\ntraversing your network to detect and prevent advanced malware in real-time.\nConfigure antivirus profiles to a value of 'reset-both' for all decoders except imap and\npop3 under both Action and WildFire Action. If required by the organization's email\nimplementation, configure imap and pop3 decoders to 'alert' under both Action and\nWildFire Action.\nCreate a secure antivirus profile and apply it to all security policies that could pass\nHTTP, SMTP, IMAP, POP3, FTP, or SMB traffic. The antivirus profile may be applied to\nthe security policies directly or through a profile group.\nIf a single rule exists within the anti-spyware profile, configure it to block on Critical,\nHigh, and Medium spyware severity level, any category, and any threat. If multiple rules\nexist within the anti-spyware profile, ensure all spyware categories, threats, and severity\nlevels (Critical, High, and Medium) are set to be blocked. Additional rules may exist for\npacket capture or exclusion purposes.\nConfigure DNS sinkholing for all anti-spyware profiles in use. All internal requests to the\nselected sinkhole IP address must traverse the firewall. Any device attempting to\ncommunicate with the DNS sinkhole IP address should be considered infected.\nCreate one or more anti-spyware profiles and collectively apply them to all security\npolicies permitting traffic to the Internet. The anti-spyware profiles may be applied to the\nsecurity policies directly or through a profile group.\nConfigure a Vulnerability Protection Profile set to block attacks against any critical or\nhigh vulnerabilities, at minimum, and set to default on any medium, low, or informational\nvulnerabilities. Configuring an alert action for low and informational, instead of default,\nwill produce additional information at the expense of greater log utilization.\nFor any security rule allowing traffic, apply a securely configured Vulnerability Protection\nProfile. Careful analysis of the target environment should be performed before\nimplementing this configuration, as outlined by PAN’s “Threat Prevention Deployment\nTech Note” in the references section.\nConfigure the device to use PAN-DB URL Filtering instead of BrightCloud.\nIdeally, deciding which URL categories to block, and which to allow, is a joint effort\nbetween IT and another entity of authority within an organization—such as the legal\ndepartment or administration. For most organizations, blocking or requiring an override\non the following categories represents a minimum baseline: adult, hacking, command-\nand-control, copyright-infringement, extremism, malware, phishing, proxy-avoidance-\nand-anonymizers, and parked. Some organizations may add \"unknown\" and \"dynamic-\ndns\" to this list, at the expense of some support calls on those topics.\nURL filters should not specify any categories as Allow Categories.\nEnable all options (User-Agent, Referer, and X-Forwarded-For) for HTTP header\nlogging.\nApply a secure URL filtering profile to all security policies permitting traffic to the\nInternet. The URL Filtering profile may be applied to the security policies directly or\nthrough a profile group.\nThis guideline is highly specific to an organization. While blocking of credit card or\nSocial Security numbers will not occur with the recommended settings below, careful\ntuning is also recommended.\nCreate a secure Data Filtering profile and apply it to all security policies permitting traffic\nto or from the Internet. The Data Filtering profile may be applied to security policies\ndirectly or through a profile group.\nEnable the SYN Flood Action of SYN Cookies for all untrusted zones. The Alert,\nActivate, and Maximum settings for SYN Flood Protection depend highly on the\nenvironment and device used. Perform traffic analysis on the specific environment and\nfirewall to determine accurate thresholds. Do not rely on default values to be\nappropriate for an environment.\nSetting these values for all interfaces is an approach that should be considered by many\norganizations, as traffic floods can result from internal testing or malware as well.\nAs a rough ballpark for most environments, an Activate value of 50% of the firewall’s\nmaximum “New sessions per second”/CPS is a conservative setting. The following is a\nlist of maximum new sessions per second for each platform (listed here is for the largest\nmodel for each series):\nPA-4xx series = 73,000 CPS\nPA-8xx series = 13,100 CPS\nPA-14xx series = 140,000 CPS\nPA-32xx series = 84,000 CPS\nPA-34xx series = 268,000 CPS\nPA-52xx series = 500,000 CPS\nPA-54xx series = 3,600,000 CPS\nPA-70xx series = 6,000,000 CPS\nNote:\nPlease confirm the exact maximum CPS using latest datasheet published by Palo Alto\nNetworks based on the exact series model of a given platform.\nEnable all Flood Protection options in the Zone Protection Profile attached to all\nuntrusted zones. The Alert, Activate, and Maximum settings for Flood Protection\ndepend highly on the environment and device used. Perform traffic analysis on the\nspecific environment and firewall to determine accurate thresholds. Do not rely on\ndefault values to be appropriate for an environment.\nSetting these values for all interfaces is an approach that should be considered by many\norganizations, as traffic floods can result from internal testing or malware as well.\nEnable all three scan options in a Zone Protection profile. Do not configure an action of\nAllow for any scan type. The exact interval and threshold values must be tuned to the\nspecific environment. Less aggressive settings are typically appropriate for trusted\nzones, such as setting an action of alert for all scan types.\nAttach appropriate Zone Protection profiles meeting these criteria to all zones. Separate\nZone Protection profiles for trusted and untrusted zones is a best practice.\nFor all zones, attach a Zone Protection Profile that is configured to drop packets with a\nspoofed IP address or a mismatched overlapping TCP segment, and packets with\nmalformed, strict source routing, or loose source routing IP options set.\nIdeally user names and passwords user within an organization are not used with third\nparty sites. Some sanctioned SAS applications may have connections to the corporate\ndomain, in which case they will need to be exempt from the user credential submission\npolicy through a custom URL category.\nConfigure 'Wildfire Inline ML Action' on antivirus profiles to a value of 'reset-both' for all\ndecoders except imap and pop3 under 'Wildfire Inline ML Action'. If required by the\norganization's email implementation, configure imap and pop3 decoders to 'alert' under\n'Wildfire Inline ML Action'.\nConfigure 'Wildfire Inline ML' on antivirus profiles to a value of 'enable' for all file types.\nEnable 'Inline Cloud Analysis' on Vulnerability Protection profiles to combat zero-day\nthreats.\nEnable both 'Local Inline Categorization' and 'Cloud Inline Categorization' on URL\nFiltering profiles to evaluate suspicious web page contents in real-time to protect users\nagainst zero-day threats.\nEnable 'Inline Cloud Analysis' on Anti-Spyware profiles to detect and protection against\nadvanced, highly-evasive zero-day command-and-control (C2) threats.\nDNS security is an extensible cloud-based service capable of generating DNS\nsignatures using advanced predictive analytics and machine learning. DNS Security\nprotects from sophisticated DNS-based attacks.\nWhen permitting traffic from an untrusted zone, such as the Internet or guest network, to\na more trusted zone, such as a DMZ segment, create security policies specifying which\nspecific applications are allowed.\n**Enhanced Security Recommendation: ** Require specific application policies when\nallowing any traffic, regardless of the trust level of a zone. Do not rely solely on port\npermissions. This may require SSL interception, and may also not be possible in all\nenvironments.\nCreate security policies specifying application-default for the Service setting, in addition\nto the specific ports desired. The Service setting of any should not be used for any\npolicies that allow traffic.\nCreate a pair of security rules at the top of the security policies ruleset to block traffic to\nand from IP addresses known to be malicious.\nNote: This recommendation (as written) requires a Palo Alto Networks \"Threat\nPrevention License\". Third Party and Open Source Threat Intelligence Feeds can also\nbe used for this purpose.\nEnable logging on built-in default security policies \"intrazone-default\" and \"interzone-\ndefault\"\nConfigure SSL Forward Proxy for all traffic destined to the Internet. In most\norganizations, including all categories except financial-services, government and\nhealth-and-medicine is recommended.\nConfigure SSL Inbound Inspection for all untrusted traffic destined for servers using\nSSL or TLS.\nThe CA Certificate used for in-line HTTP Man in the Middle should be trusted by target\nusers. For SSL Forward Proxy configurations, there are classes of users that need to\nbe considered.\n1: Users that are members of the organization, users of machines under control of the\norganization. For these people and machines, ensure that the CA Certificate is in one of\nthe Trusted CA certificate stores. This is easily done in Active Directory, using Group\nPolicies for instance. A MDM (Mobile Device Manager) can be used to accomplish the\nsame task for mobile devices such as telephones or tablets. Other central management\nor orchestration tools can be used for Linux or \"IoT\" (Internet of Things) devices.\n2: Users that are not member of the organization - often these are classed as \"Visitors\"\nin the policies of the organization. If a public CA Certificate is a possibility for your\norganization, then that is one approach. A second approach is to not decrypt affected\ntraffic - this is easily done, but leaves the majority of \"visitor\" traffic uninspected and\npotentially carrying malicious content. The final approach, and the one most commonly\nseen, is to use the same certificate as is used for the hosting organization. In this last\ncase, visitors will see a certificate warning, but the issuing CA will be the organization\nthat they are visiting.",
    "expected_values": "Not Configured\nNot configured\nPage 82\nBy default WMI probing and all User-ID functions are disabled.\nNot configured\nPage 86\nNot configured\nNot configured\nPage 90\nNot configured\nNot Configured\nPage 98\nNot Configured\nNot Configured\nNot Configured\nThis setting is by default set to Weekly.\nIn PAN-OS 9.x, the default file sizes for WildFire are:\n• pe (Portable Executable) - 16MB\n• apk (Android Application)- 10MB\n• pdf (Portable Document Format) - 3072KB\n• ms-office (Microsoft Office) — 16384KB\n• jar (Packaged Java class file) — 5MB\n• flash (Adobe Flash) — 5MB\n• MacOSX (DMG/MAC-APP/MACH-O PKG files) — 10MB\n• archive (RAR and 7z files) — 50MB\n• linux (ELF files) — 50MB\n• script (JScript, VBScript, PowerShell, and Shell Script)- 20KB\nNot Configured\nNot Configured\nAll Session Information Settings are enabled by default. These include:\n• Source IP\n• Source port\n• Destination IP\n• Destination port\n• Virtual System\n• Application\n• User\n• URL\n• File name\n• Email sender\n• Email recipient\n• Email subject\nPage 117\nNot Configured\nNot Configured\nwildfire.paloaltonetworks.com\nPage 123\nNot Configured\nNot Configured\nNo Antivirus Profiles are enabled on any default or new Security Policy\nTwo Anti-Spyware Security Profiles are configured by default \"strict\" and \"default\".\nNot Configured\nNot Configured\nTwo Vulnerability Protection Profiles are configured by default - \"strict\" and \"default\".\nNot Configured\nPage 141\nNot Configured\nNot Configured\nPage 145\nA default URL Filtering Security Profile is configured, with the following categories set to\n\"block\": abused-drugs adult gambling hacking malware phishing questionable weapons\n3 Categories are set to alert in the default policy, and 58 Categories are set to allow\n(which means they are not logged)\nNot Configured\nNot Configured\nPage 152\nNot Configured\nNot Configured\nNot Configured\nNot Configured\nNot Configured\nNot Configured\nPage 166\nNot Configured\nNot Configured\nPage 170\nNot Configured\nNot Configured\nPage 174\nNot Configured\nPage 176\nNot Configured\nPage 178\nNot Configured\nNot Configured\nNot Configured\nNot Configured\nPage 189\nDisabled\nNot Configured\nNot Configured\nDecryption is not enabled by default.",
    "validation_logic": "Navigate to Network > Network Profiles > IKE Gateways.\nOn gateways that has IKEv2 enabled, click into it and navigate to Advanced Options.\nOn IKEv2 section, navigate to PQ PPK section.\nVerify that Enable Post-Quantum Pre-Shared Key (PPK) is checked.\nNegotiation mode should be set to Mandatory if both sides of VPN supports PQ.\nNegotiation mode should be set to Preferred if you don't know or don't have control\nover whether the peer supports RFC 8784. Preferred mode preserves backward\ncompatibility to ensure connections fall back instead of dropping.\nIf both sides of VPN supports more than 1 PPK key ID, then multiple PPK key ID should\nbe configured. Configuring multiple PQ PPKs is most secure because it adds a random\nelement to PQ PPK selection.\nPage 77\nTo validate if this recommendation has been met, look at the Source User column in\nthe URL Filtering or Traffic logs (Monitor > Logs > URL Filtering and Logs >\nTraffic Logs, respectively.)\nUser traffic originating from a trusted zone should identify a username.\nNavigate to Device > User Identification > User Mapping > Palo Alto\nNetworks User ID Agent Setup.\nVerify that Enable Probing is not checked.\nNavigate to Network > Network Profiles > Interface Management.\nVerify that User-ID is only enabled for interfaces that are both internal and trusted.\nNavigate to Device > User Identification > User Mapping > Include/Exclude\nNetworks.\nVerify that all trusted internal networks have a Discovery value of Include.\nVerify that all untrusted external networks have a Discovery value of Exclude. Note that\nany value in the trusted networks list implies that all other networks are untrusted.\nNavigate to Active Directory Users and Computers for the Active Directory under\nconsideration.\nVerify that the service account for the User-ID agent is not a member of any groups\nother than Event Log Readers, Distributed COM Users, and Domain Users (for the\nintegrated, on-device User-ID agent) or Event Log Readers, Server Operators, and\nDomain Users (for the Windows User-ID agent.)\nNavigate to Active Directory Group Policies.\nVerify that Group Policies restricts the interactive logon privilege for the User-ID service\naccount.\nor\nNavigate to Active Directory Managed Service Accounts.\nVerify that Managed Service Accounts restricts the interactive logon privilege for the\nUser-ID service account.\nAuditing is operating-system dependent. For instance, in Windows Active Directory, this\naccount should not be included in any group that grants the account access to VPN or\nWireless access. In addition, domain administrative accounts should not have remote\ndesktop (RDP) access to all domain member workstations.\nNavigate to Device > Setup > Services > Services Features > Service Route\nConfiguration > Customize.\nClick on the protocol in use (IPv4 and/or IPv6).\nClick UID Agent.\nClick on the address object for the UID Agent's IP address.\nVerify SOURCE/NAME is set to 'Deny msrpc to untrusted'.\nVerify SOURCE/ZONE is set to 'INSIDE'.\nVerify SOURCE/Address is set to the Address object for the UID Agent.\nVerify DESTINATION/ZONE is set to 'GUEST' and 'OUTSIDE'.\nVerify DESTINATION/Address is set to 'any'.\nVerify DESTINATION/Application is set to 'msrpc'.\nVerify DESTINATION/Service is set to 'application-default'.\nVerify DESTINATION/Action is set to 'Block' (red circle with diagonal line).\nPage 94\nNavigate to Device > High Availability > HA Communications.\nIn the HA Communications. >Data Link (HA2) section, verify that the correct\ninterface is selected. Verify the desired protocol (IPv4 or IPv6) is selected. Verify\nthe correct Transport is selected. Verify the Enable Session Synchronization box is\nchecked.\nTo verify Link Monitoring from GUI:\nNavigate to Device > High Availability > Link and Path Monitoring. In the\nLink Monitoring section, verify the correct interfaces are in the Link Group and\nGroup Failure Conditions Under the Link Monitoring section, verify Failure\nCondition is set to Any. Verify Enabled button is checked.\nTo verify Path Monitoring from GUI:\nNavigate to Device > High Availability > Link and Path Monitoring. In the\nPath Monitoring section, verify Option is set correctly. Verify Failure Condition is\nset to Any. Verify Name, IP Address, Failure Condition is set correctly. Verify\nDefault setting is set to Any. Verify Enabled button is checked.\nTo ensure Active/Passive Settings are configured correctly:\nNavigate to Device > High Availability > General > Active/Passive\nSettings.\nVerify Passive Link State is set to auto.\nTo ensure Election Settings are configured correctly:\nNavigate to Device > High Availability > Election Settings.\nVerify Preemptive is disabled.\nNavigate to Device > Dynamic Updates > Antivirus Update Schedule.\nVerify that Action is set to Download and Install.\nVerify that Recurrence is set to Hourly.\nNavigate to Device > Dynamic Updates > Application and Threats Update\nSchedule.\nVerify that Action is set to Download and Install.\nVerify that Recurrence is set to Daily, Hourly or Every 30 Minutes\nNavigate to Device > Setup > WildFire.\nNavigate to the General Settings sections.\nVerify the maximum size for each file type at the defaults or larger, to a size that is as\nlarge enough to account for \"large\" files, but not large enough to affect performance of\nthe hardware.\nTo verify WildFire Analysis Profile:\n• Navigate to Objects > Security Profiles > WildFire Analysis Profile\nverify that a profile exists.\nTo verify File Blocking Rules:\n• For each Security Policy were the action is set to Allow, edit the Rule and\nnavigate to Actions > Profile Setting. Ensure that the WildFire\nAnalysis is set to Allow and verify that a profile is set.\nIf Group Profiles are used:\n• Navigate to Policies > Security\n• For each Security Policy were the action is set to Allow, edit the Rule and\nnavigate to Actions > Profile Setting. Ensure that the Profile Type is set\nto Group.\n• Navigate to Objects > Security Profile Groups. Open the Security Profile Group\nused above, and ensure that the Wildfire Analysis Profile is set.\nNavigate to Device > Setup > Content-ID > Content-ID Settings.\nVerify that Allow forwarding of decrypted content is checked.\nNavigate to Device > Setup > WildFire > Session Information Settings.\nVerify that every option is enabled.\nNavigate to Objects > Log Forwarding.\nVerify that the WildFire log type is configured to generate alerts using the desired\nalerting mechanism(s).\nNavigate to Device > Dynamic Updates > WildFire Update Schedule.\nVerify that Recurrence is set to Real-time.\nNavigate to Device > Setup > WildFire.\nNavigate to the General Settings sections.\nVerify that WildFire Public Cloud is set to your appropriate region.\nNavigate to Objects > Security Profiles > Wildfire\nVerify that Wildfire profiles has Enable cloud inline analysis checked.\nOn Inline cloud analysis tab, verify that there is a rule to forward files with the\nfollowing settings:\n• Application set to Any\n• File Type set to PE\n• Direction set to Both\n• Action set to Block\nNavigate to Objects > Security Profiles > Antivirus\nVerify that antivirus profiles have all decoders set to reset-both for both Action and\nWildfire Action. If imap and pop3 are required in the organization, verify that the\nimap and pop3 decoders are set to alert for both Action and Wildfire Action.\nNavigate to Policies > Security . For each policy, navigate to [Policy Name] >\nActions Verify there is a secure Antivirus profile applied to all security policies\npassing traffic - regardless of protocol. This can be set by Profiles or by Profile Group.\nNavigate to Objects > Security Profiles > Anti-Spyware. Click on existing\nprofile in used or create a new profile.\nNavigate to Signature Policies tab. Add new policy by giving it a name Policy\nName.\nVerify a Policy Name exists within the anti-spyware profile that is configured to perform\nthe reset-both on Critical, High, and Medium Severity level, any\nCategory, and any Threat Name.\nNavigate to Objects > Security Profiles > Anti-Spyware.\nWithin the each anti-spyware profile, under its DNS Policies tab, verify the Signature\nSource List: default-paloalto-dns should have as its Policy Action set to\nsinkhole If licensed, the DNS Security should have as its Policy Action set to\nsinkhole\nVerify the 'Sinkhole IPv4' IP address is correct. This should be set to\nsinkhole.paloaltnetworks.com, or if an internal host is set then that host IP or\nFQDN should be in that field\nVerify the 'Sinkhole IPv6' IP address is correct. This should be set to IPv6 Loopback\nIP (::1), or if an internal DNS Sinkhole host is set then that host IP or FQDN should\nbe in that field\nNavigate to Policies > Security Policies For each outbound security Policy, in\nthe Actions tab, verify that the Anti-Spyware setting includes the Spyware Profile\ncreated, either explicitly or as a Group Profile\nTo verify correct operation of DNS Security, from an internal station make a DNS\nrequest to each of the following hosts:\n• test-malware.testpanw.com to test Malware DNS Signature checks\n• test-c2.testpanw.com to test C2 DNS Signature checks\nPage 134\n• test-dga.testpanw.com to test DGA (Domain Generation Algorithm) DNS attack\nchecks\n• test-dnstun.testpanw.com to test DNS Tunneling attack checks Each of\nthese DNS requests should be redirected to the configured DNS Sinkhole server\nIP address Each of these DNS requests should appear in the firewall logs, under\nMonitor > Logs > Threat. If configured, each of these requests should\ngenerate an alert in the organization's SIEM.\nNavigate to Objects > Security Profiles > Anti-Spyware.\nAlso navigate to Policies > Security.\nVerify there are one or more anti-spyware profiles that collectively apply to all inside to\noutside traffic from any address to any address and any application and service.\nNavigate to Objects > Security Profiles > Vulnerability Protection.\nVerify a Vulnerability Protection Profile is set to block attacks against any critical or high\nvulnerabilities (minimum), and set to default on attacks against any medium, low, or\ninformational vulnerabilities.\nNavigate to Policies > Security.\nFor each Policy, under the Actions tab, select Vulnerability Protection.\nVerify either the 'Strict' or the 'Default' profile is selected, or a custom profile that\ncomplies with the organization's policies, legal and regulatory requirements.\nNavigate to Device > Licenses.\nClick on PAN-DB URL Filtering.\nVerify Active is set to Yes.\nNavigate to Objects > Security Profiles > URL Filtering.\nVerify that all URL categories designated by the organization are listed, and the action\nis set to Block.\nNavigate to Objects > Security Profiles > URL Filtering.\nVerify that the for all allowed categories, that the Site Access action is set to alert\nNavigate to Objects > Security Profiles > URL Filtering > URL Filtering\nProfile > URL Filtering Settings.\nVerify these four settings:\na. Log container page only box is un-checked\nb. User-Agent box is checked\nc. Referer box is checked\nd. X-Forwarded-For box is checked\nTo Verify URL Filtering:\nFor each Security Policy that transits traffic to the public internet, navigate to Policies\n> Security > Security Profiles > [Policy Name] > Actions.\nVerify there is a URL Filtering profile that complies with the policies of the organization\nis applied to all Security Policies that transit traffic to the public internet.\nNavigate to Objects > Custom Objects > Data Patterns.\nVerify an appropriate Data Pattern has been created that accounts for sensitive\ninformation within your organization. In most cases this will include Credit Card\nNumbers, and your jurisdiction's equivalent of Social Insurance Numbers. In many\ncases these can simply be picked from the list of Predefined Patterns.\nNavigate to Objects > Security Profiles > Data Filtering.\nVerify an appropriate Data Filtering Profile has been created, using the created\nData Patterns. Ensure that an Alert Threshold is set that generates alerts\nappropriately. A typical starting value for Alert Threshold is 20, but this should be\nadjusted after appropriate testing.\nNavigate to Objects > Custom Objects > Data Patterns. Verify that the patterns\ndefined match the various data that you wish to monitor or make blocking decisions on.\nNavigate to Objects > Security Profiles > Data Filtering For each Filtering\nProfile, verify that the Data Patterns defined matches the data you wish to monitor,\nwith appropriate values for Alert Threshold (typically 20), Block Threshold\n(typically 0) and Log Severity.\nFinally, navigate to Policies > Security. Open all appropriate policies, for each\nPolicy choose the Actions tab, and verify that the appropriate Data Filtering\nPolicy is applied (either as an individual Profile or as part of a Group Profile)\nFrom GUI:\nNavigate to Network > Network Profiles > Zone Protection > Zone\nProtection Profile > Flood Protection tab.\nVerify the SYN box is checked. Verify the Action dropdown is SYN Cookies. Verify Alert\nis 20000 (or appropriate for org). Verify Activate is 25000 (50% of maximum for firewall\nmodel). Verify Maximum is 1000000 (or appropriate for org).\nNavigate to Network > Zones. Open the zone facing any untrusted network. Verify that\nZone Protection has the Zone Protection Profile set to the Profile created.\nIn the GUI:\nNavigate to Network > Network Profiles > Zone Protection > Flood\nProtection.\nEnsure that all settings are enabled with at least the default values.\nNavigate to Network > Zones, select each untrusted zone in turn, and ensure that the\nZone Protection Profile is set.\nPage 161\nNavigate to Network > Network Profiles > Zone Protection > Zone\nProtection Profile > Reconnaissance Protection.\nVerify that TCP Port Scan is enabled, its Action is set to block-ip, its Interval is set to\n5, and its Threshold is set to 20. For block-ip, ensure the \"Track By\" is set to source\nand \"Duration\" is set to 600 seconds.\nVerify that Host Sweep is enabled, its Action is set to block, its Interval is set to 10,\nand its Threshold is set to 30.\nVerify that UDP Port Scan is enabled, its Action is set to alert, its Interval is set to 10,\nand its Threshold is set to 20.\nNavigate to Network > Network Profiles > Zone Protection > Zone\nProtection Profile > Packet Based Attack Protection > TCP/IP Drop.\nVerify Spoofed IP address is checked.\nVerify Mismatched overlapping TCP segment is checked.\nUnder IP Option Drop, verify that Strict Source Routing, Loose Source\nRouting, and Malformed are all checked. Additional options may also be checked.\nNavigate to Objects > Security Profiles > URL Filtering.\nChoose the Categories tab. Verify that the User Credential Submitting action on\nall enabled URL categories is set to either block or continue.\nUnder the User Credential Detection tab ensure the User Credential\nDetection is set to a value appropriate to your organization, and is not set to\nDisabled. Verify that the Log Severity value is set to a value appropriate to your\norganization and your logging or SIEM solution.\nNavigate to Objects > Security Profiles > Antivirus\nVerify that antivirus profiles have all decoders set to reset-both for Wildfire Inline\nML Action. If imap and pop3 are required in the organization, verify that the imap and\npop3 decoders are set to alert for Wildfire Inline ML Action.\nNavigate to Objects > Security Profiles > Antivirus\nGo to Wildfire Inline ML tab. Verify that all Action Setting are set to enable\n(inherit per-protocol actions).\nNavigate to Objects > Security Profiles > Vulnerability Protection\nGo to Inline Cloud Analysis tab. Verify that it is enabled and all Model action is set\nas alert.\nNavigate to Objects > Security Profiles > URL Filtering\nGo to Inline Categorization tab. Verify that it is enabled for both Enable local\ninline categorization and Enable cloud inline categorization.\nNavigate to Objects > Security Profiles > Anti-Spyware\nGo to Inline Cloud Analysis tab. Verify that it is enabled and all Model action is set\nas reset-both.\nNavigate to Objects > Security Profiles > Anti-Spyware\nGo to DNS Policies tab. Verify that policy action is set to sinkhole for all DNS\nSecurity categories.\nOn Command and control Domains category, verify that the packet capture option to\nextended-capture.Navigate to Objects > Security Profiles > Anti-Spyware\nGo to DNS Policies tab. Configure policy action to sinkhole for all DNS Security\ncategories.\nOn Command and control Domains category, set the packet capture option to\nextended-capture\nNavigate to Policies > Security.\nPage 183\nFor all Security Policies that transit from a less trusted to a more trusted interface, that\nthe appropriate Application and Service values are set. For instance, for a web\nserver exposed to the internet from a DMZ: Source tab: Zone set to OUTSIDE / Address\nset to Any Destination tab: Zone set to DMZ / Address set to [DMZ Host Object]\nApplication tab: set to web-browsing Service/URL Category tab: set Service to\nether:\n• application-default or:\n• service-http and/or service-https\n**Enhanced Security Recommendation: **\nAssess this setting for Policies on all Interfaces, for traffic in all directions. Ensure that\nfor each Security Policy that the appropriate settings are set for both Application and\nService\nNavigate to Policies > Security.\nFor each exposed host, verify that a Security Policy exists with:\n• Source tab: Zone set to OUTSIDE Address set to any\n• Destination tab: Zone set to DMZ / Address set to <DMZ Host Object>\n• Application tab: Application set to web-browsing (or appropriate\napplication)\n• Service tab: Service set to application-default. The value of any should\nnever be used\nNavigate to Policies > Security\nVerify a Security Policy exists similar to:\n• General tab: Name set to Deny to Malicious IP\n• Source tab: Source Zone set to Any,\n• Destination tab: Destination Zone set to Any, Destination Address set to\nPalo Alto Networks - Known malicious IP addresses,Palo Alto\nNetworks - High risk IP addresses, Palo Alto Networks - Tor exit\nIP addresses, Palo Alto Networks - Bulletproof IP addresses\n• Application tab: Application set to Any\n• Service/URL Category tab: Service set to Any\n• Actions tab: Action set to Block, Profile Type set to None\nVerify a Security Policy exists similar to:\nPage 188\n• General tab: Name set to Deny from Malicious IP\n• Source tab: Source Zone set to Any, Source Address set to Palo Alto\nNetworks - Known malicious IP addresses,Palo Alto Networks - High\nrisk IP addresses, Palo Alto Networks - Tor exit IP addresses, Palo\nAlto Networks - Bulletproof IP addresses\n• Destination tab: Destination Zone set to Any\n• Application tab: Application set to Any\n• Service/URL Category tab: Service set to Any\n• Actions tab: Action set to Block, Profile Type set to None\nNote: This recommendation requires a Palo Alto Networks \"Threat Prevention License\"\nNavigate to Policies > Security\nGo to default policies intrazone-default and interzone-default. On Actions tab,\nverify that log setting has Log at Session End is enabled.\nNavigate to Policies > Decryption. Verify SSL Forward Proxy is set for all traffic\ndestined to the Internet.\nVerify each Decryption Policy Rule:\n• Source tab: The Source Zone and/or Source Address should include all target\ninternal networks. Source User should include all target internal users\n• Destination tab: The Destination Zone should include the untrusted target\nzone (usually the internet). Destination Address is typically Any for an\ninternet destination.\nPage 194\n• Service/URL Category tab: Verify that all URL Category entries are included\nexcept financial-services, government and health-and-medicine (this list\nmay vary depending on your organization and its policies).\n• Options tab: Verify that the Type is set to SSL Forward Proxy\nNavigate to Policies > Decryption.\nVerify SSL Inbound Inspection is set appropriately for all untrusted traffic destined for\nservers using SSL or TLS.\nNavigate to Policies > Decryption. For each service published to the internet (or\nother untrusted zones), verify the following settings:\n• General tab: Name set to a descriptive name\n• Source: Source Zone set to the target zone (Internet in many cases). Source\nAddress set to the target address space (Any for internet traffic)\n• Destination tab: Destination Zone should be set to the appropriate zone, or\nAny. Destination Address set to the target host address\n• Options tab: Type set to SSL Inbound Inspection\nVerify the CA Certificate(s):\nNavigate to Device > Certificate Management > Certificates\n• Verify that appropriate internal certificates are imported, and that all certificates in\nthe list are valid. In particular, verify the Subject, Issuer, CA, Expires,\nAlgorithm and Usage fields\n• Alternatively, if an internal CA is implemented on the firewall, verify that target\nclients have the root certificate for this CA imported into their list of trusted\ncertificate authorities.\nPage 199\nVerify the Certificate Profile needed for the SSL Forward Proxy:\n• Navigate to Device > Certificate Management > Certificate Profile.\nVerify that an appropriate profile is created.",
    "remediation_steps": "Navigate to Network > Network Profiles > IKE Gateways.\nOn gateways that has IKEv2 enabled, click into it and navigate to Advanced Options.\nOn IKEv2 section, navigate to PQ PPK section.\nCheck Enable Post-Quantum Pre-Shared Key (PPK) option.\nNegotiation mode should be set to Mandatory if both sides of VPN supports PQ.\nNegotiation mode should be set to Preferred if you don't know or don't have control\nover whether the peer supports RFC 8784. Preferred mode preserves backward\ncompatibility to ensure connections fall back instead of dropping.\nIf both sides of VPN supports more than 1 PPK key ID, then multiple PPK key ID should\nbe configured. Configuring multiple PQ PPKs is most secure because it adds a random\nelement to PQ PPK selection.\nTo Set User-ID Agents:\nNavigate to Device > User Identification > User-ID Agents\nSet the Name, IP Address and Port of the User-ID Agent`\nEnable User Identification for each monitored zone that will have user accounts:\nNavigate to Network > Zone, for each relevant zone enable User\nIdentification\nTo Set Terminal Services Agents:\nPage 80\nNavigate to Device > Terminal Services Agents Set the Name, IP Address and\nPort of the Terminal Services Agent\nEnable User Identification for each monitored zone that will have Terminal Servers:\nNavigate to Network > Zone, enable User Identification\nNavigate to Device > User Identification > User Mapping > Palo Alto\nNetworks User ID Agent Setup.\nSet Enable Probing so it is unchecked.\nNavigate to Network > Network Profiles > Interface Management.\nSet User-ID to be checked only for interfaces that are both internal and trusted;\nuncheck it for all other interfaces.\nNavigate to Device > User Identification > User Mapping > Include/Exclude\nNetworks.\nSet all trusted internal networks to have a Discovery value of Include.\nSet all untrusted external networks to have a Discovery value of Exclude. Note that any\nvalue in the trusted networks list implies that all other networks are untrusted.\nNavigate to Active Directory Users and Computers.\nPage 88\nSet the service account for the User-ID agent so that it is only a member of the Event\nLog Readers, Distributed COM Users, and Domain Users (for the integrated, on-device\nUser-ID agent) or the Event Log Readers, Server Operators, and Domain Users groups\n(for the Windows User-ID agent.)\nNavigate to Active Directory Group Policies.\nSet Group Policies to restrict the interactive logon privilege for the User-ID service\naccount.\nor\nNavigate to Active Directory Managed Service Accounts.\nSet Managed Service Accounts to restrict the interactive logon privilege for the User-ID\nservice account.\nRemove this account from all groups that might grant remote access to the network, or\nto any network services or hosts. Remediation is operating-system dependent. For\ninstance, in Windows Active Directory, this account should be removed from any group\nthat grants the account access to VPN or Wireless access. In addition, domain\nadministrative accounts by default have remote desktop (RDP) access to all domain\nmember workstations - this should be explicitly denied for this account.\nNavigate to Device > Setup > Services > Services Features > Service Route\nConfiguration > Customize.\nClick on the protocol in use (IPv4 and/or IPv6).\nClick UID Agent.\nClick on the address object for the UID Agent's IP address.\nSet SOURCE/NAME to 'Deny msrpc to untrusted'.\nSet SOURCE/ZONE to 'INSIDE'.\nSet SOURCE/Address to the Address object for the UID Agent.\nSet DESTINATION/ZONE to 'GUEST' and 'OUTSIDE'.\nSet DESTINATION/Address to 'any'.\nSet DESTINATION/Application to 'msrpc'.\nSet DESTINATION/Service to 'application-default'.\nSet DESTINATION/Action to 'Block' (red circle with diagonal line).\nNavigate to Device > High Availability > HA Communications.\nClick HA Communications. Click Data Link (HA2). Select the correct interface.\nSelect the desired protocol (IPv4 or IPv6). Select the correct Transport. Set the\nEnable Session Synchronization box to be checked.\nChoose Save Configuration.\nTo set Link Monitoring from GUI:\nPage 100\nNavigate to Device > High Availability > Link and Path Monitoring. Click\nLink Monitoring. Set the correct interfaces to the Link Group and Group Failure\nConditions. Click Link Monitoring. Set Failure Condition to Any. Check Enabled\nbutton.\nTo set Path Monitoring from GUI:\nNavigate to Device > High Availability > Link and Path Monitoring. Click\nPath Monitoring. Set Option correctly. Set Failure Condition to Any. Set Name,\nIP Address, Failure Condition correctly. Set Default setting to Any. Check\nEnabled button.\nTo set Active/Passive Settings correctly:\nNavigate to Device > High Availability > General > Active/Passive\nSettings.\nSet Passive Link State to auto.\nTo set Election Settings correctly:\nNavigate to Device > High Availability > Election Settings.\nSet Preemptive to be disabled.\nPage 102\nNavigate to Device > Dynamic Updates > Antivirus Update Schedule.\nSet Action to Download and Install.\nSet Recurrence to Hourly.\nNavigate to Device > Dynamic Updates > Application and Threats Update\nSchedule.\nSet Action to Download and Install.\nSet Recurrence to Daily, Hourly or Every 30 Minutes\nNavigate to Device > Setup > WildFire.\nClick the General Settings edit icon.\nSet the maximum size for each file type are larger than the defaults, to a size that is as\nlarge enough to account for \"large\" files, but not large enough to affect performance of\nthe hardware.\nIn PAN-OS 9.x and higher, the default file sizes for WildFire are:\n• pe (Portable Executable) - 16MB\nPage 110\n• apk (Android Application)- 10MB\n• pdf (Portable Document Format) - 3072KB\n• ms-office (Microsoft Office) — 16384KB\n• jar (Packaged Java class file) — 5MB\n• flash (Adobe Flash) — 5MB\n• MacOSX (DMG/MAC-APP/MACH-O PKG files) — 10MB\n• archive (RAR and 7z files) — 50MB\n• linux (ELF files) — 50MB\n• script (JScript, VBScript, PowerShell, and Shell Script)- 20KB\nIn PAN-OS 9.x and higher, the maximum file sizes for Wildfire are:\n• pe (Portable Executable) - 50MB\n• apk (Android Application)- 50MB\n• pdf (Portable Document Format) - 51200KB\n• ms-office (Microsoft Office) — 51200KB\n• jar (Packaged Java class file) — 20MB\n• flash (Adobe Flash) — 10MB\n• MacOSX (DMG/MAC-APP/MACH-O PKG files) — 50MB\n• archive (RAR and 7z files) — 50MB\n• linux (ELF files) — 50MB\n• script (JScript, VBScript, PowerShell, and Shell Script)- 4096KB\nTo Set File Blocking Profile:\n• Navigate to Objects > Security Profiles > WildFire Analysis Profile.\nPage 113\n• Create a WildFire profile that has 'Application Any', 'File Types Any', and\n'Direction Both'\nTo Set WildFire Analysis Rules:\n• Navigate to Policies > Security.\n• For each Security Policy Rule where the action is \"Allow\", Navigate to Actions >\nProfile Setting > WildFire Analysis and set a WildFire Analysis profile.\nGroup Profiles can also be used. To take this approach:\n• Navigate to Objects > Security Profile Groups. Create a Security Profile\nGroup, and ensure that (among other settings) the Wildfire Analysis\nProfile is set to the created profile.\n• Navigate to Policies > Security. For each Security Policy Rule where the\naction is \"Allow\", Navigate to Actions > Profile Setting. Modify the Profile\nType to Group, and set the Group Profile to the created Security Profile Group.\nNavigate to Device > Setup > Content-ID > Content-ID Settings.\nSet Allow forwarding of decrypted content to be checked. Note that SSL\nForward Proxy must be configured for this setting to be effective.\nNavigate to Device > Setup > WildFire > Session Information Settings.\nSet every option to be enabled.\nFrom GUI, configure some combination of the following Server Profiles:\nConfigure the Email Server: Select Device > Server Profiles > Email Click Add\nEnter a name for the Profile. Select the virtual system from the Location drop down\nmenu (if applicable) Click Add\nConfigure the Syslog Server: Select Device > Server Profiles > Syslog > Add\nEnter Name, Display Name, Syslog Server, Transport, Port, Format,\nFacility Click OK Click Commit to save the configuration\nConfigure the SMTP Server: Select Device > Server Profiles > Email Select\nAdd, Name, Display Name, From, To, Additional Recipients, Gateway IP\nor Hostname Click OK Click Commit to save the configuration\nPage 119\nNavigate to Objects, Log Forwarding Choose Add, set the log type to \"wildfire\", add\nthe filter \"(verdict neq benign)\", then add log destinations for SNMP, Syslog, Email or\nHTTP as required.\nNavigate to Device > Dynamic Updates > WildFire Update Schedule.\nSet Recurrence is set to Real-time.\nNavigate to Device > Setup > WildFire.\nNavigate to the General Settings sections.\nClick the General Settings edit icon.\nChange the WildFire Public Cloud to your appropriate region.\nNavigate to Objects > Security Profiles > Wildfire\nOn relevant Wildfire profile, checked Enable cloud inline analysis box.\nOn Inline cloud analysis tab, configure a rule to forward files with the following\nsettings:\nPage 125\n• Application set to Any\n• File Type set to PE\n• Direction set to Both\n• Action set to Block\nNavigate to Objects > Security Profiles > Antivirus.\nSet antivirus profiles to have all decoders set to reset-both for both Action and\nWildfire Action. If imap and pop3 are required in the organization, set the imap and\npop3 decoders to alert for both Action and Wildfire Action.\nNavigate to Policies > Security . For each policy, navigate to [Policy Name] >\nActions\nSet an Antivirus profile or a Profile Group containing an AV profile for each\nsecurity policy passing traffic - regardless of protocol.\nNavigate to Objects > Security Profiles > Anti-Spyware. Click on existing\nprofile in used or create a new profile.\nNavigate to Signature Policies tab. Add new policy by giving it a name Policy\nName.\nSet a Policy Name exists within the anti-spyware profile that is configured to perform\nthe reset-both on Critical, High, and Medium Severity level, any\nCategory, and any Threat Name.\nPage 132\nNavigate to Objects > Security Profiles > Anti-Spyware.\nWithin the each anti-spyware profile, under its DNS Policies tab, set the Signature\nSource List: default-paloalto-dns should have as its Policy Action set to\nsinkhole If licensed, the DNS Security should have as its Policy Action set to\nsinkhole\nVerify the 'Sinkhole IPv4' IP address is correct. This should be set to\nsinkhole.paloaltnetworks.com, or if an internal host is set then that host IP or\nFQDN should be in that field\nVerify the 'Sinkhole IPv6' IP address is correct. This should be set to IPv6 Loopback\nIP (::1), or if an internal DNS Sinkhole host is set then that host IP or FQDN should\nbe in that field\nNavigate to Policies > Security Policies For each outbound security Policy, in\nthe Actions tab, set the Anti-Spyware setting to include the Spyware Profile created,\neither explicitly or as a Group Profile\nNavigate to Objects > Security Profiles > Anti-Spyware.\nAlso navigate to Policies > Security.\nSet one or more anti-spyware profiles to collectively apply to all inside to outside traffic\nfrom any address to any address and any application and service.\nNavigate to Objects > Security Profiles > Vulnerability Protection.\nSet a Vulnerability Protection Profile to block attacks against any critical or high\nvulnerabilities (minimum), and to default on attacks against any medium, low, or\ninformational vulnerabilities.\nNavigate to Policies > Security.\nFor each Policy, under the Actions tab, select Vulnerability Protection.\nSet it to use either the 'Strict' or the 'Default' profile, or a custom profile that complies\nwith the organization's policies, legal and regulatory requirements.\nNavigate to Device > Licenses.\nClick on PAN-DB URL Filtering.\nSet Active to Yes.\nNavigate to Objects > Security Profiles > URL Filtering.\nSet a URL filter so that all URL categories designated by the organization are listed.\nNavigate to the Actions tab.\nSet the action to Block.\nNavigate to Objects > Security Profiles > URL Filtering.\nFor each permitted category, set the Site Access actioun to alert\nNavigate to Objects > Security Profiles > URL Filtering > URL Filtering\nProfile > URL Filtering Settings.\nPage 149\nSet the following four settings:\na. Log container page only box is un-checked\nb. Check the User-Agent box\nc. Check the Referer box\nd. Check the X-Forwarded-For box\nTo Set URL Filtering: For each Security Profile that transits traffic to the internet,\nnavigate to Policies > Security > Security Profiles > [Policy Name] >\nActions.\nSet a URL Filtering profile that complies with the policies of the organization is applied\nto all Security Policies that transit traffic to the public internet.\nNavigate to Objects > Custom Objects > Data Patterns.\nCreate an appropriate Data Pattern that accounts for sensitive information within your\norganization. In most cases this will include Credit Card Numbers, and your jurisdiction's\nequivalent of Social Insurance Numbers. In many cases these can simply be picked\nfrom the list of Predefined Patterns.\nNavigate to Objects > Security Profiles > Data Filtering.\nPage 154\nCreate appropriate Data Filtering Profile, using the created Data Patterns.\nEnsure that an Alert Threshold is set that generates alerts appropriately. A typical\nstarting value for Alert Threshold is 20, but this should be adjusted after appropriate\ntesting.\nNavigate to Objects > Custom Objects > Data Patterns. Add patterns to match\nthe various data that you wish to monitor or make blocking decisions on.\nPage 156\nNavigate to Objects > Security Profiles > Data Filtering Add a Filtering\nProfile that matches the data you wish to monitor, with appropriate values for Alert\nThreshold (typically 20), Block Threshold (typically 0) and Log Serverity\nFinally, apply the Filtering Profile to a Security Profile. Navigate to Policies >\nSecurity. Edit all appropriate policies, and for each Policy choose the Actions tab,\nand add the appropriate Data Filtering Policy (either as an individual Profile or\nas part of a Group Profile)\nFrom GUI:\nNavigate to Network > Network Profiles > Zone Protection > Zone\nProtection Profile > Flood Protection tab.\nCheck the SYN box. Set the Action dropdown to SYN Cookies Set Alert to 20000 (or\nappropriate for org). Set Activate to 25000 (50% of maximum for firewall model). Set\nMaximum to 1000000 (or appropriate for org)\nNavigate to Network > Zones. Open the zone facing any untrusted network, if one\ndoes not exist create it. Set Zone Protection to the Zone Protection Profile\ncreated.\nIn the GUI:\nNavigate to Network > Network Profiles > Zone Protection > Flood\nProtection.\nSet all settings to \"enabled\" with at least the default values.\nNavigate to Network > Zones, select each untrusted zone in turn, and set the Zone\nProtection Profile.\nNavigate to Network > Network Profiles > Zone Protection > Zone\nProtection Profile > Reconnaissance Protection.\nPage 163\nSet TCP Port Scan to enabled, its Action to block-ip, its Interval to 5, and its\nThreshold to 20. For block-ip, set the \"Track By\" is set to source and \"Duration\" is set\nto 600 seconds.\nSet Host Sweep to enabled, its Action to block, its Interval to 10, and its Threshold to\n30.\nSet UDP Port Scan to enabled, its Action to alert, its Interval to 10, and its Threshold\nto 20.\nNavigate to Network > Network Profiles > Zone Protection > Zone\nProtection Profile > Packet Based Attack Protection > TCP/IP Drop.\nSet Spoofed IP address to be checked.\nSet Mismatched overlapping TCP segment to be checked.\nUnder IP Option Drop, set Strict Source Routing, Loose Source Routing, and\nMalformed to all be checked. Additional options may also be set if desired.\nNavigate to Objects > Security Profiles > URL Filtering.\nChoose the Categories tab. Set the User Credential Submitting action on all\nenabled URL categories is either block or continue, as appropriate to your\norganization and the category.\nPage 168\nUnder the User Credential Detection tab set the User Credential Detection\nvalue to a setting appropriate to your organization, any value except Disabled. Set the\nLog Severity to a value appropriate to your organization and your logging or SIEM\nsolution.\nNavigate to Objects > Security Profiles > Antivirus\nSet antivirus profiles to have all decoders set to reset-both for Wildfire Inline ML\nAction. If imap and pop3 are required in the organization, set the imap and pop3\ndecoders are set to alert for Wildfire Inline ML Action.\nNavigate to Objects > Security Profiles > Antivirus\nGo to Wildfire Inline ML tab. Set enable (inherit per-protocol actions) for\nall Model on Action Setting.\nNavigate to Objects > Security Profiles > Vulnerability Protection\nGo to Inline Cloud Analysis tab. Tick the checkbox for Enable cloud inline\nanalysis. Verify that all Model action is set as alert.\nNote that, firewall device certificate is used to authenticate to the Advanced Threat\nPrevention inline cloud analysis service. This step is required before 'Inline Cloud\nAnalysis' can be used. Refer to reference for detailed guide.\nNavigate to Objects > Security Profiles > URL Filtering\nGo to Inline Categorization tab. Tick the checkbox for both Enable local inline\ncategorization and Enable cloud inline categorization.\nNote that:\n1. Firewall device certificate is used to authenticate to the Advanced Threat\nPrevention inline cloud analysis service. This step is required before 'Inline Cloud\nAnalysis' can be used. Refer to reference for detailed guide.\n2. 'Local Inline Categorization' can be enabled with just the URL Filtering license\n(no Advanced Threat Prevention is needed).\nNavigate to Objects > Security Profiles > Anti-Spyware\nGo to Inline Cloud Analysis tab. Tick the checkbox for Enable cloud inline\nanalysis. Verify that all Model action is set as reset-both.\nNote that, firewall device certificate is used to authenticate to the Advanced Threat\nPrevention inline cloud analysis service. This step is required before Inline Cloud\nAnalysis can be used. Refer to reference for detailed guide.\nNavigate to Objects > Security Profiles > Anti-Spyware\nGo to DNS Policies tab. Configure policy action to sinkhole for all DNS Security\ncategories.\nOn Command and control Domains category, set the packet capture option to\nextended-capture.\nPage 180\nNavigate to Policies > Security.\nFor all Security Policies that transit from a less trusted to a more trusted interface,\nset the Application and Service values to match the exposed application. For\ninstance, for a web server exposed to the internet from a DMZ: Source tab: Zone set to\nOUTSIDE / Address set to Any Destination tab: Zone set to DMZ / Address set to [DMZ\nHost Object] Application tab: set to web-browsing Service/URL Category tab:\nset Service to ether:\n• application-default or:\n• service-http and/or service-https\n**Enhanced Security Recommendation: **\nSet these values for Policies on all Interfaces, for traffic in all directions. For each\nSecurity Policy, set the Application and Service values to match the exposed\napplication.\nNavigate to Policies > Security.\nFor each exposed host, set a Security Policy exists with:\n• Source tab: Zone set to OUTSIDE Address set to any\n• Destination tab: Zone set to DMZ / Address set to <DMZ Host Object>\n• Application tab: Application set to web-browsing (or appropriate\napplication)\nPage 186\n• Service tab: Service set to application-default. The value of any should\nnever be used\nNavigate to Policies > Security\nCreate a Security Policy similar to:\n• General tab: Name set to Deny to Malicious IP\n• Source tab: Source Zone set to Any,\n• Destination tab: Destination Zone set to Any, Destination Address set to\nPalo Alto Networks - Known malicious IP addresses,Palo Alto\nNetworks - High risk IP addresses, Palo Alto Networks - Tor exit\nIP addresses, Palo Alto Networks - Bulletproof IP addresses\n• Application tab: Application set to Any\n• Service/URL Category tab: Service set to Any\n• Actions tab: Action set to Block, Profile Type set to None\nCreate a Security Policy similar to:\n• General tab: Name set to Deny from Malicious IP\n• Source tab: Source Zone set to Any, Source Address set to Palo Alto\nNetworks - Known malicious IP addresses,Palo Alto Networks - High\nrisk IP addresses, Palo Alto Networks - Tor exit IP addresses, Palo\nAlto Networks - Bulletproof IP addresses\n• Destination tab: Destination Zone set to Any\n• Application tab: Application set to Any\n• Service/URL Category tab: Service set to Any\n• Actions tab: Action set to Block, Profile Type set to None\nNote: This recommendation requires a Palo Alto Networks \"Threat Prevention License\"\nNavigate to Policies > Security\nGo to default policies intrazone-default and interzone-default. On Actions tab,\nenable Log at Session End on log setting.\nNavigate to Policies > Decryption. Create a Policy for all traffic destined to the\nInternet. This Policy should include:\n• Source tab: The Source Zone and/or Source Address should include all target\ninternal networks. Source User should include all target internal users\n• Destination tab: The Destination Zone should include the untrusted target\nzone (usually the internet). Destination Address is typically Any for an\ninternet destination.\n• Service/URL Category tab: all URL Category entries should be included\nexcept financial-services, government and health-and-medicine (this list\nmay vary depending on your organization and its policies).\n• Options tab: Type set to SSL Forward Proxy\nNavigate to Policies > Decryption.\nSet SSL Inbound Inspection appropriately for all untrusted traffic destined for servers\nusing SSL or TLS.\nNavigate to Policies > Decryption. For each service published to the internet (or\nother untrusted zones), create a Policy and set the following options:\nPage 197\n• General tab: Name set to a descriptive name\n• Source: Source Zone set to the target zone (Internet in many cases). Source\nAddress set to the target address space (Any for internet traffic)\n• Destination tab: Destination Zone should be set to the appropriate zone, or\nAny. Destination Address set to the target host address\n• Options tab: Type set to SSL Inbound Inspection\nNote:\n1. Private key of the either the Root CA cert or Intermediate Root CA should be\nimported into the firewall in order for it to perform SSL decryption.\n2. This private key is the same one used by the internal application (behind the\nfirewall).\nSet the CA Certificate(s):\nNavigate to Device > Certificate Management > Certificates. Import the\nappropriate CA Certificates from any internal Certificate Authorities.\nAlternatively, generate a self-signed certificate for an internal CA on the firewall, and\nthen import the root certificate for that CA into the trusted CA list of target clients. In an\nActive Directory environment this can be facilitated using a Group Policy.\nSet the Certificate Profile needed for the SSL Forward Proxy:\n• Navigate to Device > Certificate Management > Certificate Profile.\nSet the decryption profile to include the settings described in the SSL Forward Proxy\nguidance in this document",
    "severity": "Manual",
    "is_active": true,
    "references_text": "1. “PAN-OS Administrator's Guide 11.1 (English) - Network Security\" -\nhttps://docs.paloaltonetworks.com/network-security/quantum-\nsecurity/administration/configure-quantum-resistant-ikev2-vpns/configure-post-\nquantum-ikev2-vpns\n1. “Best Practices for Securing User-ID Deployments” -\nhttps://live.paloaltonetworks.com/docs/DOC-7912\n2. “How to Configure Group Mapping settings?” -\nhttps://live.paloaltonetworks.com/docs/DOC-4994\n3. https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/user-id\n4. https://paloaltonetworks.com/content/dam/paloaltonetworks-\ncom/en_US/assets/pdf/tech-briefs/techbrief-user-id.pdf\n1. “R7-2014-16: Palo Alto Networks User-ID Credential Exposure” -\nhttps://blog.rapid7.com/2014/10/14/palo-alto-networks-userid-credential-\nexposure/\n2. “Best Practices for Securing User-ID Deployments” -\nhttps://live.paloaltonetworks.com/docs/DOC-7912\n3. “PAN-OS Administrator's Guide 11.1 (English) - Client Probing\" -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/user-id/user-id-\nconcepts/user-mapping/client-probing\n1. “Customer advisory: Security Impact of User-ID Misconfiguration” -\nhttps://live.paloaltonetworks.com/docs/DOC-8125\n2. “R7-2014-16: Palo Alto Networks User-ID Credential Exposure” -\nhttps://blog.rapid7.com/2014/10/14/palo-alto-networks-userid-credential-\nexposure/\nPage 84\n3. “Best Practices for Securing User-ID Deployments” -\nhttps://live.paloaltonetworks.com/docs/DOC-7912\n4. “User-ID Best Practices” - https://live.paloaltonetworks.com/docs/DOC-6591\n5. “PAN-OS Administrator's Guide 11.1 (English) - Client Probing\" -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/user-id/user-id-\nconcepts/user-mapping/client-probing\n1. Best Practices for Securing User-ID Deployments -\nhttps://live.paloaltonetworks.com/docs/DOC-7912\n1. “Best Practices for Securing User-ID Deployments” -\nhttps://live.paloaltonetworks.com/docs/DOC-7912\n2. “User-ID Best Practices” - https://live.paloaltonetworks.com/docs/DOC-6591\n3. “PAN-OS Administrator's Guide 11.1 (English) - Configure User Mapping Using\nthe Windows User-ID Agent” - https://docs.paloaltonetworks.com/pan-os/11-\n1/pan-os-admin/user-id/map-ip-addresses-to-users/configure-user-mapping-\nusing-the-windows-user-id-agent\n4. “PAN-OS Administrator's Guide 11.1 (English) - Configure User Mapping Using\nthe PAN-OS Integrated User-ID Agent” - https://docs.paloaltonetworks.com/pan-\nos/11-1/pan-os-admin/user-id/map-ip-addresses-to-users/configure-user-\nmapping-using-the-pan-os-integrated-user-id-agent\n1. “Best Practices for Securing User-ID Deployments” -\nhttps://live.paloaltonetworks.com/docs/DOC-7912\n2. “PAN-OS Administrator's Guide 11.1 (English) - Configure User Mapping Using\nthe Windows User-ID Agent” - https://docs.paloaltonetworks.com/pan-os/11-\n1/pan-os-admin/user-id/map-ip-addresses-to-users/configure-user-mapping-\nusing-the-windows-user-id-agent\n3. “PAN-OS Administrator's Guide 11.1 (English) - Configure User Mapping Using\nthe PAN-OS Integrated User-ID Agent” - https://docs.paloaltonetworks.com/pan-\nos/11-1/pan-os-admin/user-id/map-ip-addresses-to-users/configure-user-\nmapping-using-the-pan-os-integrated-user-id-agent\n4. “User-ID Best Practices” - https://live.paloaltonetworks.com/docs/DOC-6591\n1. “Best Practices for Securing User-ID Deployments” -\nhttps://live.paloaltonetworks.com/docs/DOC-7912\n2. “User-ID Best Practices” - https://live.paloaltonetworks.com/docs/DOC-6591\n3. “PAN-OS Administrator's Guide 11.1 (English) - Configure User Mapping Using\nthe Windows User-ID Agent” - https://docs.paloaltonetworks.com/pan-os/11-\nPage 92\n1/pan-os-admin/user-id/map-ip-addresses-to-users/configure-user-mapping-\nusing-the-windows-user-id-agent\n4. “PAN-OS Administrator's Guide 11.1 (English) - Configure User Mapping Using\nthe PAN-OS Integrated User-ID Agent” - https://docs.paloaltonetworks.com/pan-\nos/11-1/pan-os-admin/user-id/map-ip-addresses-to-users/configure-user-\nmapping-using-the-pan-os-integrated-user-id-agent\n1. “Best Practices for Securing User-ID Deployments” -\nhttps://live.paloaltonetworks.com/docs/DOC-7912\n2. “User-ID Best Practices” - https://live.paloaltonetworks.com/docs/DOC-6591\n3. “PAN-OS Administrator's Guide 11.1 (English) - Configure User Mapping Using\nthe Windows User-ID Agent” - https://docs.paloaltonetworks.com/pan-os/11-\n1/pan-os-admin/user-id/map-ip-addresses-to-users/configure-user-mapping-\nusing-the-windows-user-id-agent\n4. “PAN-OS Administrator's Guide 11.1 (English) - Configure User Mapping Using\nthe PAN-OS Integrated User-ID Agent” - https://docs.paloaltonetworks.com/pan-\nos/11-1/pan-os-admin/user-id/map-ip-addresses-to-users/configure-user-\nmapping-using-the-pan-os-integrated-user-id-agent\n1. “PAN-OS Administrator's Guide 11.1 (English) - High Availability\" -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-\nhelp/device/device-high-availability\n1. “PAN-OS Administrator's Guide 11.1 (English) - High Availability\" -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-\nhelp/device/device-high-availability\n1. “PAN-OS Administrator's Guide 11.1 (English) - High Availability\" -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-\nhelp/device/device-high-availability\n1. “Tips for Managing Content Updates” -\nhttps://live.paloaltonetworks.com/docs/DOC-1578\n2. “PAN-OS Administrator's Guide 9.0 (English) -Dynamic Content Updates\" -\nhttps://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/software-and-\ncontent-updates/dynamic-content-updates.html\n3. “PAN-OS Administrator's Guide 9.0 (English) - Install Content Updates\" -\nhttps://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/software-and-\ncontent-updates/install-content-and-software-updates.html\nPage 105\n1. “Tips for Managing Content Updates” -\nhttps://live.paloaltonetworks.com/docs/DOC-1578\nPage 107\n2. “PAN-OS Administrator's Guide 9.0 (English) -Dynamic Content Updates\" -\nhttps://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/software-and-\ncontent-updates/dynamic-content-updates.html\n3. “PAN-OS Administrator's Guide 9.0 (English) - Install Content Updates\" -\nhttps://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/software-and-\ncontent-updates/install-content-and-software-updates.html\n1. “How to Configure WildFire” - https://live.paloaltonetworks.com/docs/DOC-3252\n2. https://docs.paloaltonetworks.com/wildfire/10-2/wildfire-admin/wildfire-\ndeployment-best-practices/wildfire-best-practices\nPage 111\n1. “Wildfire Administrator's Guide 9.0 (English)\" -\nhttps://docs.paloaltonetworks.com/wildfire/9-0/wildfire-admin.html\n1. “WildFire Fails Forwarding File to Cloud for Encrypted Traffic” -\nhttps://live.paloaltonetworks.com/docs/DOC-6845\n2. “Wildfire Administrator's Guide 9.0 (English) - Forward Decrypted SSL Traffic for\nWildfire Analysis\" - https://docs.paloaltonetworks.com/wildfire/9-0/wildfire-\nadmin/submit-files-for-wildfire-analysis/forward-decrypted-ssl-traffic-for-wildfire-\nanalysis.html#\n3. “Wildfire Administrator's Guide 9.0 (English) - Wildfire Best Practices\" -\nhttps://docs.paloaltonetworks.com/wildfire/9-0/wildfire-admin/wildfire-deployment-\nbest-practices/wildfire-best-practices.html#\nPage 115\n1. “Wildfire Administrator's Guide 9.0 (English)\" -\nhttps://docs.paloaltonetworks.com/wildfire/9-0/wildfire-admin.html#\n2. “Wildfire Administrator's Guide 9.0 (English) - Wildfire Best Practices\" -\n/https://docs.paloaltonetworks.com/wildfire/9-0/wildfire-admin/wildfire-\ndeployment-best-practices/wildfire-best-practices.html\n1. “WildFire Email Alerts: Subscribe or Add Additional Recipients” -\nhttps://live.paloaltonetworks.com/docs/DOC-7740\n2. “Wildfire Administrator's Guide 9.0 (English)\" -\nhttps://docs.paloaltonetworks.com/wildfire/9-0/wildfire-admin.html\n1. “Wildfire What's New in 10.0 (English)\" -\nhttps://docs.paloaltonetworks.com/wildfire/u-v/wildfire-whats-new/wildfire-\nfeatures-in-panos-100/wildfire-real-time-signature-updates\n2. “How to Configure WildFire” - https://live.paloaltonetworks.com/docs/DOC-3252\n3. “Tips for Managing Content Updates” -\nhttps://live.paloaltonetworks.com/docs/DOC-1578\nPage 121\n1. \"List of Available Wildfire Regions\" -\nhttps://docs.paloaltonetworks.com/advanced-wildfire/administration/advanced-\nwildfire-overview/advanced-wildfire-deployments/advanced-wildfire-global-cloud\n2. \"Announcements as More Regions are Added\" -\nhttps://docs.paloaltonetworks.com/wildfire\n1. “Advanced WildFire (English)” - https://docs.paloaltonetworks.com/advanced-\nwildfire/administration/configure-advanced-wildfire-analysis/enable-advanced-\nwildfire-inline-cloud-analysis\n1. “Threat Prevention Deployment Tech Note” -\nhttps://live.paloaltonetworks.com/docs/DOC-3094\nPage 128\n2. “PAN-OS Administrator's Guide 11.1 (English) - Security Profiles” -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/policy/security-\nprofiles\n3. \"KB on reset-server, reset-client or silent drop\" -\nhttps://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA10g000000\nClTaCAK\n1. “PAN-OS Administrator's Guide 11.1 (English) - Security Policies ” -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/policy/security-\npolicy\nPage 130\n2. “PAN-OS Administrator's Guide 11.1 (English) - Security Profiles” -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/policy/security-\nprofiles\n1. \"PAN OS Administrator's Guide 11.1 (English) - Anti-Spyware Profile\" -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-\nhelp/objects/objects-security-profiles-anti-spyware-profile\n1. “How to Deal with Conficker using DNS Sinkhole” -\nhttps://live.paloaltonetworks.com/docs/DOC-6628\n2. “Threat Prevention Deployment Tech Note” -\nhttps://live.paloaltonetworks.com/docs/DOC-3094\n3. \"PAN OS Administrator's Guide 11.1 (English) - Anti-Spyware Profile\" -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-\nhelp/objects/objects-security-profiles-anti-spyware-profile\nPage 135\n1. “Threat Prevention Deployment Tech Note” -\nhttps://live.paloaltonetworks.com/docs/DOC-3094\nPage 137\n2. “PAN-OS Administrator's Guide 9.0 (English) - Security Profiles” -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/policy/security-\nprofiles\n1. “Threat Prevention Deployment Tech Note” -\nhttps://live.paloaltonetworks.com/docs/DOC-3094\nPage 139\n2. “PAN-OS Administrator's Guide 11.1 (English) - Security Profiles” -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/policy/security-\nprofiles\n1. “Threat Prevention Deployment Tech Note” -\nhttps://live.paloaltonetworks.com/docs/DOC-3094\n2. “PAN-OS Administrator's Guide 11.1 (English) - Security Policies” -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/policy/security-\npolicy\n3. “PAN-OS Administrator's Guide 11.1 (English) - Security Profiles” -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/policy/security-\nprofiles\n1. “PAN-OS Administrator's Guide 9.0 (English) - URL Filtering” -\nhttps://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/url-filtering.html\nPage 143\n2. “PAN-OS Administrator's Guide 9.0 (English) - URL Filtering Best Practices\" -\nhttps://docs.paloaltonetworks.com/advanced-url-\nfiltering/administration/configuring-url-filtering/url-filtering-best-practices\n1. “PAN-OS Administrator's Guide 11.1 (English) - Security Profiles” -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/policy/security-\nprofiles\n2. “PAN-OS Administrator's Guide 9.0 (English) - URL Filtering” -\nhttps://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/url-filtering.html\n3. “PAN-OS Admin Guide 9.0 (English) - URL Filtering Best Practices\" -\nhttps://docs.paloaltonetworks.com/advanced-url-\nfiltering/administration/configuring-url-filtering/url-filtering-best-practices\n1. “PAN-OS Administrator's Guide 11.1 (English) - URL Filtering Best Practices\" -\nhttps://docs.paloaltonetworks.com/advanced-url-\nfiltering/administration/configuring-url-filtering/url-filtering-best-practices\n2. “PAN-OS Administrator's Guide 9.0 (English) - URL Filtering” -\nhttps://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/url-filtering.html\nPage 147\n1. “PAN-OS Administrator's Guide 11.1 (English) - URL Filtering Best Practices\" -\nhttps://docs.paloaltonetworks.com/advanced-url-\nfiltering/administration/configuring-url-filtering/url-filtering-best-practices\n1. “PAN-OS Administrator's Guide 11.1 (English) - URL Filtering Best Practices\" -\nhttps://docs.paloaltonetworks.com/advanced-url-\nfiltering/administration/configuring-url-filtering/url-filtering-best-practices\n1. “What are the Data Filtering Best Practices?” -\nhttps://live.paloaltonetworks.com/docs/DOC-2513\n2. “PAN-OS Administrator's Guide 9.0 (English) - Setting up Data Filtering\" -\nhttps://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/threat-\nprevention/set-up-data-filtering.html#\n1. “PAN-OS Administrator's Guide 9.0 (English) - Setting up Data Filtering\" -\nhttps://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/threat-\nprevention/set-up-data-filtering.html#\n1. “Understanding DoS Protection” - https://live.paloaltonetworks.com/docs/DOC-\n5078\n2. \"Syn Cookie Operation” - https://live.paloaltonetworks.com/docs/DOC-1542\n3. “How to Determine if Configured DoS Classify TCP SYN Cookie Alarm, Activate\nand Maximal Rate is Triggered” - https://live.paloaltonetworks.com/docs/DOC-\n6801\n4. “Threat Prevention Deployment Tech Note” -\nhttps://live.paloaltonetworks.com/docs/DOC-3094\nPage 159\n5. “What are the Differences between DoS Protection and Zone Protection?” -\nhttps://live.paloaltonetworks.com/docs/DOC-4501\n6. “Application DDoS Mitigation” - https://live.paloaltonetworks.com/docs/DOC-7158\n7. PANOS 11.1 Admin Guide - Zone Protection . Flood Protection -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-\nhelp/network/network-network-profiles/network-network-profiles-zone-\nprotection/flood-protection\n1. “Understanding DoS Protection” - https://live.paloaltonetworks.com/docs/DOC-\n5078\n2. “Threat Prevention Deployment Tech Note” -\nhttps://live.paloaltonetworks.com/docs/DOC-3094\n3. “What are the Differences between DoS Protection and Zone Protection?” -\nhttps://live.paloaltonetworks.com/docs/DOC-4501\n4. PANOS 11.1 Admin Guide - Network Profiles / Zone Protection / Flood Protection\n- https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-\nhelp/network/network-network-profiles/network-network-profiles-zone-\nprotection/flood-protection\n1. “Host Sweep Triggering Method in Zone Protection Profile” -\nhttps://live.paloaltonetworks.com/docs/DOC-8703\n2. “Understanding DoS Protection” - https://live.paloaltonetworks.com/docs/DOC-\n5078\n3. “Threat Prevention Deployment Tech Note” -\nhttps://live.paloaltonetworks.com/docs/DOC-3094\n4. “What are the Differences between DoS Protection and Zone Protection?” -\nhttps://live.paloaltonetworks.com/docs/DOC-4501\n5. PANOS 11.1 Admin Guide - Network Profiles / Zone Protection /\nReconnaissance Protection - https://docs.paloaltonetworks.com/pan-os/11-\n1/pan-os-web-interface-help/network/network-network-profiles/network-network-\nprofiles-zone-protection/reconnaissance-protection\n1. “Understanding DoS Protection” - https://live.paloaltonetworks.com/docs/DOC-\n5078\n2. “Threat Prevention Deployment Tech Note” -\nhttps://live.paloaltonetworks.com/docs/DOC-3094\n3. “What are the Differences between DoS Protection and Zone Protection?” -\nhttps://live.paloaltonetworks.com/docs/DOC-4501\n4. PANOS 11.1 Admin Guide - Network Profiles / Zone Protection / Packet Based\nAttack Protection - https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-\ninterface-help/network/network-network-profiles/network-network-profiles-zone-\nprotection/packet-based-attack-protection\n1. PAN OS 11.1 Admin Guide - URL Filtering / User Credential Detection -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-\nhelp/objects/objects-security-profiles-url-filtering/user-credential-detection\n1. “PAN-OS Administrator's Guide 11.1 (English) - Security Profiles” -\nhttps://docs.paloaltonetworks.com/advanced-wildfire/administration/configure-\nadvanced-wildfire-analysis/enable-advanced-wildfire-inline-ml\n1. “PAN-OS Administrator's Guide 11.1 (English) - Security Profiles” -\nhttps://docs.paloaltonetworks.com/advanced-wildfire/administration/configure-\nadvanced-wildfire-analysis/enable-advanced-wildfire-inline-ml\n1. “Configuring Vulnerability Protection Inline Cloud Analysis Guide (English)” -\nhttps://docs.paloaltonetworks.com/pan-os/11-0/pan-os-new-features/content-\ninspection-features/vuln-protection-inline-cloud-analysis\n1. “Configuring Cloud Inline Categorization for URL Filtering Guide (English)” -\nhttps://docs.paloaltonetworks.com/pan-os/10-2/pan-os-new-features/url-filtering-\nfeatures/cloud-inline-categorization\n2. “PAN-OS Administrator's Guide 11.1 (English) - Inline Categorization” -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-\nhelp/objects/objects-security-profiles-url-filtering/inline-categorization\n1. “Configuring Inline Cloud Analysis Guide (English)” -\nhttps://docs.paloaltonetworks.com/advanced-threat-\nprevention/administration/configure-threat-prevention/configure-inline-cloud-\nanalysis#idcf1fc426-b522-4e84-9098-ac82f2d784ae\n1. “Configuring DNS Security” - https://docs.paloaltonetworks.com/dns-\nsecurity/administration/configure-dns-security/enable-dns-security#tabs-\nid066476b2-c4dd-4fc0-b7e4-f4ba32e19f60\n2. \"DNS Security Best Practices\" - https://docs.paloaltonetworks.com/advanced-\nthreat-prevention/administration/threat-prevention/best-practices-for-securing-\nyour-network-from-layer-4-and-layer-7-evasions\n1. “PAN-OS Administrator's Guide 11.1 (English) - Security Policies / Applications\nand Usage ” - https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-\ninterface-help/policies/policies-security/applications-and-usage\nPage 184\n1. “Security Policy Guidelines” - https://live.paloaltonetworks.com/docs/DOC-3469\n2. “Security Bulletin: App-ID Cache Pollution” -\nhttp://researchcenter.paloaltonetworks.com/2012/12/app-id-cache-pollution-\nresponse/\n3. “PAN-OS Administrator's Guide 11.1 (English) - Security Policiy Overview ” -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-web-interface-\nhelp/policies/policies-security/security-policy-overview\n1. \"PAN-OS 11.1 Admin Guide: Built-in External Dynamic Lists\":\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/policy/use-an-\nexternal-dynamic-list-in-policy/built-in-edls\n1. “Gateway Firewall Best Practices on Default Policies Logging Configuration” -\nhttps://docs.paloaltonetworks.com/best-practices/internet-gateway-best-\npractices/best-practice-internet-gateway-security-policy/define-the-initial-internet-\ngateway-security-policy/step-5-enable-logging-for-traffic-that-doesnt-match-any-\nrules\n2. “Datacenter Firewall Best Practices on Default Policies Logging Configuration” -\nhttps://docs.paloaltonetworks.com/best-practices/10-2/data-center-best-\npractices/data-center-best-practice-security-policy/log-and-monitor-data-center-\ntraffic/log-intra-data-center-traffic-that-matches-the-intrazone-allow-rule\nPage 191\n1. “How to Implement SSL Decryption” -\nhttps://live.paloaltonetworks.com/docs/DOC-1412\n2. ““PAN-OS Administrator's Guide 11.1 (English) - Decryption (English)” -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/decryption\n1. “How to Implement SSL Decryption” -\nhttps://live.paloaltonetworks.com/docs/DOC-1412\n2. “PAN-OS Administrator's Guide 11.1 (English) - Decryption (English)” -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/decryption\n1. \"How to Implement and Test SSL Decryption\" -\nhttps://live.paloaltonetworks.com/t5/Configuration-Articles/How-to-Implement-\nand-Test-SSL-Decryption/ta-p/59719\n2. “PAN-OS Administrator's Guide 11.1 (English) - Decryption (English)” -\nhttps://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/decryption\n3. \"SSL Certificates Resource List on Configuring and Troubleshooting\" -\nhttps://live.paloaltonetworks.com/t5/Management-Articles/SSL-certificates-\nresource-list/ta-p/53068\n4. \"Certificates\" - http://palo-alto.wikia.com/wiki/Certificates",
    "audit": "Navigate to Network > Network Profiles > IKE Gateways.\nOn gateways that has IKEv2 enabled, click into it and navigate to Advanced Options.\nOn IKEv2 section, navigate to PQ PPK section.\nVerify that Enable Post-Quantum Pre-Shared Key (PPK) is checked.\nNegotiation mode should be set to Mandatory if both sides of VPN supports PQ.\nNegotiation mode should be set to Preferred if you don't know or don't have control\nover whether the peer supports RFC 8784. Preferred mode preserves backward\ncompatibility to ensure connections fall back instead of dropping.\nIf both sides of VPN supports more than 1 PPK key ID, then multiple PPK key ID should\nbe configured. Configuring multiple PQ PPKs is most secure because it adds a random\nelement to PQ PPK selection.\nPage 77\nTo validate if this recommendation has been met, look at the Source User column in\nthe URL Filtering or Traffic logs (Monitor > Logs > URL Filtering and Logs >\nTraffic Logs, respectively.)\nUser traffic originating from a trusted zone should identify a username.\nNavigate to Device > User Identification > User Mapping > Palo Alto\nNetworks User ID Agent Setup.\nVerify that Enable Probing is not checked.\nNavigate to Network > Network Profiles > Interface Management.\nVerify that User-ID is only enabled for interfaces that are both internal and trusted.\nNavigate to Device > User Identification > User Mapping > Include/Exclude\nNetworks.\nVerify that all trusted internal networks have a Discovery value of Include.\nVerify that all untrusted external networks have a Discovery value of Exclude. Note that\nany value in the trusted networks list implies that all other networks are untrusted.\nNavigate to Active Directory Users and Computers for the Active Directory under\nconsideration.\nVerify that the service account for the User-ID agent is not a member of any groups\nother than Event Log Readers, Distributed COM Users, and Domain Users (for the\nintegrated, on-device User-ID agent) or Event Log Readers, Server Operators, and\nDomain Users (for the Windows User-ID agent.)\nNavigate to Active Directory Group Policies.\nVerify that Group Policies restricts the interactive logon privilege for the User-ID service\naccount.\nor\nNavigate to Active Directory Managed Service Accounts.\nVerify that Managed Service Accounts restricts the interactive logon privilege for the\nUser-ID service account.\nAuditing is operating-system dependent. For instance, in Windows Active Directory, this\naccount should not be included in any group that grants the account access to VPN or\nWireless access. In addition, domain administrative accounts should not have remote\ndesktop (RDP) access to all domain member workstations.\nNavigate to Device > Setup > Services > Services Features > Service Route\nConfiguration > Customize.\nClick on the protocol in use (IPv4 and/or IPv6).\nClick UID Agent.\nClick on the address object for the UID Agent's IP address.\nVerify SOURCE/NAME is set to 'Deny msrpc to untrusted'.\nVerify SOURCE/ZONE is set to 'INSIDE'.\nVerify SOURCE/Address is set to the Address object for the UID Agent.\nVerify DESTINATION/ZONE is set to 'GUEST' and 'OUTSIDE'.\nVerify DESTINATION/Address is set to 'any'.\nVerify DESTINATION/Application is set to 'msrpc'.\nVerify DESTINATION/Service is set to 'application-default'.\nVerify DESTINATION/Action is set to 'Block' (red circle with diagonal line).\nPage 94\nNavigate to Device > High Availability > HA Communications.\nIn the HA Communications. >Data Link (HA2) section, verify that the correct\ninterface is selected. Verify the desired protocol (IPv4 or IPv6) is selected. Verify\nthe correct Transport is selected. Verify the Enable Session Synchronization box is\nchecked.\nTo verify Link Monitoring from GUI:\nNavigate to Device > High Availability > Link and Path Monitoring. In the\nLink Monitoring section, verify the correct interfaces are in the Link Group and\nGroup Failure Conditions Under the Link Monitoring section, verify Failure\nCondition is set to Any. Verify Enabled button is checked.\nTo verify Path Monitoring from GUI:\nNavigate to Device > High Availability > Link and Path Monitoring. In the\nPath Monitoring section, verify Option is set correctly. Verify Failure Condition is\nset to Any. Verify Name, IP Address, Failure Condition is set correctly. Verify\nDefault setting is set to Any. Verify Enabled button is checked.\nTo ensure Active/Passive Settings are configured correctly:\nNavigate to Device > High Availability > General > Active/Passive\nSettings.\nVerify Passive Link State is set to auto.\nTo ensure Election Settings are configured correctly:\nNavigate to Device > High Availability > Election Settings.\nVerify Preemptive is disabled.\nNavigate to Device > Dynamic Updates > Antivirus Update Schedule.\nVerify that Action is set to Download and Install.\nVerify that Recurrence is set to Hourly.\nNavigate to Device > Dynamic Updates > Application and Threats Update\nSchedule.\nVerify that Action is set to Download and Install.\nVerify that Recurrence is set to Daily, Hourly or Every 30 Minutes\nNavigate to Device > Setup > WildFire.\nNavigate to the General Settings sections.\nVerify the maximum size for each file type at the defaults or larger, to a size that is as\nlarge enough to account for \"large\" files, but not large enough to affect performance of\nthe hardware.\nTo verify WildFire Analysis Profile:\n• Navigate to Objects > Security Profiles > WildFire Analysis Profile\nverify that a profile exists.\nTo verify File Blocking Rules:\n• For each Security Policy were the action is set to Allow, edit the Rule and\nnavigate to Actions > Profile Setting. Ensure that the WildFire\nAnalysis is set to Allow and verify that a profile is set.\nIf Group Profiles are used:\n• Navigate to Policies > Security\n• For each Security Policy were the action is set to Allow, edit the Rule and\nnavigate to Actions > Profile Setting. Ensure that the Profile Type is set\nto Group.\n• Navigate to Objects > Security Profile Groups. Open the Security Profile Group\nused above, and ensure that the Wildfire Analysis Profile is set.\nNavigate to Device > Setup > Content-ID > Content-ID Settings.\nVerify that Allow forwarding of decrypted content is checked.\nNavigate to Device > Setup > WildFire > Session Information Settings.\nVerify that every option is enabled.\nNavigate to Objects > Log Forwarding.\nVerify that the WildFire log type is configured to generate alerts using the desired\nalerting mechanism(s).\nNavigate to Device > Dynamic Updates > WildFire Update Schedule.\nVerify that Recurrence is set to Real-time.\nNavigate to Device > Setup > WildFire.\nNavigate to the General Settings sections.\nVerify that WildFire Public Cloud is set to your appropriate region.\nNavigate to Objects > Security Profiles > Wildfire\nVerify that Wildfire profiles has Enable cloud inline analysis checked.\nOn Inline cloud analysis tab, verify that there is a rule to forward files with the\nfollowing settings:\n• Application set to Any\n• File Type set to PE\n• Direction set to Both\n• Action set to Block\nNavigate to Objects > Security Profiles > Antivirus\nVerify that antivirus profiles have all decoders set to reset-both for both Action and\nWildfire Action. If imap and pop3 are required in the organization, verify that the\nimap and pop3 decoders are set to alert for both Action and Wildfire Action.\nNavigate to Policies > Security . For each policy, navigate to [Policy Name] >\nActions Verify there is a secure Antivirus profile applied to all security policies\npassing traffic - regardless of protocol. This can be set by Profiles or by Profile Group.\nNavigate to Objects > Security Profiles > Anti-Spyware. Click on existing\nprofile in used or create a new profile.\nNavigate to Signature Policies tab. Add new policy by giving it a name Policy\nName.\nVerify a Policy Name exists within the anti-spyware profile that is configured to perform\nthe reset-both on Critical, High, and Medium Severity level, any\nCategory, and any Threat Name.\nNavigate to Objects > Security Profiles > Anti-Spyware.\nWithin the each anti-spyware profile, under its DNS Policies tab, verify the Signature\nSource List: default-paloalto-dns should have as its Policy Action set to\nsinkhole If licensed, the DNS Security should have as its Policy Action set to\nsinkhole\nVerify the 'Sinkhole IPv4' IP address is correct. This should be set to\nsinkhole.paloaltnetworks.com, or if an internal host is set then that host IP or\nFQDN should be in that field\nVerify the 'Sinkhole IPv6' IP address is correct. This should be set to IPv6 Loopback\nIP (::1), or if an internal DNS Sinkhole host is set then that host IP or FQDN should\nbe in that field\nNavigate to Policies > Security Policies For each outbound security Policy, in\nthe Actions tab, verify that the Anti-Spyware setting includes the Spyware Profile\ncreated, either explicitly or as a Group Profile\nTo verify correct operation of DNS Security, from an internal station make a DNS\nrequest to each of the following hosts:\n• test-malware.testpanw.com to test Malware DNS Signature checks\n• test-c2.testpanw.com to test C2 DNS Signature checks\nPage 134\n• test-dga.testpanw.com to test DGA (Domain Generation Algorithm) DNS attack\nchecks\n• test-dnstun.testpanw.com to test DNS Tunneling attack checks Each of\nthese DNS requests should be redirected to the configured DNS Sinkhole server\nIP address Each of these DNS requests should appear in the firewall logs, under\nMonitor > Logs > Threat. If configured, each of these requests should\ngenerate an alert in the organization's SIEM.\nNavigate to Objects > Security Profiles > Anti-Spyware.\nAlso navigate to Policies > Security.\nVerify there are one or more anti-spyware profiles that collectively apply to all inside to\noutside traffic from any address to any address and any application and service.\nNavigate to Objects > Security Profiles > Vulnerability Protection.\nVerify a Vulnerability Protection Profile is set to block attacks against any critical or high\nvulnerabilities (minimum), and set to default on attacks against any medium, low, or\ninformational vulnerabilities.\nNavigate to Policies > Security.\nFor each Policy, under the Actions tab, select Vulnerability Protection.\nVerify either the 'Strict' or the 'Default' profile is selected, or a custom profile that\ncomplies with the organization's policies, legal and regulatory requirements.\nNavigate to Device > Licenses.\nClick on PAN-DB URL Filtering.\nVerify Active is set to Yes.\nNavigate to Objects > Security Profiles > URL Filtering.\nVerify that all URL categories designated by the organization are listed, and the action\nis set to Block.\nNavigate to Objects > Security Profiles > URL Filtering.\nVerify that the for all allowed categories, that the Site Access action is set to alert\nNavigate to Objects > Security Profiles > URL Filtering > URL Filtering\nProfile > URL Filtering Settings.\nVerify these four settings:\na. Log container page only box is un-checked\nb. User-Agent box is checked\nc. Referer box is checked\nd. X-Forwarded-For box is checked\nTo Verify URL Filtering:\nFor each Security Policy that transits traffic to the public internet, navigate to Policies\n> Security > Security Profiles > [Policy Name] > Actions.\nVerify there is a URL Filtering profile that complies with the policies of the organization\nis applied to all Security Policies that transit traffic to the public internet.\nNavigate to Objects > Custom Objects > Data Patterns.\nVerify an appropriate Data Pattern has been created that accounts for sensitive\ninformation within your organization. In most cases this will include Credit Card\nNumbers, and your jurisdiction's equivalent of Social Insurance Numbers. In many\ncases these can simply be picked from the list of Predefined Patterns.\nNavigate to Objects > Security Profiles > Data Filtering.\nVerify an appropriate Data Filtering Profile has been created, using the created\nData Patterns. Ensure that an Alert Threshold is set that generates alerts\nappropriately. A typical starting value for Alert Threshold is 20, but this should be\nadjusted after appropriate testing.\nNavigate to Objects > Custom Objects > Data Patterns. Verify that the patterns\ndefined match the various data that you wish to monitor or make blocking decisions on.\nNavigate to Objects > Security Profiles > Data Filtering For each Filtering\nProfile, verify that the Data Patterns defined matches the data you wish to monitor,\nwith appropriate values for Alert Threshold (typically 20), Block Threshold\n(typically 0) and Log Severity.\nFinally, navigate to Policies > Security. Open all appropriate policies, for each\nPolicy choose the Actions tab, and verify that the appropriate Data Filtering\nPolicy is applied (either as an individual Profile or as part of a Group Profile)\nFrom GUI:\nNavigate to Network > Network Profiles > Zone Protection > Zone\nProtection Profile > Flood Protection tab.\nVerify the SYN box is checked. Verify the Action dropdown is SYN Cookies. Verify Alert\nis 20000 (or appropriate for org). Verify Activate is 25000 (50% of maximum for firewall\nmodel). Verify Maximum is 1000000 (or appropriate for org).\nNavigate to Network > Zones. Open the zone facing any untrusted network. Verify that\nZone Protection has the Zone Protection Profile set to the Profile created.\nIn the GUI:\nNavigate to Network > Network Profiles > Zone Protection > Flood\nProtection.\nEnsure that all settings are enabled with at least the default values.\nNavigate to Network > Zones, select each untrusted zone in turn, and ensure that the\nZone Protection Profile is set.\nPage 161\nNavigate to Network > Network Profiles > Zone Protection > Zone\nProtection Profile > Reconnaissance Protection.\nVerify that TCP Port Scan is enabled, its Action is set to block-ip, its Interval is set to\n5, and its Threshold is set to 20. For block-ip, ensure the \"Track By\" is set to source\nand \"Duration\" is set to 600 seconds.\nVerify that Host Sweep is enabled, its Action is set to block, its Interval is set to 10,\nand its Threshold is set to 30.\nVerify that UDP Port Scan is enabled, its Action is set to alert, its Interval is set to 10,\nand its Threshold is set to 20.\nNavigate to Network > Network Profiles > Zone Protection > Zone\nProtection Profile > Packet Based Attack Protection > TCP/IP Drop.\nVerify Spoofed IP address is checked.\nVerify Mismatched overlapping TCP segment is checked.\nUnder IP Option Drop, verify that Strict Source Routing, Loose Source\nRouting, and Malformed are all checked. Additional options may also be checked.\nNavigate to Objects > Security Profiles > URL Filtering.\nChoose the Categories tab. Verify that the User Credential Submitting action on\nall enabled URL categories is set to either block or continue.\nUnder the User Credential Detection tab ensure the User Credential\nDetection is set to a value appropriate to your organization, and is not set to\nDisabled. Verify that the Log Severity value is set to a value appropriate to your\norganization and your logging or SIEM solution.\nNavigate to Objects > Security Profiles > Antivirus\nVerify that antivirus profiles have all decoders set to reset-both for Wildfire Inline\nML Action. If imap and pop3 are required in the organization, verify that the imap and\npop3 decoders are set to alert for Wildfire Inline ML Action.\nNavigate to Objects > Security Profiles > Antivirus\nGo to Wildfire Inline ML tab. Verify that all Action Setting are set to enable\n(inherit per-protocol actions).\nNavigate to Objects > Security Profiles > Vulnerability Protection\nGo to Inline Cloud Analysis tab. Verify that it is enabled and all Model action is set\nas alert.\nNavigate to Objects > Security Profiles > URL Filtering\nGo to Inline Categorization tab. Verify that it is enabled for both Enable local\ninline categorization and Enable cloud inline categorization.\nNavigate to Objects > Security Profiles > Anti-Spyware\nGo to Inline Cloud Analysis tab. Verify that it is enabled and all Model action is set\nas reset-both.\nNavigate to Objects > Security Profiles > Anti-Spyware\nGo to DNS Policies tab. Verify that policy action is set to sinkhole for all DNS\nSecurity categories.\nOn Command and control Domains category, verify that the packet capture option to\nextended-capture.Navigate to Objects > Security Profiles > Anti-Spyware\nGo to DNS Policies tab. Configure policy action to sinkhole for all DNS Security\ncategories.\nOn Command and control Domains category, set the packet capture option to\nextended-capture\nNavigate to Policies > Security.\nPage 183\nFor all Security Policies that transit from a less trusted to a more trusted interface, that\nthe appropriate Application and Service values are set. For instance, for a web\nserver exposed to the internet from a DMZ: Source tab: Zone set to OUTSIDE / Address\nset to Any Destination tab: Zone set to DMZ / Address set to [DMZ Host Object]\nApplication tab: set to web-browsing Service/URL Category tab: set Service to\nether:\n• application-default or:\n• service-http and/or service-https\n**Enhanced Security Recommendation: **\nAssess this setting for Policies on all Interfaces, for traffic in all directions. Ensure that\nfor each Security Policy that the appropriate settings are set for both Application and\nService\nNavigate to Policies > Security.\nFor each exposed host, verify that a Security Policy exists with:\n• Source tab: Zone set to OUTSIDE Address set to any\n• Destination tab: Zone set to DMZ / Address set to <DMZ Host Object>\n• Application tab: Application set to web-browsing (or appropriate\napplication)\n• Service tab: Service set to application-default. The value of any should\nnever be used\nNavigate to Policies > Security\nVerify a Security Policy exists similar to:\n• General tab: Name set to Deny to Malicious IP\n• Source tab: Source Zone set to Any,\n• Destination tab: Destination Zone set to Any, Destination Address set to\nPalo Alto Networks - Known malicious IP addresses,Palo Alto\nNetworks - High risk IP addresses, Palo Alto Networks - Tor exit\nIP addresses, Palo Alto Networks - Bulletproof IP addresses\n• Application tab: Application set to Any\n• Service/URL Category tab: Service set to Any\n• Actions tab: Action set to Block, Profile Type set to None\nVerify a Security Policy exists similar to:\nPage 188\n• General tab: Name set to Deny from Malicious IP\n• Source tab: Source Zone set to Any, Source Address set to Palo Alto\nNetworks - Known malicious IP addresses,Palo Alto Networks - High\nrisk IP addresses, Palo Alto Networks - Tor exit IP addresses, Palo\nAlto Networks - Bulletproof IP addresses\n• Destination tab: Destination Zone set to Any\n• Application tab: Application set to Any\n• Service/URL Category tab: Service set to Any\n• Actions tab: Action set to Block, Profile Type set to None\nNote: This recommendation requires a Palo Alto Networks \"Threat Prevention License\"\nNavigate to Policies > Security\nGo to default policies intrazone-default and interzone-default. On Actions tab,\nverify that log setting has Log at Session End is enabled.\nNavigate to Policies > Decryption. Verify SSL Forward Proxy is set for all traffic\ndestined to the Internet.\nVerify each Decryption Policy Rule:\n• Source tab: The Source Zone and/or Source Address should include all target\ninternal networks. Source User should include all target internal users\n• Destination tab: The Destination Zone should include the untrusted target\nzone (usually the internet). Destination Address is typically Any for an\ninternet destination.\nPage 194\n• Service/URL Category tab: Verify that all URL Category entries are included\nexcept financial-services, government and health-and-medicine (this list\nmay vary depending on your organization and its policies).\n• Options tab: Verify that the Type is set to SSL Forward Proxy\nNavigate to Policies > Decryption.\nVerify SSL Inbound Inspection is set appropriately for all untrusted traffic destined for\nservers using SSL or TLS.\nNavigate to Policies > Decryption. For each service published to the internet (or\nother untrusted zones), verify the following settings:\n• General tab: Name set to a descriptive name\n• Source: Source Zone set to the target zone (Internet in many cases). Source\nAddress set to the target address space (Any for internet traffic)\n• Destination tab: Destination Zone should be set to the appropriate zone, or\nAny. Destination Address set to the target host address\n• Options tab: Type set to SSL Inbound Inspection\nVerify the CA Certificate(s):\nNavigate to Device > Certificate Management > Certificates\n• Verify that appropriate internal certificates are imported, and that all certificates in\nthe list are valid. In particular, verify the Subject, Issuer, CA, Expires,\nAlgorithm and Usage fields\n• Alternatively, if an internal CA is implemented on the firewall, verify that target\nclients have the root certificate for this CA imported into their list of trusted\ncertificate authorities.\nPage 199\nVerify the Certificate Profile needed for the SSL Forward Proxy:\n• Navigate to Device > Certificate Management > Certificate Profile.\nVerify that an appropriate profile is created.",
    "rationale": "Post-quantum IKEv2 VPNs based on RFC 8784 work by transmitting a pre-shared\nsecret separately (out-of-band) from the initial peering exchange (the IKE_SA_INIT\nExchange). Instead of transmitting the pre-shared secret in the peering exchange,\nwhich an attacker could compromise or harvest now and decrypt later, the peering\nexchange only transmits a Key ID. A Key ID and a pre-shared secret comprise a unique\npair called a post-quantum pre-shared key (PQ PPK).\nEach IKEv2 peer uses the Key ID to look up the pre-shared secret, which is transmitted\nsecurely between administrators or pushed by Panorama, and stored locally on each\nIKEv2 peer. The pre-shared key is never part of the peering exchange and never\ntraverses the post-quantum VPN, so an attacker using a quantum computer can't steal\nit, crack it, and use it to decrypt data harvested from a VPN.\nBoth IKEv2 peers must have the same active pairs of Key ID plus pre-shared secret so\nthat when peers negotiate the connection, each peer can look up the same Key ID and\nretrieve the same pre-shared secret. If the responding peer doesn't have a matching\nKey ID or if the pre-shared secret associated with the Key ID differs from the initiator,\nthe connection is aborted.\nUnderstanding which user is involved in a security incident allows appropriate personnel\nto move quickly between the detection and reaction phases of incident response. In\nenvironments with either short DHCP lease times, or where users may move frequently\nbetween systems, the ability to analyze or report, or alert on events based on user\naccounts or user groups is a tremendous advantage. For forensics tasks when DHCP\nlease information may not be available, the Source User information may be the only\nway to tie together related data.\nWMI probing normally requires a domain administrator account. A malicious user could\ncapture the encrypted password hash for offline cracking or relayed authentication\nattacks. Relying on other forms of user identification, such as using UserID Agents or\nsecurity log monitoring, mitigates this risk.\nIn addition, it is easy to mis-configure this feature such that it is enabled on untrusted\ninterfaces. This can result in a domain administrator account and the associated\npassword hash being sent to untrusted hosts on the internet, where malicious users can\nthen capture that hash for offline cracking.\nPAN released a customer advisory in October of 2014 warning of WMI probing on\nuntrusted interfaces with User-ID enabled. This can result in theft of the password hash\nfor the account used in WMI probing.\nThe Include/Exclude Networks feature allow users to configure boundaries for the User-\nID service. By using the feature to limit User-ID probing to only trusted internal\nnetworks, the risks of privileged information disclosure through sent probes can be\nreduced. Note that if an entry appears in the Include/Exclude Networks section, an\nimplicit exclude-all-networks policy will take effect for all other networks.\nAs a principle of least privilege, user accounts should have only minimum necessary\npermissions. If an attacker compromises a User-ID service account with domain admin\nrights, the organization is at far greater risk than if the service account were only\ngranted minimum rights.\nIn the event of a compromised User-ID service account, restricting interactive logins\nforbids the attacker from utilizing services such as RDP against computers in the Active\nDirectory domain of the organization. This reduces the impact of a User-ID service\naccount compromise.\nIn the event of a compromised User-ID service account, restricting the account’s ability\nto remotely access resources within the organization’s internal network reduces the\nimpact of a service account compromise.\nIf User-ID and WMI probes are sent to untrusted zones, the risk of privileged information\ndisclosure exists. The information disclosed can include the User-ID Agent service\naccount name, domain name, and encrypted password hashes sent in User-ID and\nWMI probes. To prevent this exposure, msrpc traffic originating from the firewall to\nuntrusted networks should be explicitly denied. This security policy should be in effect\neven for environments not currently using WMI probing to help guard against possible\nprobe misconfigurations in the future.\nThis setting is a \"fail safe\" to prevent exposure of this information if any of the other\nWMI User control settings are misconfigured.\nTo ensure availability of both the firewall and the resources it protects, a High\nAvailability peer is required. In the event a single firewall fails, or when maintenance\nsuch as a software update is required, the HA peer can be used to automatically fail\nover session states and maintain overall availability\nIf Link or Path Monitoring is not enabled, the standby router will not automatically take\nover as active if a critical link fails on the active firewall. Services through the firewall\ncould become unavailable as a result.\nSimultaneously enabling the 'Preemptive' option and setting the 'Passive Link State'\noption to 'Shutdown' could cause a 'preemptive loop' if Link and Path Monitoring are\nboth configured. This will negatively impact the availability of the firewall and network\nservices, should a monitored failure occur.\nNew antivirus definitions may be released at any time. With an hourly update schedule,\nthe firewall can ensure threats with new definitions are quickly mitigated. A daily update\nschedule could leave an organization vulnerable to a known virus for nearly 24 hours, in\na worst-case scenario. Setting an appropriate threshold value reduces the risk of a bad\ndefinition file negatively affecting traffic.\nNew Applications and Threats file versions may be released at any time. With a\nfrequent update schedule, the firewall can ensure threats with new signatures are\nquickly mitigated, and the latest application signatures are applied.\nIt is recommended that 30 Minute intervals are used\nBecause the firewall has a specific capacity reserved to forward files for WildFire\nanalysis, forwarding high numbers of large files can cause the firewall to skip forwarding\nof some files. This condition occurs when the maximum file size limits are configured for\na file type that is traversing the firewall at a high rate. In this case, a potentially\nmalicious file might not get forwarded for WildFire analysis. Consider this possible\ncondition if you would like to increase the size limit for files other than PEs beyond their\ndefault size limit.\nTraffic matching security policies that do not include a WildFire file blocking profile will\nnot utilize WildFire for file analysis. Wildfire analysis is one of the key security measures\navailable on this platform. Without Wildfire analysis enabled, inbound malware can only\nbe analyzed by signature - which industry wide is roughly 40-60% effective. In a\ntargeted attack, the success of signature-based-only analysis drops even further.\nAs encrypted Internet traffic continues to proliferate, WildFire becomes less effective\nunless it is allowed to act on decrypted content. For example, if a user downloads a\nmalicious pdf over SSL, WildFire can only provide analysis if 1) the session is decrypted\nby the firewall and 2) forwarding of decrypted content is enabled. In today's internet,\nroughly 70-80% of all user traffic is encrypted. If Wildfire is not configured to analyze\nencrypted content, the effectiveness of Wildfire is drastically reduced.\nPermitting the firewall to send all of this information to WildFire creates more detailed\nreports, thereby making the process of tracking down potentially infected devices more\nefficient. This could prevent an infected system from further infecting the environment.\nEnvironments with security policies restricting sending this data to the WildFire cloud\ncan instead utilize an on-premises WildFire appliance. In addition, risk can be analyzed\nin the context of the destination host and user account, either during analysis or during\nincident response.\nWildFire analyzes files that have already been downloaded and possibly executed. A\nWildFire verdict of malicious indicates that a computer could already be infected. In\naddition, because WildFire only analyzes files it has not already seen that were not\nflagged by the firewall’s antivirus filter, files deemed malicious by WildFire are more\nlikely to evade detection by desktop antivirus products.\nWildFire definitions may contain signatures to block immediate, active threats to the\nenvironment. With updates in real-time, the firewall can ensure threats with new\ndefinitions are quickly mitigated.\nDepending on regulations, files is only allowed to be uploaded to local country / region.\nBesides, uploading to local country or even nearest country decreases file uploading\nspeed.\nRefer to the available regions in the references below.\nAdvanced WildFire Inline Cloud Analysis uses a lightweight forwarding mechanism on\nthe firewall to minimize performance impact. The cloud-based ML models are updated\nseamlessly, to address the ever-changing threat landscape without requiring content\nupdates or feature release support.\nAdvanced WildFire Inline Cloud Analysis is enabled and configured through the WildFire\nAnalysis profile and requires PAN-OS 11.1 or later with an active Advanced WildFire\nlicense.\nAs of PAN-OS 11.1, only PE file type is supported.\nAntivirus signatures produce low false positives. By blocking any detected malware\nthrough the specified decoders, the threat of malware propagation through the firewall is\ngreatly reduced. It is recommended to mitigate malware found in pop3 and imap\nthrough a dedicated antivirus gateway. Due to the nature of the pop3 and imap\nprotocols, the firewall is not able to block only a single email message containing\nmalware. Instead, the entire session would be terminated, potentially affecting benign\nemail messages.\nBy applying a secure antivirus profile to all applicable traffic, the threat of malware\npropagation through the firewall is greatly reduced. Without an antivirus profile assigned\nto any potential hostile zone, the first protection in the path against malware is removed,\nleaving in most cases only the desktop endpoint protection application to detect and\nremediate any potential malware.\nRequiring a blocking policy for all spyware threats, categories, and severities (Critical,\nHigh, and Medium) reduces the risk of spyware traffic from successfully exiting the\norganization. Without an anti-spyware profile assigned to any potential hostile zone, the\nfirst protection in the path against malware is removed, leaving in most cases only the\ndesktop endpoint protection application to detect and remediate any potential spyware.\nDNS sinkholing helps to identify infected clients by spoofing DNS responses for\nmalware domain queries. Without sinkholing, the DNS server itself may be seen as\ninfected, while the truly infected device remains unidentified. In addition, sinkholing also\nensures that DNS queries that might be indicators of compromise do not transit the\ninternet, where they could be potentially used to negatively impact the \"ip reputation\" of\nthe organization's internet network subnets.\nBy applying secure anti-spyware profiles to all applicable traffic, the threat of sensitive\ndata exfiltration or command-and-control traffic successfully passing through the firewall\nis greatly reduced. Anti-spyware profiles are not restricted to particular protocols like\nantivirus profiles, so anti-spyware profiles should be applied to all security policies\npermitting traffic to the Internet. Assigning an anti-spyware profile to each trusted zone\nwill quickly and easily identify trusted hosts that have been infected with spyware, by\nidentifying the infection from their outbound network traffic. In addition, that outbound\nnetwork traffic will be blocked by the profile.\nA Vulnerability Protection Profile helps to protect assets by alerting on, or blocking,\nnetwork attacks. The default action for attacks against many critical and high\nvulnerabilities is to only alert on the attack - not to block.\nA Vulnerability Protection Profile helps to protect assets by alerting on, or blocking\nnetwork attacks. By applying a secure Vulnerability Protection Profile to all security rules\npermitting traffic, all network traffic traversing the firewall will be inspected for attacks.\nThis protects both organizational assets from attack and organizational reputation from\ndamage.\nNote that encrypted sessions do not allow for complete inspection.\nStandard URL filtering provides protection against inappropriate and malicious URLs\nand IP addresses. PAN-DB URL Filtering is slightly less granular than the BrightCloud\nURL filtering. However the PAN-DB Filter offers additional malware protection and PAN\nthreat intelligence by using the Wildfire service as an additional input, which is currently\nnot available in the BrightCloud URL Filtering license. This makes the PAN-DB filter\nmore responsive to specific malware \"campaigns\".\nCertain URL categories pose a technology-centric threat, such as command-and-\ncontrol, copyright-infringement, extremism, malware, phishing, proxy-avoidance-and-\nanonymizers, and parked. Users visiting websites in these categories, many times\nunintentionally, are at greater risk of compromising the security of their system. Other\ncategories, such as adult, may pose a legal liability and will be blocked for those\nreasons.\nSetting a URL filter to have one or more entries under Allow Categories will cause no\nlog entries to be produced in the URL Filtering logs for access to URLs in those\ncategories. For forensic, legal, and HR purposes, it is advisable to log access to every\nURL. In many cases failure to log all URL access is a violation of corporate policy, legal\nrequirements or regulatory requirements.\nLogging HTTP header information provides additional information in the URL logs,\nwhich may be useful during forensic investigations. The User-Agent option logs which\nbrowser was used during the web session, which could provide insight to the vector\nused for malware retrieval. The Referer option logs the source webpage responsible for\nreferring the user to the logged webpage. The X-Forwarded-For option is useful for\npreserving the user’s source IP address, such as if a user traverses a proxy server prior\nto the firewall. Un-checking the Log container page only box produces substantially\nmore information about web activity, with the expense of producing far more entries in\nthe URL logs. If this option remains checked, a URL filter log entry showing details of a\nmalicious file download may not exist.\nURL Filtering policies dramatically reduce the risk of users visiting malicious or\ninappropriate websites. In addition, a complete URL history log for all devices is\ninvaluable when performing forensic analysis in the event of a security incident.\nApplying complete and approved URL filtering to outbound traffic is a frequent\nrequirement in corporate policies, legal requirements or regulatory requirements.\nCredit card and Social Security numbers are sensitive, and should never traverse an\norganization’s Internet connection in clear text. Passing sensitive data within an\norganization should also be avoided whenever possible. Detecting and blocking known\nsensitive information is a basic protection against a data breach or data loss. Not\nimplementing these defenses can lead to loss of regulatory accreditation (such as PCI,\nHIPAA etc), or can lead to legal action from injured parties or regulatory bodies.\nA Data Filtering profile helps prevent certain types of sensitive information from\ntraversing an organization’s Internet connection, especially in clear text. Detecting and\nblocking known sensitive information is a basic protection against a data breach or data\nloss. Not implementing these defenses can lead to loss of regulatory accreditation (such\nas PCI, HIPAA etc), or can lead to legal action from injured parties or regulatory bodies.\nBefore starting, be very aware that Data Filtering will often block data that you didn't\nanticipate, false positives will definitely occur. Even the prebuilt filters will frequently\nmatch on unintended data in files or websites. Work very closely with your user\ncommunity to ensure that required data is blocked or alerted on, but a minimum of false\npositive blocks occur. As false positives occur, ensure that your user community has a\nclear and timely procedure to get the configuration updated.\nProtecting resources and the firewall itself against DoS/DDoS attacks requires a layered\napproach. Firewalls alone cannot mitigate all DoS attacks, however, many attacks can\nbe successfully mitigated. Utilizing SYN Cookies helps to mitigate SYN flood attacks,\nwhere the CPU and/or memory buffers of the victim device become overwhelmed by\nincomplete TCP sessions. SYN Cookies are preferred over Random Early Drop.\nPage 158\nWithout flood protection, it may be possible for an attacker, through the use of a botnet\nor other means, to overwhelm network resources. Flood protection does not completely\neliminate this risk; rather, it provides a layer of protection. Without a properly configured\nzone protection profile applied to untrusted interfaces, the protected / trusted networks\nare susceptible to large number of attacks. While many of these involve denial of\nservice, some of these attacks are designed to evade IPS systems (fragmentation\nattacks for instance) or to evade basic firewall protections (source routing and record\nroute attacks).\nPort scans and host sweeps are common in the reconnaissance phase of an attack.\nBots scouring the Internet in search of a vulnerable target may also scan for open ports\nand available hosts. Reconnaissance Protection will allow for these attacks to be either\nalerted on or blocked altogether.\nUsing specially crafted packets, an attacker may attempt to evade or diminish the\neffectiveness of network security devices. Enabling the options in this recommendation\nlowers the risk of these attacks.\nPreventing users from having the ability to submit their corporate credentials to the\nInternet could stop credential phishing attacks and the potential that a breach at a site\nwhere a user reused credentials could lead to a credential stuffing attack.\nStarting from PanOS 10, Wildfire supports real-time detection and blocking. As more\nattacks are designed to bypass signature-based protection, real-time signatureless-\nbased protection is needed. Antivirus signatures produce low false positives. By\nblocking any detected malware through the specified decoders, the threat of malware\npropagation through the firewall is greatly reduced. It is recommended to mitigate\nmalware found in pop3 and imap through a dedicated antivirus gateway. Due to the\nnature of the pop3 and imap protocols, the firewall is not able to block only a single\nemail message containing malware. Instead, the entire session would be terminated,\npotentially affecting benign email messages.\nStarting from PanOS 10, Wildfire supports real-time detection and blocking. As more\nattacks are designed to bypass signature-based protection, real-time signatureless-\nbased protection is needed. With this new functionality, common file types used for\nmalware delivery such as Windows Executables, PowerShell Script, MSOffice, Shell,\nand Executable Linked Format (ELF) can be inspected using Wildfire and malicious files\nare blocked in real-time.\nStarting from PanOS 11, Palo Alto Networks now operates new inline deep learning\ndetection engines in the Advanced Threat Prevention cloud to analyze traffic for\ncommand injection and SQL injection vulnerabilities in real-time to protect users against\nzero-day threats. By operating cloud-based detection engines, you can access a wide\narray of detection mechanisms that are updated and deployed automatically without\nrequiring the user to download update packages or operate process intensive, firewall-\nbased analyzers which can sap resources.\nIt is recommended to set the action as 'alert' during initial deployment and monitor it's\nfalse positive, configure the exclusion URL and IP before moving to 'reset-both' action.\nStarting from PanOS 10, Palo Alto Networks Advanced URL Filtering now operates a\nseries of inline cloud-based deep learning detectors that evaluate suspicious web page\ncontents in real-time to protect users against zero-day threats. This includes cloaked\nwebsites, multi-step attacks, CAPTCHA challenges, and previously unseen one-time-\nuse URLs.\nStarting from PanOS 10, Palo Alto Networks now operates a series of ML-based\ndetection engines in the Advanced Threat Prevention cloud to analyze traffic for\nadvanced C2 (command-and-control) and spyware threats in real-time to protect users\nagainst zero-day threats. By operating cloud-based detection engines, you can access\na wide array of detection mechanisms that are updated and deployed automatically\nwithout requiring the user to download update packages or operate process intensive,\nfirewall-based analyzers which can sap resources.\nThe cloud-based detection engine logic is continuously monitored and updated using\nC2 traffic datasets from WildFire, with additional support through manual updates by\nPalo Alto Networks threat researchers, who provide human intervention for highly\naccurized detection enhancements.\nDNS traffic are normally allowed on firewall. With this in mind, attackers leverage on this\nattack surface to evade detections or extract out data. Starting from PanOS 9, Palo Alto\nNetworks has launched DNS Security services to combat against evassive malwares\nand to detect DNS tunneling activities.\nFor DNS Security to be effective, \"Threat Prevention\" or \"Advanced Threat Prevention\"\nlicense must be purchased in addition of \"DNS Security\" license.\nTo avoid unintentionally exposing systems and services, rules allowing traffic from\nuntrusted zones to trusted zones should be as specific as possible. Application-based\nrules, as opposed to service/port rules, further tighten what traffic is allowed to pass.\nSimilarly, traffic from trusted to untrusted networks should have a security policy set,\nwith application-based rules. A \"catch-all\" rule that allows all applications will also allow\nmalware traffic. The goal should be to understand both inbound and outbound traffic,\npermit what is known, and block all other traffic.\nApp-ID requires a number of packets to traverse the firewall before an application can\nbe identified and either allowed or dropped. Due to this behavior, even when an\napplication is defined in a security policy, a service setting of any may allow a device in\none zone to perform ports scans on IP addresses in a different zone. In addition, this\nrecommendation helps to avoid an App-ID cache pollution attack.\nBecause of how App-ID works, configuring the service setting to \"Any\" allows some\ninitial traffic to reach the target host before App-ID can recognize and appropriately\nrestrict the traffic. Setting the Service Setting to application specific at least restricts the\ntraffic to the target applications or protocols for that initial volume of traffic.\nCreating rules that block traffic to/from known malicious sites from Trusted Threat\nIntelligence Sources protects you against IP addresses that Palo Alto Networks has\nproven to be used almost exclusively to distribute malware, initiate command-and-\ncontrol activity, and launch attacks.\nBy default, these default security policies does not have logging enabled. This enables\nSOC or security analyst to do further investigations on security incidents especially on\nthreat hunting or incident response activities.\nWithout SSL inspection, the firewall cannot apply many of its protection features against\nencrypted traffic. The amount of encrypted malware traffic continues to rise, and\nlegitimate websites using SSL encryption are hacked or tricked into delivering malware\non a frequent basis. As encryption on the Internet continues to grow at a rapid rate, SSL\ninspection is no longer optional as a practical security measure. If proper decryption is\nnot configured, it follows that the majority of traffic is not being fully inspected for\nmalicious content or policy violations. This is a major exposure, allowing delivery of\nexploits and payloads direct to user desktops.\nNote that, categories to be decrypted is highly dependant on each organization's policy.\nWithout SSL Inbound Inspection, the firewall is not able to protect SSL or TLS-enabled\nwebservers against many threats.\nUsing a self-signed certificate, or any certificate that generates a warning in the\nbrowser, means that members of the organization have no method of determining if\nthey are being presented with a legitimate certificate, or an attacker's \"man in the\nmiddle' certificate. It also very rapidly teaches members of the organization to bypass all\nsecurity warnings of this type.",
    "impact": "While this removes the exposure of having the WMI user account password being\ncompromised, it also reduces the effectiveness of user identification during operation of\nthe firewall (applying rules and policies). This trade-off should be weighed carefully for\nall installations.\nIf WMI probing is enabled without limiting the scope, internet hosts that are sources or\ndestinations of traffic will be probed, and the password hash of the configured Domain\nAdmin account can be captured by an outside attacker on such a host.\nNot restricting the networks subject to User Identification means that the administrative\ncredentials (userid and password hash) used for this task will transit untrusted networks,\nor be sent to untrusted hosts. Capturing these credentials exposes them to offline\ncracking attacks.\nUsing accounts with full administrative privileges when those rights are not required is\nalways a bad idea. This is particularly true for service accounts of this type, which in\nmany organizations do not see strong passwords or frequent password changes. In\naddition, service passwords are stored in the Windows Registry, and are recoverable\nwith the user of appropriate malicious tools. The principal of least privilege means that\nany compromised accounts of this type have less value to an attacker, and expose\nfewer assets based on their rights.\nNot configuring High Availability (HA) correctly directly impacts the Availability of the\nsystem. With HA in place, standard maintenance such as OS updates, network and\npower cabling can be accomplished with no outage or a minimum impact.\nNot configuring High Availability (HA) correctly directly impacts the Availability of the\nsystem. With HA in place, standard maintenance such as OS updates, network and\npower cabling can be accomplished with no outage or a minimum impact.\nWithout Link and Path monitoring in particular, failover will only occur when the primary\ndevice fails completely. Link and path monitoring permits failover if a critical interface\nloses link (either due to cabling or an upstream switch failover), or if a route or path fails\n(indicating an upstream issue that affects local Layer 3).\nIncorrectly configuring this setting will adversely affect availability, rather than positively\naffect it.\nHaving a shorter update frequency can in rare occasions cause latency issues.\nUsing larger file filtering can cause the system to skip files in the event multiple larger\nfiles are sent.\nWith default values, all relevant files are uploaded to wildfire.paloaltonetworks.com\nwhich is located in US.\nNot having an AV Profile on a Security Policy allows signature-based malware to transit\nthe security boundary without blocks or alerts. In most cases this leaves only the\nEndpoint Security application to block or alert malware.\nNot configuring a Vulnerability Protection Profile means that network attacks will not be\nlogged, alerted on or blocked.\nNot configuring a Vulnerability Protection Profile means that network attacks will not be\nlogged, alerted on or blocked.\nNot having an effective URL Filtering configuration can leave an organization open to\nlegal action, internal HR issues, non-compliance with regulatory policies or productivity\nloss.\nNot having an effective URL Filtering configuration can leave an organization open to\nlegal action, internal HR issues, non-compliance with regulatory policies or productivity\nloss.\nNot having an effective URL Filtering configuration can leave an organization open to\nlegal action, internal HR issues, non-compliance with regulatory policies or productivity\nloss.\nNot having an effective URL Filtering configuration can leave an organization open to\nlegal action, internal HR issues, non-compliance with regulatory policies or productivity\nloss.\nNot having an effective URL Filtering configuration can leave an organization open to\nlegal action, internal HR issues, non-compliance with regulatory policies or productivity\nloss.\nNot configuring a Network Zone Protection Profile on untrusted interfaces leaves an\norganization exposed to common attacks and reconnaissance from those untrusted\nnetworks. Not configuring a Zone Protection Profile for internal networks leaves an\norganization vulnerable to malware, software or hardware causes of traffic flooding from\ninternal sources.\nNot configuring and applying a Network Zone Protection Profile leaves an organization\nexposed to common attacks and reconnaissance from untrusted networks.\nNot configuring a Zone Protection Profile for internal networks leaves an organization\nvulnerable to malware, software or hardware causes of traffic flooding from internal\nsources.\nNot configuring a Network Zone Protection Profile leaves an organization exposed to\ncommon attacks and reconnaissance from untrusted networks.\nNot configuring a Network Zone Protection Profile leaves an organization exposed to\ncommon attacks and reconnaissance from untrusted networks.\nNot preventing users from submitting their corporate credentials to the Internet can\nleave them open to phishing attacks or allow for credential reuse on unauthorized sites.\nUsing internal email accounts provides malicious actors with intelligence information,\nwhich can be used for phishing, credential stuffing and other attacks. Using internal\npasswords will often provide authenticated access directly to sensitive information. Not\nonly that, but a pattern of credential re-use can expose personal information from\nmultiple online sources.\nSetting application based rules on both inbound and outbound traffic ensures that the\ntraffic on the protocol and port being specified is actually the application that you expect.\nFor outbound traffic, the days of \"we trust our users\" is well past us, that statement also\nimplies that we trust the malware on the user workstations, which is obviously not the\ncase.\nFor traffic from trusted to less trusted interfaces, the applications should be\ncharacterized over time, with the end goal being that all applications in in the rules, and\na final \"block all\" rule is in place. Not having this goal gives both attackers and malware\nthe leeway they need to accomplish their goals.\nTrusting only Port permissions to control traffic exposes an organization to \"tunneling\"\nstyle attacks that can exfiltrate data or facilitate Command and Control (C2) sessions.\nWhile not foolproof, simply blocking traffic from known malicious hosts allows more\nresources to be devoted to analyzing traffic from other sources for malicious content.\nThis approach is a recommended part of most \"Defense in Depth\" recommendations,\nallowing defenders to focus more deeply on traffic from uncategorized sources.\nFailure to decrypt outbound traffic allows attackers to mask attacks, data exfiltration\nand/or command and control (C2) traffic by simply using standard TLS encryption.\nPrivacy concerns for your organization's users will dictate that some common categories\nshould be exempted from inspection and decryption. Personal banking or healthcare\ninformation is almost always exempted, as are interactions with government entities.\nExemptions and inclusions to decryption policies should be negotiated internally and\ngoverned by published Corporate Policies.\nNot decrypting inbound traffic to TLS encrypted services means that inspection for\nmany common attacks cannot occur on the firewall. This means that all defenses\nagainst these attacks are up to the host."
  },
  {
    "rule_id": "1.1",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "Ensure DNS server is configured",
    "cis_level": "• Level 1",
    "description": "Fortinet uses the Domain Name Service (DNS) to translate host names into IP\naddresses. To enable DNS lookups, you must specify the primary DNS server for your\nsystem. You can also specify secondary and tertiary DNS servers. When resolving host\nnames, the system consults the primary name server. If a failure or time-out occurs, the\nsystem consults the secondary name server.\nFor security purpose, trusted DNS servers should be configured to prevent man-in-the-\nmiddle attacks.",
    "expected_values": "Default primary DNS server is 96.45.45.45. Default secondary DNS server is\n96.45.46.46.",
    "validation_logic": "In CLI:\nFGT1 # config system dns\nFGT1 (dns) # show\nconfig system dns\nset primary <ip_address>\nset secondary <ip_address>\n...\nend\nIn the GUI:\nNavigate to Networks > DNS. The FortiGate uses either the default FortiGuard DNS or\ncustomized DNS",
    "remediation_steps": "In this example, we will assign 8.8.8.8 as primary DNS and 8.8.4.4 as secondary DNS.\nIn CLI:\nFGT1 # config system dns\nFGT1 (dns) # set primary 8.8.8.8\nFGT1 (dns) # set secondary 8.8.4.4\nFGT1 (dns) # end\nFGT1 #\nPage 16\nInternal Only - General\nIn the GUI:\nNavigate to Networks > DNS. Select \"Specify\" and enter 8.8.8.8 as \"Primary DNS\nServer\" and 8.8.4.4 as \"Secondary DNS Server\"",
    "severity": "Automated",
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.2.0/administration-guide/903162",
    "audit": "In CLI:\nFGT1 # config system dns\nFGT1 (dns) # show\nconfig system dns\nset primary <ip_address>\nset secondary <ip_address>\n...\nend\nIn the GUI:\nNavigate to Networks > DNS. The FortiGate uses either the default FortiGuard DNS or\ncustomized DNS",
    "rationale": "The purpose is to perform the resolution of system hostnames to Internet Protocol (IP)\naddresses using trusted DNS servers.",
    "impact": null
  },
  {
    "rule_id": "1.2",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "Ensure intra-zone traffic is not always allowed",
    "cis_level": "• Level 1",
    "description": "This is to make sure that only specific, authorized traffic is allowed between networks in\nthe same zone.",
    "expected_values": "By default, intra-zone traffic is blocked\nPage 18\nInternal Only - General",
    "validation_logic": "In this example, we'll verify the zone DMZ. In CLI:\nFGT1 # config system zone\nFGT1 (zone) # edit DMZ\nFGT1 (DMZ) # show full\nconfig system zone\nedit \"DMZ\"\n...\nset intrazone deny\n...\nnext\nend\nIn the GUI, click on Network -> Interfaces, select the zone and click on \"Edit\". Make\nsure that the option \"Block intra-zone traffic\" is enabled.",
    "remediation_steps": "In this example, we'll turn off intra-zone traffic in the zone DMZ. In CLI:\nFGT1 # config system zone\nFGT1 (zone) # edit DMZ\nFGT1 (DMZ) # set intrazone deny\nFGT1 (DMZ) # end\nFGT1 #\nIn the GUI, click on Network -> Interfaces, select the zone and click on \"Edit\" and turn\non \"Block intra-zone traffic\"",
    "severity": "Manual",
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.2.7/cli-reference/68620/config-\nsystem-zone\n2. https://docs.fortinet.com/document/fortigate/7.2.0/administration-guide/116821",
    "audit": "In this example, we'll verify the zone DMZ. In CLI:\nFGT1 # config system zone\nFGT1 (zone) # edit DMZ\nFGT1 (DMZ) # show full\nconfig system zone\nedit \"DMZ\"\n...\nset intrazone deny\n...\nnext\nend\nIn the GUI, click on Network -> Interfaces, select the zone and click on \"Edit\". Make\nsure that the option \"Block intra-zone traffic\" is enabled.",
    "rationale": "This adds an extra layer of protection between different networks.",
    "impact": null
  },
  {
    "rule_id": "1.3",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "Disable all management related services on WAN port",
    "cis_level": "• Level 1",
    "description": "Enabling any management related services on WAN interface is high risk. Management\nrelated services such as HTTPS, HTTP, ping, SSH, SNMP, and Radius should be\ndisabled on WAN.",
    "expected_values": null,
    "validation_logic": "On GUI:\nGo to \"Network\" > \"Interfaces\".\nIdentify WAN interface and validate that HTTPS, HTTP, PING, SSH, SNMP, and\nRadius Accounting is not enabled in \"Administrative Access\" section.\nOn CLI:\n`FGT1 # show system interface`\nIdentify WAN interface and validate that \"set allowaccess\" does not have ping, https,\nhttp, ssh, snmp or radius-acct configured.",
    "remediation_steps": "On GUI:\nGo to \"Network\" > \"Interfaces\".\nReview WAN interface and disable HTTPS, HTTP, ping, SSH, SNMP, and Radius\nservices.\nPage 20\nInternal Only - General\nOn CLI:\nFGT1 # config system interface\nFGT1 (interface) # edit \"port1\"\nFGT1 (port1) # unselect allowaccess ping https ssh snmp http radius-acct\nNote:\n1. Interface name may differ based on deployment. For this example, port1 is\ndeployed as WAN interface.\n2. \"unselect allowaccess\" will only show services that you have enabled. If you\nhave not enabled snmp on that interface, then snmp option will not be available.",
    "severity": null,
    "is_active": true,
    "references_text": null,
    "audit": "On GUI:\nGo to \"Network\" > \"Interfaces\".\nIdentify WAN interface and validate that HTTPS, HTTP, PING, SSH, SNMP, and\nRadius Accounting is not enabled in \"Administrative Access\" section.\nOn CLI:\n`FGT1 # show system interface`\nIdentify WAN interface and validate that \"set allowaccess\" does not have ping, https,\nhttp, ssh, snmp or radius-acct configured.",
    "rationale": "Management related services should only be enabled on management interface. This is\npart of defending the firewall from attacks and reducing the attack surface. For WAN\nrelated services such as IPSec and SSLVPN, make use of local-in-policy (refer to CIS\nSection 2.4) to tighten firewall defenses.",
    "impact": "Enabling management related services on WAN port is convenient, but it exposes the\nfirewall to unnecessary risks. Vulnerabilities found on vendor devices are commonly\nrelated to management services, and opening access to these allows attackers to\nexploit its vulnerabilities."
  },
  {
    "rule_id": "2.1",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "General Settings",
    "cis_level": "• Level 1",
    "description": "Configure a pre-login banner, ideally approved by the organization’s legal team. This\nbanner should, at minimum, prohibit unauthorized access, provide notice of logging or\nmonitoring, and avoid using the word “welcome” or similar words of invitation.",
    "expected_values": "the 'Pre-Login Banner' is disabled by default\nFG1 # config system global\nFG1 (global) # show\nconfig system global\n...\nset pre-login-banner disable\n...\nend\nthe warning message default value is as follows:\nPRE WARNING:\nThis is a private computer system. Unauthorized access or use\nis prohibited and subject to prosecution and/or disciplinary\naction. All use of this system constitutes consent to\nmonitoring at all times and users are not entitled to any\nexpectation of privacy. If monitoring reveals possible evidence\nof violation of criminal statutes, this evidence and any other\nrelated information, including identification information about\nthe user, may be provided to law enforcement officials.\nIf monitoring reveals violations of security regulations or\nunauthorized use, employees who violate security regulations or\nmake unauthorized use of this system are subject to appropriate\ndisciplinary action.",
    "validation_logic": "Run the following command in the CLI to verify the pre-login-banner is enabled:\nFG1 # get system global\n...\npre-login-banner : enable\n...\nend\nIn the GUI, to verify the content of the pre-login disclaimer message:\n1) Go to 'System' -> 'Replacement Messages'\n2) From the top right side, select 'Extended View'\n3) Find 'Pre-login Disclaimer Message'",
    "remediation_steps": "Run the following command in the CLI to enable the pre-login-banner:\nFG1 # config system global\nFG1 (global) # set pre-login-banner enable\nFG1 (global) # end\nFG1 #\nIn the GUI, to edit the content of the pre-login disclaimer message:\nPage 23\nInternal Only - General\n1. Go to 'System' -> 'Replacement Messages' -> 'Extended View' -> 'Pre-login\nDisclaimer Message'. The edit screen is on the bottom right corner of the page.\nClick on \"Save\" after the editing is done.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://community.fortinet.com/t5/FortiGate/Technical-Tip-Configuring-admin-\ndisclaimer-page/ta-p/198609?externalID=FD33887",
    "audit": "Run the following command in the CLI to verify the pre-login-banner is enabled:\nFG1 # get system global\n...\npre-login-banner : enable\n...\nend\nIn the GUI, to verify the content of the pre-login disclaimer message:\n1) Go to 'System' -> 'Replacement Messages'\n2) From the top right side, select 'Extended View'\n3) Find 'Pre-login Disclaimer Message'",
    "rationale": "Through a properly stated login banner, the risk of unintentional access to the device by\nunauthorized users is reduced. Should legal action take place against a person\naccessing the device without authorization, the login banner greatly diminishes a\ndefendant’s claim of ignorance.",
    "impact": "Login banners provide a definitive warning to any possible intruders who may want to\naccess the FortiGate that certain types of activity are illegal. At the same time, it also\nadvises the authorized and legitimate users of their obligations relating to acceptable\nuse."
  },
  {
    "rule_id": "17.3",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "Implement a Security Awareness Program",
    "cis_level": "• Level 1",
    "description": "Sets the banner after users successfully log in. This is equivalent to Message of the Day\n(MOTD) in some other systems.",
    "expected_values": "POST WARNING: This is a private computer system. Unauthorized access or use is\nprohibited and subject to prosecution and/or disciplinary action. All use of this system\nconstitutes consent to monitoring at all times and users are not entitled to any\nexpectation of privacy. If monitoring reveals possible evidence of violation of criminal\nstatutes, this evidence and any other related information, including identification\ninformation about the user, may be provided to law enforcement officials. If monitoring\nreveals violations of security regulations or unauthorized use, employees who violate\nsecurity regulations or make unauthorized use of this system are subject to appropriate\ndisciplinary action.\n%%LAST_SUCCESSFUL_LOGIN%% %%LAST_FAILED_LOGIN%%",
    "validation_logic": "Run the following command in the CLI to verify the post-login-banner is enabled:\nFG1 # get system global\n...\npost-login-banner : enable\n...\nIn the GUI, to verify the content of the post-login disclaimer message:\n1) Go to 'System' -> 'Replacement Messages'\n2) From the top right side, select 'Extended View'\n3) Find 'Post-login Disclaimer Message'",
    "remediation_steps": "Run the following command in the CLI to enable the post-login-banner:\nFG1 # config system global\nFG1 (global) # set post-login-banner enable\nFG1 (global) # end\nFG1 #\nIn the GUI, to edit the content of the post-login disclaimer message, go to\nPage 26\nInternal Only - General\nSystem -> Replace Messages -> Extended View -> \"Post-login Disclaimer\nMessage\". The edit screen is on the bottom right corner of the page. Click on\n\"Save\" after the editing is done.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://community.fortinet.com/t5/FortiGate/Technical-Tip-Configuring-admin-\ndisclaimer-page/ta-p/198609?externalID=FD33887",
    "audit": "Run the following command in the CLI to verify the post-login-banner is enabled:\nFG1 # get system global\n...\npost-login-banner : enable\n...\nIn the GUI, to verify the content of the post-login disclaimer message:\n1) Go to 'System' -> 'Replacement Messages'\n2) From the top right side, select 'Extended View'\n3) Find 'Post-login Disclaimer Message'",
    "rationale": "Network banners are electronic messages that provide notice of legal rights to users of\ncomputer networks. From a legal standpoint, banners have four primary functions:\nFirst, banners may be used to generate consent to real-time monitoring under Title III.\nSecond, banners may be used to generate consent to the retrieval of stored files and\nrecords pursuant to ECPA. Third, in the case of government networks, banners may\neliminate any Fourth Amendment \"reasonable expectation of privacy\" that government\nemployees or other users might otherwise retain in their use of the government's\nnetwork under O'Connor v.",
    "impact": "When post-login banner is enabled, some automated-script might be affected because\nboth CLI and GUI need an acceptance action (press \"A\" or \"Accept\") to continue."
  },
  {
    "rule_id": "11.1",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "Maintain Standard Security Configurations for",
    "cis_level": "• Level 1",
    "description": "Sets the local time zone information so that the time displayed by the device is more\nrelevant to those who are viewing it.",
    "expected_values": "Default value is (GMT-8:00) Pacific Time (US & Canada)",
    "validation_logic": "In the CLI, do the following command and check the result of timezone filed in the\noutput\nFGT1 # get system global\n...\ntimezone : (GMT-8:00) Pacific Time (US & Canada)\n...\nOr from GUI, do the following:\n1) Login to FortiGate\n2) Go to 'System' -> 'Settings'.\n3) Time Zone and NTP settings are under 'System Time'",
    "remediation_steps": "In this example, we will set Eastern Timezone (GMT-5:00) for the Fortigate. Each\ntimezone will have its corresponding ID. To find the correct ID, when you type in the\ncommand \"set timezone \", also type the question mark '?' to list all of the available\ntimezones and their IDs. The ID of the Eastern Timezone is 12 In the CLI:\nPage 28\nInternal Only - General\nFGT1 # config system global\nFGT1 (global) # set timezone 12\nFGT1 (global) # end\nFGT1 #\nIn the GUI, do the following:\n1) After login to fortigate, go to 'System' -> 'Settings'\n2) Select '(GMT-5:00) Eastern Time (US & Canada)' under 'System Time'",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://community.fortinet.com/t5/FortiGate/Technical-Tip-Setting-the-system-\ntime/ta-p/192907?externalID=FD49018\n2. https://docs.fortinet.com/document/fortigate/7.2.0/administration-\nguide/512210/setting-the-system-time",
    "audit": "In the CLI, do the following command and check the result of timezone filed in the\noutput\nFGT1 # get system global\n...\ntimezone : (GMT-8:00) Pacific Time (US & Canada)\n...\nOr from GUI, do the following:\n1) Login to FortiGate\n2) Go to 'System' -> 'Settings'.\n3) Time Zone and NTP settings are under 'System Time'",
    "rationale": "Having a correct time set on the device is important for two main reasons. The first\nreason is that digital certificates compare this time to the range defined by their Valid\nFrom and Valid To fields to define a specific validity period. The second reason is to\nhave relevant time stamps when logging information. Whether you are sending\nmessages to a Syslog server, sending messages to an SNMP monitoring station, or\nperforming packet captures, timestamps have little usefulness if you cannot be certain\nof their accuracy.",
    "impact": "For many features to work, including scheduling, logging, and SSL-dependent features,\nthe FortiOS system time must be accurate."
  },
  {
    "rule_id": "6.1",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "Utilize Three Synchronized Time Sources",
    "cis_level": "• Level 1",
    "description": "You can either manually set the FortiOS system time, or configure the device to\nautomatically keep its system time correct by synchronizing with a Network Time\nProtocol (NTP) server.\nThese settings enable the use of primary and secondary NTP servers to provide\nredundancy in case of a failure involving the primary NTP server.",
    "expected_values": "By default, Fortinet uses the NTPs server of the FortiGuard",
    "validation_logic": "In the CLI:\nPage 30\nInternal Only - General\nFGT1 # diag sys ntp status\nsynchronized: yes, ntpsync: enabled, server-mode: enabled\nipv4 server(ntp2.fortiguard.com) 208.91.114.23 -- reachable(0xff) S:3 T:54\nserver-version=4, stratum=1\nreference time is e12361d5.f27e0322 -- UTC Wed Sep 11 12:06:45 2019\nclock offset is -0.001569 sec, root delay is 0.000000 sec\nroot dispersion is 0.010269 sec, peer dispersion is 19 msec\nipv4 server(ntp1.fortiguard.com) 208.91.115.123 -- reachable(0xff) S:3 T:54\nselected\nserver-version=4, stratum=1\nreference time is e12361d4.4f8b22a5 -- UTC Wed Sep 11 12:06:44 2019\nclock offset is -0.000652 sec, root delay is 0.000000 sec\nroot dispersion is 0.010284 sec, peer dispersion is 8 msec\nipv4 server(ntp2.fortiguard.com) 208.91.113.71 -- reachable(0xff) S:3 T:54\nserver-version=4, stratum=2\nreference time is e12361d6.4caf57ab -- UTC Wed Sep 11 12:06:46 2019\nclock offset is -0.004814 sec, root delay is 0.000137 sec\nroot dispersion is 0.011154 sec, peer dispersion is 3 msec\nipv4 server(ntp1.fortiguard.com) 208.91.113.70 -- reachable(0xff) S:3 T:54\nserver-version=4, stratum=2\nreference time is e123617b.c98e2059 -- UTC Wed Sep 11 12:05:15 2019\nclock offset is -0.005106 sec, root delay is 0.000122 sec\nroot dispersion is 0.013382 sec, peer dispersion is 6 msec",
    "remediation_steps": "You can only customize NTP setting using CLI. In this example, we'll assign\npool.ntp.org as primary NTP server and 1.1.1.1 as secondary NTP server.\nFGT1 # config system ntp\nFGT1 (ntp) # set type custom\nFGT1 (ntp) # config ntpserver\nFGT1 (ntpserver) # edit 1\nFGT1 (1) # set server pool.ntp.org\nFGT1 (1) # next\nFGT1 (ntpserver) # edit 2\nFGT1 (2) # set server 1.1.1.1\nFGT1 (2) # end\nFGT1 (ntp) # end\nFGT1 #",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://community.fortinet.com/t5/FortiGate/Technical-Tip-Setting-the-system-\ntime/ta-p/192907?externalID=FD49018\n2. https://docs.fortinet.com/document/fortigate/7.2.0/administration-\nguide/512210/setting-the-system-time\nPage 31\nInternal Only - General",
    "audit": "In the CLI:\nPage 30\nInternal Only - General\nFGT1 # diag sys ntp status\nsynchronized: yes, ntpsync: enabled, server-mode: enabled\nipv4 server(ntp2.fortiguard.com) 208.91.114.23 -- reachable(0xff) S:3 T:54\nserver-version=4, stratum=1\nreference time is e12361d5.f27e0322 -- UTC Wed Sep 11 12:06:45 2019\nclock offset is -0.001569 sec, root delay is 0.000000 sec\nroot dispersion is 0.010269 sec, peer dispersion is 19 msec\nipv4 server(ntp1.fortiguard.com) 208.91.115.123 -- reachable(0xff) S:3 T:54\nselected\nserver-version=4, stratum=1\nreference time is e12361d4.4f8b22a5 -- UTC Wed Sep 11 12:06:44 2019\nclock offset is -0.000652 sec, root delay is 0.000000 sec\nroot dispersion is 0.010284 sec, peer dispersion is 8 msec\nipv4 server(ntp2.fortiguard.com) 208.91.113.71 -- reachable(0xff) S:3 T:54\nserver-version=4, stratum=2\nreference time is e12361d6.4caf57ab -- UTC Wed Sep 11 12:06:46 2019\nclock offset is -0.004814 sec, root delay is 0.000137 sec\nroot dispersion is 0.011154 sec, peer dispersion is 3 msec\nipv4 server(ntp1.fortiguard.com) 208.91.113.70 -- reachable(0xff) S:3 T:54\nserver-version=4, stratum=2\nreference time is e123617b.c98e2059 -- UTC Wed Sep 11 12:05:15 2019\nclock offset is -0.005106 sec, root delay is 0.000122 sec\nroot dispersion is 0.013382 sec, peer dispersion is 6 msec",
    "rationale": "NTP enables the device to maintain accurate time and date when receiving updates\nfrom a reliable NTP server. Accurate timestamps are critical when correlating events\nwith other systems, troubleshooting, or performing investigative work. Logs and certain\ncryptographic functions, such as those utilizing certificates, rely on accurate time and\ndate parameters. In addition, rules referencing a Schedule object will not function as\nintended if the device’s time and date are incorrect. For additional security,\nauthenticated NTP can be utilized. If Symmetric Key authentication is selected, only\nSHA1 should be used, as MD5 is considered severely compromised.",
    "impact": "For many features to work, including scheduling, logging, and SSL-dependent features,\nthe FortiOS system time must be accurate."
  },
  {
    "rule_id": "6.1",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "Utilize Three Synchronized Time Sources",
    "cis_level": "• Level 1",
    "description": "Changes the device default hostname.",
    "expected_values": "The default value of the hostname is the model number of the unit. Example: 'FortiGate\n2000E'",
    "validation_logic": "In CLI\nget system global\n...\nhostname : FG1\n...\nIn GUI\n1) Go to 'System' > 'Settings'\n2) Check the field 'Hostname'",
    "remediation_steps": "In CLI, set the hostname to 'New_FGT1' as follows:\nFGT1 # config system global\nFGT1 (global) # set hostname \"New_FGT1\"\nFGT1 (global) # end\nNew_FGT1 #\nIn GUI\n1) Go to 'System' > 'Settings'\n2) Update the field 'Hostname' with the new hostname\n3) click 'Apply'",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://community.fortinet.com/t5/FortiGate/Technical-Tip-Renaming-the-\nhostname/ta-p/198521?externalID=FD48765\nPage 33\nInternal Only - General",
    "audit": "In CLI\nget system global\n...\nhostname : FG1\n...\nIn GUI\n1) Go to 'System' > 'Settings'\n2) Check the field 'Hostname'",
    "rationale": "The device hostname plays an important role in asset inventory and identification as a\nsecurity requirement. It is also crucial in the public keys and certificate deployments, as\nwell as when correlating logs from different systems during an incident handling.",
    "impact": null
  },
  {
    "rule_id": "0.0",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "Explicitly Not Mapped",
    "cis_level": "• Level 2",
    "description": "Check against the Fortinet website to make sure that the latest stable firmware is\ninstalled.",
    "expected_values": "There is no default firmware. The hardware comes with the latest firmware at the time it\nwas manufactured.",
    "validation_logic": "First, check for the latest firmware version available by going to\nhttps://docs.fortinet.com/upgrade-tool, select your product from the Current Product\ndrop-down menu, then select the upgrade to FortiOS Version for the latest available\nversion.\nSecond, verify the current firmware on your system. In the CLI:\nFGT1 # get system status\n...\nVersion: Fortigate-100D v6.2.7,build1190,201216 (GA)\n...\nFGT1 #\nIn the GUI:\n1. Go to Dashboard > Status > System information\n2. Check for firmware.\nAt the same time, go to https://www.fortiguard.com/psirt?product=FortiOS and check for\nvulnerabilities that your existing version might have.",
    "remediation_steps": "First, determine the upgrade path recommended by Fortinet. If you have not upgraded\nthe system for a long time, it is not recommended to upgrade straight to the latest\nversion, as the configuration could be lost. Fortinet provides a tool to recommend an\nupgrade path for all of its products.\nPage 35\nInternal Only - General\nGo to https://docs.fortinet.com/upgrade-tool. Choose your product from the \"Current\nProduct\" drop-down menu, the \"current FortiOS version\", and the latest firmware\nversion available for that model from \"Upgrade to FortiOS Version\". Click \"Go\". Write\ndown the path and then click on \"Download\" to download all the necessary versions.\nThe second step is to download the required FortiOS firmware/s. Go to\nhttps://support.fortinet.com and login. Go to Support -> Firmware Download. Once\nthere, select the product and click on \"Upgrade Path\". Choose the specific model of the\nhardware, the current firmware version and the latest firmware version available for that\nmodel. Click \"Go\". Write down the path and then click on \"Download\" to download all\nthe necessary versions.\nThe last step is to install the new firmwares in the order provided by the \"Upgrade tool\".\nIt is recommended to use GUI to perform this task as it would be much easier.\nIn the GUI\n1. Go to System > Fabric Management\n2. Right click on device that needs to be upgraded.\n3. Then click on \"Upgrade\". You might have to perform this step multiple\ntimes if you follow the upgrade path.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://community.fortinet.com/t5/FortiGate/Technical-Tip-How-to-upgrade-the-\nFortiGate-firmware/ta-p/194980?externalID=10948",
    "audit": "First, check for the latest firmware version available by going to\nhttps://docs.fortinet.com/upgrade-tool, select your product from the Current Product\ndrop-down menu, then select the upgrade to FortiOS Version for the latest available\nversion.\nSecond, verify the current firmware on your system. In the CLI:\nFGT1 # get system status\n...\nVersion: Fortigate-100D v6.2.7,build1190,201216 (GA)\n...\nFGT1 #\nIn the GUI:\n1. Go to Dashboard > Status > System information\n2. Check for firmware.\nAt the same time, go to https://www.fortiguard.com/psirt?product=FortiOS and check for\nvulnerabilities that your existing version might have.",
    "rationale": "Fortinet periodically updates the FortiGate firmware to include new features and resolve\nimportant issues. After you have registered your FortiGate unit, firmware updates can\nbe downloaded from the Fortinet Customer Service & Support website.\nIt is important to constantly keep the firmware up to date to prevent any new well-known\nexploitation.",
    "impact": null
  },
  {
    "rule_id": "11.4",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "Install the Latest Stable Version of Any Security-",
    "cis_level": "• Level 2",
    "description": "Disable USB port auto install feature for config and firmware.",
    "expected_values": "auto-install is disabled by default on 7.2.x.\nHowever, upgrading from earlier version to FortiOS 7.2.x will have auto-install\nvalues set as \"enable\".",
    "validation_logic": "CLI:\nconfig system auto-install\nget\nVerify that set auto-install-config and set auto-install-image are disabled",
    "remediation_steps": "CLI:\nconfig system auto-install\nset auto-install-config disable\nset auto-install-image disable\nend",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.2.7/cli-reference/106620/config-\nsystem-auto-install\nPage 38\nInternal Only - General",
    "audit": "CLI:\nconfig system auto-install\nget\nVerify that set auto-install-config and set auto-install-image are disabled",
    "rationale": "Disabling USB port for auto install prevents a USB with a manipulated configuration or\nincorrect firmware from being connected and loaded automatically.",
    "impact": null
  },
  {
    "rule_id": "11.3",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "Use Automated Tools to Verify Standard Device",
    "cis_level": "• Level 2",
    "description": "Disable support for static keys on TLS sessions terminating on the FortiGate",
    "expected_values": "ssl-static-key-ciphers is enabled",
    "validation_logic": "CLI:\nconfig system global\nget\nValidate that ssl-static-key-ciphers disabled.",
    "remediation_steps": "CLI:\nconfig system global\nset ssl-static-key-ciphers disable\nend",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.2.7/cli-reference/1620/config-\nsystem-global",
    "audit": "CLI:\nconfig system global\nget\nValidate that ssl-static-key-ciphers disabled.",
    "rationale": "Prevent TLS sessions terminating on the FortiGate from using static SSL keys",
    "impact": null
  },
  {
    "rule_id": "9.2",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "Ensure Only Approved Ports, Protocols and Services",
    "cis_level": "• Level 2",
    "description": "Enable FortiOS to only use strong encryption and allow only strong ciphers for\ncommunication",
    "expected_values": "strong-crypto is enabled by default.",
    "validation_logic": "CLI:\nconfig system global\nget\nValidate strong-crypto is enabled.",
    "remediation_steps": "CLI:\nconfig system global\nset strong-crypto enable\nend",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.2.7/cli-reference/1620/config-\nsystem-global",
    "audit": "CLI:\nconfig system global\nget\nValidate strong-crypto is enabled.",
    "rationale": null,
    "impact": null
  },
  {
    "rule_id": "0.0",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "Explicitly Not Mapped",
    "cis_level": "• Level 1",
    "description": "As we move towards better encryption capabilities, we need to also ensure GUI access\nis properly secured. TLS 1.3 is currently the most secure SSL/TLS supported version for\nSSL-encrypted administrator access (at this time of writing).",
    "expected_values": "FortiOS 7.x - TLS 1.2 and 1.3 enabled\nFortiOS 6.x - TLS 1.1, 1.2, and 1.3 enabled",
    "validation_logic": "CLI:\nconfig system global\nget\nVerify if set admin-https-ssl-versions tlsv1-3 is configured.",
    "remediation_steps": "CLI:\nconfig system global\nset admin-https-ssl-versions tlsv1-3",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.2.7/cli-reference/1620/config-\nsystem-global",
    "audit": "CLI:\nconfig system global\nget\nVerify if set admin-https-ssl-versions tlsv1-3 is configured.",
    "rationale": "Use higher version of SSL/TLS to prevent MiTM attacks.",
    "impact": null
  },
  {
    "rule_id": "0.0",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "Explicitly Not Mapped",
    "cis_level": "• Level 2",
    "description": "To improve GUI performance, an option is added to enable loading static GUI artifacts\ncached in CDN (content delivery network) servers closer to the user rather than from\nthe FortiGate. On failure, the files can fall back to loading from the FortiGate.",
    "expected_values": "Disabled",
    "validation_logic": "On CLI:\nconfig system global\nget\nEnsure that gui-cdn-usage is enabled.",
    "remediation_steps": "On CLI:\nconfig system global\nset gui-cdn-usage enable\nend",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.2.0/fortios-release-\nnotes/743723/new-features-or-enhancements\nPage 45\nInternal Only - General",
    "audit": "On CLI:\nconfig system global\nget\nEnsure that gui-cdn-usage is enabled.",
    "rationale": "When accessing a remote FortiGate, GUI might experience some slowness due to\ngeographical distance. For this case, loading static GUI artifacts cached in CDN servers\nwill provide a better GUI / web management experience.",
    "impact": "This is not a security control recommendation. Hence, there is no impact if this is not\nenabled."
  },
  {
    "rule_id": "0.0",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "Explicitly Not Mapped",
    "cis_level": "• Level 1",
    "description": "Add log-single-cpu-high option under config system global. When enabled, CPU single\ncore usage will be polled every three seconds, and any single CPU core usage above\nthe CPU usage threshold will report an event log. If a core is reported, that core will not\nbe checked again for the next 30 seconds.",
    "expected_values": "Disabled",
    "validation_logic": "On CLI:\nconfig system global\nget\nEnsure that log-single-cpu-high is enabled.",
    "remediation_steps": "On CLI:\nconfig system global\nset log-single-cpu-high enable\nend",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://community.fortinet.com/t5/FortiGate/Technical-Tip-Enable-logging-for-\nsingle-core-CPU-spike-against/ta-p/293010\n2. https://docs.fortinet.com/document/fortigate/7.2.4/fortios-release-\nnotes/743723/new-features-or-enhancements\nPage 47\nInternal Only - General",
    "audit": "On CLI:\nconfig system global\nget\nEnsure that log-single-cpu-high is enabled.",
    "rationale": "There are instances where overall CPU usage is low, but there is a single CPU core\nthat is overloaded. But because reporting and dashboard in FortiGate shows the overall\nCPU usage, a single CPU core spike may get overlooked on a FortiGate with multiple\nCPU cores. This causes performance issues where there are instances which traffic has\nbeen stopped processing.",
    "impact": null
  },
  {
    "rule_id": "2.2",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "Password Policy",
    "cis_level": "• Level 1",
    "description": "It is important to use secure and complex passwords for preventing unauthorized\naccess to the FortiGate device.",
    "expected_values": "By default, 'Password Policy' is disabled. It can be checked from CLI as follows:\nconfig system password-policy\nset status disable\nend\nOr from GUI as follows:\n1) Log in to FortiGate as Super Admin\n2) Go to 'System' > 'Settings'\n3) Find the 'Password Policy' section\n4) Default 'Password scope' is 'Off'",
    "validation_logic": "Currently implemented password policy can be shown from GUI or CLI\nFrom CLI, type:\nget system password-policy\nOr from GUI as follows:\n1) Log in to FortiGate with a user with at least read-only privileges\n2) Go to 'System' > 'Settings'\n3) Find and check the status of the 'Password Policy' Section",
    "remediation_steps": "Can be modified from CLI or GUI.\nFrom CLI, do the following:\nPage 50\nInternal Only - General\nconfig system password-policy\nset status enable\nset apply-to admin-password ipsec-preshared-key\nset minimum-length 8\nset min-lower-case-letter 1\nset min-upper-case-letter 1\nset min-non-alphanumeric 1\nset min-number 1\nset expire-status enable\nset expire-day 90\nset reuse-password disable\nend\nOr from GUI, do the following:\n1) Log in to FortiGate as Super Admin\n2) Go to 'System' > 'Settings'\n3) Find the 'Password Policy' section\n4) Default 'Password scope' is 'Off', change it to 'Both'\n5) set 'Minimum length' to '8'\n6) Enable 'Character requirements'\n7) set minimum '1' in the filed of 'Upper Case', 'Lower Case', 'Numbers (0-\n9)' and 'Special'\n8) Disable 'Allow password reuse'\n9) Enable 'Password expiration' and set it to 90",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://community.fortinet.com/t5/FortiGate/Technical-Tip-Strong-Password-\nPassword-Policy-feature/ta-p/197485?externalID=FD31021\n2. https://docs.fortinet.com/document/fortigate/7.2.7/cli-reference/10620/config-\nsystem-password-policy\n3. https://docs.fortinet.com/document/fortigate/7.2.0/administration-\nguide/364729/password-policy",
    "audit": "Currently implemented password policy can be shown from GUI or CLI\nFrom CLI, type:\nget system password-policy\nOr from GUI as follows:\n1) Log in to FortiGate with a user with at least read-only privileges\n2) Go to 'System' > 'Settings'\n3) Find and check the status of the 'Password Policy' Section",
    "rationale": "Attackers can use brute force password software to launch more than just dictionary\nattacks. Such attacks can discover common passwords where a letter is replaced by a\nnumber or symbol.",
    "impact": "Weak passwords can be easily discovered by hackers, which leads to unauthorized\naccess to FortiGate. Depending on the access privilege of the compromised account,\nthe attacker may modify important settings."
  },
  {
    "rule_id": "4.4",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "Use Unique Passwords",
    "cis_level": "• Level 1",
    "description": "Failed login attempts can indicate malicious attempts to gain access to your network. To\nprevent this security risk, FortiGate is preconfigured to limit the number of failed\nadministrator login attempts. After the maximum number of failed login attempts is\nreached, access to the account is blocked for the configured lockout period.",
    "expected_values": "By default, the number of password retry attempts is set to three, allowing the\nadministrator a maximum of three attempts at logging in to their account before they are\nlocked out for a set amount of time (by default, 60 seconds).",
    "validation_logic": "To check the lockout options, from CLI:\nget system global\nfrom the output, check the value of the below fields:\n1. admin-lockout-threshold\n2. admin-lockout-duration\nEnsure that admin-lockout-threshold is set at 3 and admin-lockout-duration is\nset at 900.",
    "remediation_steps": "To configure the lockout options, from CLI:\nconfig system global\nset admin-lockout-threshold 3\nset admin-lockout-duration 900\nend\nLockout affects the offending IP address, not the entire account.\nPage 53\nInternal Only - General",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.2.7/cli-reference/1620/config-\nsystem-global",
    "audit": "To check the lockout options, from CLI:\nget system global\nfrom the output, check the value of the below fields:\n1. admin-lockout-threshold\n2. admin-lockout-duration\nEnsure that admin-lockout-threshold is set at 3 and admin-lockout-duration is\nset at 900.",
    "rationale": "When you log in and fail to enter the correct password, you could potentially be a valid\nuser or a hacker attempting to gain access. For this reason, best practice dictates\nlimiting the number of failed login attempts before a lockout period in which you cannot\nlog in for a certain period of time. Lockout period will minimize hacker attempts to gain\naccess to the firewall.",
    "impact": "Attackers will keep attempting to access the device through brute force attacks without\nany interruption, which may lead to a successful login."
  },
  {
    "rule_id": "2.3",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "SNMP",
    "cis_level": "• Level 2",
    "description": "Ensuring that only SNMPv3 service is enabled and SNMPv1, SNMPv2c are disabled.",
    "expected_values": "By default, SNMP agent is disabled.",
    "validation_logic": "From CLI, check to make sure that there is not any community for SNMPv1 or\nSNMPv2c and only SNMPv3 users are there. Also make sure that SNMP Agent is\nenabled:\nPage 56\nInternal Only - General\nFGT1 # config system snmp sysinfo\nFGT1 (sysinfo) # show\nconfig system snmp sysinfo\nset status enable\n...\nend\nFGT1 (sysinfo) # end\nFGT1 # config system snmp community\nFGT1 (community) # show\nconfig system snmp community\nend\nFGT1 (community) # end\nFGT1 # config system snmp user\nFGT1 (user) # show\nconfig system snmp user\nedit \"snmp_test\"\nset security-level auth-priv\nset auth-proto sha256\nset auth-pwd ENC xxxxxx\nset priv-proto aes256\nset priv-pwd ENC xxxxxx\nnext\nend\nIn the GUI, go to:\n1. System > SNMP. Make sure that SNMP agent is enabled.\n2. Make sure that there is not any SNMPv1/2c community.\n3. Make sure that there is at least 1 SNMPv3 user in the list.",
    "remediation_steps": "To enable SNMP agent in CLI:\nFGT1 # config system snmp sysinfo\nFGT1 (sysinfo) # set status enable\nFGT1 (sysinfo) # end\nIn GUI, go to System > SNMP and enable SNMP Agent.\nTo delete SNMPv1/2c communities. In this example, we'll delete community \"public\" in\nCLI:\nFGT1 # config system snmp community\nFGT1 (community) # delete public\nFGT1 (community) # end\nFGT #\nIn the GUI, go to:\nSystem > SNMP, select the community and click on the Delete button.\nTo add SNMPv3 user in CLI:\nPage 57\nInternal Only - General\nFGT1 # config system snmp user\nFGT1 (user) # edit \"snmp_test\"\nFGT1 (snmp_test) # set security-level auth-priv\nFGT1 (snmp_test) # set auth-proto sha256\nFGT1 (snmp_test) # set auth-pwd xxxx\nFGT1 (snmp_test) # set priv-proto aes256\nFGT1 (snmp_test) # set priv_pwd xxxx\nFGT1 (snmp_test) # end\nFGT1 #\nIn the GUI, go to:\n1. System > SNMP, under SNMPv3, click on \"Create New\" button.\n2. Select \"Authentication\" and choose SHA256 as Authentication algorithm.\n3. Click \"Change\" to type in the password.\n4. Also select option \"Private\", choose AES256 as Encryption Algorithm.\n5. Click on \"Change\" to change the password. Click \"OK\" to add the new user.\n6. Click apply to apply the new setting into the current config.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://community.fortinet.com/t5/FortiGate/Technical-Tip-How-to-Configure-\nFortiGate-SNMP-Agent-for/ta-p/196866?externalID=FD45755\n2. https://docs.fortinet.com/document/fortigate/7.2.0/administration-\nguide/457149/snmp-v3-users",
    "audit": "From CLI, check to make sure that there is not any community for SNMPv1 or\nSNMPv2c and only SNMPv3 users are there. Also make sure that SNMP Agent is\nenabled:\nPage 56\nInternal Only - General\nFGT1 # config system snmp sysinfo\nFGT1 (sysinfo) # show\nconfig system snmp sysinfo\nset status enable\n...\nend\nFGT1 (sysinfo) # end\nFGT1 # config system snmp community\nFGT1 (community) # show\nconfig system snmp community\nend\nFGT1 (community) # end\nFGT1 # config system snmp user\nFGT1 (user) # show\nconfig system snmp user\nedit \"snmp_test\"\nset security-level auth-priv\nset auth-proto sha256\nset auth-pwd ENC xxxxxx\nset priv-proto aes256\nset priv-pwd ENC xxxxxx\nnext\nend\nIn the GUI, go to:\n1. System > SNMP. Make sure that SNMP agent is enabled.\n2. Make sure that there is not any SNMPv1/2c community.\n3. Make sure that there is at least 1 SNMPv3 user in the list.",
    "rationale": "SNMP Version 3 provides security enhancements that are not available in SNMP\nVersion 1 or SNMP Version 2c. SNMP Versions 1 and 2c transmit data between the\nSNMP server and SNMP agent in clear text. SNMP Version 3 adds authentication and\nprivacy options to secure protocol operations. Some firewalls need to be constantly\nmonitored of its performance and status, especially if the firewalls are critical to the\noperation. Enabling SNMPv3 will ensure that the firewall is monitored properly.",
    "impact": "Some older SNMP servers that only run SNMPv1 or SNMPv2c will not be able to query\nto this firewall."
  },
  {
    "rule_id": "11.5",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "Manage Network Devices Using Multi-Factor",
    "cis_level": "• Level 2",
    "description": "Ensuring that only certain hosts are able to conduct SNMP GET or receive SNMP Trap.",
    "expected_values": "By default, no SNMP is configured.",
    "validation_logic": "From CLI:\nFGT1 # show system snmp user\nconfig system snmp user\nedit \"snmp_test\"\nset notify-hosts 192.168.1.101\nset security-level auth-priv\nset auth-proto sha512\nset auth-pwd ENC xxxxx\nset priv-proto aes256\nset priv-pwd ENC xxxxx\nnext\nend\nValidate that \"notify-hosts\" is configured with specific IP address, and there is no\n\"0.0.0.0\" configured.\nFrom GUI:\n1. System > SNMP.\n2. On SNMPv3 section, double click on the configured SNMPv3 settings.\n3. Ensure that \"Hosts\" is configured with specific IP address, and there is\nno \"0.0.0.0\" configured.",
    "remediation_steps": "To remove 0.0.0.0 from trusted hosts in CLI:\nFGT1 # config system snmp user\nFGT1 (user) # edit \"snmp_test\"\nFGT1 (snmp_test) # unselect notify-hosts 0.0.0.0\nFGT1 (snmp_test) # end\nFGT1 #\nFrom GUI:\nPage 59\nInternal Only - General\n1. System > SNMP.\n2. On SNMPv3 section, double click on the configured SNMPv3 settings.\n3. Remove 0.0.0.0 from \"Hosts\" option.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.2.0/administration-\nguide/457149/snmp-v3-users",
    "audit": "From CLI:\nFGT1 # show system snmp user\nconfig system snmp user\nedit \"snmp_test\"\nset notify-hosts 192.168.1.101\nset security-level auth-priv\nset auth-proto sha512\nset auth-pwd ENC xxxxx\nset priv-proto aes256\nset priv-pwd ENC xxxxx\nnext\nend\nValidate that \"notify-hosts\" is configured with specific IP address, and there is no\n\"0.0.0.0\" configured.\nFrom GUI:\n1. System > SNMP.\n2. On SNMPv3 section, double click on the configured SNMPv3 settings.\n3. Ensure that \"Hosts\" is configured with specific IP address, and there is\nno \"0.0.0.0\" configured.",
    "rationale": "SNMP offers rich information that can be useful for reconnaissance activity. Hence,\nlimiting this information to only relevant devices such as NMS (Network Monitoring\nSystem) or other SNMP servers is necessary.",
    "impact": null
  },
  {
    "rule_id": "2.4",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "Administrators and Admin Profiles",
    "cis_level": "• Level 1",
    "description": "Before deploying any new FortiGate, it is important to change the password of the\ndefault admin account.\nIt is also recommended that you change even the user name of the default admin\naccount, However, since you cannot change the user name of an account that is\ncurrently in use, a second administrator account must be created in order to do this.",
    "expected_values": "By default, your FortiGate has an administrator account set up with the username admin\nand no password. In order to prevent unauthorized access to FortiGate, it is highly\nrecommended that you add a password to this account.\nUsername: admin The default admin account does not have any password. Just\nleave it blank",
    "validation_logic": "Using both CLI and GUI, in the username field put in \"admin\", leave the password field\nblank and proceed. If it's checked out, it means that the default password is still in place\nand needs to be changed.",
    "remediation_steps": "In the CLI, to change the password of account \"admin\":\nFG1 # config system admin\nFG1 (admin) # edit \"admin\"\nFG1 (admin) # set password <your passwords>\nFG1 (admin) # end\nFG1 #\nTo change the default password in the GUI:\nPage 62\nInternal Only - General\n1) Login to FortiGate with admin account\n2) Go to System > Administrators.\n3) Edit the admin account.\n4) Click Change Password.\n5) If applicable, enter the current password in the Old Password field.\n6) Enter a password in the New Password field, then enter it again in the\nConfirm Password field.\n7) Click OK.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://kb.fortinet.com/kb/documentLink.do?externalID=FD48763\n2. https://docs.fortinet.com/document/fortigate/6.2.0/cookbook/99980/default-\nadministrator-password",
    "audit": "Using both CLI and GUI, in the username field put in \"admin\", leave the password field\nblank and proceed. If it's checked out, it means that the default password is still in place\nand needs to be changed.",
    "rationale": "Default credentials are well documented by most vendors, including Fortinet. Therefore,\nit will be one of the first things that will be tried to illegally gain access to the system.",
    "impact": "If not changed, then any scripts that use default credentials will be able to access the\nsystem."
  },
  {
    "rule_id": "4.2",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "Change Default Passwords",
    "cis_level": "• Level 1",
    "description": "Configure an administrative account to be accessible only to someone who is using a\ntrusted host. You can set a specific IP address for the trusted host or use a subnet.",
    "expected_values": "By default, each account is accessible from everywhere. The host value is 0.0.0.0/0",
    "validation_logic": "This example is to check if trusted hosts option is enabled for account \"test_admin\" and\nwhich trusted hosts are in the list:\nFG1 # config system admin\nFG1 (admin) # edit \"test_admin\"\nFG1 (test_admin) # show\nconfig system admin\nedit \"test_admin\"\n...\nset trusthost1 10.0.0.0 255.255.255.0\nset trusthost2 192.168.10.0 255.255.255.0\n...\nnext\nend\nIn the Web GUI:\nPage 64\nInternal Only - General\n1. System > Administrators.\n2. Select the account and click on edit.\n3. In the account setting page, make sure that \"Restrict login to trusted\nhosts\" is enabled and all the allowed hosts / subnets are in the list of\ntrusted host.\nPlease take note that certain versions of FortiOS will only show the first 3 trusted hosts\nin the list. If you want to see more, you have to click on the \"+\" sign as if you're adding a\nnew item into the list. Keep clicking until you see an empty field of trusted host. That's\nwhen you know that you have reached the bottom of the list.",
    "remediation_steps": "To remove a trusted host item from the list in CLI:\nFG1 # config system admin\nFG1 (admin) # edit \"test_admin\"\nFG1 (test_admin) # unset trusthost1\nFG1 (test_admin) # end\nFG1 #\nTo add a trusted host into the list in CLI:\nFG1 # config system admin\nFG1 (admin) # edit \"test_admin\"\nFG1 (test_admin) # set trusthost6 1.1.1.1 255.255.255.255\nFG1 (test_admin) # end\nFG1 #\nBefore adding an item, please make sure that it does not already exist. For example, if\ntrusthost3 is already in the list, using it again will override the existing host/network.\nIn the Web GUI:\n1. System > Administrators.\n2. select the account and click on edit.\n3. In the account setting page, make sure that \"Restrict login to trusted\nhosts\" is enabled and all the allowed hosts / subnets are in the list of\ntrusted host.\nPlease take note that certain versions of FortiOS will only show the first 3 trusted hosts\nin the list. If you want to see more, you have to click on the \"+\" sign as if you're adding a\nnew item into the list. Keep clicking until you see an empty field of trusted host. That's\nwhen you know that you have reached the bottom of the list. To add another trusted\nhost, fill in the empty field of the new \"Trusted Host\". To remove a trusted host, simply\nerase everything in the field of that corresponding host.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.2.0/administration-\nguide/14906/administrator-account-options\nPage 65\nInternal Only - General",
    "audit": "This example is to check if trusted hosts option is enabled for account \"test_admin\" and\nwhich trusted hosts are in the list:\nFG1 # config system admin\nFG1 (admin) # edit \"test_admin\"\nFG1 (test_admin) # show\nconfig system admin\nedit \"test_admin\"\n...\nset trusthost1 10.0.0.0 255.255.255.0\nset trusthost2 192.168.10.0 255.255.255.0\n...\nnext\nend\nIn the Web GUI:\nPage 64\nInternal Only - General\n1. System > Administrators.\n2. Select the account and click on edit.\n3. In the account setting page, make sure that \"Restrict login to trusted\nhosts\" is enabled and all the allowed hosts / subnets are in the list of\ntrusted host.\nPlease take note that certain versions of FortiOS will only show the first 3 trusted hosts\nin the list. If you want to see more, you have to click on the \"+\" sign as if you're adding a\nnew item into the list. Keep clicking until you see an empty field of trusted host. That's\nwhen you know that you have reached the bottom of the list.",
    "rationale": "Access to a firewall to perform administrative tasks should only come from specific\nnetwork segments reserved for administrators only. This additional layer of security\nensures that no one from anywhere else on the network is able to log in, even with\ncorrect credentials.",
    "impact": "All access outside of the allowed segment will be stopped, including from both\nlegitimate and illegitimate users. Thus, administrators working remotely will have to\nmake sure that they have access to jump hosts that sit in the allowed segment."
  },
  {
    "rule_id": "11.7",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "Manage Network Infrastructure Through a Dedicated",
    "cis_level": "• Level 1",
    "description": "Verify that users with access to the Fortinet should only have the minimum privileges\nrequired for that particular user.",
    "expected_values": "By default, there are only 2 profiles: prof_admin and super_admin. You must select a\nprofile to create an admin account. The system will not automatically choose for you.",
    "validation_logic": "There are 2 stages to audit. Here is how to verify in the CLI:\nStage 1: Verify the profile.\nFGT1 # config system accprofile\nFGT1 (accprofile) # edit \"tier_1\"\nFGT1 (tier_1) # show full\nconfig system accprofile\nedit \"tier_1\"\nset comments ''\nset secfabgrp read\nset ftviewgrp read\nset authgrp none\nset sysgrp none\nset netgrp read\nset loggrp none\nset fwgrp custom\nset vpngrp none\nset utmgrp none\nset wifi none\nset admintimeout-override disable\nconfig fwgrp-permission\nset policy none\nset address none\nset service none\nset schedule none\nend\nnext\nend\nFGT1 (tier_1) #\nIf the following privileges are set to \"custom\", please also check the sub-privileges of the\ncustomized ones to make sure that only the right privileges are allowed: fwgrp, sysgrp,\nnetgrp, loggrp, utmgrpset.\nPage 67\nInternal Only - General\nIn the GUI, go to:\nSystem > Admin Profiles, select the profile and click on \"Edit\".\nStage 2: Verify the admin accounts.\nIn the CLI:\nFGT1 #config system admin\nFGT1 (admin) # edit \"support1\"\nFGT1 (support1) # show full\nconfig system admin\nedit \"support1\"\n...\nset accprofile \"tier_1\"\n...\nnext\nend\nIn the GUI, go to:\nSystem > Administrators, select the account and click \"Edit\"",
    "remediation_steps": "In this example, the goal is to provide the profile \"tier_1\" the ability to view and modify\naddress objects. This sub-privilege is under fwgrp privilege.\nIn CLI:\nFGT1 # config system accprofile\nFGT1 (accprofile) # edit \"tier_1\"\nFGT1 (tier_1) # set fwgrp custom\nFGT1 (tier_1) # config fwgrp-permission\nFGT1 (fwgrp-permission) # set address read-write\nFGT1 (fwgrp-permission) # end\nFGT1 (tier_1) # end\nFGT1 #\nFor the GUI, go to:\n1. System > Admin Profiles, select \"tier_1\" and click \"Edit\".\n2. On \"Firewall\", click on \"Custom\".\n3. Click on \"Read/Write\" option for \"Address\".\nIn the next example, assign the profile \"tier_1\" to the account \"support1\".\nIn the CLI:\nFGT1 # config system admin\nFGT1 (admin) # edit \"support1\"\nFGT1 (support1) # set accprofile \"tier_1\"\nFGT1 (support1) # end\nFGT1 #\nFor the GUI, go to:\nPage 68\nInternal Only - General\n1. System > Administrators.\n2. Select \"support1\" and click \"Edit\".\n3. Under \"Administrator Profile\", select \"tier_1\".",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.2.0/administration-\nguide/294491/administrator-profiles",
    "audit": "There are 2 stages to audit. Here is how to verify in the CLI:\nStage 1: Verify the profile.\nFGT1 # config system accprofile\nFGT1 (accprofile) # edit \"tier_1\"\nFGT1 (tier_1) # show full\nconfig system accprofile\nedit \"tier_1\"\nset comments ''\nset secfabgrp read\nset ftviewgrp read\nset authgrp none\nset sysgrp none\nset netgrp read\nset loggrp none\nset fwgrp custom\nset vpngrp none\nset utmgrp none\nset wifi none\nset admintimeout-override disable\nconfig fwgrp-permission\nset policy none\nset address none\nset service none\nset schedule none\nend\nnext\nend\nFGT1 (tier_1) #\nIf the following privileges are set to \"custom\", please also check the sub-privileges of the\ncustomized ones to make sure that only the right privileges are allowed: fwgrp, sysgrp,\nnetgrp, loggrp, utmgrpset.\nPage 67\nInternal Only - General\nIn the GUI, go to:\nSystem > Admin Profiles, select the profile and click on \"Edit\".\nStage 2: Verify the admin accounts.\nIn the CLI:\nFGT1 #config system admin\nFGT1 (admin) # edit \"support1\"\nFGT1 (support1) # show full\nconfig system admin\nedit \"support1\"\n...\nset accprofile \"tier_1\"\n...\nnext\nend\nIn the GUI, go to:\nSystem > Administrators, select the account and click \"Edit\"",
    "rationale": "In some organizations, it is necessary to create different levels of administrative\naccounts. For example, technicians from tier 1 support should not have total access to\nthe system compared to a tier 3 support.",
    "impact": null
  },
  {
    "rule_id": "4.3",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "Ensure the Use of Dedicated Administrative Accounts",
    "cis_level": "• Level 1",
    "description": "The idle timeout period is the amount of time that an administrator will stay logged in to\nthe GUI without any activity.",
    "expected_values": "By default, it is set to five minutes.",
    "validation_logic": "To check the idle timeout in the GUI:\n1) Login to FortiGate\n2) Go to 'System' > 'Settings'.\n3) In the 'Administration Settings' section, check the 'Idle timeout' value\nin minutes.\nTo check the idle timeout in the CLI:\nget system global\ncheck the value of admintimeout in minutes",
    "remediation_steps": "To change the idle timeout in the GUI:\n1) Login to FortiGate with Super Admin privileges\n2) Go to 'System' > 'Settings'.\n3) In the 'Administration Settings' section, set the 'Idle timeout' value to\nfive minutes by typing 5.\n4) Click Apply.\nTo change the idle timeout in the CLI:\nPage 70\nInternal Only - General\nconfig system global\nset admintimeout 5\nend",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.2.0/administration-\nguide/215451/setting-the-idle-timeout-time",
    "audit": "To check the idle timeout in the GUI:\n1) Login to FortiGate\n2) Go to 'System' > 'Settings'.\n3) In the 'Administration Settings' section, check the 'Idle timeout' value\nin minutes.\nTo check the idle timeout in the CLI:\nget system global\ncheck the value of admintimeout in minutes",
    "rationale": "Best practice dictates setting admin idle timeout to prevent the risk of unauthorized\naccess to the device, such as someone using a logged-in GUI on a PC that has been\nleft unattended.",
    "impact": "This is to prevent someone from accessing the FortiGate if the management PC is left\nunattended."
  },
  {
    "rule_id": "11.1",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "Maintain Standard Security Configurations for",
    "cis_level": "• Level 1",
    "description": "Allow only HTTPS access to the GUI and SSH access to the CLI.",
    "expected_values": "By default, HTTP and Telnet are not enabled on any interface.",
    "validation_logic": "In the CLI, when verifying the network interface, make sure that http and telnet are not\nin the allowaccess list:\nFG1 # config system interface\nFG1 (interface) # edit port1\nFG1 (port1) # show\nconfig system interface\nedit \"port1\"\n...\nset allowaccess ssh https ping snmp\n...\nnext\nend\nIn the web GUI, click on:\n1. Network > Interfaces, select the interface and click \"Edit\".\n2. In the interface setting page, make sure that HTTP and Telnet are not\nselected in the section \"Administrative Access\"",
    "remediation_steps": "If HTTP or Telnet is in the allowaccess list, you will have to set that list again with the\nsame elements except for http or telnet.\nOn CLI:\nFG1 # config system interface\nFG1 (interface) # edit port1\nFG1 (port1) # set allowaccess ssh https ping snmp\nFG1 (port1) # end\nFG1 #\nIn the web GUI, click on:\nPage 72\nInternal Only - General\n1. Network > Interfaces, select the interface and click \"Edit\".\n2. In the interface setting page, uncheck HTTP and Telnet in the section\n\"Administrative Access\".",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.2.0/administration-\nguide/574723/interface-settings#Configur",
    "audit": "In the CLI, when verifying the network interface, make sure that http and telnet are not\nin the allowaccess list:\nFG1 # config system interface\nFG1 (interface) # edit port1\nFG1 (port1) # show\nconfig system interface\nedit \"port1\"\n...\nset allowaccess ssh https ping snmp\n...\nnext\nend\nIn the web GUI, click on:\n1. Network > Interfaces, select the interface and click \"Edit\".\n2. In the interface setting page, make sure that HTTP and Telnet are not\nselected in the section \"Administrative Access\"",
    "rationale": "By only allowing encrypted access, we are making it harder to use \"Man in the Middle\"\nattacks to sniff login credentials.",
    "impact": null
  },
  {
    "rule_id": "4.5",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "Use Multifactor Authentication For All Administrative",
    "cis_level": "• Level 1",
    "description": "Configure Local-in Policies to control inbound traffic that is destined to a FortiGate\ninterface.",
    "expected_values": "There are no Local-in Policies in place by default.",
    "validation_logic": "To review Local-in Policies in the GUI, go to:\n1. System > Feature Visibility.\n2. Turning on \"Local-in policies\" under the Additional Features Section.\nThis will then add the section under \"Policies and Objects\" there will now be a section\nfor \"Local-in Policies\"\nIt can also be viewed through the CLI:\nconfig firewall local-in-policy\nshow",
    "remediation_steps": "Local-in Policies can only be configured through the CLI:\nPage 74\nInternal Only - General\nconfig firewall {local-in-policy | local-in-policy6}\nedit <policy_number>\nset intf <interface>\nset srcaddr <source_address> [source_address] ...\nset dstaddr <destination_address> [destination_address] ...\nset action {accept | deny}\nset service <service_name> [service_name] ...\nset schedule <schedule_name>\nset comments <string>\nnext\nend\nFor example, to prevent the source subnet 10.10.10.0/24 from pinging port1, but allow\nadministrative access for PING on port1:\nconfig firewall address\nedit \"10.10.10.0\"\nset subnet 10.10.10.0 255.255.255.0\nnext\nend\nconfig firewall local-in-policy\nedit 1\nset intf \"port1\"\nset srcaddr \"10.10.10.0\"\nset dstaddr \"all\"\nset service \"PING\"\nset schedule \"always\"\nnext\nend",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.2.0/administration-\nguide/363127/local-in-policy",
    "audit": "To review Local-in Policies in the GUI, go to:\n1. System > Feature Visibility.\n2. Turning on \"Local-in policies\" under the Additional Features Section.\nThis will then add the section under \"Policies and Objects\" there will now be a section\nfor \"Local-in Policies\"\nIt can also be viewed through the CLI:\nconfig firewall local-in-policy\nshow",
    "rationale": "Local-in Policies allow for more granular and specific control of all types of traffic that\nare destined for a FortiGate interface. They are not limited to management-only\nprotocols, therefore they can extend past \"trusted host\" configurations and be\nconfigured with source and destination addresses as well as specific services.",
    "impact": "Local-in Policies are processed before \"trusted host\" configurations, so it is important to\nvalidate that management access will be maintained once the Local-in policies are put\nin place."
  },
  {
    "rule_id": "14.6",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "Protect Information through Access Control Lists",
    "cis_level": "• Level 1",
    "description": "FortiGate admin ports listen on the common ports of 80 and 443. This is default\nbehavior. While interface access is controlled by configuring network interfaces, the\nFortiGate still listens on the admin ports that have been configured, which can also\ncause a conflict should 80 or 443 be needed as part of additional configuration later on.",
    "expected_values": "config system global\nset admin-https-redirect enable\nset admin-port 80\nset admin-server-cert \"self-sign\"\nset admin-sport 443",
    "validation_logic": "Log in to the GUI and click on System > Settings > Review the ports under\n'Administration Settings' section.",
    "remediation_steps": "config system global\nset admin-https-redirect disable\nset admin-port 8082 **(or any other uncommon port)**\nset admin-server-cert \"self-sign\"\nset admin-sport 4343 **(or any other uncommon port)**\nend\nOR\nFrom Web GUI:\n1. System > Settings\n2. Change the ports/settings under 'Administration Settings' section.\nNOTE: https redirection must be turned off as well as changing port 80. This is due to\nthe nature of how browser port redirection works. The browser will be redirected from\nport 80 to port 443 or whichever 'admin-sport' is configured, meaning that it will still\nlisten on port 80 even when the port has been reconfigured.\nPage 77\nInternal Only - General",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.2.4/administration-\nguide/616955/configuring-ports\n2. https://community.fortinet.com/t5/FortiGate/Technical-Tip-How-to-change-the-\nport-for-the-admin-access-to/ta-p/192295?externalID=FD46981",
    "audit": "Log in to the GUI and click on System > Settings > Review the ports under\n'Administration Settings' section.",
    "rationale": "To increase security of the FortiGate Admin Ports, changing it from the default ports will\nreduce the attack surface should FortiGate Admin Access be targeted. As mentioned, a\npossible port conflict can also be avoided.",
    "impact": "Unauthorized access to a FortiGate or any firewall could prove very costly. While this is\na single hardening step of many, it is an important one when hardening any firewall."
  },
  {
    "rule_id": "9.4",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "Apply Host-based Firewalls or Port Filtering",
    "cis_level": "• Level 1",
    "description": "Allow virtual patching to be applied to traffic destined to the FortiGate by applying IPS\nsignatures to the local in interface using local in policies. Attacks geared towards GUI\nand SSH management access, for example, can be mitigated using IPS signatures\npushed from FortiGuard, thereby virtually patching these vulnerabilities.",
    "expected_values": "Disabled",
    "validation_logic": "On CLI:\nconfig firewall local-in-policy\nshow\nEnsure that virtual-patch is enabled for those policy that is allowing traffic.",
    "remediation_steps": "On CLI:\nconfig firewall local-in-policy\nedit <id>\nset virtual-patch enable\nnext\nend",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.2.0/new-features/393161/virtual-\npatching-on-the-local-in-management-interface-7-2-4\nPage 79\nInternal Only - General",
    "audit": "On CLI:\nconfig firewall local-in-policy\nshow\nEnsure that virtual-patch is enabled for those policy that is allowing traffic.",
    "rationale": "Patches require scheduling of downtime, which means there is some attack window\nfrom the time Fortinet announced the vulnerability to when patch is applied. To minimise\nthe risk, virtual patching on GUI and SSH management access is needed.",
    "impact": null
  },
  {
    "rule_id": "2.5",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "High Availability",
    "cis_level": "• Level 2",
    "description": "Ensure that FortiGate devices are configured for High Availability (HA).",
    "expected_values": "N/A\nPage 83\nInternal Only - General",
    "validation_logic": "In GUI:\n1. Navigate to \"System\" and then \"HA\"\n2. Ensure \"Mode\" is set to proper setting \"Active-Active\" or \"Active-Passive\"\n3. Review Configuration settings:\n- \"Cluster Name\" must match on devices\n- \"Password\" Must match on devices\n- \"Heartbeat Interfaces\" need to be defined on devices\n4. Click \"OK\" to save changes and exit\nIn CLI:\nFGT1 # config system ha\nFGT1 (ha) # set mode a-p ###(Active-Passive)\nFGT1 (ha) # set group-name \"FGT-HA\" ###(Set cluster name)\nFGT1 (ha) # set password ******* ###(Set password)\nFGT1 (ha) # set hbdev port10 50 ###(Set Heartbeat\nInterface and priority)\nFGT1 (ha) # end\nTo review configuration in CLI:\nPage 82\nInternal Only - General\nFGT1 # config system ha\nFGT1 (ha) # show\nconfig system ha\nset group-name \"FGT-HA\"\nset mode a-p\nset password ENC\nenrwD467hJmO6j6YW/l6FEOa1YNVYdo8Z5mCcTDEKUFpOVXcNYnPBmQDGX//ViXk6TkwNH0il5aJr\n/fZY25lq+husndQHZVWp2LIlXmCv/n81U43nkZUWaIKvqkellGFbhv0/IHoOLzQPCsVcBbyrsgopr\nYMvh6w7F06+nRriBtMNQxpOV5V+e388EcwsOOMsXBZOw==\nset hbdev \"port10\" 50\nset override disable\nend",
    "remediation_steps": "In GUI:\n1. Navigate to \"System\" and then \"HA\"\n2. Ensure \"Mode\" is set to proper setting \"Active-Active\" or \"Active-Passive\"\n3. Review Configuration settings:\n- \"Cluster Name\" must match on devices\n- \"Password\" Must match on devices\n- \"Heartbeat Interfaces\" need to be defined on devices\n4. Click \"OK\" to save changes and exit\nIn CLI:\nFGT1 # config system ha\nFGT1 (ha) # set mode a-p ###(Active-Passive)\nFGT1 (ha) # set group-name \"FGT-HA\" ###(Set cluster name)\nFGT1 (ha) # set password ******* ###(Set password)\nFGT1 (ha) # set hbdev port10 50 ###(Set Heartbeat\nInterface and priority)\nFGT1 (ha) # end\nTo review configuration in CLI:\nFGT1 # config system ha\nFGT1 (ha) # show\nconfig system ha\nset group-name \"FGT-HA\"\nset mode a-p\nset password ENC\nenrwD467hJmO6j6YW/l6FEOa1YNVYdo8Z5mCcTDEKUFpOVXcNYnPBmQDGX//ViXk6TkwNH0il5aJr\n/fZY25lq+husndQHZVWp2LIlXmCv/n81U43nkZUWaIKvqkellGFbhv0/IHoOLzQPCsVcBbyrsgopr\nYMvh6w7F06+nRriBtMNQxpOV5V+e388EcwsOOMsXBZOw==\nset hbdev \"port10\" 50\nset override disable\nend",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.2.0/administration-\nguide/900885/ha-active-passive-cluster-setup\n2. https://docs.fortinet.com/document/fortigate/7.2.0/administration-\nguide/357558/ha-active-active-cluster-setup",
    "audit": "In GUI:\n1. Navigate to \"System\" and then \"HA\"\n2. Ensure \"Mode\" is set to proper setting \"Active-Active\" or \"Active-Passive\"\n3. Review Configuration settings:\n- \"Cluster Name\" must match on devices\n- \"Password\" Must match on devices\n- \"Heartbeat Interfaces\" need to be defined on devices\n4. Click \"OK\" to save changes and exit\nIn CLI:\nFGT1 # config system ha\nFGT1 (ha) # set mode a-p ###(Active-Passive)\nFGT1 (ha) # set group-name \"FGT-HA\" ###(Set cluster name)\nFGT1 (ha) # set password ******* ###(Set password)\nFGT1 (ha) # set hbdev port10 50 ###(Set Heartbeat\nInterface and priority)\nFGT1 (ha) # end\nTo review configuration in CLI:\nPage 82\nInternal Only - General\nFGT1 # config system ha\nFGT1 (ha) # show\nconfig system ha\nset group-name \"FGT-HA\"\nset mode a-p\nset password ENC\nenrwD467hJmO6j6YW/l6FEOa1YNVYdo8Z5mCcTDEKUFpOVXcNYnPBmQDGX//ViXk6TkwNH0il5aJr\n/fZY25lq+husndQHZVWp2LIlXmCv/n81U43nkZUWaIKvqkellGFbhv0/IHoOLzQPCsVcBbyrsgopr\nYMvh6w7F06+nRriBtMNQxpOV5V+e388EcwsOOMsXBZOw==\nset hbdev \"port10\" 50\nset override disable\nend",
    "rationale": "Configuring High Availability (HA) increases system availability as well as decreases\nimpact of routine maintenance (Firmware updates, cable moves, etc.) and the the\nimpact of device failure.",
    "impact": "Not having High Availability (HA) configured correctly and synced properly impacts the\navailability of the FortiGate devices as well as any systems that require traversing the\nFortiGates. With properly configured HA in place outages can be minimized during\nfirmware updates as well as if there are power outages or device failures."
  },
  {
    "rule_id": "11.1",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "Maintain Standard Security Configurations for",
    "cis_level": "• Level 1",
    "description": "Configure Interface Monitoring within High Availability settings. Interface Monitoring\nshould be enabled on all critical interfaces.",
    "expected_values": "N/A",
    "validation_logic": "To validate from GUI:\n1. Go to System > HA.\n2. Under \"Monitor Interfaces\" validate all applicable interfaces are\nselected.\n3. Select \"OK\".\nTo validate from CLI:\nFGT1 # config system ha\nFGT1 (ha) # show\nconfig system ha\nset group-name \"FGT-HA\"\nset mode a-p\nset password ENC\nenrwD467hJmO6j6YW/l6FEOa1YNVYdo8Z5mCcTDEKUFpOVXcNYnPBmQDGX//ViXk6TkwNH0il5aJr\n/fZY25lq+husndQHZVWp2LIlXmCv/n81U43nkZUWaIKvqkellGFbhv0/IHoOLzQPCsVcBbyrsgopr\nYMvh6w7F06+nRriBtMNQxpiTE+12xAHz7lA3EoYZzf8A==\nset override disable\nset monitor \"port6\" \"port7\" ###Validate proper interfaces are present\nend",
    "remediation_steps": "To remediate from GUI:\nPage 85\nInternal Only - General\n1. Go to System > HA.\n2. Under \"Monitor Interfaces\" select all applicable interfaces.\n3. Select \"OK\".\nTo validate from CLI:\nFGT1 # config system ha\nFGT1 (ha) # set monitor \"port6\" \"port7\"\nFGT1 (ha) # show ###To Review changes to monitored interfaces before\napplying\nconfig system ha\nset group-name \"FGT-HA\"\nset mode a-p\nset password ENC\nenrwD467hJmO6j6YW/l6FEOa1YNVYdo8Z5mCcTDEKUFpOVXcNYnPBmQDGX//ViXk6TkwNH0il5aJr\n/fZY25lq+husndQHZVWp2LIlXmCv/n81U43nkZUWaIKvqkellGFbhv0/IHoOLzQPCsVcBbyrsgopr\nYMvh6w7F06+nRriBtMNQxpiTE+12xAHz7lA3EoYZzf8A==\nset override disable\nset monitor \"port6\" \"port7\"\nend",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/6.0.0/best-\npractices/498515/interface-monitoring-port-monitoring",
    "audit": "To validate from GUI:\n1. Go to System > HA.\n2. Under \"Monitor Interfaces\" validate all applicable interfaces are\nselected.\n3. Select \"OK\".\nTo validate from CLI:\nFGT1 # config system ha\nFGT1 (ha) # show\nconfig system ha\nset group-name \"FGT-HA\"\nset mode a-p\nset password ENC\nenrwD467hJmO6j6YW/l6FEOa1YNVYdo8Z5mCcTDEKUFpOVXcNYnPBmQDGX//ViXk6TkwNH0il5aJr\n/fZY25lq+husndQHZVWp2LIlXmCv/n81U43nkZUWaIKvqkellGFbhv0/IHoOLzQPCsVcBbyrsgopr\nYMvh6w7F06+nRriBtMNQxpiTE+12xAHz7lA3EoYZzf8A==\nset override disable\nset monitor \"port6\" \"port7\" ###Validate proper interfaces are present\nend",
    "rationale": "With Interface Monitoring enabled on devices, failover can occur if there are\nphysical media issues or issues with the specific port to which the FortiGate is\nconnected.",
    "impact": "Not configuring Interface Monitoring can directly impact services due to a failure to\ntrigger a High Availability failover if an interface is impacted only on the primary device\nand is not being monitored. Without the Interface Monitoring enabled, failover\nwould be limited to hardware, system, or power faults."
  },
  {
    "rule_id": "11.1",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "Maintain Standard Security Configurations for",
    "cis_level": "• Level 1",
    "description": "Ensure Reserved Management Interfaces are configured on HA devices.",
    "expected_values": "N/A",
    "validation_logic": "Review through the GUI:\n1. Go to System > HA edit the \"Master\" device.\n2. Verify that \"Management Interface Reservation\" is selected and there is an\ninterface, and gateway defined.\nReview through the CLI:\nFGT1 #config system ha\nFGT1 (ha) # show\nconfig system ha\nset group-name \"FGT-HA\"\nset mode a-p\nset password ENC\nenrwD467hJmO6j6YW/l6FEOa1YNVYdo8Z5mCcTDEKUFpOVXcNYnPBmQDGX//ViXk6TkwNH0il5aJr\n/fZY25lq+husndQHZVWp2LIlXmCv/n81U43nkZUWaIKvqkellGFbhv0/IHoOLzQPCsVcBbyrsgopr\nYMvh6w7F06+nRriBtMNQxpiTE+12xAHz7lA3EoYZzf8A==\nset ha-mgmt-status enable\nconfig ha-mgmt-interfaces\nedit 1\nset interface \"port6\"\nset gateway 10.10.10.1\nnext\nend\nset override disable\nend\nValidate that set ha-mgmt-status is enabled and that config ha-mgmt-interfaces\nhas at least one entry with an interface and gateway defined.\nPage 87\nInternal Only - General",
    "remediation_steps": "Remediate through the GUI:\n1. Go to System > HA edit the \"Master\" device.\n2. Enable \"Management Interface Reservation\" once this is enabled select an\nan interface, and configure the appropriate gateway.\nRemediate through the CLI:\nFGT1 #config system ha\nFGT1 (ha) # set ha-mgmt-status enable\nFGT1 (ha) # config ha-mgmt-interfaces\nFGT1 (ha-mgmt-interfaces) # edit 1\nnew entry '1' added\nFGT1 (1) # set interface port6\nFGT1 (1) # set gateway 10.10.10.1\nFGT1 (1) # end\nFGT1 (ha) # show\nconfig system ha\nset group-name \"FGT-HA\"\nset mode a-p\nset password ENC\nenrwD467hJmO6j6YW/l6FEOa1YNVYdo8Z5mCcTDEKUFpOVXcNYnPBmQDGX//ViXk6TkwNH0il5aJr\n/fZY25lq+husndQHZVWp2LIlXmCv/n81U43nkZUWaIKvqkellGFbhv0/IHoOLzQPCsVcBbyrsgopr\nYMvh6w7F06+nRriBtMNQxpiTE+12xAHz7lA3EoYZzf8A==\nset ha-mgmt-status enable\nconfig ha-mgmt-interfaces\nedit 1\nset interface \"port6\"\nset gateway 10.10.10.1\nnext\nend\nset override disable\nend\nFGT1 (ha) # end",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.2.0/administration-\nguide/313152/out-of-band-management-with-reserved-management-interfaces\nPage 88\nInternal Only - General",
    "audit": "Review through the GUI:\n1. Go to System > HA edit the \"Master\" device.\n2. Verify that \"Management Interface Reservation\" is selected and there is an\ninterface, and gateway defined.\nReview through the CLI:\nFGT1 #config system ha\nFGT1 (ha) # show\nconfig system ha\nset group-name \"FGT-HA\"\nset mode a-p\nset password ENC\nenrwD467hJmO6j6YW/l6FEOa1YNVYdo8Z5mCcTDEKUFpOVXcNYnPBmQDGX//ViXk6TkwNH0il5aJr\n/fZY25lq+husndQHZVWp2LIlXmCv/n81U43nkZUWaIKvqkellGFbhv0/IHoOLzQPCsVcBbyrsgopr\nYMvh6w7F06+nRriBtMNQxpiTE+12xAHz7lA3EoYZzf8A==\nset ha-mgmt-status enable\nconfig ha-mgmt-interfaces\nedit 1\nset interface \"port6\"\nset gateway 10.10.10.1\nnext\nend\nset override disable\nend\nValidate that set ha-mgmt-status is enabled and that config ha-mgmt-interfaces\nhas at least one entry with an interface and gateway defined.\nPage 87\nInternal Only - General",
    "rationale": "To be able to access both the primary and secondary firewalls in an HA cluster,\nReserved Management Interfaces need to be configured to prevent them from\nsyncing with HA and sharing a virtual MAC address.",
    "impact": "Not configuring Reserved Management Interfaces impacts the ability to access\nsecondary devices directly due to the primary and secondary devices syncing\nconfiguration exactly and floating a virtualized mac address between them for failover."
  },
  {
    "rule_id": "3.1",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "Ensure that unused policies are reviewed regularly",
    "cis_level": "• Level 2",
    "description": "All firewall policies should be reviewed regularly to verify the business purpose. Unused\npolicies should be disabled and logged.\nRecommendation to review twice per year or inline with BCP practice (Business\nContinuity Plan). Some of the firewall policies will only be used during BCP, hence, the\nhit count might show 0 if the review is done too often.",
    "expected_values": "By default, the hit count value is 0 at the beginning.",
    "validation_logic": "In CLI, type \"diag firewall iprope show 100004 <policy_id>\". In this example, we'll verify\npolicy with ID of 32. We'll also need to clear the counter after each review so that we\ncan tell if the policy is still being used for the next review :\nFGT1 # diag firewall iprope show 100004 32\nidx=2 pkts/bytes=144967/135758174 asic_pkts/asic_bytes=0/0 flag=0x0 hit\ncount:663\nFGT1 # diag firewall iprope clear 100004 32\nIn the GUI,\n1. Go to Policy & Objects.\n2. Click on Firewall Policy.\n3. Make sure that either the columns \"Bytes\" or \"Hit Count\" are visible. To\ndisplay either one of them, move the cursor to the top row where all the\ncolumns names are. Right click and select \"Bytes\" or \"Hit Count\" and click\nOK. To clear the counter, right click on the \"Bytes\" or \"Hit Count\" columns\nof that policy and click on \"Clear Counters\".",
    "remediation_steps": "The remediation is to review and decide if you should delete unused policies.",
    "severity": "Manual",
    "is_active": true,
    "references_text": "1. https://kb.fortinet.com/kb/documentLink.do?externalID=FD44631\nPage 91\nInternal Only - General",
    "audit": "In CLI, type \"diag firewall iprope show 100004 <policy_id>\". In this example, we'll verify\npolicy with ID of 32. We'll also need to clear the counter after each review so that we\ncan tell if the policy is still being used for the next review :\nFGT1 # diag firewall iprope show 100004 32\nidx=2 pkts/bytes=144967/135758174 asic_pkts/asic_bytes=0/0 flag=0x0 hit\ncount:663\nFGT1 # diag firewall iprope clear 100004 32\nIn the GUI,\n1. Go to Policy & Objects.\n2. Click on Firewall Policy.\n3. Make sure that either the columns \"Bytes\" or \"Hit Count\" are visible. To\ndisplay either one of them, move the cursor to the top row where all the\ncolumns names are. Right click and select \"Bytes\" or \"Hit Count\" and click\nOK. To clear the counter, right click on the \"Bytes\" or \"Hit Count\" columns\nof that policy and click on \"Clear Counters\".",
    "rationale": "By reviewing policies regularly, we can determine if the policies are still needed by the\nbusiness purpose. Thus, we can keep the firewall policies lean and efficient. It also\nprevents traffic being allowed or blocked accidently.",
    "impact": null
  },
  {
    "rule_id": "3.2",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "Ensure that policies do not use \"ALL\" as Service",
    "cis_level": "• Level 1",
    "description": "Ensure that all security policies in effect clearly state which protocols / services they are\nallowing.",
    "expected_values": "By default, all new policy will have \"ALL\" in its service field.",
    "validation_logic": "In CLI:\nFGT1 # config firewall policy\nFGT1 (policy) # show\nTEST-FG-Third (policy) # show\nconfig firewall policy\nedit 1\nset uuid d0eed832-bb73-51e6-c3da-3cd2ec201608\nset srcintf \"internal\"\nset dstintf \"wan\"\nset srcaddr \"all\"\nset dstaddr \"all\"\nset action accept\nset schedule \"always\"\nset service \"HTTPS\" \"HTTP\"\nset ssl-ssh-profile \"__tmp_no-inspection\"\nset nat enable\nnext\nend\nIn the GUI,\n1. Go to Policy & Objects.\n2. Click on Firewall Policy.\nMake sure that none of the policies use \"ALL\" as its service.",
    "remediation_steps": "This is an example showing how to modify policy with ID of 2 to change the service from\n\"ALL\" to FTP and SNMP.\nIn CLI:\nPage 93\nInternal Only - General\nFGT1 # config firewall policy\nFGT1 (policy) # edit 2\nFGT1 (2) # set service \"FTP\" \"SNMP\"\nFGT1 (2) # end\nFGT1 #\nIn the GUI,\n1. Go to Policy & Objects.\n2. Click on Firewall Policy.\n3. Select the policy, click \"Edit\".\n4. In the Service section, click on it and select FTP and SNMP. Click OK.",
    "severity": "Automated",
    "is_active": true,
    "references_text": null,
    "audit": "In CLI:\nFGT1 # config firewall policy\nFGT1 (policy) # show\nTEST-FG-Third (policy) # show\nconfig firewall policy\nedit 1\nset uuid d0eed832-bb73-51e6-c3da-3cd2ec201608\nset srcintf \"internal\"\nset dstintf \"wan\"\nset srcaddr \"all\"\nset dstaddr \"all\"\nset action accept\nset schedule \"always\"\nset service \"HTTPS\" \"HTTP\"\nset ssl-ssh-profile \"__tmp_no-inspection\"\nset nat enable\nnext\nend\nIn the GUI,\n1. Go to Policy & Objects.\n2. Click on Firewall Policy.\nMake sure that none of the policies use \"ALL\" as its service.",
    "rationale": "This is to make sure that the firewall do not allow traffic with unauthorized\nprotocols/services by mistake.",
    "impact": null
  },
  {
    "rule_id": "3.3",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "Ensure firewall policy denying all traffic to/from Tor, malicious",
    "cis_level": "• Level 1",
    "description": "Firewall policies should include a deny rule for traffic going to/from Tor, malicious\nserver, or scanner IP addresses using ISDB (Internet Service Database).",
    "expected_values": null,
    "validation_logic": "Go to \"Policy & Objects\".\nValidate that there is a firewall policy created to block inbound connections from\nsources named \"Tor-Exit.Node\", \"Tor-Relay.Node\", \"Censys-Scanner\", \"Shodan-\nScanner\", \"Botnet-C&C.Server\", \"Phishing-Phishing.Server\", \"Proxy-Proxy.Server\",\n\"Spam-Spamming.Server\", \"VPN-Anonymous.VPN\", and \"Malicious-Malicious.Server\"\non \"All\" services.\nValidate that there is a firewall policy created to block outbound connections to\ndestination named \"Tor-Relay.Node\", \"Botnet-C&C.Server\", \"Phishing-Phishing.Server\",\n\"Proxy-Proxy.Server\", \"Spam-Spamming.Server\", \"VPN-Anonymous.VPN\", and\n\"Malicious-Malicious.Server\".",
    "remediation_steps": "Review firewall policies and ensure there are:\n1. A firewall policy created to block inbound connections with these settings:\nPage 95\nInternal Only - General\nFrom: Any\nTo: Any\nSource: \"Tor-Exit.Node\", \"Tor-Relay.Node\", \"Censys-Scanner\", \"Shodan-\nScanner\", \"Botnet-C&C.Server\", \"Phishing-Phishing.Server\", \"Proxy-\nProxy.Server\", \"Spam-Spamming.Server\", \"VPN-Anonymous.VPN\", and \"Malicious-\nMalicious.Server\"\nDestination: all\nSchedule: Always\nServices: All\nAction: Deny\nLog Violation Traffic: Enabled\nEnable this policy: Enabled\n2. A firewall policy created to block outbound connections with these settings:\nFrom: Any\nTo: Any\nSource: All\nDestination: \"Tor-Relay.Node\", \"Botnet-C&C.Server\", \"Phishing-\nPhishing.Server\", \"Proxy-Proxy.Server\", \"Spam-Spamming.Server\", \"VPN-\nAnonymous.VPN\", and \"Malicious-Malicious.Server\"\nSchedule: Always\nAction: Deny\nLog Violation Traffic: Enabled\nEnable this policy: Enabled",
    "severity": null,
    "is_active": true,
    "references_text": null,
    "audit": "Go to \"Policy & Objects\".\nValidate that there is a firewall policy created to block inbound connections from\nsources named \"Tor-Exit.Node\", \"Tor-Relay.Node\", \"Censys-Scanner\", \"Shodan-\nScanner\", \"Botnet-C&C.Server\", \"Phishing-Phishing.Server\", \"Proxy-Proxy.Server\",\n\"Spam-Spamming.Server\", \"VPN-Anonymous.VPN\", and \"Malicious-Malicious.Server\"\non \"All\" services.\nValidate that there is a firewall policy created to block outbound connections to\ndestination named \"Tor-Relay.Node\", \"Botnet-C&C.Server\", \"Phishing-Phishing.Server\",\n\"Proxy-Proxy.Server\", \"Spam-Spamming.Server\", \"VPN-Anonymous.VPN\", and\n\"Malicious-Malicious.Server\".",
    "rationale": "FortiGate includes Tor or malicious server related IP address using ISDB. The idea is to\nfilter out malicious traffic using firewall policies as first level filtering. This is done without\ninvolving more resource intensive processes such as IPS inspection, hence optimizing\nFortiGate's performance.",
    "impact": null
  },
  {
    "rule_id": "3.4",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "Ensure logging is enabled on all firewall policies",
    "cis_level": "• Level 1",
    "description": "Logging should be enabled for all firewall policies including the default implicit deny\npolicy.",
    "expected_values": "Logging is disabled.\nPage 98\nInternal Only - General",
    "validation_logic": "Go to \"Policy & Objects\" > \"Firewall Policy\".\nValidate that logging is enabled on all firewall policies.",
    "remediation_steps": "Review firewall policies and ensure that:\n1. For allowed policies, \"Log Allowed Traffic\" is set on \"All Sessions\" option.\n2. For denied policies, \"Log Violation Traffic\" is enabled.",
    "severity": "Manual",
    "is_active": true,
    "references_text": null,
    "audit": "Go to \"Policy & Objects\" > \"Firewall Policy\".\nValidate that logging is enabled on all firewall policies.",
    "rationale": "Firewall policies should log for all traffic (both allow and deny policies). This enables\nSOC or security analyst to do further investigations on security incidents especially on\nthreat hunting or incident response activities. Although there are many data sources that\ncan provide DNS query logs (AD or EDR), this option should be enabled out of best\npractice and with assumption that no other data sources are available.",
    "impact": "By default, when creating firewall policies, a logging option is not enabled. Also, the\ndefault implicit deny policy is not logged. This creates a data gap in threat hunting or\nincident response activities."
  },
  {
    "rule_id": "4.1",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "Intrusion Prevention System",
    "cis_level": "• Level 2",
    "description": "Interfaces which are classified as \"WAN\" and are used by a policy should use an IPS\nsensor which blocks or monitors outgoing connections to botnet sites.",
    "expected_values": "\"Scan Outgoing Connections to Botnet Sites\" is disabled on default profile.",
    "validation_logic": "On GUI:\n1. Ensure that relevant IPS profile is configured with \"Scan Outgoing\nConnections to Botnet Sites\" set to \"Block\".\n2. Review all firewall policies that have a \"WAN\" interface as the\ndestination.",
    "remediation_steps": "On GUI:\n1. Configure relevant IPS profiles with \"Scan Outgoing Connections to Botnet\nSites\" set to \"Block\".\n2. Apply relevant IPS profile on all firewall policies with traffic exiting\nthe network to a \"WAN\" interface.",
    "severity": "IPS",
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.2.0/administration-\nguide/668865/ips-with-botnet-c-c-ip-blocking\nPage 102\nInternal Only - General",
    "audit": "On GUI:\n1. Ensure that relevant IPS profile is configured with \"Scan Outgoing\nConnections to Botnet Sites\" set to \"Block\".\n2. Review all firewall policies that have a \"WAN\" interface as the\ndestination.",
    "rationale": "Blocking outgoing connections to known Botnets should be utilized in a Defense In\nDepth network design.",
    "impact": null
  },
  {
    "rule_id": "12.7",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "Deploy Network-Based Intrusion Prevention",
    "cis_level": "• Level 1",
    "description": "Ensuring that traffic traversing between networks on the FortiGate have an IPS security\nprofile inspecting it.",
    "expected_values": "Not Configured",
    "validation_logic": "Review all firewall policies and ensure that traffic has an IPS security profile assigned\nfor inspection.",
    "remediation_steps": "Configure on all \"Allowed\" firewall policies to have an appropriate IPS security profile\napplied to policies.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.2.0/administration-\nguide/243446/ngfw-policy",
    "audit": "Review all firewall policies and ensure that traffic has an IPS security profile assigned\nfor inspection.",
    "rationale": "Traffic moving between \"interfaces\" on the FortiGate should have firewall policies\napplied with an IPS security profile applied.",
    "impact": null
  },
  {
    "rule_id": "4.2",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "Antivirus",
    "cis_level": "• Level 2",
    "description": "Ensure FortiGate is configured to accept antivirus definition push updates.",
    "expected_values": "Enabled and set to automatic.\nPage 106\nInternal Only - General",
    "validation_logic": "On GUI:\n1. Access the FortiGate administrative web access page and go to System >\nFortiGuard.\n2. Under \"FortiGuard Updates\" ensure that the \"Scheduled updates\" is set to\n\"Automatic\".\nOn CLI:\nconfig system autoupdate schedule\nshow (Validate that there are no output, meaning it is already set as\n\"automatic\"",
    "remediation_steps": "On GUI:\n1. Access the FortiGate administrative web access page and go to System >\nFortiGuard.\n2. Under \"FortiGuard Updates\" ensure that the \"Scheduled updates\" is set to\n\"Automatic\".\nOn CLI:\nconfig system autoupdate schedule\nset status enable\nset frequency automatic\nend",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.2.0/administration-\nguide/547335/automatic-updates",
    "audit": "On GUI:\n1. Access the FortiGate administrative web access page and go to System >\nFortiGuard.\n2. Under \"FortiGuard Updates\" ensure that the \"Scheduled updates\" is set to\n\"Automatic\".\nOn CLI:\nconfig system autoupdate schedule\nshow (Validate that there are no output, meaning it is already set as\n\"automatic\"",
    "rationale": "Ensure that the FortiGate will accept push updates from FortiGuard to ensure the most\nup to date signature databases are present on the device.",
    "impact": null
  },
  {
    "rule_id": "8.2",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "Ensure Anti-Malware Software and Signatures are",
    "cis_level": "• Level 2",
    "description": "Ensuring that traffic traversing between networks on the FortiGate has an Antivirus\nSecurity profile inspecting it.",
    "expected_values": "No security inspection on firewall policies.",
    "validation_logic": "Review all firewall policies and ensure that traffic has an antivirus security profile\nassigned for inspection.",
    "remediation_steps": "Review firewall policies and apply an appropriate antivirus security profile to policies.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.2.0/administration-\nguide/243446/ngfw-policy",
    "audit": "Review all firewall policies and ensure that traffic has an antivirus security profile\nassigned for inspection.",
    "rationale": "Traffic moving between \"interfaces\" on the FortiGate should have firewall policies\napplied with an antivirus security profile applied.",
    "impact": null
  },
  {
    "rule_id": "8.1",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "Utilize Centrally Managed Anti-malware Software",
    "cis_level": "• Level 2",
    "description": "Ensure FortiGate AV inspection uses outbreak prevention database as an added layer\nof protection on top of antivirus' signature-based detection.",
    "expected_values": "Disabled",
    "validation_logic": "On GUI:\n1. Go to \"Security Profiles\" > \"AntiVirus\".\n2. Select AV profile.\nValidate that \"Use FortiGuard outbreak prevention database\" is enabled.\nOn CLI:\nFGT1 # config antivirus profile\nFGT1 (profile) # show\nValidate that for each traffic protocol, \"set outbreak-prevention block\" is configured.",
    "remediation_steps": "Review Antivirus Security Profiles and validate that \"Use FortiGuard outbreak\nprevention database\" is enabled.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.2.0/administration-\nguide/889364/fortiguard-outbreak-prevention\nPage 109\nInternal Only - General",
    "audit": "On GUI:\n1. Go to \"Security Profiles\" > \"AntiVirus\".\n2. Select AV profile.\nValidate that \"Use FortiGuard outbreak prevention database\" is enabled.\nOn CLI:\nFGT1 # config antivirus profile\nFGT1 (profile) # show\nValidate that for each traffic protocol, \"set outbreak-prevention block\" is configured.",
    "rationale": "Antivirus mainly uses signature for malware blocking. By enabling \"FortiGuard outbreak\nprevention database\", FortiGate can leverage on 3rd party malware hash signatures\ncurated by the FortiGuard as an additional protection layer.\nThe hash signatures are obtained from FortiGuard's Global Threat Intelligence\ndatabase. The antivirus database queries FortiGuard with the hash of a scanned file. If\nFortiGuard returns a match, the scanned file is deemed to be malicious.",
    "impact": null
  },
  {
    "rule_id": "8.6",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "Centralize Anti-malware Logging",
    "cis_level": "• Level 2",
    "description": "AI /heuristic based detection should be enabled.",
    "expected_values": "Enabled.",
    "validation_logic": "Configuration and verification can be only done on CLI.\nOn CLI:\nFGT1 # show antivirus settings | grep machine-learning-detection\nValidate that it is enabled.",
    "remediation_steps": "On CLI:\nFGT1 # config antivirus settings\nFGT1 (settings) # set machine-learning-detection enable",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.2.0/cli-reference/532620/config-\nantivirus-settings\n2. https://docs.fortinet.com/document/fortigate/7.0.0/new-features/773410/ai-based-\nmalware-detection\nPage 111\nInternal Only - General",
    "audit": "Configuration and verification can be only done on CLI.\nOn CLI:\nFGT1 # show antivirus settings | grep machine-learning-detection\nValidate that it is enabled.",
    "rationale": "The AV Engine AI malware detection model integrates into regular AV scanning to help\ndetect potentially malicious Windows Portable Executables (PEs) in order to mitigate\nzero-day attacks. It is an additional layer of protection on top of traditional antivirus\nprotection.\nIn version 6.x, it is named \"Heuristic detection\". On version 7.x, Fortinet has renamed\nthis to AI based detection.",
    "impact": null
  },
  {
    "rule_id": "8.3",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "Enable Operating System Anti-Exploitation Features/",
    "cis_level": "• Level 2",
    "description": "Grayware detection should be enabled.",
    "expected_values": "Disabled",
    "validation_logic": "CLI:\nFGT1 # show antivirus settings | grep grayware\nValidate that grayware detection is enabled.",
    "remediation_steps": "On CLI:\nFGT1 # config antivirus settings\nFGT1 (settings) # set grayware enable",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.2.0/cli-reference/532620/config-\nantivirus-settings",
    "audit": "CLI:\nFGT1 # show antivirus settings | grep grayware\nValidate that grayware detection is enabled.",
    "rationale": "Usage of grayware is generally not allowed in strict company policies and some\ngraywares can be used for malicious intent. If the file passes the virus scan, it can be\nchecked for grayware. Grayware signatures are kept up to date in the same manner as\nthe antivirus definitions.",
    "impact": null
  },
  {
    "rule_id": "8.2",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "Ensure Anti-Malware Software and Signatures are",
    "cis_level": "• Level 1",
    "description": "Inline scanning is supported when the FortiGate is licensed with the FortiGuard AI-\nBased Sandbox Service (FAIS). It works similar to inline scanning for the FortiSandbox\nappliance, by holding a file up to 50 seconds for the verdict to be returned. Timed out\nscans can either be set to block, log, or ignore. Inline scanning can be enabled from the\nGUI on the Cloud Sandbox configuration page.",
    "expected_values": "Disabled",
    "validation_logic": "On CLI:\nconfig system fortiguard\nget\nVerify if sandbox-inline-scan is enabled. Note that, sandbox-inline-scan will only\nshow up after sandbox region is set (this is done during initial setup). If there is no\nsandbox-inline-scan in the output, it means that this feature is not enabled.\nIf sandbox-inline-scan is enabled, check on CLI if it is enforced on AV security",
    "remediation_steps": "On GUI:\nEnable the FortiGate Cloud feature visibility:\n1. Go to System > Feature Visibility.\n2. In the Additional Features section, enable FortiGate Cloud Sandbox.\n3. Click Apply.\nConfigure the Cloud Sandbox Fabric connector:\n1. Go to Security Fabric > Fabric Connectors and double-click the Cloud\nSandbox card.\n2. Set the Type to FortiGate Cloud.\n3. Select a Region.\n4. Enable Inline scan.\n5. Click OK.\nConfigure the antivirus profile:\n1. Go to Security Profiles > AntiVirus and click Create New.\n2. Set the Feature set to Proxy-based.\n3. Enable the protocols to inspect.\n4. Enable Send files to FortiSandbox for inspection.\n5. Set the Scan strategy to Inline, and set the Action to Block.\n6. Click OK.\nOn CLI: Disable FortiSandbox appliance and FortiSandbox Cloud:\nconfig system fortisandbox\nset status disable\nend\nConfigure FortiGate Cloud Sandbox (example given is setting it as \"Global\" region):\n# execute forticloud-sandbox region\n0 Global\n1 Europe\n2 Japan\n3 US\nPlease select cloud sandbox region[0-3]:0\nCloud sandbox region is selected: Global\nEnable inline scanning for FortiGate Cloud:\nPage 116\nInternal Only - General\nconfig system fortiguard\nset sandbox-region \"Global\"\nset sandbox-inline-scan enable\nend\nEnforced on AV security profile:\nconfig antivirus profile edit set feature-set proxy set fortisandbox-mode inline config http\nset fortisandbox block end config ftp set fortisandbox block end config imap set\nfortisandbox block ..... end",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.2.0/new-features/599740/inline-\nscanning-with-fortiguard-ai-based-sandbox-service-7-2-1",
    "audit": "On CLI:\nconfig system fortiguard\nget\nVerify if sandbox-inline-scan is enabled. Note that, sandbox-inline-scan will only\nshow up after sandbox region is set (this is done during initial setup). If there is no\nsandbox-inline-scan in the output, it means that this feature is not enabled.\nIf sandbox-inline-scan is enabled, check on CLI if it is enforced on AV security",
    "rationale": "With FAIS, unknown malware can be detected and blocked using cloud sandboxing\ntechnology. Using inline scanning with FAIS, patient zero can also be prevented. This\ncomplements the existing antivirus signature-based detection and also acts as an\nadditional layer of defense on top of FortiGate's AV heuristics feature.",
    "impact": null
  },
  {
    "rule_id": "4.3",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "DNS Filter",
    "cis_level": "• Level 2",
    "description": "Enable Botnet C&C domain blocking to block botnet access at the DNS name resolving\nstage.",
    "expected_values": "\"Redirect botnet C&C requests to Block Portal\" is enabled on default profile.",
    "validation_logic": "On GUI:\n1. Review DNS filters under Security Profiles > DNS Filter and ensure that\n\"Redirect botnet C&C requests to Block Portal\" is enabled.\n2. Ensure that firewall policies allowing DNS traffic have a DNS Filter\nSecurity profile applied.",
    "remediation_steps": "On GUI:\n1. Go to Security Profiles > DNS Filter.\n2. On the relevant security profile name, double click. Enable \"Redirect\nbotnet C&C requests to Block Portal\".\n2. Ensure that firewall policies that have DNS traffic have a DNS Filter\nsecurity profile applied with that option enabled.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.2.0/administration-\nguide/105208/botnet-c-c-domain-blocking\nPage 119\nInternal Only - General",
    "audit": "On GUI:\n1. Review DNS filters under Security Profiles > DNS Filter and ensure that\n\"Redirect botnet C&C requests to Block Portal\" is enabled.\n2. Ensure that firewall policies allowing DNS traffic have a DNS Filter\nSecurity profile applied.",
    "rationale": "Blocking botnet website access at the DNS resolution stage provides an additional layer\nof defense.",
    "impact": null
  },
  {
    "rule_id": "8.7",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "Enable DNS Query Logging",
    "cis_level": "• Level 1",
    "description": "DNS filter should log all DNS queries and responses.",
    "expected_values": "Disabled\nPage 121\nInternal Only - General",
    "validation_logic": "GUI:\n1. Go to \"Security Profiles\" > \"DNS Filter\".\n2. Select relevant DNS Filter profile.\nValidate that \"Log all DNS queries and responses\" is enabled.\nCLI:\nFGT1 # config dnsfilter profile\nFGT1 (profile) # show\nValidate that \"set log-all-domain enable\" is configured on DNS Filter profile.",
    "remediation_steps": "Review DNS Filter Security Profiles and validate that \"Log all DNS queries and\nresponses\" is enabled.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://community.fortinet.com/t5/FortiGate/Technical-Tip-FortiGate-Static-DNS-\nfilter-behavior-in-logging/ta-p/223110",
    "audit": "GUI:\n1. Go to \"Security Profiles\" > \"DNS Filter\".\n2. Select relevant DNS Filter profile.\nValidate that \"Log all DNS queries and responses\" is enabled.\nCLI:\nFGT1 # config dnsfilter profile\nFGT1 (profile) # show\nValidate that \"set log-all-domain enable\" is configured on DNS Filter profile.",
    "rationale": "DNS filter should log all DNS queries and responses (whether the DNS category is\nblocked, monitored, or allowed). This enables SOC or security analysts to do further\ninvestigations on security incidents, especially on threat hunting or incident response\nactivities. Although there are many data sources that can provide DNS query logs (AD\nor EDR), this option should be enabled out of best practice and with the assumption that\nno other data source is available.",
    "impact": "By default, allowed DNS is not logged. This creates a data gap in threat hunting or\nincident response activities."
  },
  {
    "rule_id": "8.7",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "Enable DNS Query Logging",
    "cis_level": "• Level 1",
    "description": "Ensuring that traffic traversing to the Internet on the FortiGate has a DNS Filter security\nprofile inspecting it.",
    "expected_values": "Not Configured",
    "validation_logic": "Review firewall policies that handle traffic outbound to Internet has an DNS Filter\nsecurity profile assigned for inspection.",
    "remediation_steps": "Configure on \"Allowed\" firewall policies that handle traffic outbound to Internet to have\nan appropriate DNS Filter security profile applied to policies.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.2.0/administration-\nguide/243446/ngfw-policy",
    "audit": "Review firewall policies that handle traffic outbound to Internet has an DNS Filter\nsecurity profile assigned for inspection.",
    "rationale": "Traffic outbound to the Internet on the FortiGate should have firewall policies applied\nwith an DNS Filter security profile applied.",
    "impact": null
  },
  {
    "rule_id": "4.4",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "Application Control",
    "cis_level": "• Level 1",
    "description": "Ensure FortiGate Application Control blocks high risk applications to reduce attack\nsurface.",
    "expected_values": "All application category \"Action\" is set as \"Monitor\" by default.",
    "validation_logic": "GUI:\n1. Go to \"Security Profiles\" > \"Application Control\".\n2. Select App Control profile.\nValidate that \"P2P\" and \"Proxy\" category is blocked.",
    "remediation_steps": "Review Application Control Security Profiles and validate that \"P2P\" and \"Proxy\"\ncategory is blocked.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.2.0/administration-\nguide/19814/basic-category-filters-and-overrides\nPage 125\nInternal Only - General",
    "audit": "GUI:\n1. Go to \"Security Profiles\" > \"Application Control\".\n2. Select App Control profile.\nValidate that \"P2P\" and \"Proxy\" category is blocked.",
    "rationale": "High risk applications such as those in \"P2P\" and \"Proxy\" are known for spreading\nmalware. Some of this traffic is encrypted and therefore is able to bypass network\nsecurity inspection (for those without decryption implemented). Blocking these\napplications from running eliminates this risk.\nIf any application that falls under \"P2P\" and \"Proxy\" is required to be allowed based on\nan organization's policy, that specific application needs to be under \"Monitor\" mode in\nthe \"Application and Filter Override\" configuration.",
    "impact": null
  },
  {
    "rule_id": "14.6",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "Protect Information through Access Control Lists",
    "cis_level": "• Level 2",
    "description": "Ensure FortiGate Application Control blocks applications running on non-default ports.",
    "expected_values": "Disabled",
    "validation_logic": "On GUI:\n1. Go to \"Security Profiles\" > \"Application Control\".\n2. Select relevant App Control profile.\nValidate that \"Block applications detected on non-default ports\" option is enabled.",
    "remediation_steps": "GUI:\n1. Go to \"Security Profiles\" > \"Application Control\".\n2. Select relevant App Control profile.\nEnable \"Block applications detected on non-default ports\" option.\nOn CLI:\nFGT1 # config application list\nFGT1 (list) # edit <profile name>\nFGT1 (<profile name>) # set enforce-default-app-port enable",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.2.0/administration-\nguide/66882/port-enforcement-check\nPage 127\nInternal Only - General",
    "audit": "On GUI:\n1. Go to \"Security Profiles\" > \"Application Control\".\n2. Select relevant App Control profile.\nValidate that \"Block applications detected on non-default ports\" option is enabled.",
    "rationale": "Running applications on non-default ports is not directly a threat, but can be an\nindication of something unexpected. For example, HTTPS runs on port 443. Potentially,\nif an attacker starts a rogue HTTPS server on port 10443, it could be used for data\nexfiltration.",
    "impact": null
  },
  {
    "rule_id": "0.0",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "Explicitly Not Mapped",
    "cis_level": "• Level 1",
    "description": "Ensure no category is set to \"Allow\" on FortiGate Application Control.",
    "expected_values": "\"Unknown Applications\" category is set as \"Allow\".",
    "validation_logic": "On GUI:\n1. Review \"Security Profiles\" > \"Application Control\".\n2. Select the relevant App Control profile.\nValidate that no \"Allow\" action is set on any categories.",
    "remediation_steps": "On GUI:\n1. Go to \"Security Profiles\" > \"Application Control\".\n2. Select the relevant App Control profile.\n3. Change any categories with \"Allow\" action to \"Monitor\".",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.2.0/administration-\nguide/19814/basic-category-filters-and-overrides\nPage 129\nInternal Only - General",
    "audit": "On GUI:\n1. Review \"Security Profiles\" > \"Application Control\".\n2. Select the relevant App Control profile.\nValidate that no \"Allow\" action is set on any categories.",
    "rationale": "Any category that is set as \"Allow\" on Application Control will not be logged. This\ncreates a visibility gap on security investigation. This includes \"Unknown Applications\"\ncategory.",
    "impact": "Visibility gap, which affects incident forensics and response."
  },
  {
    "rule_id": "0.0",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "Explicitly Not Mapped",
    "cis_level": "• Level 1",
    "description": "Ensuring that traffic traversing between networks on the FortiGate have an Application\nControl security profile inspecting it.",
    "expected_values": "Not Configured",
    "validation_logic": "Review all firewall policies and ensure that traffic has an Application Control\nsecurity profile assigned for inspection.",
    "remediation_steps": "Configure on all \"Allowed\" firewall policies to have an appropriate Application\nControl security profile applied to policies.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.2.0/administration-\nguide/243446/ngfw-policy",
    "audit": "Review all firewall policies and ensure that traffic has an Application Control\nsecurity profile assigned for inspection.",
    "rationale": "Traffic moving between \"interfaces\" on the FortiGate should have firewall policies\napplied with an Application Control security profile applied.",
    "impact": null
  },
  {
    "rule_id": "5.1",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "Automation",
    "cis_level": "• Level 1",
    "description": "Default automation trigger configuration for when a high severity compromised host is\ndetected.",
    "expected_values": "Not enabled",
    "validation_logic": "GUI\nSecurity Fabric > Automation\nVerify Compromised Host Quarantine is enabled.",
    "remediation_steps": "GUI\nSecurity Fabric > Automation\nEdit and change Disabled to Enabled\nCLI\nPage 135\nInternal Only - General\nconfig system automation-action\nedit \"Quarantine on FortiSwitch + FortiAP\"\nset description \"Default automation action configuration for\nquarantining a MAC address on FortiSwitches and FortiAPs.\"\nset action-type quarantine\nnext\nedit \"Quarantine FortiClient EMS Endpoint\"\nset description \"Default automation action configuration for\nquarantining a FortiClient EMS endpoint device.\"\nset action-type quarantine-forticlient\nnext\nend\nconfig system automation-trigger\nedit \"Compromised Host - High\"\nset description \"Default automation trigger configuration for when a\nhigh severity compromised host is detected.\"\nnext\nend\nconfig system automation-stitch\nedit \"Compromised Host Quarantine\"\nset description \"Default automation stitch to quarantine a high\nseverity compromised host on FortiAPs, FortiSwitches, and FortiClient EMS.\"\nset status enable\nset trigger \"Compromised Host - High\"\nconfig actions\nedit 1\nset action \"Quarantine on FortiSwitch + FortiAP\"\nnext\nedit 2\nset action \"Quarantine FortiClient EMS Endpoint\"\nnext\nend\nnext\nend",
    "severity": null,
    "is_active": true,
    "references_text": null,
    "audit": "GUI\nSecurity Fabric > Automation\nVerify Compromised Host Quarantine is enabled.",
    "rationale": "By enabling this feature you protect your environment against compromised hosts.\nDefault automation stitch to quarantine a high severity compromised host on FortiAPs,\nFortiSwitches, and FortiClient EMS.\nPlease note that this is only applicable if you have Fortinet's solution ecosystem\n(FortiGate with FortiAP, FortiSwitches, or FortiClient EMS).",
    "impact": null
  },
  {
    "rule_id": "5.2",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "Fabric Connectors",
    "cis_level": "• Level 2",
    "description": "Ensure Root FortiGate is configured as security fabric root.",
    "expected_values": "Disabled\nPage 140\nInternal Only - General",
    "validation_logic": "Review through the GUI:\n1. Go to \"Security Fabric\" -> Fabric Connectors and then select \"Security\nFabric Setup\".\n2. Validate that the root FortiGate has status set to enabled and the\nSecurity Fabric Role set to \"Serve as Fabric Root\".\n3. Ensure that FortiAnalyzer settings are correct and that there is a defined\nFabric name as well as interfaces selected that will \"Allow other Security\nFabric Devices to Join\".",
    "remediation_steps": "Remediation through the GUI:\n1. Go to \"Security Fabric\" -> Fabric Connectors and then select \"Security\nFabric Setup\".\n2. On the root FortiGate, set the status to enabled and the Security Fabric\nRole to \"Serve as Fabric Root\".\n3. Configure FortiAnalyzer settings when prompted and define a Fabric name as\nwell as interfaces that will \"Allow other Security Fabric Devices to Join\".",
    "severity": null,
    "is_active": true,
    "references_text": null,
    "audit": "Review through the GUI:\n1. Go to \"Security Fabric\" -> Fabric Connectors and then select \"Security\nFabric Setup\".\n2. Validate that the root FortiGate has status set to enabled and the\nSecurity Fabric Role set to \"Serve as Fabric Root\".\n3. Ensure that FortiAnalyzer settings are correct and that there is a defined\nFabric name as well as interfaces selected that will \"Allow other Security\nFabric Devices to Join\".",
    "rationale": "Without a root FortiGate configured, the security fabric is not functional and can not be\nleveraged.\nPlease note that this is only applicable if security fabric function within FortiGate is used.",
    "impact": "Without Security Fabric enabled, visibility and management of traffic throughout an\norganization is decreased and individual FortiGate management becomes more\nintensive."
  },
  {
    "rule_id": "6.1",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "SSL VPN",
    "cis_level": "• Level 2",
    "description": "Apply a signed certificate from a trusted Certificate Authority (CA) to the SSL VPN portal\nto allow users to connect securely with confidence.",
    "expected_values": "Self Signed Factory installed certificate",
    "validation_logic": "GUI:\n1. Access the FortiGate administrative web access page.\n2. Go to VPN > SSL-VPN Settings and assign a signed certificate in the\ndropdown for \"Server Certificate\".",
    "remediation_steps": "Import a signed certificate from a trusted CA through the GUI:\n1. Go to System > Certificates > Import.\n2. Then assign the certificate to the SSL VPN portal by going to VPN > SSL-\nVPN Settings and selecting the proper certificate in the dropdown for \"Server\nCertificate\".",
    "severity": null,
    "is_active": true,
    "references_text": null,
    "audit": "GUI:\n1. Access the FortiGate administrative web access page.\n2. Go to VPN > SSL-VPN Settings and assign a signed certificate in the\ndropdown for \"Server Certificate\".",
    "rationale": "Having an unsigned or self signed certificate leaves connections open to man-in-the-\nmiddle attacks and could allow users to connect to untrusted servers.",
    "impact": null
  },
  {
    "rule_id": "12.2",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "Scan for Unauthorized Connections across Trusted",
    "cis_level": "• Level 2",
    "description": "Enable and disable TLS versions and Cipher suites for more granular control of SSL\nVPN connections and enforcing more secure connections.",
    "expected_values": "ssl-max-proto-ver : tls1-3\nssl-min-proto-ver : tls1-2\nalgorithm : high",
    "validation_logic": "CLI:\nconfig vpn ssl settings\nget\nValidate that:\nssl-max-prot-ver is set to tls1-3.\nssl-min-proto-ver is set to tls1-2.\nalgorithm is set to high.",
    "remediation_steps": "CLI:\nconfig vpn ssl settings\nset ssl-max-prot-ver tls1-3\nset ssl-min-proto ver tls1-2\nset algorithm high",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.2.0/cli-reference/362620/config-\nvpn-ssl-settings\nPage 146\nInternal Only - General",
    "audit": "CLI:\nconfig vpn ssl settings\nget\nValidate that:\nssl-max-prot-ver is set to tls1-3.\nssl-min-proto-ver is set to tls1-2.\nalgorithm is set to high.",
    "rationale": "Limiting TLS versions to more secure versions as well as enforcing stronger ciphers\nincreases the security of the SSL VPN connections.",
    "impact": null
  },
  {
    "rule_id": "7.1",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "Enable Logging",
    "cis_level": "• Level 2",
    "description": "Enabling event logging to allow for log generation and review.",
    "expected_values": "Enabled",
    "validation_logic": "CLI:\nconfig log eventfilter\nget\nValidate that all event types are enabled.",
    "remediation_steps": "On GUI:\n1. Go to Log & Report > Log Settings.\n2. Enable \"All\" Event Logging.\nOn CLI:\nconfig log eventfilter\nset event enable\nend",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.2.6/administration-guide/250999\nPage 150\nInternal Only - General",
    "audit": "CLI:\nconfig log eventfilter\nget\nValidate that all event types are enabled.",
    "rationale": "Enabling event logging generates logs that can be stored for later review or auditing or\ncan be ingested by another system (SIEM, Analyzer) for monitoring and response.",
    "impact": null
  },
  {
    "rule_id": "7.2",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "Encrypt Logs Sent to FortiAnalyzer / FortiManager",
    "cis_level": "• Level 1",
    "description": "Enable encryption for logs that are sent to FortiAnalyzer or FortiManager.",
    "expected_values": "Disabled",
    "validation_logic": "CLI:\nconfig log fortianalyzer setting\nget\nValidate enc-algorithm is set to high.\nValidate reliable is set enabled.",
    "remediation_steps": "Secure log transfer settings can only be configured on CLI:\nconfig log fortianalyzer setting\nset reliable enable\nset enc-algorithm high\nend",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortianalyzer/7.2.0/administration-\nguide/410387/appendix-b-log-integrity-and-secure-log-transfer\nPage 153\nInternal Only - General",
    "audit": "CLI:\nconfig log fortianalyzer setting\nget\nValidate enc-algorithm is set to high.\nValidate reliable is set enabled.",
    "rationale": "Provides encryption for logs that are sent to FortiAnalyzer or FortiManager to prevent\nlogs being collected and viewed as they traverse the network.",
    "impact": null
  },
  {
    "rule_id": "7.3",
    "benchmark": "CIS FortiGate 7.0.x Benchmark v1.4.0",
    "device_type": "FortiGate",
    "control_name": "Centralized Logging and Reporting",
    "cis_level": "• Level 2",
    "description": "Device logs should be sent to a centralized device for log collection, retention, and\nreporting. This could be a SIEM. syslog device, FortiAnalyzer, FortiManager, etc.",
    "expected_values": "Not configured.",
    "validation_logic": "On GUI:\n1. Go to Log & Report > Log Settings.\n2. Validate under \"Syslog logging\" that logs are being offloaded to another\ndevice.",
    "remediation_steps": "Configure a remote server for logs to be sent to:\n1. Go to Log & Report > Log Settings.\n2. Under \"Syslog logging\" configure a remote server to send logs to.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.2.6/administration-guide/250999",
    "audit": "On GUI:\n1. Go to Log & Report > Log Settings.\n2. Validate under \"Syslog logging\" that logs are being offloaded to another\ndevice.",
    "rationale": "Centralized logging allows for more reliable log retention and more enriched log data for\nreview and reporting.",
    "impact": null
  },
  {
    "rule_id": "1.1",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Ensure DNS server is configured",
    "cis_level": "• Level 1",
    "description": "Fortinet uses the Domain Name Service (DNS) to translate host names into IP\naddresses. To enable DNS lookups, you must specify the primary DNS server for your\nsystem. You can also specify secondary and tertiary DNS servers. When resolving host\nnames, the system consults the primary name server. If a failure or time-out occurs, the\nsystem consults the secondary name server.\nFor security purpose, trusted DNS servers should be configured to prevent man-in-the-\nmiddle attacks.",
    "expected_values": "Default primary DNS server is 96.45.45.45. Default secondary DNS server is\n96.45.46.46.",
    "validation_logic": "In CLI:\nFGT1 # config system dns\nFGT1 (dns) # show\nconfig system dns\nset primary <ip_address>\nset secondary <ip_address>\n...\nend\nIn the GUI, go to Networks > DNS. The FortiGate uses either the default FortiGuard\nDNS or customized DNS",
    "remediation_steps": "In this example, we will assign 8.8.8.8 as primary DNS and 8.8.4.4 as secondary DNS.\nIn CLI:\nFGT1 # config system dns\nFGT1 (dns) # set primary 8.8.8.8\nFGT1 (dns) # set secondary 8.8.4.4\nFGT1 (dns) # end\nFGT1 #\nIn the GUI, go to Networks > DNS. Click on \"Specify\" and put in 8.8.8.8 as \"Primary\nDNS Server\" and 8.8.4.4 as \"Secondary DNS Server\"\nPage 17",
    "severity": "Automated",
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.4.0/administration-guide/903162",
    "audit": "In CLI:\nFGT1 # config system dns\nFGT1 (dns) # show\nconfig system dns\nset primary <ip_address>\nset secondary <ip_address>\n...\nend\nIn the GUI, go to Networks > DNS. The FortiGate uses either the default FortiGuard\nDNS or customized DNS",
    "rationale": "The purpose is to perform the resolution of system hostnames to Internet Protocol (IP)\naddresses using trusted DNS servers.",
    "impact": null
  },
  {
    "rule_id": "1.2",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Ensure intra-zone traffic is not always allowed",
    "cis_level": "• Level 1",
    "description": "This is to make sure that only specific, authorized traffic is allowed between networks in\nthe same zone.",
    "expected_values": "By default, intra-zone traffic is blocked\nPage 19",
    "validation_logic": "In this example, we'll verify the zone DMZ. In CLI:\nFGT1 # config system zone\nFGT1 (zone) # edit DMZ\nFGT1 (DMZ) # show full\nconfig system zone\nedit \"DMZ\"\n...\nset intrazone deny\n...\nnext\nend\nIn the GUI, click on Network -> Interfaces, select the zone and click on \"Edit\". Make\nsure that the option \"Block intra-zone traffic\" is enabled.",
    "remediation_steps": "In this example, we'll turn off intra-zone traffic in the zone DMZ. In CLI:\nFGT1 # config system zone\nFGT1 (zone) # edit DMZ\nFGT1 (DMZ) # set intrazone deny\nFGT1 (DMZ) # end\nFGT1 #\nIn the GUI, click on Network -> Interfaces, select the zone and click on \"Edit\" and turn\non \"Block intra-zone traffic\"",
    "severity": "Manual",
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.4.5/cli-\nreference/314783845/config-system-zone\n2. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/116821",
    "audit": "In this example, we'll verify the zone DMZ. In CLI:\nFGT1 # config system zone\nFGT1 (zone) # edit DMZ\nFGT1 (DMZ) # show full\nconfig system zone\nedit \"DMZ\"\n...\nset intrazone deny\n...\nnext\nend\nIn the GUI, click on Network -> Interfaces, select the zone and click on \"Edit\". Make\nsure that the option \"Block intra-zone traffic\" is enabled.",
    "rationale": "This adds an extra layer of protection between different networks.",
    "impact": null
  },
  {
    "rule_id": "1.3",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Disable all management related services on WAN port",
    "cis_level": "• Level 1",
    "description": "Enabling any management related services on WAN interface is high risk. Management\nrelated services such as HTTPS, HTTP, ping, SSH, SNMP, and Radius should be\ndisabled on WAN.",
    "expected_values": null,
    "validation_logic": "On GUI:\nGo to \"Network\" > \"Interfaces\".\nIdentify WAN interface and validate that HTTPS, HTTP, PING, SSH, SNMP, and\nRadius Accounting is not enabled in \"Administrative Access\" section.\nOn CLI:\n`FGT1 # show system interface`\nIdentify WAN interface and validate that \"set allowaccess\" does not include ping, https,\nhttp, ssh, snmp or radius-acct configured.",
    "remediation_steps": "On GUI:\nGo to \"Network\" > \"Interfaces\".\nReview WAN interface and disable HTTPS, HTTP, ping, SSH, SNMP, and Radius\nservices.\nOn CLI:\nPage 21\nFGT1 # config system interface\nFGT1 (interface) # edit \"port1\"\nFGT1 (port1) # unselect allowaccess ping https ssh snmp http radius-acct\nNote:\n1. Interface name may differ based on deployment. For this example, port1 is\ndeployed as WAN interface.\n2. \"unselect allowaccess\" will only show services that you have enabled. If you\nhave not enabled snmp on that interface, then snmp option will not be available.",
    "severity": null,
    "is_active": true,
    "references_text": null,
    "audit": "On GUI:\nGo to \"Network\" > \"Interfaces\".\nIdentify WAN interface and validate that HTTPS, HTTP, PING, SSH, SNMP, and\nRadius Accounting is not enabled in \"Administrative Access\" section.\nOn CLI:\n`FGT1 # show system interface`\nIdentify WAN interface and validate that \"set allowaccess\" does not include ping, https,\nhttp, ssh, snmp or radius-acct configured.",
    "rationale": "Management related services should only be enabled on management interface. This is\npart of defending the firewall from attacks and reducing the attack surface. For WAN\nrelated services such as IPsec and SSLVPN, make use of local-in-policy (refer to CIS\nSection 2.4) to tighten firewall defenses.",
    "impact": "Enabling management related services on WAN port is convenient, but it exposes the\nfirewall to unnecessary risks. Vulnerabilities found on vendor devices are commonly\nrelated to management services, and opening access to these allows attackers to\nexploit its vulnerabilities."
  },
  {
    "rule_id": "2.1",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "General Settings",
    "cis_level": "• Level 1",
    "description": "Configure a pre-login banner, ideally approved by the organization’s legal team. This\nbanner should, at minimum, prohibit unauthorized access, provide notice of logging or\nmonitoring, and avoid using the word “welcome” or similar words of invitation.",
    "expected_values": "the 'Pre-Login Banner' is disabled by default\nFG1 # config system global\nFG1 (global) # show\nconfig system global\n...\nset pre-login-banner disable\n...\nend\nthe warning message default value is as follows:\nPRE WARNING:\nThis is a private computer system. Unauthorized access or use\nis prohibited and subject to prosecution and/or disciplinary\naction. All use of this system constitutes consent to\nmonitoring at all times and users are not entitled to any\nexpectation of privacy. If monitoring reveals possible evidence\nof violation of criminal statutes, this evidence and any other\nrelated information, including identification information about\nthe user, may be provided to law enforcement officials.\nIf monitoring reveals violations of security regulations or\nunauthorized use, employees who violate security regulations or\nmake unauthorized use of this system are subject to appropriate\ndisciplinary action.",
    "validation_logic": "Run the following command in the CLI to verify the pre-login-banner is enabled:\nFG1 # get system global\n...\npre-login-banner : enable\n...\nend\nIn the GUI, to verify the content of the pre-login disclaimer message:\n1) Go to 'System' -> 'Replacement Messages'\n2) From the top right side, select 'Extended View'\n3) Find 'Pre-login Disclaimer Message'",
    "remediation_steps": "Run the following command in the CLI to enable the pre-login-banner:\nFG1 # config system global\nFG1 (global) # set pre-login-banner enable\nFG1 (global) # end\nFG1 #\nIn the GUI, to edit the content of the pre-login disclaimer message:\nPage 25\n1. Go to 'System' -> 'Replacement Messages' -> 'Extended View' -> 'Pre-login\nDisclaimer Message'. The edit screen is on the bottom right corner of the page.\nClick on \"Save\" after the editing is done.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://community.fortinet.com/t5/FortiGate/Technical-Tip-Configuring-admin-\ndisclaimer-page/ta-p/198609?externalID=FD33887",
    "audit": "Run the following command in the CLI to verify the pre-login-banner is enabled:\nFG1 # get system global\n...\npre-login-banner : enable\n...\nend\nIn the GUI, to verify the content of the pre-login disclaimer message:\n1) Go to 'System' -> 'Replacement Messages'\n2) From the top right side, select 'Extended View'\n3) Find 'Pre-login Disclaimer Message'",
    "rationale": "Through a properly stated login banner, the risk of unintentional access to the device by\nunauthorized users is reduced. Should legal action take place against a person\naccessing the device without authorization, the login banner greatly diminishes a\ndefendant’s claim of ignorance.",
    "impact": "Login banners provide a definitive warning to any possible intruders who may want to\naccess the FortiGate that certain types of activity are illegal. At the same time, it also\nadvises the authorized and legitimate users of their obligations relating to acceptable\nuse."
  },
  {
    "rule_id": "0.0",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Explicitly Not Mapped",
    "cis_level": "• Level 1",
    "description": "Sets the banner after users successfully log in. This is equivalent to Message of the Day\n(MOTD) in some other systems.",
    "expected_values": "POST WARNING: This is a private computer system. Unauthorized access or use is\nprohibited and subject to prosecution and/or disciplinary action. All use of this system\nconstitutes consent to monitoring at all times and users are not entitled to any\nexpectation of privacy. If monitoring reveals possible evidence of violation of criminal\nstatutes, this evidence and any other related information, including identification\ninformation about the user, may be provided to law enforcement officials. If monitoring\nreveals violations of security regulations or unauthorized use, employees who violate\nsecurity regulations or make unauthorized use of this system are subject to appropriate\ndisciplinary action.\n%%LAST_SUCCESSFUL_LOGIN%% %%LAST_FAILED_LOGIN%%",
    "validation_logic": "Run the following command in the CLI to verify the post-login-banner is enabled:\nFG1 # get system global\n...\npost-login-banner : enable\n...\nIn the GUI, to verify the content of the post-login disclaimer message:\n1) Go to 'System' -> 'Replacement Messages'\n2) From the top right side, select 'Extended View'\n3) Find 'Post-login Disclaimer Message'",
    "remediation_steps": "Run the following command in the CLI to enable the post-login-banner:\nFG1 # config system global\nFG1 (global) # set post-login-banner enable\nFG1 (global) # end\nFG1 #\nIn the GUI, to edit the content of the post-login disclaimer message, go to\nPage 27\nSystem -> Replace Messages -> Extended View -> \"Post-login Disclaimer\nMessage\". The edit screen is on the bottom right corner of the page. Click on\n\"Save\" after the editing is done.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://community.fortinet.com/t5/FortiGate/Technical-Tip-Configuring-admin-\ndisclaimer-page/ta-p/198609?externalID=FD33887",
    "audit": "Run the following command in the CLI to verify the post-login-banner is enabled:\nFG1 # get system global\n...\npost-login-banner : enable\n...\nIn the GUI, to verify the content of the post-login disclaimer message:\n1) Go to 'System' -> 'Replacement Messages'\n2) From the top right side, select 'Extended View'\n3) Find 'Post-login Disclaimer Message'",
    "rationale": "Network banners are electronic messages that provide notice of legal rights to users of\ncomputer networks. From a legal standpoint, banners have four primary functions:\nFirst, banners may be used to generate consent to real-time monitoring under Title III.\nSecond, banners may be used to generate consent to the retrieval of stored files and\nrecords pursuant to ECPA. Third, in the case of government networks, banners may\neliminate any Fourth Amendment \"reasonable expectation of privacy\" that government\nemployees or other users might otherwise retain in their use of the government's\nnetwork under O'Connor v.",
    "impact": "When post-login banner is enabled, some automated-script might be affected because\nboth CLI and GUI need an acceptance action (press \"A\" or \"Accept\") to continue."
  },
  {
    "rule_id": "0.0",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Explicitly Not Mapped",
    "cis_level": "• Level 1",
    "description": "Sets the local time zone information so that the time displayed by the device is more\nrelevant to those who are viewing it.",
    "expected_values": "Default value is (GMT-8:00) Pacific Time (US & Canada)",
    "validation_logic": "In the CLI, do the following command and check the result of timezone filed in the\noutput\nFGT1 # get system global\n...\ntimezone : (GMT-8:00) Pacific Time (US & Canada)\n...\nOr from GUI, do the following:\n1) Login to FortiGate\n2) Go to 'System' -> 'Settings'.\n3) Time Zone and NTP settings are under 'System Time'",
    "remediation_steps": "In this example, we will set Eastern Timezone (GMT-5:00) for the Fortigate. Each\ntimezone will have its corresponding ID. To find the correct ID, when you type in the\ncommand \"set timezone \", also type the question mark '?' to list all of the available\ntimezones and their IDs. The ID of the Eastern Timezone is 12 In the CLI:\nPage 29\nFGT1 # config system global\nFGT1 (global) # set timezone 12\nFGT1 (global) # end\nFGT1 #\nIn the GUI, do the following:\n1) After login to fortigate, go to 'System' -> 'Settings'\n2) Select '(GMT-5:00) Eastern Time (US & Canada)' under 'System Time'",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://community.fortinet.com/t5/FortiGate/Technical-Tip-Setting-the-system-\ntime/ta-p/192907?externalID=FD49018\n2. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/512210",
    "audit": "In the CLI, do the following command and check the result of timezone filed in the\noutput\nFGT1 # get system global\n...\ntimezone : (GMT-8:00) Pacific Time (US & Canada)\n...\nOr from GUI, do the following:\n1) Login to FortiGate\n2) Go to 'System' -> 'Settings'.\n3) Time Zone and NTP settings are under 'System Time'",
    "rationale": "Having a correct time set on the device is important for two main reasons. The first\nreason is that digital certificates compare this time to the range defined by their Valid\nFrom and Valid To fields to define a specific validity period. The second reason is to\nhave relevant time stamps when logging information. Whether you are sending\nmessages to a Syslog server, sending messages to an SNMP monitoring station, or\nperforming packet captures, timestamps have little usefulness if you cannot be certain\nof their accuracy.",
    "impact": "For many features to work, including scheduling, logging, and SSL-dependent features,\nthe FortiOS system time must be accurate."
  },
  {
    "rule_id": "6.1",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Utilize Three Synchronized Time Sources",
    "cis_level": "• Level 1",
    "description": "You can either manually set the FortiOS system time, or configure the device to\nautomatically keep its system time correct by synchronizing with a Network Time\nProtocol (NTP) server.\nThese settings enable the use of primary and secondary NTP servers to provide\nredundancy in case of a failure involving the primary NTP server.",
    "expected_values": "By default, Fortinet uses the NTPs server of the FortiGuard",
    "validation_logic": "In the CLI:\nPage 31\nFGT1 # diag sys ntp status\nsynchronized: yes, ntpsync: enabled, server-mode: enabled\nipv4 server(ntp2.fortiguard.com) 208.91.114.23 -- reachable(0xff) S:3 T:54\nserver-version=4, stratum=1\nreference time is e12361d5.f27e0322 -- UTC Wed Sep 11 12:06:45 2019\nclock offset is -0.001569 sec, root delay is 0.000000 sec\nroot dispersion is 0.010269 sec, peer dispersion is 19 msec\nipv4 server(ntp1.fortiguard.com) 208.91.115.123 -- reachable(0xff) S:3 T:54\nselected\nserver-version=4, stratum=1\nreference time is e12361d4.4f8b22a5 -- UTC Wed Sep 11 12:06:44 2019\nclock offset is -0.000652 sec, root delay is 0.000000 sec\nroot dispersion is 0.010284 sec, peer dispersion is 8 msec\nipv4 server(ntp2.fortiguard.com) 208.91.113.71 -- reachable(0xff) S:3 T:54\nserver-version=4, stratum=2\nreference time is e12361d6.4caf57ab -- UTC Wed Sep 11 12:06:46 2019\nclock offset is -0.004814 sec, root delay is 0.000137 sec\nroot dispersion is 0.011154 sec, peer dispersion is 3 msec\nipv4 server(ntp1.fortiguard.com) 208.91.113.70 -- reachable(0xff) S:3 T:54\nserver-version=4, stratum=2\nreference time is e123617b.c98e2059 -- UTC Wed Sep 11 12:05:15 2019\nclock offset is -0.005106 sec, root delay is 0.000122 sec\nroot dispersion is 0.013382 sec, peer dispersion is 6 msec",
    "remediation_steps": "You can only customize NTP setting using CLI. In this example, we'll assign\npool.ntp.org as primary NTP server and 1.1.1.1 as secondary NTP server.\nFGT1 # config system ntp\nFGT1 (ntp) # set type custom\nFGT1 (ntp) # config ntpserver\nFGT1 (ntpserver) # edit 1\nFGT1 (1) # set server pool.ntp.org\nFGT1 (1) # next\nFGT1 (ntpserver) # edit 2\nFGT1 (2) # set server 1.1.1.1\nFGT1 (2) # end\nFGT1 (ntp) # end\nFGT1 #",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://community.fortinet.com/t5/FortiGate/Technical-Tip-Setting-the-system-\ntime/ta-p/192907?externalID=FD49018\n2. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/512210\nPage 32",
    "audit": "In the CLI:\nPage 31\nFGT1 # diag sys ntp status\nsynchronized: yes, ntpsync: enabled, server-mode: enabled\nipv4 server(ntp2.fortiguard.com) 208.91.114.23 -- reachable(0xff) S:3 T:54\nserver-version=4, stratum=1\nreference time is e12361d5.f27e0322 -- UTC Wed Sep 11 12:06:45 2019\nclock offset is -0.001569 sec, root delay is 0.000000 sec\nroot dispersion is 0.010269 sec, peer dispersion is 19 msec\nipv4 server(ntp1.fortiguard.com) 208.91.115.123 -- reachable(0xff) S:3 T:54\nselected\nserver-version=4, stratum=1\nreference time is e12361d4.4f8b22a5 -- UTC Wed Sep 11 12:06:44 2019\nclock offset is -0.000652 sec, root delay is 0.000000 sec\nroot dispersion is 0.010284 sec, peer dispersion is 8 msec\nipv4 server(ntp2.fortiguard.com) 208.91.113.71 -- reachable(0xff) S:3 T:54\nserver-version=4, stratum=2\nreference time is e12361d6.4caf57ab -- UTC Wed Sep 11 12:06:46 2019\nclock offset is -0.004814 sec, root delay is 0.000137 sec\nroot dispersion is 0.011154 sec, peer dispersion is 3 msec\nipv4 server(ntp1.fortiguard.com) 208.91.113.70 -- reachable(0xff) S:3 T:54\nserver-version=4, stratum=2\nreference time is e123617b.c98e2059 -- UTC Wed Sep 11 12:05:15 2019\nclock offset is -0.005106 sec, root delay is 0.000122 sec\nroot dispersion is 0.013382 sec, peer dispersion is 6 msec",
    "rationale": "NTP enables the device to maintain accurate time and date when receiving updates\nfrom a reliable NTP server. Accurate timestamps are critical when correlating events\nwith other systems, troubleshooting, or performing investigative work. Logs and certain\ncryptographic functions, such as those utilizing certificates, rely on accurate time and\ndate parameters. In addition, rules referencing a Schedule object will not function as\nintended if the device’s time and date are incorrect. For additional security,\nauthenticated NTP can be utilized. If Symmetric Key authentication is selected, only\nSHA1 should be used, as MD5 is considered severely compromised.",
    "impact": "For many features to work, including scheduling, logging, and SSL-dependent features,\nthe FortiOS system time must be accurate."
  },
  {
    "rule_id": "6.1",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Utilize Three Synchronized Time Sources",
    "cis_level": "• Level 1",
    "description": "Changes the device default hostname.",
    "expected_values": "The default value of the hostname is the model number of the unit. Example: 'FortiGate\n2000E'",
    "validation_logic": "In CLI\nget system global\n...\nhostname : FG1\n...\nIn GUI\n1) Go to 'System' > 'Settings'\n2) Check the field 'Hostname'",
    "remediation_steps": "In CLI, set the hostname to 'New_FGT1' as follows:\nFGT1 # config system global\nFGT1 (global) # set hostname \"New_FGT1\"\nFGT1 (global) # end\nNew_FGT1 #\nIn GUI\n1) Go to 'System' > 'Settings'\n2) Update the field 'Hostname' with the new hostname\n3) click 'Apply'",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://community.fortinet.com/t5/FortiGate/Technical-Tip-Renaming-the-\nhostname/ta-p/198521?externalID=FD48765\nPage 34",
    "audit": "In CLI\nget system global\n...\nhostname : FG1\n...\nIn GUI\n1) Go to 'System' > 'Settings'\n2) Check the field 'Hostname'",
    "rationale": "The device hostname plays an important role in asset inventory and identification as a\nsecurity requirement. It is also crucial in the public keys and certificate deployments, as\nwell as when correlating logs from different systems during an incident handling.",
    "impact": null
  },
  {
    "rule_id": "0.0",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Explicitly Not Mapped",
    "cis_level": "• Level 2",
    "description": "Check against the Fortinet website to make sure that the latest stable firmware is\ninstalled.",
    "expected_values": "There is no default firmware. The hardware comes with the latest firmware at the time it\nwas manufactured.",
    "validation_logic": "First, check for the latest firmware version available by going to\nhttps://docs.fortinet.com/upgrade-tool, select your product from the Current Product\ndrop-down menu, then select the upgrade to FortiOS Version for the latest available\nversion.\nSecond, verify the current firmware on your system. In the CLI:\nFGT1 # get system status\n...\nVersion: Fortigate-100D v6.2.7,build1190,201216 (GA)\n...\nFGT1 #\nIn the GUI:\n1. Go to Dashboard > Status > System information\n2. Check for firmware.\nAt the same time, go to https://www.fortiguard.com/psirt?product=FortiOS and check for\nvulnerabilities that your existing version might have.",
    "remediation_steps": "First, determine the upgrade path recommended by Fortinet. If you have not upgraded\nthe system for a long time, it is not recommended to upgrade straight to the latest\nversion, as the configuration could be lost. Fortinet provides a tool to recommend an\nupgrade path for all of its products.\nPage 36\nGo to https://docs.fortinet.com/upgrade-tool. Choose your product from the \"Current\nProduct\" drop-down menu, the \"current FortiOS version\", and the latest firmware\nversion available for that model from \"Upgrade to FortiOS Version\". Click \"Go\". Write\ndown the path and then click on \"Download\" to download all the necessary versions.\nThe second step is to download the required FortiOS firmware/s. Go to\nhttps://support.fortinet.com and login. Go to Support -> Firmware Download. Once\nthere, select the product and click on \"Upgrade Path\". Choose the specific model of the\nhardware, the current firmware version and the latest firmware version available for that\nmodel. Click \"Go\". Write down the path and then click on \"Download\" to download all\nthe necessary versions.\nThe last step is to install the new firmwares in the order provided by the \"Upgrade tool\".\nIt is recommended to use GUI to perform this task as it would be much easier.\nIn the GUI\n1. Go to System > Fabric Management\n2. Right click on device that needs to be upgraded.\n3. Then click on \"Upgrade\". You might have to perform this step multiple\ntimes if you follow the upgrade path.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://community.fortinet.com/t5/FortiGate/Technical-Tip-How-to-upgrade-\nFortiGate-firmware/ta-p/194980?externalID=10948",
    "audit": "First, check for the latest firmware version available by going to\nhttps://docs.fortinet.com/upgrade-tool, select your product from the Current Product\ndrop-down menu, then select the upgrade to FortiOS Version for the latest available\nversion.\nSecond, verify the current firmware on your system. In the CLI:\nFGT1 # get system status\n...\nVersion: Fortigate-100D v6.2.7,build1190,201216 (GA)\n...\nFGT1 #\nIn the GUI:\n1. Go to Dashboard > Status > System information\n2. Check for firmware.\nAt the same time, go to https://www.fortiguard.com/psirt?product=FortiOS and check for\nvulnerabilities that your existing version might have.",
    "rationale": "Fortinet periodically updates the FortiGate firmware to include new features and resolve\nimportant issues. After you have registered your FortiGate unit, firmware updates can\nbe downloaded from the Fortinet Customer Service & Support website.\nIt is important to constantly keep the firmware up to date to prevent any new well-known\nexploitation.",
    "impact": null
  },
  {
    "rule_id": "11.4",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Install the Latest Stable Version of Any Security-",
    "cis_level": "• Level 2",
    "description": "Disable USB port auto install feature for config and firmware.",
    "expected_values": "auto-install is enabled by default.",
    "validation_logic": "CLI:\nconfig system auto-install\nget\nVerify that set auto-install-config and set auto-install-image are disabled",
    "remediation_steps": "CLI:\nconfig system auto-install\nset auto-install-config disable\nset auto-install-image disable\nend",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.4.5/cli-\nreference/304730529/config-system-auto-install\nPage 39",
    "audit": "CLI:\nconfig system auto-install\nget\nVerify that set auto-install-config and set auto-install-image are disabled",
    "rationale": "Disabling USB port for auto install prevents a USB with a manipulated configuration or\nincorrect firmware from being connected and loaded automatically.",
    "impact": null
  },
  {
    "rule_id": "11.3",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Use Automated Tools to Verify Standard Device",
    "cis_level": "• Level 2",
    "description": "Disable support for static keys on TLS sessions terminating on the FortiGate",
    "expected_values": "ssl-static-key-ciphers is enabled",
    "validation_logic": "CLI:\nconfig system global\nget\nValidate that ssl-static-key-ciphers disabled.",
    "remediation_steps": "CLI:\nconfig system global\nset ssl-static-key-ciphers disable\nend",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.4.5/cli-\nreference/339914554/config-system-global",
    "audit": "CLI:\nconfig system global\nget\nValidate that ssl-static-key-ciphers disabled.",
    "rationale": "Prevent TLS sessions terminating on the FortiGate from using static SSL keys",
    "impact": null
  },
  {
    "rule_id": "12.4",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Deny Communication over Unauthorized Ports",
    "cis_level": "• Level 2",
    "description": "Enable FortiOS to only use strong encryption and allow only strong ciphers for\ncommunication",
    "expected_values": "strong-crypto is enabled by default.",
    "validation_logic": "CLI:\nconfig system global\nget\nValidate strong-crypto is enabled.",
    "remediation_steps": "CLI:\nconfig system global\nset strong-crypto enable\nend",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.4.5/cli-\nreference/339914554/config-system-global",
    "audit": "CLI:\nconfig system global\nget\nValidate strong-crypto is enabled.",
    "rationale": null,
    "impact": null
  },
  {
    "rule_id": "18.5",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Use Only Standardized and Extensively Reviewed",
    "cis_level": "• Level 1",
    "description": "As we move towards better encryption capabilities, we need to also ensure GUI access\nis properly secured. TLS 1.3 is currently the most secure SSL/TLS supported version for\nSSL-encrypted administrator access (at this time of writing).",
    "expected_values": "FortiOS 7.x - TLS 1.2 and 1.3 enabled\nFortiOS 6.x - TLS 1.1, 1.2, and 1.3 enabled",
    "validation_logic": "CLI:\nconfig system global\nget\nVerify if set admin-https-ssl-versions tlsv1-3 is configured.",
    "remediation_steps": "CLI:\nconfig system global\nset admin-https-ssl-versions tlsv1-3",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.4.5/cli-\nreference/339914554/config-system-global",
    "audit": "CLI:\nconfig system global\nget\nVerify if set admin-https-ssl-versions tlsv1-3 is configured.",
    "rationale": "Use higher version of SSL/TLS to prevent MiTM attacks.",
    "impact": null
  },
  {
    "rule_id": "0.0",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Explicitly Not Mapped",
    "cis_level": "• Level 2\n• Level 1",
    "description": "To improve GUI performance, an option is added to enable loading static GUI artifacts\ncached in CDN (content delivery network) servers closer to the user rather than from\nthe FortiGate. On failure, the files can fall back to loading from the FortiGate.\nAdd log-single-cpu-high option under config system global. When enabled, CPU single\ncore usage will be polled every three seconds, and any single CPU core usage above\nthe CPU usage threshold will report an event log. If a core is reported, that core will not\nbe checked again for the next 30 seconds.",
    "expected_values": "Enabled\nDisabled",
    "validation_logic": "On CLI:\nconfig system global\nget\nEnsure that gui-cdn-usage is enabled.\nOn CLI:\nconfig system global\nget\nEnsure that log-single-cpu-high is enabled.",
    "remediation_steps": "On CLI:\nconfig system global\nset gui-cdn-usage enable\nend\nOn CLI:\nconfig system global\nset log-single-cpu-high enable\nend",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.4.5/administration-\nguide/205105/loading-artifacts-from-a-cdn\nPage 46\n2.1.12 Ensure single CPU core overloaded event is logged\n(Automated)\n1. https://community.fortinet.com/t5/FortiGate/Technical-Tip-Enable-logging-for-\nsingle-core-CPU-spike-against/ta-p/293010\n2. https://docs.fortinet.com/document/fortigate/7.2.4/fortios-release-\nnotes/743723/new-features-or-enhancements\nPage 47",
    "audit": "On CLI:\nconfig system global\nget\nEnsure that gui-cdn-usage is enabled.\nOn CLI:\nconfig system global\nget\nEnsure that log-single-cpu-high is enabled.",
    "rationale": "When accessing a remote FortiGate, GUI might experience some slowness due to\ngeographical distance. For this case, loading static GUI artifacts cached in CDN servers\nwill provide a better GUI / web management experience.\nThere are instances where overall CPU usage is low, but there is a single CPU core\nthat is overloaded. But because reporting and dashboard in FortiGate shows the overall\nCPU usage, a single CPU core spike may get overlooked on a FortiGate with multiple\nCPU cores. This causes performance issues where there are instances which traffic has\nbeen stopped processing.",
    "impact": "This is not a security control recommendation. Hence, there is no impact if this is not\nenabled."
  },
  {
    "rule_id": "6.2",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Activate audit logging",
    "cis_level": "• Level 2",
    "description": "Ensure that the device hostname is not displayed on the GUI login page",
    "expected_values": "Default Value for \"gui-display-hostname\" is disable\nPage 49",
    "validation_logic": "From the CLI run the command:\nFGT1 # get system global | grep -f gui-display\ngui-display-hostname: disable <---\nIf \"gui-display-hostname\" is set to disable the hostname will not be displayed on the\nlogin screen",
    "remediation_steps": "To disable \"gui-display-hostname\"\nIn the CLI:\nFGT1 # config system global\nFGT1 (global) # set gui-display-hostname disable\nFGT1 (global) # end\nFGT1 #",
    "severity": null,
    "is_active": true,
    "references_text": null,
    "audit": "From the CLI run the command:\nFGT1 # get system global | grep -f gui-display\ngui-display-hostname: disable <---\nIf \"gui-display-hostname\" is set to disable the hostname will not be displayed on the\nlogin screen",
    "rationale": "The hostname of the device may be displayed on the GUI login page which may provide\ninformation for reconnaissance",
    "impact": null
  },
  {
    "rule_id": "2.2",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Password Policy",
    "cis_level": "• Level 1",
    "description": "It is important to use secure and complex passwords for preventing unauthorized\naccess to the FortiGate device.",
    "expected_values": "By default, 'Password Policy' is disabled. It can be checked from CLI as follows:\nconfig system password-policy\nset status disable\nend\nOr from GUI as follows:\n1) Log in to FortiGate as Super Admin\n2) Go to 'System' > 'Settings'\n3) Find the 'Password Policy' section\n4) Default 'Password scope' is 'Off'",
    "validation_logic": "Currently implemented password policy can be shown from GUI or CLI\nFrom CLI, type:\nget system password-policy\nOr from GUI as follows:\n1) Log in to FortiGate with a user with at least read-only privileges\n2) Go to 'System' > 'Settings'\n3) Find and check the status of the 'Password Policy' Section\n4) Ensure 'Password scope' is 'Both'\n5) Ensure 'Minimum length' to '14'\nThe recent update by NIST on password policy has shifted focus to password length,\nsince longer passwords are harder to crack with brute-force attacks. Not enforcing\npassword complexity such as symbols and numbers can be easier for users to\nremember without being predictable.\nNIST also is now recommending password resets in the case of a credential breach\nonly.",
    "remediation_steps": "Can be modified from CLI or GUI.\nPage 51\nFrom CLI, do the following:\nconfig system password-policy\nset status enable\nset apply-to admin-password ipsec-preshared-key\nset minimum-length 14\nend\nOr from GUI, do the following:\n1) Log in to FortiGate as Super Admin\n2) Go to 'System' > 'Settings'\n3) Find the 'Password Policy' section\n4) Default 'Password scope' is 'Off', change it to 'Both'\n5) set 'Minimum length' to '14'",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://pages.nist.gov/800-63-4/sp800-63b.html\n2. https://docs.fortinet.com/document/fortigate/7.4.5/cli-\nreference/127236326/config-system-password-policy\n3. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/364729",
    "audit": "Currently implemented password policy can be shown from GUI or CLI\nFrom CLI, type:\nget system password-policy\nOr from GUI as follows:\n1) Log in to FortiGate with a user with at least read-only privileges\n2) Go to 'System' > 'Settings'\n3) Find and check the status of the 'Password Policy' Section\n4) Ensure 'Password scope' is 'Both'\n5) Ensure 'Minimum length' to '14'\nThe recent update by NIST on password policy has shifted focus to password length,\nsince longer passwords are harder to crack with brute-force attacks. Not enforcing\npassword complexity such as symbols and numbers can be easier for users to\nremember without being predictable.\nNIST also is now recommending password resets in the case of a credential breach\nonly.",
    "rationale": "Attackers can use brute force password software to launch more than just dictionary\nattacks. Such attacks can discover common passwords where a letter is replaced by a\nnumber or symbol. Center for Internet Security (CIS) recommends that passwords\nshould be at least 14 characters long with no limit on the enforced maximum number of\ncharacters",
    "impact": "Weak passwords can be easily discovered by hackers, which leads to unauthorized\naccess to FortiGate. Depending on the access privilege of the compromised account,\nthe attacker may modify important settings."
  },
  {
    "rule_id": "4.4",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Use Unique Passwords",
    "cis_level": "• Level 1",
    "description": "Failed login attempts can indicate malicious attempts to gain access to your network. To\nprevent this security risk, FortiGate is preconfigured to limit the number of failed\nadministrator login attempts. After the maximum number of failed login attempts is\nreached, access to the account is blocked for the configured lockout period.",
    "expected_values": "By default, the number of password retry attempts is set to three, allowing the\nadministrator a maximum of three attempts at logging in to their account before they are\nlocked out for a set amount of time (by default, 60 seconds).",
    "validation_logic": "To check the lockout options, from CLI:\nget system global\nfrom the output, check the value of the below fields:\n1. admin-lockout-threshold\n2. admin-lockout-duration\nEnsure that admin-lockout-threshold is set at 3 or less and admin-lockout-\nduration is set at 900 or less",
    "remediation_steps": "To configure the lockout options, from CLI:\nconfig system global\nset admin-lockout-threshold 3\nset admin-lockout-duration 900\nend\nLockout affects the offending IP address, not the entire account.\nPage 54",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.4.5/cli-\nreference/339914554/config-system-global",
    "audit": "To check the lockout options, from CLI:\nget system global\nfrom the output, check the value of the below fields:\n1. admin-lockout-threshold\n2. admin-lockout-duration\nEnsure that admin-lockout-threshold is set at 3 or less and admin-lockout-\nduration is set at 900 or less",
    "rationale": "When you log in and fail to enter the correct password, you could potentially be a valid\nuser or a hacker attempting to gain access. For this reason, best practice dictates\nlimiting the number of failed login attempts before a lockout period in which you cannot\nlog in for a certain period of time. Lockout period will minimize hacker attempts to gain\naccess to the firewall.",
    "impact": "Attackers will keep attempting to access the device through brute force attacks without\nany interruption, which may lead to a successful login."
  },
  {
    "rule_id": "2.3",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "SNMP",
    "cis_level": "• Level 1",
    "description": "Ensuring that only SNMPv3 service is enabled and SNMPv1, SNMPv2c are disabled.",
    "expected_values": "By default, SNMP agent is disabled.",
    "validation_logic": "From CLI, check to make sure that there is not any community for SNMPv1 or\nSNMPv2c and only SNMPv3 users are there. Also make sure that SNMP Agent is\nenabled:\nPage 57\nFGT1 # config system snmp sysinfo\nFGT1 (sysinfo) # show\nconfig system snmp sysinfo\nset status enable\n...\nend\nFGT1 (sysinfo) # end\nFGT1 # config system snmp community\nFGT1 (community) # show\nconfig system snmp community\nend\nFGT1 (community) # end\nFGT1 # config system snmp user\nFGT1 (user) # show\nconfig system snmp user\nedit \"snmp_test\"\nset security-level auth-priv\nset auth-proto sha256\nset auth-pwd ENC xxxxxx\nset priv-proto aes256\nset priv-pwd ENC xxxxxx\nnext\nend\nIn the GUI, go to:\n1. System > SNMP. Make sure that SNMP agent is enabled.\n2. Make sure that there is not any SNMPv1/2c community.\n3. Make sure that there is at least 1 SNMPv3 user in the list.",
    "remediation_steps": "To enable SNMP agent in CLI:\nFGT1 # config system snmp sysinfo\nFGT1 (sysinfo) # set status enable\nFGT1 (sysinfo) # end\nIn GUI, go to System > SNMP and enable SNMP Agent.\nTo delete SNMPv1/2c communities. In this example, we'll delete community \"public\" in\nCLI:\nFirst, to identify the community, run\nFGT1 # config system snmp community\nFGT1 (community) # show\nconfig system snmp community\nedit 1\nset name \"public\"\nconfig hosts\nedit 1\nnext\nend\nnext\nend\nThis shows that the community public has ID 1\nPage 58\nFGT1 # config system snmp community\nFGT1 (community) # delete 1\nFGT1 (community) # end\nFGT #\nIn the GUI, go to:\nSystem > SNMP, select the community and click on the Delete button.\nTo add SNMPv3 user in CLI:\nFGT1 # config system snmp user\nFGT1 (user) # edit \"snmp_test\"\nFGT1 (snmp_test) # set security-level auth-priv\nFGT1 (snmp_test) # set auth-proto sha256\nFGT1 (snmp_test) # set auth-pwd xxxx\nFGT1 (snmp_test) # set priv-proto aes256\nFGT1 (snmp_test) # set priv_pwd xxxx\nFGT1 (snmp_test) # end\nFGT1 #\nIn the GUI, go to:\n1. System > SNMP, under SNMPv3, click on \"Create New\" button.\n2. Select \"Authentication\" and choose SHA256 as Authentication algorithm.\n3. Click \"Change\" to type in the password.\n4. Also select option \"Private\", choose AES256 as Encryption Algorithm.\n5. Click on \"Change\" to change the password. Click \"OK\" to add the new user.\n6. Click apply to apply the new setting into the current config.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://community.fortinet.com/t5/FortiGate/Technical-Tip-How-to-Configure-\nFortiGate-SNMP-Agent-for/ta-p/196866?externalID=FD45755\n2. https://docs.fortinet.com/document/fortigate/7.4.5/administration-\nguide/325005/basic-configuration",
    "audit": "From CLI, check to make sure that there is not any community for SNMPv1 or\nSNMPv2c and only SNMPv3 users are there. Also make sure that SNMP Agent is\nenabled:\nPage 57\nFGT1 # config system snmp sysinfo\nFGT1 (sysinfo) # show\nconfig system snmp sysinfo\nset status enable\n...\nend\nFGT1 (sysinfo) # end\nFGT1 # config system snmp community\nFGT1 (community) # show\nconfig system snmp community\nend\nFGT1 (community) # end\nFGT1 # config system snmp user\nFGT1 (user) # show\nconfig system snmp user\nedit \"snmp_test\"\nset security-level auth-priv\nset auth-proto sha256\nset auth-pwd ENC xxxxxx\nset priv-proto aes256\nset priv-pwd ENC xxxxxx\nnext\nend\nIn the GUI, go to:\n1. System > SNMP. Make sure that SNMP agent is enabled.\n2. Make sure that there is not any SNMPv1/2c community.\n3. Make sure that there is at least 1 SNMPv3 user in the list.",
    "rationale": "SNMP Version 3 provides security enhancements that are not available in SNMP\nVersion 1 or SNMP Version 2c. SNMP Versions 1 and 2c transmit data between the\nSNMP server and SNMP agent in clear text. SNMP Version 3 adds authentication and\nprivacy options to secure protocol operations. Some firewalls need to be constantly\nmonitored of its performance and status, especially if the firewalls are critical to the\noperation. Enabling SNMPv3 will ensure that the firewall is monitored properly.",
    "impact": "Some older SNMP servers that only run SNMPv1 or SNMPv2c will not be able to query\nto this firewall."
  },
  {
    "rule_id": "11.5",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Manage Network Devices Using Multi-Factor",
    "cis_level": "• Level 2",
    "description": "Ensuring that only certain hosts are able to conduct SNMP GET or receive SNMP Trap.",
    "expected_values": "By default, no SNMP is configured.",
    "validation_logic": "From CLI:\nFGT1 # show system snmp user\nconfig system snmp user\nedit \"snmp_test\"\nset notify-hosts 192.168.1.101\nset security-level auth-priv\nset auth-proto sha512\nset auth-pwd ENC xxxxx\nset priv-proto aes256\nset priv-pwd ENC xxxxx\nnext\nend\nValidate that \"notify-hosts\" is configured with specific IP address, and there is no\n\"0.0.0.0\" configured.\nFrom GUI:\n1. System > SNMP.\n2. On SNMPv3 section, double click on the configured SNMPv3 settings.\n3. Ensure that \"Hosts\" is configured with specific IP address, and there is\nno \"0.0.0.0\" configured.",
    "remediation_steps": "To remove 0.0.0.0 from trusted hosts in CLI:\nFGT1 # config system snmp user\nFGT1 (user) # edit \"snmp_test\"\nFGT1 (snmp_test) # unselect notify-hosts 0.0.0.0\nFGT1 (snmp_test) # end\nFGT1 #\nFrom GUI:\nPage 61\n1. System > SNMP.\n2. On SNMPv3 section, double click on the configured SNMPv3 settings.\n3. Remove 0.0.0.0 from \"Hosts\" option.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.4.5/administration-\nguide/325005/basic-configuration",
    "audit": "From CLI:\nFGT1 # show system snmp user\nconfig system snmp user\nedit \"snmp_test\"\nset notify-hosts 192.168.1.101\nset security-level auth-priv\nset auth-proto sha512\nset auth-pwd ENC xxxxx\nset priv-proto aes256\nset priv-pwd ENC xxxxx\nnext\nend\nValidate that \"notify-hosts\" is configured with specific IP address, and there is no\n\"0.0.0.0\" configured.\nFrom GUI:\n1. System > SNMP.\n2. On SNMPv3 section, double click on the configured SNMPv3 settings.\n3. Ensure that \"Hosts\" is configured with specific IP address, and there is\nno \"0.0.0.0\" configured.",
    "rationale": "SNMP offers rich information that can be useful for reconnaissance activity. Hence,\nlimiting this information to only relevant devices such as NMS (Network Monitoring\nSystem) or other SNMP servers is necessary.",
    "impact": null
  },
  {
    "rule_id": "12.2",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Scan for Unauthorized Connections across Trusted",
    "cis_level": "• Level 2\n• Level 1",
    "description": "Disabling SNMP query for SNMPv3 Users that only need to receive SNMP traps\nEnabling SNMP traps for memory usage monitoring helps detect anomalies and ensure\ncritical security features remain operational. This proactive approach enhances system\nreliability by alerting administrators to potential resource issues.",
    "expected_values": "By Default SNMPv3 Users allow Queries\nPage 64\n2.3.4 Enabling SNMP trap for memory usage (Automated)\ntrap-free-memory-threshold is set to 5 trap-freeable-memory-threshold is set to 60",
    "validation_logic": "From CLI:\nconfig system snmp user\nedit \"snmp_test\"\nset queries disable\nset notify-hosts 192.168.1.101\nset security-level auth-priv\nset auth-proto sha512\nset auth-pwd ENC xxxxxx\nset priv-proto aes256\nset priv-pwd ENC xxxxxx\nnext\nend\nValidate that \"set queries\" is disabled\nFrom GUI:\n1. System > SNMP\n2. On SNMPv3 settings double click on the SNMPv3 user to modify\n3. Ensure that the slider for \"Queries\" is disabled\nIn the example below, SNMP trap will trigger once memory usage is above 80% (less\nthan 20% free memory), and the freeable memory is more than 35% (memory that can\nbe reclaimed by the system when needed).\nFrom CLI, enable SNMP trap trap-free-memory-threshold and trap-freeable-memory-\nthreshold.\nFGT1 # config system snmp sysinfo\nFGT1 (sysinfo) # show\nconfig system snmp sysinfo\nset status enable\nset trap-free-memory-threshold 20\nset trap-freeable-memory-threshold 50\nend",
    "remediation_steps": "To disable Queries for a specific SNMPv3 User in CLI:\n{snmp_test is the example SNMPv3 username}\nFGT1 # config system snmp user\nFGT1 (user) # edit snmp_test\nFGT1 (snmp_test) # set queries disable\nFGT1 (snmp_test) # next\nFGT1 (user) # end\nTo disable Queries for a specific SNMPv3 User in GUI:\nPage 63\n1. System > SNMP\n2. Under the SNMPv3 section select the specific user and double click or\nsingle click and select edit\n3. Under the Queries section click the slider for \"Enabled\" so it is turned\noff\nTo configure SNMP trap trap-free-memory-threshold and trap-freeable-memory-\nthreshold. From CLI:\nPage 65\nFGT1 # config system snmp sysinfo\nFGT1 (sysinfo) # show\nconfig system snmp sysinfo\nset status enable\nset trap-free-memory-threshold 20\nset trap-freeable-memory-threshold 50\nend",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/943586",
    "audit": "From CLI:\nconfig system snmp user\nedit \"snmp_test\"\nset queries disable\nset notify-hosts 192.168.1.101\nset security-level auth-priv\nset auth-proto sha512\nset auth-pwd ENC xxxxxx\nset priv-proto aes256\nset priv-pwd ENC xxxxxx\nnext\nend\nValidate that \"set queries\" is disabled\nFrom GUI:\n1. System > SNMP\n2. On SNMPv3 settings double click on the SNMPv3 user to modify\n3. Ensure that the slider for \"Queries\" is disabled\nIn the example below, SNMP trap will trigger once memory usage is above 80% (less\nthan 20% free memory), and the freeable memory is more than 35% (memory that can\nbe reclaimed by the system when needed).\nFrom CLI, enable SNMP trap trap-free-memory-threshold and trap-freeable-memory-\nthreshold.\nFGT1 # config system snmp sysinfo\nFGT1 (sysinfo) # show\nconfig system snmp sysinfo\nset status enable\nset trap-free-memory-threshold 20\nset trap-freeable-memory-threshold 50\nend",
    "rationale": "SNMP can contain information that is useful for reconnaissance, SNMP queries allow\ndevices to send requests for information, disabling this on SNMPv3 users that do not\nneed to query and only need to receive SNMP traps is necessary.\nMonitoring memory usage via SNMP traps ensures that critical security processes have\nsufficient resources to operate effectively. This helps prevent performance degradation\nor failures that could expose the system to security risks.",
    "impact": "Memory usage reaching critical status will automatically turn FortiGates into conserve\nmode which will impact security inspection."
  },
  {
    "rule_id": "2.4",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Administrators and Admin Profiles",
    "cis_level": "• Level 1",
    "description": "Before deploying any new FortiGate, it is important to change the password of the\ndefault admin account.\nIt is also recommended that you change even the user name of the default admin\naccount, However, since you cannot change the user name of an account that is\ncurrently in use, a second administrator account must be created in order to do this.",
    "expected_values": "By default, your FortiGate has an administrator account set up with the username admin\nand no password. In order to prevent unauthorized access to FortiGate, it is highly\nrecommended that you add a password to this account.\nUsername: admin The default admin account does not have any password. Just\nleave it blank",
    "validation_logic": "Using both CLI and GUI, in the username field put in \"admin\", leave the password field\nblank and proceed. If it's checked out, it means that the default password is still in place\nand needs to be changed.",
    "remediation_steps": "First create an other local admin account, for example mycompanyadmin.\n#if VDOM enabled\nconfig global\n#configure new admin\nconfig system admin\nedit \"mycompanyadmin\"\nset password\nset accprofile \"super_admin\"\nnext\nend\nVerify if the newly created login works by opening another CLI session, do not logout of\nyour current session.\nOnce validated, logout with the default local admin account and use the CLI session\nwith mycompanyadmin to delete the default local admin account.\nPage 68\nPlease make sure there are no references in the configuration to the account (groups,\netc.)\n#if VDOM enabled\nconfig global\nconfig system admin\ndelete \"admin\"\nend\nTo change the default password in the GUI:\nGlobal (if VDOM enabled) > System > Administrators\nCreate New admin account (mycompanyadmin) Verify if you can login with that account\nvia another browser session (eg. incognito mode).\nRemove default admin\nSystem > Administrators menu",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://kb.fortinet.com/kb/documentLink.do?externalID=FD48763\n2. https://docs.fortinet.com/document/fortigate/6.2.0/cookbook/99980/default-\nadministrator-password",
    "audit": "Using both CLI and GUI, in the username field put in \"admin\", leave the password field\nblank and proceed. If it's checked out, it means that the default password is still in place\nand needs to be changed.",
    "rationale": "Default credentials are well documented by most vendors, including Fortinet. Therefore,\nit will be one of the first things that will be tried to illegally gain access to the system.",
    "impact": "If not changed, then any scripts that use default credentials will be able to access the\nsystem."
  },
  {
    "rule_id": "4.2",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Change Default Passwords",
    "cis_level": "• Level 1",
    "description": "Configure an administrative account to be accessible only to someone who is using a\ntrusted host. You can set a specific IP address for the trusted host or use a subnet.",
    "expected_values": "By default, each account is accessible from everywhere. The host value is 0.0.0.0/0",
    "validation_logic": "This example is to check if trusted hosts option is enabled for account \"test_admin\" and\nwhich trusted hosts are in the list:\nFG1 # config system admin\nFG1 (admin) # edit \"test_admin\"\nFG1 (test_admin) # show\nconfig system admin\nedit \"test_admin\"\n...\nset trusthost1 10.0.0.0 255.255.255.0\nset trusthost2 192.168.10.0 255.255.255.0\n...\nnext\nend\nIn the Web GUI:\nPage 71\n1. System > Administrators.\n2. Select the account and click on edit.\n3. In the account setting page, make sure that \"Restrict login to trusted\nhosts\" is enabled and all the allowed hosts / subnets are in the list of\ntrusted host.\nPlease take note that certain versions of FortiOS will only show the first 3 trusted hosts\nin the list. If you want to see more, you have to click on the \"+\" sign as if you're adding a\nnew item into the list. Keep clicking until you see an empty field of trusted host. That's\nwhen you know that you have reached the bottom of the list.",
    "remediation_steps": "To remove a trusted host item from the list in CLI:\nFG1 # config system admin\nFG1 (admin) # edit \"test_admin\"\nFG1 (test_admin) # unset trusthost1\nFG1 (test_admin) # end\nFG1 #\nTo add a trusted host into the list in CLI:\nFG1 # config system admin\nFG1 (admin) # edit \"test_admin\"\nFG1 (test_admin) # set trusthost6 1.1.1.1 255.255.255.255\nFG1 (test_admin) # end\nFG1 #\nBefore adding an item, please make sure that it does not already exist. For example, if\ntrusthost3 is already in the list, using it again will override the existing host/network.\nIn the Web GUI:\n1. System > Administrators.\n2. select the account and click on edit.\n3. In the account setting page, make sure that \"Restrict login to trusted\nhosts\" is enabled and all the allowed hosts / subnets are in the list of\ntrusted host.\nPlease take note that certain versions of FortiOS will only show the first 3 trusted hosts\nin the list. If you want to see more, you have to click on the \"+\" sign as if you're adding a\nnew item into the list. Keep clicking until you see an empty field of trusted host. That's\nwhen you know that you have reached the bottom of the list. To add another trusted\nhost, fill in the empty field of the new \"Trusted Host\". To remove a trusted host, simply\nerase everything in the field of that corresponding host.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/14906\nPage 72",
    "audit": "This example is to check if trusted hosts option is enabled for account \"test_admin\" and\nwhich trusted hosts are in the list:\nFG1 # config system admin\nFG1 (admin) # edit \"test_admin\"\nFG1 (test_admin) # show\nconfig system admin\nedit \"test_admin\"\n...\nset trusthost1 10.0.0.0 255.255.255.0\nset trusthost2 192.168.10.0 255.255.255.0\n...\nnext\nend\nIn the Web GUI:\nPage 71\n1. System > Administrators.\n2. Select the account and click on edit.\n3. In the account setting page, make sure that \"Restrict login to trusted\nhosts\" is enabled and all the allowed hosts / subnets are in the list of\ntrusted host.\nPlease take note that certain versions of FortiOS will only show the first 3 trusted hosts\nin the list. If you want to see more, you have to click on the \"+\" sign as if you're adding a\nnew item into the list. Keep clicking until you see an empty field of trusted host. That's\nwhen you know that you have reached the bottom of the list.",
    "rationale": "Access to a firewall to perform administrative tasks should only come from specific\nnetwork segments reserved for administrators only. This additional layer of security\nensures that no one from anywhere else on the network is able to log in, even with\ncorrect credentials.",
    "impact": "All access outside of the allowed segment will be stopped, including from both\nlegitimate and illegitimate users. Thus, administrators working remotely will have to\nmake sure that they have access to jump hosts that sit in the allowed segment."
  },
  {
    "rule_id": "11.7",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Manage Network Infrastructure Through a Dedicated",
    "cis_level": "• Level 1",
    "description": "Verify that users with access to the Fortinet should only have the minimum privileges\nrequired for that particular user.",
    "expected_values": "By default, there are only 2 profiles: prof_admin and super_admin. You must select a\nprofile to create an admin account. The system will not automatically choose for you.",
    "validation_logic": "There are 2 stages to audit. Here is how to verify in the CLI:\nStage 1: Verify the profile.\nFGT1 # config system accprofile\nFGT1 (accprofile) # edit \"tier_1\"\nFGT1 (tier_1) # show full\nconfig system accprofile\nedit \"tier_1\"\nset comments ''\nset secfabgrp read\nset ftviewgrp read\nset authgrp none\nset sysgrp none\nset netgrp read\nset loggrp none\nset fwgrp custom\nset vpngrp none\nset utmgrp none\nset wifi none\nset admintimeout-override disable\nconfig fwgrp-permission\nset policy none\nset address none\nset service none\nset schedule none\nend\nnext\nend\nFGT1 (tier_1) #\nIf the following privileges are set to \"custom\", please also check the sub-privileges of the\ncustomized ones to make sure that only the right privileges are allowed: fwgrp, sysgrp,\nnetgrp, loggrp, utmgrpset.\nPage 74\nIn the GUI, go to:\nSystem > Admin Profiles, select the profile and click on \"Edit\".\nStage 2: Verify the admin accounts.\nIn the CLI:\nFGT1 #config system admin\nFGT1 (admin) # edit \"support1\"\nFGT1 (support1) # show full\nconfig system admin\nedit \"support1\"\n...\nset accprofile \"tier_1\"\n...\nnext\nend\nIn the GUI, go to:\nSystem > Administrators, select the account and click \"Edit\"",
    "remediation_steps": "In this example, the goal is to provide the profile \"tier_1\" the ability to view and modify\naddress objects. This sub-privilege is under fwgrp privilege.\nIn CLI:\nFGT1 # config system accprofile\nFGT1 (accprofile) # edit \"tier_1\"\nFGT1 (tier_1) # set fwgrp custom\nFGT1 (tier_1) # config fwgrp-permission\nFGT1 (fwgrp-permission) # set address read-write\nFGT1 (fwgrp-permission) # end\nFGT1 (tier_1) # end\nFGT1 #\nFor the GUI, go to:\n1. System > Admin Profiles, select \"tier_1\" and click \"Edit\".\n2. On \"Firewall\", click on \"Custom\".\n3. Click on \"Read/Write\" option for \"Address\".\nIn the next example, assign the profile \"tier_1\" to the account \"support1\".\nIn the CLI:\nFGT1 # config system admin\nFGT1 (admin) # edit \"support1\"\nFGT1 (support1) # set accprofile \"tier_1\"\nFGT1 (support1) # end\nFGT1 #\nFor the GUI, go to:\nPage 75\n1. System > Administrators.\n2. Select \"support1\" and click \"Edit\".\n3. Under \"Administrator Profile\", select \"tier_1\".",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/294491",
    "audit": "There are 2 stages to audit. Here is how to verify in the CLI:\nStage 1: Verify the profile.\nFGT1 # config system accprofile\nFGT1 (accprofile) # edit \"tier_1\"\nFGT1 (tier_1) # show full\nconfig system accprofile\nedit \"tier_1\"\nset comments ''\nset secfabgrp read\nset ftviewgrp read\nset authgrp none\nset sysgrp none\nset netgrp read\nset loggrp none\nset fwgrp custom\nset vpngrp none\nset utmgrp none\nset wifi none\nset admintimeout-override disable\nconfig fwgrp-permission\nset policy none\nset address none\nset service none\nset schedule none\nend\nnext\nend\nFGT1 (tier_1) #\nIf the following privileges are set to \"custom\", please also check the sub-privileges of the\ncustomized ones to make sure that only the right privileges are allowed: fwgrp, sysgrp,\nnetgrp, loggrp, utmgrpset.\nPage 74\nIn the GUI, go to:\nSystem > Admin Profiles, select the profile and click on \"Edit\".\nStage 2: Verify the admin accounts.\nIn the CLI:\nFGT1 #config system admin\nFGT1 (admin) # edit \"support1\"\nFGT1 (support1) # show full\nconfig system admin\nedit \"support1\"\n...\nset accprofile \"tier_1\"\n...\nnext\nend\nIn the GUI, go to:\nSystem > Administrators, select the account and click \"Edit\"",
    "rationale": "In some organizations, it is necessary to create different levels of administrative\naccounts. For example, technicians from tier 1 support should not have total access to\nthe system compared to a tier 3 support.",
    "impact": null
  },
  {
    "rule_id": "4.3",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Ensure the Use of Dedicated Administrative Accounts",
    "cis_level": "• Level 1",
    "description": "The idle timeout period is the amount of time that an administrator will stay logged in to\nthe GUI without any activity.",
    "expected_values": "By default, it is set to five minutes.",
    "validation_logic": "To check the idle timeout in the GUI:\n1) Login to FortiGate\n2) Go to 'System' > 'Settings'.\n3) In the 'Administration Settings' section, check the 'Idle timeout' value\nin minutes.\nTo check the idle timeout in the CLI:\nget system global\ncheck the value of admintimeout in minutes",
    "remediation_steps": "To change the idle timeout in the GUI:\n1) Login to FortiGate with Super Admin privileges\n2) Go to 'System' > 'Settings'.\n3) In the 'Administration Settings' section, set the 'Idle timeout' value to\nfive minutes by typing 5.\n4) Click Apply.\nTo change the idle timeout in the CLI:\nPage 77\nconfig system global\nset admintimeout 5\nend",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/215451",
    "audit": "To check the idle timeout in the GUI:\n1) Login to FortiGate\n2) Go to 'System' > 'Settings'.\n3) In the 'Administration Settings' section, check the 'Idle timeout' value\nin minutes.\nTo check the idle timeout in the CLI:\nget system global\ncheck the value of admintimeout in minutes",
    "rationale": "Best practice dictates setting admin idle timeout to prevent the risk of unauthorized\naccess to the device, such as someone using a logged-in GUI on a PC that has been\nleft unattended.\nFor security reasons, the Center for Internet Security (CIS) recommends that\nadministrator sessions should automatically timeout after a period of inactivity, with a\nmaximum recommended time of 15 minutes or less",
    "impact": "This is to prevent someone from accessing the FortiGate if the management PC is left\nunattended."
  },
  {
    "rule_id": "4.3",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Ensure the Use of Dedicated Administrative Accounts",
    "cis_level": "• Level 1",
    "description": "Allow only HTTPS access to the GUI and SSH access to the CLI.",
    "expected_values": "By default, HTTP and Telnet are not enabled on any interface.",
    "validation_logic": "In the CLI, when verifying the network interface, make sure that http and telnet are not\nin the allowaccess list:\nFG1 # config system interface\nFG1 (interface) # edit port1\nFG1 (port1) # show\nconfig system interface\nedit \"port1\"\n...\nset allowaccess ssh https ping snmp\n...\nnext\nend\nIn the web GUI, click on:\n1. Network > Interfaces, select the interface and click \"Edit\".\n2. In the interface setting page, make sure that HTTP and Telnet are not\nselected in the section \"Administrative Access\"",
    "remediation_steps": "If HTTP or Telnet is in the allowaccess list, you will have to set that list again with the\nsame elements except for http or telnet.\nOn CLI:\nFG1 # config system interface\nFG1 (interface) # edit port1\nFG1 (port1) # set allowaccess ssh https ping snmp\nFG1 (port1) # end\nFG1 #\nIn the web GUI, click on:\nPage 79\n1. Network > Interfaces, select the interface and click \"Edit\".\n2. In the interface setting page, uncheck HTTP and Telnet in the section\n\"Administrative Access\".",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/574723",
    "audit": "In the CLI, when verifying the network interface, make sure that http and telnet are not\nin the allowaccess list:\nFG1 # config system interface\nFG1 (interface) # edit port1\nFG1 (port1) # show\nconfig system interface\nedit \"port1\"\n...\nset allowaccess ssh https ping snmp\n...\nnext\nend\nIn the web GUI, click on:\n1. Network > Interfaces, select the interface and click \"Edit\".\n2. In the interface setting page, make sure that HTTP and Telnet are not\nselected in the section \"Administrative Access\"",
    "rationale": "By only allowing encrypted access, we are making it harder to use \"Man in the Middle\"\nattacks to sniff login credentials.",
    "impact": null
  },
  {
    "rule_id": "4.5",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Use Multifactor Authentication For All Administrative",
    "cis_level": "• Level 1",
    "description": "Configure Local-in Policies to control inbound traffic that is destined to a FortiGate\ninterface.",
    "expected_values": "There are no Local-in Policies in place by default.",
    "validation_logic": "To review Local-in Policies in the GUI, go to:\n1. System > Feature Visibility.\n2. Turning on \"Local-in policies\" under the Additional Features Section.\nThis will then add the section under \"Policies and Objects\" there will now be a section\nfor \"Local-in Policies\"\nIt can also be viewed through the CLI:\nconfig firewall local-in-policy\nshow",
    "remediation_steps": "Local-in Policies can only be configured through the CLI:\nPage 81\nconfig firewall {local-in-policy | local-in-policy6}\nedit <policy_number>\nset intf <interface>\nset srcaddr <source_address> [source_address] ...\nset dstaddr <destination_address> [destination_address] ...\nset action {accept | deny}\nset service <service_name> [service_name] ...\nset schedule <schedule_name>\nset comments <string>\nnext\nend\nFor example, to prevent the source subnet 10.10.10.0/24 from pinging port1, but allow\nadministrative access for PING on port1:\nconfig firewall address\nedit \"10.10.10.0\"\nset subnet 10.10.10.0 255.255.255.0\nnext\nend\nconfig firewall local-in-policy\nedit 1\nset intf \"port1\"\nset srcaddr \"10.10.10.0\"\nset dstaddr \"all\"\nset service \"PING\"\nset schedule \"always\"\nnext\nend",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/363127",
    "audit": "To review Local-in Policies in the GUI, go to:\n1. System > Feature Visibility.\n2. Turning on \"Local-in policies\" under the Additional Features Section.\nThis will then add the section under \"Policies and Objects\" there will now be a section\nfor \"Local-in Policies\"\nIt can also be viewed through the CLI:\nconfig firewall local-in-policy\nshow",
    "rationale": "Local-in Policies allow for more granular and specific control of all types of traffic that\nare destined for a FortiGate interface. They are not limited to management-only\nprotocols, therefore they can extend past \"trusted host\" configurations and be\nconfigured with source and destination addresses as well as specific services.",
    "impact": "Local-in Policies are processed before \"trusted host\" configurations, so it is important to\nvalidate that management access will be maintained once the Local-in policies are put\nin place."
  },
  {
    "rule_id": "14.6",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Protect Information through Access Control Lists",
    "cis_level": "• Level 1",
    "description": "FortiGate admin ports listen on the common ports of 80 and 443. This is default\nbehavior. While interface access is controlled by configuring network interfaces, the\nFortiGate still listens on the admin ports that have been configured, which can also\ncause a conflict should 80 or 443 be needed as part of additional configuration later on.",
    "expected_values": "config system global\nset admin-https-redirect enable\nset admin-port 80\nset admin-server-cert \"self-sign\"\nset admin-sport 443",
    "validation_logic": "Log in to the GUI and click on System > Settings > Review the ports under\n'Administration Settings' section.",
    "remediation_steps": "config system global\nset admin-https-redirect disable\nset admin-port 8082 **(or any other uncommon port)**\nset admin-server-cert \"self-sign\"\nset admin-sport 4343 **(or any other uncommon port)**\nend\nOR\nFrom Web GUI:\n1. System > Settings\n2. Change the ports/settings under 'Administration Settings' section.\nNOTE: https redirection must be turned off as well as changing port 80. This is due to\nthe nature of how browser port redirection works. The browser will be redirected from\nport 80 to port 443 or whichever 'admin-sport' is configured, meaning that it will still\nlisten on port 80 even when the port has been reconfigured.\nPage 84",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/616955\n2. https://community.fortinet.com/t5/FortiGate/Technical-Tip-How-to-change-the-\nport-for-the-admin-access-to/ta-p/192295?externalID=FD46981",
    "audit": "Log in to the GUI and click on System > Settings > Review the ports under\n'Administration Settings' section.",
    "rationale": "To increase security of the FortiGate Admin Ports, changing it from the default ports will\nreduce the attack surface should FortiGate Admin Access be targeted. As mentioned, a\npossible port conflict can also be avoided.",
    "impact": "Unauthorized access to a FortiGate or any firewall could prove very costly. While this is\na single hardening step of many, it is an important one when hardening any firewall."
  },
  {
    "rule_id": "9.4",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Apply Host-based Firewalls or Port Filtering",
    "cis_level": "• Level 1",
    "description": "Allow virtual patching to be applied to traffic destined to the FortiGate by applying IPS\nsignatures to the local in interface using local in policies. Attacks geared towards GUI\nand SSH management access, for example, can be mitigated using IPS signatures\npushed from FortiGuard, thereby virtually patching these vulnerabilities.\nThe FortiGate must have a valid FMWR (Firmware) license to install the FMWP\ndatabase. The FMWP database can be viewed by running the diagnose autoupdate\nversions command.",
    "expected_values": "Disabled",
    "validation_logic": "On CLI:\nconfig firewall local-in-policy\nshow\nEnsure that virtual-patch is enabled for those policy that is allowing traffic.",
    "remediation_steps": "On CLI:\nconfig firewall local-in-policy\nedit <id>\nset virtual-patch enable\nnext\nend",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/393161\nPage 86",
    "audit": "On CLI:\nconfig firewall local-in-policy\nshow\nEnsure that virtual-patch is enabled for those policy that is allowing traffic.",
    "rationale": "Patches require scheduling of downtime, which means there is some attack window\nfrom the time Fortinet announced the vulnerability to when patch is applied. To minimise\nthe risk, virtual patching on GUI and SSH management access is needed.",
    "impact": null
  },
  {
    "rule_id": "2.5",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "High Availability",
    "cis_level": "• Level 2",
    "description": "Ensure that FortiGate devices are configured for High Availability (HA).",
    "expected_values": "N/A\nPage 90",
    "validation_logic": "In GUI:\n1. Navigate to \"System\" and then \"HA\"\n2. Ensure \"Mode\" is set to proper setting \"Active-Active\" or \"Active-Passive\"\n3. Review Configuration settings:\n- \"Cluster Name\" must match on devices\n- \"Password\" Must match on devices\n- \"Heartbeat Interfaces\" need to be defined on devices\n4. Click \"OK\" to save changes and exit\nIn CLI:\nFGT1 # config system ha\nFGT1 (ha) # set mode a-p ###(Active-Passive)\nFGT1 (ha) # set group-name \"FGT-HA\" ###(Set cluster name)\nFGT1 (ha) # set password ******* ###(Set password)\nFGT1 (ha) # set hbdev port10 50 ###(Set Heartbeat\nInterface and priority)\nFGT1 (ha) # end\nTo review configuration in CLI:\nPage 89\nFGT1 # config system ha\nFGT1 (ha) # show\nconfig system ha\nset group-name \"FGT-HA\"\nset mode a-p\nset password ENC\nenrwD467hJmO6j6YW/l6FEOa1YNVYdo8Z5mCcTDEKUFpOVXcNYnPBmQDGX//ViXk6TkwNH0il5aJr\n/fZY25lq+husndQHZVWp2LIlXmCv/n81U43nkZUWaIKvqkellGFbhv0/IHoOLzQPCsVcBbyrsgopr\nYMvh6w7F06+nRriBtMNQxpOV5V+e388EcwsOOMsXBZOw==\nset hbdev \"port10\" 50\nset override disable\nend",
    "remediation_steps": "In GUI:\n1. Navigate to \"System\" and then \"HA\"\n2. Ensure \"Mode\" is set to proper setting \"Active-Active\" or \"Active-Passive\"\n3. Review Configuration settings:\n- \"Cluster Name\" must match on devices\n- \"Password\" Must match on devices\n- \"Heartbeat Interfaces\" need to be defined on devices\n4. Click \"OK\" to save changes and exit\nIn CLI:\nFGT1 # config system ha\nFGT1 (ha) # set mode a-p ###(Active-Passive)\nFGT1 (ha) # set group-name \"FGT-HA\" ###(Set cluster name)\nFGT1 (ha) # set password ******* ###(Set password)\nFGT1 (ha) # set hbdev port10 50 ###(Set Heartbeat\nInterface and priority)\nFGT1 (ha) # end\nTo review configuration in CLI:\nFGT1 # config system ha\nFGT1 (ha) # show\nconfig system ha\nset group-name \"FGT-HA\"\nset mode a-p\nset password ENC\nenrwD467hJmO6j6YW/l6FEOa1YNVYdo8Z5mCcTDEKUFpOVXcNYnPBmQDGX//ViXk6TkwNH0il5aJr\n/fZY25lq+husndQHZVWp2LIlXmCv/n81U43nkZUWaIKvqkellGFbhv0/IHoOLzQPCsVcBbyrsgopr\nYMvh6w7F06+nRriBtMNQxpOV5V+e388EcwsOOMsXBZOw==\nset hbdev \"port10\" 50\nset override disable\nend",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/357558\n2. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/900885",
    "audit": "In GUI:\n1. Navigate to \"System\" and then \"HA\"\n2. Ensure \"Mode\" is set to proper setting \"Active-Active\" or \"Active-Passive\"\n3. Review Configuration settings:\n- \"Cluster Name\" must match on devices\n- \"Password\" Must match on devices\n- \"Heartbeat Interfaces\" need to be defined on devices\n4. Click \"OK\" to save changes and exit\nIn CLI:\nFGT1 # config system ha\nFGT1 (ha) # set mode a-p ###(Active-Passive)\nFGT1 (ha) # set group-name \"FGT-HA\" ###(Set cluster name)\nFGT1 (ha) # set password ******* ###(Set password)\nFGT1 (ha) # set hbdev port10 50 ###(Set Heartbeat\nInterface and priority)\nFGT1 (ha) # end\nTo review configuration in CLI:\nPage 89\nFGT1 # config system ha\nFGT1 (ha) # show\nconfig system ha\nset group-name \"FGT-HA\"\nset mode a-p\nset password ENC\nenrwD467hJmO6j6YW/l6FEOa1YNVYdo8Z5mCcTDEKUFpOVXcNYnPBmQDGX//ViXk6TkwNH0il5aJr\n/fZY25lq+husndQHZVWp2LIlXmCv/n81U43nkZUWaIKvqkellGFbhv0/IHoOLzQPCsVcBbyrsgopr\nYMvh6w7F06+nRriBtMNQxpOV5V+e388EcwsOOMsXBZOw==\nset hbdev \"port10\" 50\nset override disable\nend",
    "rationale": "Configuring High Availability (HA) increases system availability as well as decreases\nimpact of routine maintenance (Firmware updates, cable moves, etc.) and the the\nimpact of device failure.",
    "impact": "Not having High Availability (HA) configured correctly and synced properly impacts the\navailability of the FortiGate devices as well as any systems that require traversing the\nFortiGates. With properly configured HA in place outages can be minimized during\nfirmware updates as well as if there are power outages or device failures."
  },
  {
    "rule_id": "0.0",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Explicitly Not Mapped",
    "cis_level": "• Level 1",
    "description": "Configure Interface Monitoring within High Availability settings. Interface Monitoring\nshould be enabled on all critical interfaces.",
    "expected_values": "N/A",
    "validation_logic": "To validate from GUI:\n1. Go to System > HA.\n2. Under \"Monitor Interfaces\" validate all applicable interfaces are\nselected.\n3. Select \"OK\".\nTo validate from CLI:\nFGT1 # config system ha\nFGT1 (ha) # show\nconfig system ha\nset group-name \"FGT-HA\"\nset mode a-p\nset password ENC\nenrwD467hJmO6j6YW/l6FEOa1YNVYdo8Z5mCcTDEKUFpOVXcNYnPBmQDGX//ViXk6TkwNH0il5aJr\n/fZY25lq+husndQHZVWp2LIlXmCv/n81U43nkZUWaIKvqkellGFbhv0/IHoOLzQPCsVcBbyrsgopr\nYMvh6w7F06+nRriBtMNQxpiTE+12xAHz7lA3EoYZzf8A==\nset override disable\nset monitor \"port6\" \"port7\" ###Validate proper interfaces are present\nend",
    "remediation_steps": "To remediate from GUI:\nPage 92\n1. Go to System > HA.\n2. Under \"Monitor Interfaces\" select all applicable interfaces.\n3. Select \"OK\".\nTo validate from CLI:\nFGT1 # config system ha\nFGT1 (ha) # set monitor \"port6\" \"port7\"\nFGT1 (ha) # show ###To Review changes to monitored interfaces before\napplying\nconfig system ha\nset group-name \"FGT-HA\"\nset mode a-p\nset password ENC\nenrwD467hJmO6j6YW/l6FEOa1YNVYdo8Z5mCcTDEKUFpOVXcNYnPBmQDGX//ViXk6TkwNH0il5aJr\n/fZY25lq+husndQHZVWp2LIlXmCv/n81U43nkZUWaIKvqkellGFbhv0/IHoOLzQPCsVcBbyrsgopr\nYMvh6w7F06+nRriBtMNQxpiTE+12xAHz7lA3EoYZzf8A==\nset override disable\nset monitor \"port6\" \"port7\"\nend",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/6.0.0/best-\npractices/498515/interface-monitoring-port-monitoring",
    "audit": "To validate from GUI:\n1. Go to System > HA.\n2. Under \"Monitor Interfaces\" validate all applicable interfaces are\nselected.\n3. Select \"OK\".\nTo validate from CLI:\nFGT1 # config system ha\nFGT1 (ha) # show\nconfig system ha\nset group-name \"FGT-HA\"\nset mode a-p\nset password ENC\nenrwD467hJmO6j6YW/l6FEOa1YNVYdo8Z5mCcTDEKUFpOVXcNYnPBmQDGX//ViXk6TkwNH0il5aJr\n/fZY25lq+husndQHZVWp2LIlXmCv/n81U43nkZUWaIKvqkellGFbhv0/IHoOLzQPCsVcBbyrsgopr\nYMvh6w7F06+nRriBtMNQxpiTE+12xAHz7lA3EoYZzf8A==\nset override disable\nset monitor \"port6\" \"port7\" ###Validate proper interfaces are present\nend",
    "rationale": "With Interface Monitoring enabled on devices, failover can occur if there are\nphysical media issues or issues with the specific port to which the FortiGate is\nconnected.",
    "impact": "Not configuring Interface Monitoring can directly impact services due to a failure to\ntrigger a High Availability failover if an interface is impacted only on the primary device\nand is not being monitored. Without the Interface Monitoring enabled, failover\nwould be limited to hardware, system, or power faults."
  },
  {
    "rule_id": "0.0",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Explicitly Not Mapped",
    "cis_level": "• Level 1",
    "description": "Ensure Reserved Management Interfaces are configured on HA devices.",
    "expected_values": "N/A",
    "validation_logic": "Review through the GUI:\n1. Go to System > HA edit the \"Master\" device.\n2. Verify that \"Management Interface Reservation\" is selected and there is an\ninterface, and gateway defined.\nReview through the CLI:\nFGT1 #config system ha\nFGT1 (ha) # show\nconfig system ha\nset group-name \"FGT-HA\"\nset mode a-p\nset password ENC\nenrwD467hJmO6j6YW/l6FEOa1YNVYdo8Z5mCcTDEKUFpOVXcNYnPBmQDGX//ViXk6TkwNH0il5aJr\n/fZY25lq+husndQHZVWp2LIlXmCv/n81U43nkZUWaIKvqkellGFbhv0/IHoOLzQPCsVcBbyrsgopr\nYMvh6w7F06+nRriBtMNQxpiTE+12xAHz7lA3EoYZzf8A==\nset ha-mgmt-status enable\nconfig ha-mgmt-interfaces\nedit 1\nset interface \"port6\"\nset gateway 10.10.10.1\nnext\nend\nset override disable\nend\nValidate that set ha-mgmt-status is enabled and that config ha-mgmt-interfaces\nhas at least one entry with an interface and gateway defined.\nPage 94",
    "remediation_steps": "Remediate through the GUI:\n1. Go to System > HA edit the \"Master\" device.\n2. Enable \"Management Interface Reservation\" once this is enabled select an\nan interface, and configure the appropriate gateway.\nRemediate through the CLI:\nFGT1 #config system ha\nFGT1 (ha) # set ha-mgmt-status enable\nFGT1 (ha) # config ha-mgmt-interfaces\nFGT1 (ha-mgmt-interfaces) # edit 1\nnew entry '1' added\nFGT1 (1) # set interface port6\nFGT1 (1) # set gateway 10.10.10.1\nFGT1 (1) # end\nFGT1 (ha) # show\nconfig system ha\nset group-name \"FGT-HA\"\nset mode a-p\nset password ENC\nenrwD467hJmO6j6YW/l6FEOa1YNVYdo8Z5mCcTDEKUFpOVXcNYnPBmQDGX//ViXk6TkwNH0il5aJr\n/fZY25lq+husndQHZVWp2LIlXmCv/n81U43nkZUWaIKvqkellGFbhv0/IHoOLzQPCsVcBbyrsgopr\nYMvh6w7F06+nRriBtMNQxpiTE+12xAHz7lA3EoYZzf8A==\nset ha-mgmt-status enable\nconfig ha-mgmt-interfaces\nedit 1\nset interface \"port6\"\nset gateway 10.10.10.1\nnext\nend\nset override disable\nend\nFGT1 (ha) # end",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/313152",
    "audit": "Review through the GUI:\n1. Go to System > HA edit the \"Master\" device.\n2. Verify that \"Management Interface Reservation\" is selected and there is an\ninterface, and gateway defined.\nReview through the CLI:\nFGT1 #config system ha\nFGT1 (ha) # show\nconfig system ha\nset group-name \"FGT-HA\"\nset mode a-p\nset password ENC\nenrwD467hJmO6j6YW/l6FEOa1YNVYdo8Z5mCcTDEKUFpOVXcNYnPBmQDGX//ViXk6TkwNH0il5aJr\n/fZY25lq+husndQHZVWp2LIlXmCv/n81U43nkZUWaIKvqkellGFbhv0/IHoOLzQPCsVcBbyrsgopr\nYMvh6w7F06+nRriBtMNQxpiTE+12xAHz7lA3EoYZzf8A==\nset ha-mgmt-status enable\nconfig ha-mgmt-interfaces\nedit 1\nset interface \"port6\"\nset gateway 10.10.10.1\nnext\nend\nset override disable\nend\nValidate that set ha-mgmt-status is enabled and that config ha-mgmt-interfaces\nhas at least one entry with an interface and gateway defined.\nPage 94",
    "rationale": "To be able to access both the primary and secondary firewalls in an HA cluster,\nReserved Management Interfaces need to be configured to prevent them from\nsyncing with HA and sharing a virtual MAC address.",
    "impact": "Not configuring Reserved Management Interfaces impacts the ability to access\nsecondary devices directly due to the primary and secondary devices syncing\nconfiguration exactly and floating a virtualized mac address between them for failover."
  },
  {
    "rule_id": "0.0",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Explicitly Not Mapped",
    "cis_level": "• Level 2",
    "description": "Ensure that FortiGate High Availability (HA) configuration has non-default \"Group-ID\"",
    "expected_values": "The default \"Group-ID\" value is set to 0\nPage 97\n3 Policy and Objects\nThis section contains best practices related to configuring firewall policies, Objects and\ntraffic shaping\nPage 98",
    "validation_logic": "In the CLI:\nFGT1 # show sys ha\nconfig system ha\nset group-id 10\nset group-name \"HAGROUP\"\nset mode a-p\nset password ENC xxxxxxxx\nset hbdev \"port7\" 50\nset session-pickup enable\nset override disable\nset priority 200\nend\nValidate that \"group-id\" is present and not configured for the default of 0\nIn the GUI:\n1. System > HA\n2. Select the primary device and either double click to open or single click\nand select edit\n3. Under \"Cluster Settings\" Validate that \"Group ID\" is not 0 and has been\nconfigured",
    "remediation_steps": "To modify High Availability (HA) Group-ID\nFrom the CLI:\nPage 96\nFGT1 # config system ha\nFGT1 (ha) # set group-id 10\nFGT1 (ha) # end\nFGT1 #\nThe Group ID can be any integer value from 0-1023\nFrom the GUI:\n1. System > HA\n2. Select Primary device and either double click or single click and select\n\"Edit\"\n3. Under Cluster Settings enter a value in the \"Group ID\"\n4. Click OK to apply\nThe Group ID can be any integer value from 0-1023",
    "severity": null,
    "is_active": true,
    "references_text": null,
    "audit": "In the CLI:\nFGT1 # show sys ha\nconfig system ha\nset group-id 10\nset group-name \"HAGROUP\"\nset mode a-p\nset password ENC xxxxxxxx\nset hbdev \"port7\" 50\nset session-pickup enable\nset override disable\nset priority 200\nend\nValidate that \"group-id\" is present and not configured for the default of 0\nIn the GUI:\n1. System > HA\n2. Select the primary device and either double click to open or single click\nand select edit\n3. Under \"Cluster Settings\" Validate that \"Group ID\" is not 0 and has been\nconfigured",
    "rationale": "High Availability (HA) allows a FortiGate cluster to float a virtual MAC address between\ndevices to minimize downtime if there is a failover event. This Virtual MAC address is\ngenerated using the GROUP-ID so to prevent possible duplicate MAC addresses on\nLayer 2 of the network configuring a non-default Group-ID is needed.",
    "impact": "Not modifying the Group-ID attribute in HA could allow a duplicate MAC address from\nanother default FortiGate having HA configured which can cause problems if they are\nboth within the same network"
  },
  {
    "rule_id": "3.1",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Ensure that unused policies are reviewed regularly",
    "cis_level": "• Level 2",
    "description": "All firewall policies should be reviewed regularly to verify the business purpose. Unused\npolicies should be disabled and logged.\nRecommendation to review twice per year or inline with BCP practice (Business\nContinuity Plan). Some of the firewall policies will only be used during BCP, hence, the\nhit count might show 0 if the review is done too often.",
    "expected_values": "By default, the hit count value is 0 at the beginning.",
    "validation_logic": "In CLI, type \"diag firewall iprope show 100004 <policy_id>\". In this example, we'll verify\npolicy with ID of 32. We'll also need to clear the counter after each review so that we\ncan tell if the policy is still being used for the next review :\nFGT1 # diag firewall iprope show 100004 32\nidx=2 pkts/bytes=144967/135758174 asic_pkts/asic_bytes=0/0 flag=0x0 hit\ncount:663\nFGT1 # diag firewall iprope clear 100004 32\nIn the GUI,\n1. Go to Policy & Objects.\n2. Click on Firewall Policy.\n3. Make sure that either the columns \"Bytes\" or \"Hit Count\" are visible. To\ndisplay either one of them, move the cursor to the top row where all the\ncolumns names are. Right click and select \"Bytes\" or \"Hit Count\" and click\nOK. To clear the counter, right click on the \"Bytes\" or \"Hit Count\" columns\nof that policy and click on \"Clear Counters\".",
    "remediation_steps": "The remediation is to review and decide if you should delete unused policies.",
    "severity": "Manual",
    "is_active": true,
    "references_text": "1. https://kb.fortinet.com/kb/documentLink.do?externalID=FD44631\nPage 99",
    "audit": "In CLI, type \"diag firewall iprope show 100004 <policy_id>\". In this example, we'll verify\npolicy with ID of 32. We'll also need to clear the counter after each review so that we\ncan tell if the policy is still being used for the next review :\nFGT1 # diag firewall iprope show 100004 32\nidx=2 pkts/bytes=144967/135758174 asic_pkts/asic_bytes=0/0 flag=0x0 hit\ncount:663\nFGT1 # diag firewall iprope clear 100004 32\nIn the GUI,\n1. Go to Policy & Objects.\n2. Click on Firewall Policy.\n3. Make sure that either the columns \"Bytes\" or \"Hit Count\" are visible. To\ndisplay either one of them, move the cursor to the top row where all the\ncolumns names are. Right click and select \"Bytes\" or \"Hit Count\" and click\nOK. To clear the counter, right click on the \"Bytes\" or \"Hit Count\" columns\nof that policy and click on \"Clear Counters\".",
    "rationale": "By reviewing policies regularly, we can determine if the policies are still needed by the\nbusiness purpose. Thus, we can keep the firewall policies lean and efficient. It also\nprevents traffic being allowed or blocked accidently.",
    "impact": null
  },
  {
    "rule_id": "3.2",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Ensure that policies do not use \"ALL\" as Service",
    "cis_level": "• Level 1",
    "description": "Ensure that all security policies in effect clearly state which protocols / services they are\nallowing.",
    "expected_values": "By default, all new policy will have \"ALL\" in its service field.",
    "validation_logic": "In CLI:\nFGT1 # config firewall policy\nFGT1 (policy) # show\nTEST-FG-Third (policy) # show\nconfig firewall policy\nedit 1\nset uuid d0eed832-bb73-51e6-c3da-3cd2ec201608\nset srcintf \"internal\"\nset dstintf \"wan\"\nset srcaddr \"all\"\nset dstaddr \"all\"\nset action accept\nset schedule \"always\"\nset service \"HTTPS\" \"HTTP\"\nset ssl-ssh-profile \"__tmp_no-inspection\"\nset nat enable\nnext\nend\nIn the GUI,\n1. Go to Policy & Objects.\n2. Click on Firewall Policy.\nMake sure that none of the policies use \"ALL\" as its service.",
    "remediation_steps": "This is an example showing how to modify policy with ID of 2 to change the service from\n\"ALL\" to FTP and SNMP.\nIn CLI:\nPage 101\nFGT1 # config firewall policy\nFGT1 (policy) # edit 2\nFGT1 (2) # set service \"FTP\" \"SNMP\"\nFGT1 (2) # end\nFGT1 #\nIn the GUI,\n1. Go to Policy & Objects.\n2. Click on Firewall Policy.\n3. Select the policy, click \"Edit\".\n4. In the Service section, click on it and select FTP and SNMP. Click OK.",
    "severity": "Automated",
    "is_active": true,
    "references_text": null,
    "audit": "In CLI:\nFGT1 # config firewall policy\nFGT1 (policy) # show\nTEST-FG-Third (policy) # show\nconfig firewall policy\nedit 1\nset uuid d0eed832-bb73-51e6-c3da-3cd2ec201608\nset srcintf \"internal\"\nset dstintf \"wan\"\nset srcaddr \"all\"\nset dstaddr \"all\"\nset action accept\nset schedule \"always\"\nset service \"HTTPS\" \"HTTP\"\nset ssl-ssh-profile \"__tmp_no-inspection\"\nset nat enable\nnext\nend\nIn the GUI,\n1. Go to Policy & Objects.\n2. Click on Firewall Policy.\nMake sure that none of the policies use \"ALL\" as its service.",
    "rationale": "This is to make sure that the firewall do not allow traffic with unauthorized\nprotocols/services by mistake.",
    "impact": null
  },
  {
    "rule_id": "3.3",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Ensure firewall policy denying all traffic to/from Tor, malicious",
    "cis_level": "• Level 1",
    "description": "Firewall policies should include a deny rule for traffic going to/from Tor, malicious\nserver, or scanner IP addresses using ISDB (Internet Service Database).",
    "expected_values": null,
    "validation_logic": "Go to \"Policy & Objects\".\nValidate that there is a firewall policy created to block inbound connections from\nsources named \"Tor-Exit.Node\", \"Tor-Relay.Node\", \"Censys-Scanner\", \"Shodan-\nScanner\", \"Botnet-C&C.Server\", \"Phishing-Phishing.Server\", \"Proxy-Proxy.Server\",\n\"Spam-Spamming.Server\", \"VPN-Anonymous.VPN\", and \"Malicious-Malicious.Server\"\non \"All\" services.\nValidate that there is a firewall policy created to block outbound connections to\ndestination named \"Tor-Relay.Node\", \"Botnet-C&C.Server\", \"Phishing-Phishing.Server\",\n\"Proxy-Proxy.Server\", \"Spam-Spamming.Server\", \"VPN-Anonymous.VPN\", and\n\"Malicious-Malicious.Server\".\nNote that these ISDBs is recommended as of December 2024 (FortiOS 7.4.5). Fortinet\nmight rollout additional ISDBs to be blocked in newer versions that is not covered in this\nbenchmark.",
    "remediation_steps": "Review firewall policies and ensure there are:\n1. A firewall policy created to block inbound connections with these settings:\nPage 103\nFrom: Any\nTo: Any\nSource: \"Tor-Exit.Node\", \"Tor-Relay.Node\", \"Censys-Scanner\", \"Shodan-\nScanner\", \"Botnet-C&C.Server\", \"Phishing-Phishing.Server\", \"Proxy-\nProxy.Server\", \"Spam-Spamming.Server\", \"VPN-Anonymous.VPN\", and \"Malicious-\nMalicious.Server\"\nDestination: all\nSchedule: Always\nServices: All\nAction: Deny\nLog Violation Traffic: Enabled\nEnable this policy: Enabled\n2. A firewall policy created to block outbound connections with these settings:\nFrom: Any\nTo: Any\nSource: All\nDestination: \"Tor-Relay.Node\", \"Botnet-C&C.Server\", \"Phishing-\nPhishing.Server\", \"Proxy-Proxy.Server\", \"Spam-Spamming.Server\", \"VPN-\nAnonymous.VPN\", and \"Malicious-Malicious.Server\"\nSchedule: Always\nAction: Deny\nLog Violation Traffic: Enabled\nEnable this policy: Enabled",
    "severity": null,
    "is_active": true,
    "references_text": null,
    "audit": "Go to \"Policy & Objects\".\nValidate that there is a firewall policy created to block inbound connections from\nsources named \"Tor-Exit.Node\", \"Tor-Relay.Node\", \"Censys-Scanner\", \"Shodan-\nScanner\", \"Botnet-C&C.Server\", \"Phishing-Phishing.Server\", \"Proxy-Proxy.Server\",\n\"Spam-Spamming.Server\", \"VPN-Anonymous.VPN\", and \"Malicious-Malicious.Server\"\non \"All\" services.\nValidate that there is a firewall policy created to block outbound connections to\ndestination named \"Tor-Relay.Node\", \"Botnet-C&C.Server\", \"Phishing-Phishing.Server\",\n\"Proxy-Proxy.Server\", \"Spam-Spamming.Server\", \"VPN-Anonymous.VPN\", and\n\"Malicious-Malicious.Server\".\nNote that these ISDBs is recommended as of December 2024 (FortiOS 7.4.5). Fortinet\nmight rollout additional ISDBs to be blocked in newer versions that is not covered in this\nbenchmark.",
    "rationale": "FortiGate includes Tor or malicious server related IP address using ISDB. The idea is to\nfilter out malicious traffic using firewall policies as first level filtering. This is done without\ninvolving more resource intensive processes such as IPS inspection, hence optimizing\nFortiGate's performance.",
    "impact": null
  },
  {
    "rule_id": "3.4",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Ensure logging is enabled on all firewall policies",
    "cis_level": "• Level 1",
    "description": "Logging should be enabled for all firewall policies including the default implicit deny\npolicy.",
    "expected_values": "Logging is disabled.\nPage 105",
    "validation_logic": "Go to \"Policy & Objects\" > \"Firewall Policy\".\nValidate that logging is enabled on all firewall policies.",
    "remediation_steps": "Review firewall policies and ensure that:\n1. For allowed policies, \"Log Allowed Traffic\" is set on \"All Sessions\" option.\n2. For denied policies, \"Log Violation Traffic\" is enabled.",
    "severity": "Automated",
    "is_active": true,
    "references_text": null,
    "audit": "Go to \"Policy & Objects\" > \"Firewall Policy\".\nValidate that logging is enabled on all firewall policies.",
    "rationale": "Firewall policies should log for all traffic (both allow and deny policies). This enables\nSOC or security analyst to do further investigations on security incidents especially on\nthreat hunting or incident response activities. Although there are many data sources that\ncan provide DNS query logs (AD or EDR), this option should be enabled out of best\npractice and with assumption that no other data sources are available.",
    "impact": "By default, when creating firewall policies, a logging option is not enabled. Also, the\ndefault implicit deny policy is not logged. This creates a data gap in threat hunting or\nincident response activities."
  },
  {
    "rule_id": "4.1",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Intrusion Prevention System",
    "cis_level": "• Level 2",
    "description": "Interfaces which are classified as \"WAN\" and are used by a policy should use an IPS\nsensor which blocks or monitors outgoing connections to botnet sites.",
    "expected_values": "\"Scan Outgoing Connections to Botnet Sites\" is disabled on default profile.",
    "validation_logic": "On GUI:\n1. Ensure that relevant IPS profile is configured with \"Scan Outgoing\nConnections to Botnet Sites\" set to \"Block\".\n2. Review all firewall policies that have a \"WAN\" interface as the\ndestination.",
    "remediation_steps": "On GUI:\n1. Configure relevant IPS profiles with \"Scan Outgoing Connections to Botnet\nSites\" set to \"Block\".\n2. Apply relevant IPS profile on all firewall policies with traffic exiting\nthe network to a \"WAN\" interface.",
    "severity": "IPS",
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/668865",
    "audit": "On GUI:\n1. Ensure that relevant IPS profile is configured with \"Scan Outgoing\nConnections to Botnet Sites\" set to \"Block\".\n2. Review all firewall policies that have a \"WAN\" interface as the\ndestination.",
    "rationale": "Blocking outgoing connections to known Botnets should be utilized in a Defense In\nDepth network design.",
    "impact": null
  },
  {
    "rule_id": "15.3",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Use a Wireless Intrusion Detection System",
    "cis_level": "• Level 1",
    "description": "Ensuring that traffic traversing between networks on the FortiGate have an IPS security\nprofile inspecting it.",
    "expected_values": "Not Configured",
    "validation_logic": "Review all firewall policies and ensure that traffic has an IPS security profile assigned\nfor inspection.",
    "remediation_steps": "Configure on all \"Allowed\" firewall policies to have an appropriate IPS security profile\napplied to policies.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/243446",
    "audit": "Review all firewall policies and ensure that traffic has an IPS security profile assigned\nfor inspection.",
    "rationale": "Traffic moving between \"interfaces\" on the FortiGate should have firewall policies\napplied with an IPS security profile applied.",
    "impact": null
  },
  {
    "rule_id": "4.2",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Antivirus",
    "cis_level": "• Level 2",
    "description": "Ensure FortiGate is configured to accept antivirus definition push updates.",
    "expected_values": "Enabled and set to automatic.",
    "validation_logic": "On GUI:\n1. Access the FortiGate administrative web access page and go to System >\nFortiGuard.\n2. Under \"FortiGuard Updates\" ensure that the \"Scheduled updates\" is set to\n\"Automatic\".\nOn CLI:\nconfig system autoupdate schedule\nshow (Validate that there are no output, meaning it is already set as\n\"automatic\"",
    "remediation_steps": "On GUI:\n1. Access the FortiGate administrative web access page and go to System >\nFortiGuard.\n2. Under \"FortiGuard Updates\" ensure that the \"Scheduled updates\" is set to\n\"Automatic\".\nOn CLI:\nconfig system autoupdate schedule\nset status enable\nset frequency automatic\nend",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/547335\nPage 113",
    "audit": "On GUI:\n1. Access the FortiGate administrative web access page and go to System >\nFortiGuard.\n2. Under \"FortiGuard Updates\" ensure that the \"Scheduled updates\" is set to\n\"Automatic\".\nOn CLI:\nconfig system autoupdate schedule\nshow (Validate that there are no output, meaning it is already set as\n\"automatic\"",
    "rationale": "Ensure that the FortiGate will accept push updates from FortiGuard to ensure the most\nup to date signature databases are present on the device.",
    "impact": null
  },
  {
    "rule_id": "8.2",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Ensure Anti-Malware Software and Signatures are",
    "cis_level": "• Level 2",
    "description": "Ensuring that traffic traversing between networks on the FortiGate has an Antivirus\nSecurity profile inspecting it.",
    "expected_values": "No security inspection on firewall policies.",
    "validation_logic": "Review all firewall policies and ensure that traffic has an antivirus security profile\nassigned for inspection.",
    "remediation_steps": "Review firewall policies and apply an appropriate antivirus security profile to policies.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/243446",
    "audit": "Review all firewall policies and ensure that traffic has an antivirus security profile\nassigned for inspection.",
    "rationale": "Traffic moving between \"interfaces\" on the FortiGate should have firewall policies\napplied with an antivirus security profile applied.",
    "impact": null
  },
  {
    "rule_id": "8.2",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Ensure Anti-Malware Software and Signatures are",
    "cis_level": "• Level 2",
    "description": "Ensure FortiGate AV inspection uses outbreak prevention database as an added layer\nof protection on top of antivirus' signature-based detection.",
    "expected_values": "Disabled",
    "validation_logic": "On GUI:\n1. Go to \"Security Profiles\" > \"AntiVirus\".\n2. Select AV profile.\nValidate that \"Use FortiGuard outbreak prevention database\" is enabled.\nOn CLI:\nFGT1 # config antivirus profile\nFGT1 (profile) # show\nValidate that for each traffic protocol, \"set outbreak-prevention block\" is configured.",
    "remediation_steps": "Review Antivirus Security Profiles and validate that \"Use FortiGuard outbreak\nprevention database\" is enabled.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/889364\nPage 116",
    "audit": "On GUI:\n1. Go to \"Security Profiles\" > \"AntiVirus\".\n2. Select AV profile.\nValidate that \"Use FortiGuard outbreak prevention database\" is enabled.\nOn CLI:\nFGT1 # config antivirus profile\nFGT1 (profile) # show\nValidate that for each traffic protocol, \"set outbreak-prevention block\" is configured.",
    "rationale": "Antivirus mainly uses signature for malware blocking. By enabling \"FortiGuard outbreak\nprevention database\", FortiGate can leverage on 3rd party malware hash signatures\ncurated by the FortiGuard as an additional protection layer.\nThe hash signatures are obtained from FortiGuard's Global Threat Intelligence\ndatabase. The antivirus database queries FortiGuard with the hash of a scanned file. If\nFortiGuard returns a match, the scanned file is deemed to be malicious.",
    "impact": null
  },
  {
    "rule_id": "8.6",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Centralize Anti-malware Logging",
    "cis_level": "• Level 2",
    "description": "AI /heuristic based detection should be enabled.",
    "expected_values": "Enabled.",
    "validation_logic": "Configuration and verification can be only done on CLI.\nOn CLI:\nFGT1 # show antivirus settings | grep machine-learning-detection\nValidate that it is enabled.",
    "remediation_steps": "On CLI:\nFGT1 # config antivirus settings\nFGT1 (settings) # set machine-learning-detection enable",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.4.5/cli-\nreference/252375733/config-antivirus-settings\nPage 118",
    "audit": "Configuration and verification can be only done on CLI.\nOn CLI:\nFGT1 # show antivirus settings | grep machine-learning-detection\nValidate that it is enabled.",
    "rationale": "The AV Engine AI malware detection model integrates into regular AV scanning to help\ndetect potentially malicious Windows Portable Executables (PEs) in order to mitigate\nzero-day attacks. It is an additional layer of protection on top of traditional antivirus\nprotection.\nIn version 6.x, it is named \"Heuristic detection\". On version 7.x, Fortinet has renamed\nthis to AI based detection.",
    "impact": null
  },
  {
    "rule_id": "8.3",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Enable Operating System Anti-Exploitation Features/",
    "cis_level": "• Level 2",
    "description": "Grayware detection should be enabled.",
    "expected_values": "Enabled in 7.4 or newer. Older versions the default is disabled",
    "validation_logic": "CLI:\nFGT1 # show antivirus settings | grep grayware\nValidate that grayware detection is enabled.",
    "remediation_steps": "On CLI:\nFGT1 # config antivirus settings\nFGT1 (settings) # set grayware enable",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.4.5/cli-\nreference/252375733/config-antivirus-settings",
    "audit": "CLI:\nFGT1 # show antivirus settings | grep grayware\nValidate that grayware detection is enabled.",
    "rationale": "Usage of grayware is generally not allowed in strict company policies and some\ngraywares can be used for malicious intent. If the file passes the virus scan, it can be\nchecked for grayware. Grayware signatures are kept up to date in the same manner as\nthe antivirus definitions.",
    "impact": null
  },
  {
    "rule_id": "8.2",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Ensure Anti-Malware Software and Signatures are",
    "cis_level": "• Level 1\n• Level 2",
    "description": "Inline scanning is supported when the FortiGate is licensed with the FortiGuard AI-\nBased Sandbox Service (FAIS). It works similar to inline scanning for the FortiSandbox\nappliance, by holding a file up to 50 seconds for the verdict to be returned. Timed out\nscans can either be set to block, log, or ignore. Inline scanning can be enabled from the\nGUI on the Cloud Sandbox configuration page.\nEnabling Content Disarm & Reconstruction (CDR) for proxy mode on XLSB,\nOpenOffice, and RTF files enhances security by sanitizing potentially malicious content\nin these file types. This helps prevent threats embedded in documents while maintaining\nusability.\nNote that, this is only applicable for AV profiles and firewall policies in \"Proxy mode\".",
    "expected_values": "Disabled\nDisabled",
    "validation_logic": "On CLI:\nconfig system fortiguard\nget\nVerify if sandbox-inline-scan is enabled. Note that, sandbox-inline-scan will only\nshow up after sandbox region is set (this is done during initial setup). If there is no\nsandbox-inline-scan in the output, it means that this feature is not enabled.\nIf sandbox-inline-scan is enabled, check on CLI if it is enforced on AV security\nEnsure CDR is configured from GUI:\n1. Go to Security Profiles > AntiVirus and click Create New.\n2. Enable AntiVirus scan, and select Block.\n3. Set Feature set to Proxy-based.\n4. Under Inspected Protocols, enable one or more protocols that support\nproxy-based antivirus scanning.\n5. Under APT Protection Options, enable Content Disarm and Reconstruction,\nand select Apply CDR to office files to disarm Microsoft Office and\nOpenOffice files, including RTF (Rich Text Format) and XLSB (Excel Binary\nWorkbook) files.",
    "remediation_steps": "On GUI:\nEnable the FortiGate Cloud feature visibility:\n1. Go to System > Feature Visibility.\n2. In the Additional Features section, enable FortiGate Cloud Sandbox.\n3. Click Apply.\nConfigure the Cloud Sandbox Fabric connector:\n1. Go to Security Fabric > Fabric Connectors and double-click the Cloud\nSandbox card.\n2. Set the Type to FortiGate Cloud.\n3. Select a Region.\n4. Enable Inline scan.\n5. Click OK.\nConfigure the antivirus profile:\n1. Go to Security Profiles > AntiVirus and click Create New.\n2. Set the Feature set to Proxy-based.\n3. Enable the protocols to inspect.\n4. Enable Send files to FortiSandbox for inspection.\n5. Set the Scan strategy to Inline, and set the Action to Block.\n6. Click OK.\nOn CLI: Disable FortiSandbox appliance and FortiSandbox Cloud:\nconfig system fortisandbox\nset status disable\nend\nConfigure FortiGate Cloud Sandbox (example given is setting it as \"Global\" region):\n# execute forticloud-sandbox region\n0 Global\n1 Europe\n2 Japan\n3 US\nPlease select cloud sandbox region[0-3]:0\nCloud sandbox region is selected: Global\nEnable inline scanning for FortiGate Cloud:\nconfig system fortiguard\nset sandbox-region \"Global\"\nset sandbox-inline-scan enable\nend\nEnforced on AV security profile:\nPage 123\nconfig antivirus profile\nedit <profile name>\nset feature-set proxy\nset fortisandbox-mode inline\nconfig http\nset fortisandbox block\nend\nconfig ftp\nset fortisandbox block\nend\nconfig imap\nset fortisandbox block\nend\nconfig pop3\nset fortisandbox block\nend\nconfig mapi\nset fortisandbox block\nend\nconfig nntp\nset fortisandbox block\nend\nconfig cifs\nset fortisandbox block\nend\nconfig ssh\nset fortisandbox block\nend\nnext\nend\nTo configure antivirus CDR in the GUI:\nPage 125\n1. Go to Security Profiles > AntiVirus and click Create New.\n2. Enable AntiVirus scan, and select Block.\n3. Set Feature set to Proxy-based.\n4. Under Inspected Protocols, enable one or more protocols that support\nproxy-based antivirus scanning.\n5. Under APT Protection Options, enable Content Disarm and Reconstruction,\nand select Apply CDR to office files to disarm Microsoft Office and\nOpenOffice files, including RTF (Rich Text Format) and XLSB (Excel Binary\nWorkbook) files.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.4.5/administration-\nguide/571153/using-fortisandbox-inline-scanning-with-antivirus\nPage 124\n4.2.7 Enable CDR for proxy mode on XLSB, OpenOffice, and\nRTF files (Automated)\n1. https://docs.fortinet.com/document/fortigate/7.4.0/new-features/920942/support-\nxlsb-openoffice-and-rtf-files-for-cdr-in-antivirus-profiles-7-4-4",
    "audit": "On CLI:\nconfig system fortiguard\nget\nVerify if sandbox-inline-scan is enabled. Note that, sandbox-inline-scan will only\nshow up after sandbox region is set (this is done during initial setup). If there is no\nsandbox-inline-scan in the output, it means that this feature is not enabled.\nIf sandbox-inline-scan is enabled, check on CLI if it is enforced on AV security\nEnsure CDR is configured from GUI:\n1. Go to Security Profiles > AntiVirus and click Create New.\n2. Enable AntiVirus scan, and select Block.\n3. Set Feature set to Proxy-based.\n4. Under Inspected Protocols, enable one or more protocols that support\nproxy-based antivirus scanning.\n5. Under APT Protection Options, enable Content Disarm and Reconstruction,\nand select Apply CDR to office files to disarm Microsoft Office and\nOpenOffice files, including RTF (Rich Text Format) and XLSB (Excel Binary\nWorkbook) files.",
    "rationale": "With FAIS, unknown malware can be detected and blocked using cloud sandboxing\ntechnology. Using inline scanning with FAIS, patient zero can also be prevented. This\ncomplements the existing antivirus signature-based detection and also acts as an\nadditional layer of defense on top of FortiGate's AV heuristics feature.\nEnabling Content Disarm & Reconstruction (CDR) for XLSB, OpenOffice, and RTF files\nmitigates the risk of embedded malware by sanitizing potentially harmful content before\nit reaches the user. This proactive approach reduces the attack surface while ensuring\nbusiness continuity.",
    "impact": "Without CDR, malicious payloads hidden in these document formats could bypass\ntraditional security measures, leading to data breaches or system compromise."
  },
  {
    "rule_id": "4.3",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "DNS Filter",
    "cis_level": "• Level 2",
    "description": "Enable Botnet C&C domain blocking to block botnet access at the DNS name resolving\nstage.",
    "expected_values": "\"Redirect botnet C&C requests to Block Portal\" is enabled on default profile.",
    "validation_logic": "On GUI:\n1. Review DNS filters under Security Profiles > DNS Filter and ensure that\n\"Redirect botnet C&C requests to Block Portal\" is enabled.\n2. Ensure that firewall policies allowing DNS traffic have a DNS Filter\nSecurity profile applied.",
    "remediation_steps": "On GUI:\n1. Go to Security Profiles > DNS Filter.\n2. On the relevant security profile name, double click. Enable \"Redirect\nbotnet C&C requests to Block Portal\".\n2. Ensure that firewall policies that have DNS traffic have a DNS Filter\nsecurity profile applied with that option enabled.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/105208\nPage 128",
    "audit": "On GUI:\n1. Review DNS filters under Security Profiles > DNS Filter and ensure that\n\"Redirect botnet C&C requests to Block Portal\" is enabled.\n2. Ensure that firewall policies allowing DNS traffic have a DNS Filter\nSecurity profile applied.",
    "rationale": "Blocking botnet website access at the DNS resolution stage provides an additional layer\nof defense.",
    "impact": null
  },
  {
    "rule_id": "8.7",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Enable DNS Query Logging",
    "cis_level": "• Level 1",
    "description": "DNS filter should log all DNS queries and responses.",
    "expected_values": "Disabled\nPage 130",
    "validation_logic": "GUI:\n1. Go to \"Security Profiles\" > \"DNS Filter\".\n2. Select relevant DNS Filter profile.\nValidate that \"Log all DNS queries and responses\" is enabled.\nCLI:\nFGT1 # config dnsfilter profile\nFGT1 (profile) # show\nValidate that \"set log-all-domain enable\" is configured on DNS Filter profile.",
    "remediation_steps": "Review DNS Filter Security Profiles and validate that \"Log all DNS queries and\nresponses\" is enabled.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://community.fortinet.com/t5/FortiGate/Technical-Tip-FortiGate-Static-DNS-\nfilter-behavior-in-logging/ta-p/223110",
    "audit": "GUI:\n1. Go to \"Security Profiles\" > \"DNS Filter\".\n2. Select relevant DNS Filter profile.\nValidate that \"Log all DNS queries and responses\" is enabled.\nCLI:\nFGT1 # config dnsfilter profile\nFGT1 (profile) # show\nValidate that \"set log-all-domain enable\" is configured on DNS Filter profile.",
    "rationale": "DNS filter should log all DNS queries and responses (whether the DNS category is\nblocked, monitored, or allowed). This enables SOC or security analysts to do further\ninvestigations on security incidents, especially on threat hunting or incident response\nactivities. Although there are many data sources that can provide DNS query logs (AD\nor EDR), this option should be enabled out of best practice and with the assumption that\nno other data source is available.",
    "impact": "By default, allowed DNS is not logged. This creates a data gap in threat hunting or\nincident response activities."
  },
  {
    "rule_id": "8.7",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Enable DNS Query Logging",
    "cis_level": "• Level 1",
    "description": "Ensuring that traffic traversing to the Internet on the FortiGate has a DNS Filter security\nprofile inspecting it.",
    "expected_values": "Not Configured",
    "validation_logic": "Review firewall policies that handle traffic outbound to Internet has an DNS Filter\nsecurity profile assigned for inspection.",
    "remediation_steps": "Configure on \"Allowed\" firewall policies that handle traffic outbound to Internet to have\nan appropriate DNS Filter security profile applied to policies.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/243446",
    "audit": "Review firewall policies that handle traffic outbound to Internet has an DNS Filter\nsecurity profile assigned for inspection.",
    "rationale": "Traffic outbound to the Internet on the FortiGate should have firewall policies applied\nwith an DNS Filter security profile applied.",
    "impact": null
  },
  {
    "rule_id": "4.4",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Web Filtering",
    "cis_level": "• Level 1",
    "description": "Ensure FortiGuard Category-based Web filtering is blocking Security Risk categories",
    "expected_values": "By default, all categories under \"Security Risk\" and \"Unrated\" are set to Block.\nPage 134",
    "validation_logic": "GUI:\nGo to Security Profiles > Web Filter. Select the relevant web filter profile,\nif applicable. Validate that, within the \"Security Risk\" section, categories\nsuch as \"Malicious Websites\", \"Phishing\", and \"Spam URLs\" are set to the\naction \"Block\".",
    "remediation_steps": "Apply Web Filter profile to the firewall policy or SD-WAN and ensure that the Security\nRisk categories, including Malicious Websites, Phishing, and Spam URLs, are\nconfigured to Block.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.6.2/administration-\nguide/267887/configuring-a-web-filter-profile\nPage 135",
    "audit": "GUI:\nGo to Security Profiles > Web Filter. Select the relevant web filter profile,\nif applicable. Validate that, within the \"Security Risk\" section, categories\nsuch as \"Malicious Websites\", \"Phishing\", and \"Spam URLs\" are set to the\naction \"Block\".",
    "rationale": "Websites categorized under \"Security Risk\" pose significant threats to an organization's\nnetwork and users. Categories such as \"Dynamic DNS\", \"Malicious Websites\",\n\"Phishing\", and \"Spam URLs\" are often associated with cyber threats and serve as\ninitial access vectors for attacks such as malware distribution, phishing schemes,\ncommand-and-control activities, and data theft.\nIf any websites or web pages that fall under the FortiGuard URL Database Categories\n\"Dynamic DNS\", \"Newly Observed Domains\", or \"Newly Registered Domains\" are\nrequired to be allowed, this based on an organization's policy, those specific entries\nshould be configured under \"Monitor\" action in the web filter configuration.",
    "impact": "Setting the FortiGuard URL Database Categories \"Newly Observed Domains\" or \"Newly\nRegistered Domains\" to \"Block\" action, can significantly impact user access to websites,\nparticularly newly created website and/or uncategorized websites while it's relation to\nunrated category."
  },
  {
    "rule_id": "4.5",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Application Control",
    "cis_level": "• Level 1",
    "description": "Ensure FortiGate Application Control blocks high risk applications to reduce attack\nsurface.",
    "expected_values": "All application category \"Action\" is set as \"Monitor\" by default.",
    "validation_logic": "GUI:\n1. Go to \"Security Profiles\" > \"Application Control\".\n2. Select App Control profile.\nValidate that \"P2P\" and \"Proxy\" category is blocked.",
    "remediation_steps": "Review Application Control Security Profiles and validate that \"P2P\" and \"Proxy\"\ncategory is blocked.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/19814\nPage 137",
    "audit": "GUI:\n1. Go to \"Security Profiles\" > \"Application Control\".\n2. Select App Control profile.\nValidate that \"P2P\" and \"Proxy\" category is blocked.",
    "rationale": "High risk applications such as those in \"P2P\" and \"Proxy\" are known for spreading\nmalware. Some of this traffic is encrypted and therefore is able to bypass network\nsecurity inspection (for those without decryption implemented). Blocking these\napplications from running eliminates this risk.\nIf any application that falls under \"P2P\" and \"Proxy\" is required to be allowed based on\nan organization's policy, that specific application needs to be under \"Monitor\" mode in\nthe \"Application and Filter Override\" configuration.",
    "impact": null
  },
  {
    "rule_id": "9.5",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Implement Application Firewalls",
    "cis_level": "• Level 2",
    "description": "Ensure FortiGate Application Control blocks applications running on non-default ports.",
    "expected_values": "Disabled",
    "validation_logic": "On GUI:\n1. Go to \"Security Profiles\" > \"Application Control\".\n2. Select relevant App Control profile.\nValidate that \"Block applications detected on non-default ports\" option is enabled.",
    "remediation_steps": "GUI:\n1. Go to \"Security Profiles\" > \"Application Control\".\n2. Select relevant App Control profile.\nEnable \"Block applications detected on non-default ports\" option.\nOn CLI:\nFGT1 # config application list\nFGT1 (list) # edit <profile name>\nFGT1 (<profile name>) # set enforce-default-app-port enable",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/66882\nPage 139",
    "audit": "On GUI:\n1. Go to \"Security Profiles\" > \"Application Control\".\n2. Select relevant App Control profile.\nValidate that \"Block applications detected on non-default ports\" option is enabled.",
    "rationale": "Running applications on non-default ports is not directly a threat, but can be an\nindication of something unexpected. For example, HTTPS runs on port 443. Potentially,\nif an attacker starts a rogue HTTPS server on port 10443, it could be used for data\nexfiltration.",
    "impact": null
  },
  {
    "rule_id": "0.0",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Explicitly Not Mapped",
    "cis_level": "• Level 1",
    "description": "Ensure no category is set to \"Allow\" on FortiGate Application Control.",
    "expected_values": "\"Unknown Applications\" category is set as \"Allow\".",
    "validation_logic": "On GUI:\n1. Review \"Security Profiles\" > \"Application Control\".\n2. Select the relevant App Control profile.\nValidate that no \"Allow\" action is set on any categories.",
    "remediation_steps": "On GUI:\n1. Go to \"Security Profiles\" > \"Application Control\".\n2. Select the relevant App Control profile.\n3. Change any categories with \"Allow\" action to \"Monitor\".",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/19814\nPage 141",
    "audit": "On GUI:\n1. Review \"Security Profiles\" > \"Application Control\".\n2. Select the relevant App Control profile.\nValidate that no \"Allow\" action is set on any categories.",
    "rationale": "Any category that is set as \"Allow\" on Application Control will not be logged. This\ncreates a visibility gap on security investigation. This includes \"Unknown Applications\"\ncategory.",
    "impact": "Visibility gap, which affects incident forensics and response."
  },
  {
    "rule_id": "6.3",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Enable Detailed Logging",
    "cis_level": "• Level 1",
    "description": "Ensuring that traffic traversing between networks on the FortiGate have an Application\nControl security profile inspecting it.",
    "expected_values": "Not Configured",
    "validation_logic": "Review all firewall policies and ensure that traffic has an Application Control\nsecurity profile assigned for inspection.",
    "remediation_steps": "Configure on all \"Allowed\" firewall policies to have an appropriate Application\nControl security profile applied to policies.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/243446",
    "audit": "Review all firewall policies and ensure that traffic has an Application Control\nsecurity profile assigned for inspection.",
    "rationale": "Traffic moving between \"interfaces\" on the FortiGate should have firewall policies\napplied with an Application Control security profile applied.",
    "impact": null
  },
  {
    "rule_id": "5.1",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Automation",
    "cis_level": "• Level 1",
    "description": "Default automation trigger configuration for when a high severity compromised host is\ndetected.",
    "expected_values": "Not enabled",
    "validation_logic": "GUI\nSecurity Fabric > Automation\nVerify Compromised Host Quarantine is enabled.",
    "remediation_steps": "GUI\nSecurity Fabric > Automation\nEdit and change Disabled to Enabled\nCLI\nPage 147\nconfig system automation-action\nedit \"Quarantine on FortiSwitch + FortiAP\"\nset description \"Default automation action configuration for\nquarantining a MAC address on FortiSwitches and FortiAPs.\"\nset action-type quarantine\nnext\nedit \"Quarantine FortiClient EMS Endpoint\"\nset description \"Default automation action configuration for\nquarantining a FortiClient EMS endpoint device.\"\nset action-type quarantine-forticlient\nnext\nend\nconfig system automation-trigger\nedit \"Compromised Host - High\"\nset description \"Default automation trigger configuration for when a\nhigh severity compromised host is detected.\"\nnext\nend\nconfig system automation-stitch\nedit \"Compromised Host Quarantine\"\nset description \"Default automation stitch to quarantine a high\nseverity compromised host on FortiAPs, FortiSwitches, and FortiClient EMS.\"\nset status enable\nset trigger \"Compromised Host - High\"\nconfig actions\nedit 1\nset action \"Quarantine on FortiSwitch + FortiAP\"\nnext\nedit 2\nset action \"Quarantine FortiClient EMS Endpoint\"\nnext\nend\nnext\nend",
    "severity": null,
    "is_active": true,
    "references_text": null,
    "audit": "GUI\nSecurity Fabric > Automation\nVerify Compromised Host Quarantine is enabled.",
    "rationale": "By enabling this feature you protect your environment against compromised hosts.\nDefault automation stitch to quarantine a high severity compromised host on FortiAPs,\nFortiSwitches, and FortiClient EMS.\nPlease note that this is only applicable if you have Fortinet's solution ecosystem\n(FortiGate with FortiAP, FortiSwitches, or FortiClient EMS).",
    "impact": null
  },
  {
    "rule_id": "5.2",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Fabric Connectors",
    "cis_level": "• Level 2",
    "description": "Ensure Root FortiGate is configured as security fabric root.",
    "expected_values": "Disabled\nPage 152",
    "validation_logic": "Review through the GUI:\n1. Go to \"Security Fabric\" -> Fabric Connectors and then select \"Security\nFabric Setup\".\n2. Validate that the root FortiGate has status set to enabled and the\nSecurity Fabric Role set to \"Serve as Fabric Root\".\n3. Ensure that FortiAnalyzer settings are correct and that there is a defined\nFabric name as well as interfaces selected that will \"Allow other Security\nFabric Devices to Join\".",
    "remediation_steps": "Remediation through the GUI:\n1. Go to \"Security Fabric\" -> Fabric Connectors and then select \"Security\nFabric Setup\".\n2. On the root FortiGate, set the status to enabled and the Security Fabric\nRole to \"Serve as Fabric Root\".\n3. Configure FortiAnalyzer settings when prompted and define a Fabric name as\nwell as interfaces that will \"Allow other Security Fabric Devices to Join\".",
    "severity": null,
    "is_active": true,
    "references_text": null,
    "audit": "Review through the GUI:\n1. Go to \"Security Fabric\" -> Fabric Connectors and then select \"Security\nFabric Setup\".\n2. Validate that the root FortiGate has status set to enabled and the\nSecurity Fabric Role set to \"Serve as Fabric Root\".\n3. Ensure that FortiAnalyzer settings are correct and that there is a defined\nFabric name as well as interfaces selected that will \"Allow other Security\nFabric Devices to Join\".",
    "rationale": "Without a root FortiGate configured, the security fabric is not functional and can not be\nleveraged.\nPlease note that this is only applicable if security fabric function within FortiGate is used.",
    "impact": "Without Security Fabric enabled, visibility and management of traffic throughout an\norganization is decreased and individual FortiGate management becomes more\nintensive."
  },
  {
    "rule_id": "6.1",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "SSL VPN",
    "cis_level": "• Level 2",
    "description": "Apply a signed certificate from a trusted Certificate Authority (CA) to the SSL VPN portal\nto allow users to connect securely with confidence.",
    "expected_values": "Self Signed Factory installed certificate",
    "validation_logic": "GUI:\n1. Access the FortiGate administrative web access page.\n2. Go to VPN > SSL-VPN Settings and assign a signed certificate in the\ndropdown for \"Server Certificate\".",
    "remediation_steps": "Import a signed certificate from a trusted CA through the GUI:\n1. Go to System > Certificates > Import.\n2. Then assign the certificate to the SSL VPN portal by going to VPN > SSL-\nVPN Settings and selecting the proper certificate in the dropdown for \"Server\nCertificate\".",
    "severity": null,
    "is_active": true,
    "references_text": null,
    "audit": "GUI:\n1. Access the FortiGate administrative web access page.\n2. Go to VPN > SSL-VPN Settings and assign a signed certificate in the\ndropdown for \"Server Certificate\".",
    "rationale": "Having an unsigned or self signed certificate leaves connections open to man-in-the-\nmiddle attacks and could allow users to connect to untrusted servers.",
    "impact": null
  },
  {
    "rule_id": "1.8",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Utilize Client Certificates to Authenticate Hardware",
    "cis_level": "• Level 2",
    "description": "Enable and disable TLS versions and Cipher suites for more granular control of SSL\nVPN connections and enforcing more secure connections.",
    "expected_values": "ssl-max-proto-ver : tls1-3\nssl-min-proto-ver : tls1-2\nalgorithm : high",
    "validation_logic": "CLI:\nconfig vpn ssl settings\nget\nValidate that:\nssl-max-prot-ver is set to tls1-3.\nssl-min-proto-ver is set to tls1-2.\nalgorithm is set to high.",
    "remediation_steps": "CLI:\nconfig vpn ssl settings\nset ssl-max-proto-ver tls1-3\nset ssl-min-proto-ver tls1-2\nset algorithm high",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.4.5/cli-\nreference/114404382/config-vpn-ssl-settings\nPage 158",
    "audit": "CLI:\nconfig vpn ssl settings\nget\nValidate that:\nssl-max-prot-ver is set to tls1-3.\nssl-min-proto-ver is set to tls1-2.\nalgorithm is set to high.",
    "rationale": "Limiting TLS versions to more secure versions as well as enforcing stronger ciphers\nincreases the security of the SSL VPN connections.",
    "impact": null
  },
  {
    "rule_id": "7.1",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Enable Logging",
    "cis_level": "• Level 2",
    "description": "Enabling event logging to allow for log generation and review.",
    "expected_values": "Enabled",
    "validation_logic": "CLI:\nconfig log eventfilter\nget\nValidate that all event types are enabled.",
    "remediation_steps": "On GUI:\n1. Go to Log & Report > Log Settings.\n2. Enable \"All\" Event Logging.\nOn CLI:\nconfig log eventfilter\nset event enable\nend",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/250999\nPage 162",
    "audit": "CLI:\nconfig log eventfilter\nget\nValidate that all event types are enabled.",
    "rationale": "Enabling event logging generates logs that can be stored for later review or auditing or\ncan be ingested by another system (SIEM, Analyzer) for monitoring and response.",
    "impact": null
  },
  {
    "rule_id": "7.2",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Centralized Logging and Reporting",
    "cis_level": "• Level 2",
    "description": "Device logs should be sent to a centralized device for log collection, retention, and\nreporting. This could be a SIEM. syslog device, FortiAnalyzer, FortiManager, etc.",
    "expected_values": "Not configured.",
    "validation_logic": "On GUI:\n1. Go to Log & Report > Log Settings.\n2. Validate under \"Syslog logging\" that logs are being offloaded to another\ndevice.",
    "remediation_steps": "Configure a remote server for logs to be sent to:\n1. Go to Log & Report > Log Settings.\n2. Under \"Syslog logging\" configure a remote server to send logs to.",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortigate/7.4.5/administration-guide/250999",
    "audit": "On GUI:\n1. Go to Log & Report > Log Settings.\n2. Validate under \"Syslog logging\" that logs are being offloaded to another\ndevice.",
    "rationale": "Centralized logging allows for more reliable log retention and more enriched log data for\nreview and reporting.",
    "impact": null
  },
  {
    "rule_id": "7.3",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Encrypt Logs in Transit",
    "cis_level": "• Level 1",
    "description": "Enable encryption for logs that are sent to FortiAnalyzer or FortiManager.",
    "expected_values": "Disabled",
    "validation_logic": "CLI:\nconfig log fortianalyzer setting\nget\nValidate enc-algorithm is set to high.\nValidate reliable is set enabled.",
    "remediation_steps": "Secure log transfer settings can only be configured on CLI:\nconfig log fortianalyzer setting\nset reliable enable\nset enc-algorithm high\nend",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortianalyzer/7.4.5/administration-\nguide/410387\nPage 168",
    "audit": "CLI:\nconfig log fortianalyzer setting\nget\nValidate enc-algorithm is set to high.\nValidate reliable is set enabled.",
    "rationale": "Provides encryption for logs that are sent to FortiAnalyzer or FortiManager to prevent\nlogs being collected and viewed as they traverse the network.",
    "impact": null
  },
  {
    "rule_id": "14.4",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Encrypt All Sensitive Information in Transit",
    "cis_level": "• Level 1",
    "description": "Enable encryption for logs that are sent to FortiAnalyzer or FortiManager.",
    "expected_values": "Disabled",
    "validation_logic": "CLI:\nconfig log syslog setting\nget\nValidate enc-algorithm is set to high.\nValidate reliable is set enabled.",
    "remediation_steps": "Secure log transfer settings can only be configured on CLI:\nconfig log syslog setting\nset reliable enable\nset enc-algorithm high\nend",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortianalyzer/7.4.5/administration-\nguide/410387",
    "audit": "CLI:\nconfig log syslog setting\nget\nValidate enc-algorithm is set to high.\nValidate reliable is set enabled.",
    "rationale": "Provides encryption for logs that are sent to syslog to prevent logs being collected and\nviewed as they traverse the network.",
    "impact": null
  },
  {
    "rule_id": "14.4",
    "benchmark": "CIS FortiGate 7.4.x Benchmark v1.0.1",
    "device_type": "FortiGate",
    "control_name": "Encrypt All Sensitive Information in Transit",
    "cis_level": "• Level 1",
    "description": "Enable encryption for logs that are sent to FortiAnalyzer or FortiManager.",
    "expected_values": "Disabled",
    "validation_logic": "CLI:\nconfig log syslog setting\nget\nValidate enc-algorithm is set to high.\nValidate reliable is set enabled.",
    "remediation_steps": "Secure log transfer settings can only be configured on CLI:\nconfig log syslog setting\nset reliable enable\nset enc-algorithm high\nend",
    "severity": null,
    "is_active": true,
    "references_text": "1. https://docs.fortinet.com/document/fortianalyzer/7.4.5/administration-\nguide/410387",
    "audit": "CLI:\nconfig log syslog setting\nget\nValidate enc-algorithm is set to high.\nValidate reliable is set enabled.",
    "rationale": "Provides encryption for logs that are sent to syslog to prevent logs being collected and\nviewed as they traverse the network.",
    "impact": null
  }
]